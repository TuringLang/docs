<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../tutorials/docs-07-for-developers-variational-inference/index.html" rel="prev">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/docs-00-getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/00-introduction/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.34" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.34</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.34">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Users</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-00-getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-12-using-turing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Core Functionality</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Usage Tips</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-10-using-turing-autodiff/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-custom-distribution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Custom Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-probability-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Querying Model Probabilities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-modifying-logprob/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modifying the Log Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-generated-quantities/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generated Quantities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-13-using-turing-performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-15-using-turing-sampler-viz/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-11-using-turing-dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-16-using-turing-external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/00-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction: Coin Flipping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/01-gaussian-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/02-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/03-bayesian-neural-network/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/04-hidden-markov-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/05-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/06-infinite-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/07-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/08-multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/09-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/10-bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/11-probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/13-seasonal-time-series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/15-gaussian-processes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Gaussian Processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/12-gplvm/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Contributing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-01-contributing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to Contribute</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">DynamicPPL in Depth</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/dev-model-manual/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manually Defining a Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-05-for-developers-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/14-minituring/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/16-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Inference (note: outdated)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-06-for-developers-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-24.1761294868027</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-24.1761294868027</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([0.0, 0.0, 0.0]), MALAState{Vector{Float64}}([0.0, 0.0, 0.0]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -3.3441   -3.52549   -5.50598   -5.50598   …  -4.71453  -4.12916  -4.12916
 -1.32274  -0.084669   0.527702   0.527702     -1.11659   1.6231    1.6231
  4.23413   3.92466    4.29465    4.29465       5.57358   5.58786   5.58786</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.97948    0.991815
  0.0367258  1.00061
  5.00575    1.00843</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip030">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip030)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip031">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip030)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip032">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip032)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip032)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip032)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip032)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip032)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip032)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1630.18 2640.76,1630.18 "></polyline>
<polyline clip-path="url(#clip032)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1391.85 2640.76,1391.85 "></polyline>
<polyline clip-path="url(#clip032)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1153.51 2640.76,1153.51 "></polyline>
<polyline clip-path="url(#clip032)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,915.175 2640.76,915.175 "></polyline>
<polyline clip-path="url(#clip032)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,676.839 2640.76,676.839 "></polyline>
<polyline clip-path="url(#clip032)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,438.504 2640.76,438.504 "></polyline>
<polyline clip-path="url(#clip032)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,200.168 2640.76,200.168 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip030)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1630.18 215.714,1630.18 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1391.85 215.714,1391.85 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1153.51 215.714,1153.51 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,915.175 215.714,915.175 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,676.839 215.714,676.839 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,438.504 215.714,438.504 "></polyline>
<polyline clip-path="url(#clip030)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,200.168 215.714,200.168 "></polyline>
<path clip-path="url(#clip030)" d="M50.5475 1630.63 L80.2233 1630.63 L80.2233 1634.57 L50.5475 1634.57 L50.5475 1630.63 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M89.1352 1612.9 L111.357 1612.9 L111.357 1614.89 L98.8111 1647.46 L93.9269 1647.46 L105.732 1616.84 L89.1352 1616.84 L89.1352 1612.9 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M120.478 1641.58 L125.362 1641.58 L125.362 1647.46 L120.478 1647.46 L120.478 1641.58 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M135.593 1612.9 L153.95 1612.9 L153.95 1616.84 L139.876 1616.84 L139.876 1625.31 Q140.894 1624.96 141.913 1624.8 Q142.931 1624.61 143.95 1624.61 Q149.737 1624.61 153.116 1627.78 Q156.496 1630.96 156.496 1636.37 Q156.496 1641.95 153.024 1645.05 Q149.552 1648.13 143.232 1648.13 Q141.056 1648.13 138.788 1647.76 Q136.542 1647.39 134.135 1646.65 L134.135 1641.95 Q136.218 1643.09 138.441 1643.64 Q140.663 1644.2 143.14 1644.2 Q147.144 1644.2 149.482 1642.09 Q151.82 1639.98 151.82 1636.37 Q151.82 1632.76 149.482 1630.66 Q147.144 1628.55 143.14 1628.55 Q141.265 1628.55 139.39 1628.97 Q137.538 1629.38 135.593 1630.26 L135.593 1612.9 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M49.5521 1392.3 L79.2279 1392.3 L79.2279 1396.23 L49.5521 1396.23 L49.5521 1392.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M89.3667 1374.57 L107.723 1374.57 L107.723 1378.5 L93.6491 1378.5 L93.6491 1386.97 Q94.6676 1386.63 95.6861 1386.46 Q96.7047 1386.28 97.7232 1386.28 Q103.51 1386.28 106.89 1389.45 Q110.269 1392.62 110.269 1398.04 Q110.269 1403.62 106.797 1406.72 Q103.325 1409.8 97.0056 1409.8 Q94.8297 1409.8 92.5612 1409.43 Q90.3158 1409.06 87.9084 1408.32 L87.9084 1403.62 Q89.9917 1404.75 92.2139 1405.31 Q94.4361 1405.86 96.913 1405.86 Q100.918 1405.86 103.256 1403.76 Q105.593 1401.65 105.593 1398.04 Q105.593 1394.43 103.256 1392.32 Q100.918 1390.21 96.913 1390.21 Q95.038 1390.21 93.163 1390.63 Q91.3112 1391.05 89.3667 1391.93 L89.3667 1374.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M119.482 1403.25 L124.367 1403.25 L124.367 1409.13 L119.482 1409.13 L119.482 1403.25 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M144.552 1377.64 Q140.941 1377.64 139.112 1381.21 Q137.306 1384.75 137.306 1391.88 Q137.306 1398.99 139.112 1402.55 Q140.941 1406.09 144.552 1406.09 Q148.186 1406.09 149.991 1402.55 Q151.82 1398.99 151.82 1391.88 Q151.82 1384.75 149.991 1381.21 Q148.186 1377.64 144.552 1377.64 M144.552 1373.94 Q150.362 1373.94 153.417 1378.55 Q156.496 1383.13 156.496 1391.88 Q156.496 1400.61 153.417 1405.21 Q150.362 1409.8 144.552 1409.8 Q138.741 1409.8 135.663 1405.21 Q132.607 1400.61 132.607 1391.88 Q132.607 1383.13 135.663 1378.55 Q138.741 1373.94 144.552 1373.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M50.5475 1153.96 L80.2233 1153.96 L80.2233 1157.9 L50.5475 1157.9 L50.5475 1153.96 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M94.3436 1166.85 L110.663 1166.85 L110.663 1170.79 L88.7186 1170.79 L88.7186 1166.85 Q91.3806 1164.1 95.9639 1159.47 Q100.57 1154.82 101.751 1153.48 Q103.996 1150.95 104.876 1149.22 Q105.779 1147.46 105.779 1145.77 Q105.779 1143.01 103.834 1141.28 Q101.913 1139.54 98.8111 1139.54 Q96.6121 1139.54 94.1584 1140.3 Q91.7278 1141.07 88.9501 1142.62 L88.9501 1137.9 Q91.7741 1136.76 94.2278 1136.18 Q96.6815 1135.6 98.7185 1135.6 Q104.089 1135.6 107.283 1138.29 Q110.478 1140.98 110.478 1145.47 Q110.478 1147.6 109.668 1149.52 Q108.881 1151.42 106.774 1154.01 Q106.195 1154.68 103.094 1157.9 Q99.9917 1161.09 94.3436 1166.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M120.478 1164.91 L125.362 1164.91 L125.362 1170.79 L120.478 1170.79 L120.478 1164.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M135.593 1136.23 L153.95 1136.23 L153.95 1140.17 L139.876 1140.17 L139.876 1148.64 Q140.894 1148.29 141.913 1148.13 Q142.931 1147.94 143.95 1147.94 Q149.737 1147.94 153.116 1151.11 Q156.496 1154.29 156.496 1159.7 Q156.496 1165.28 153.024 1168.38 Q149.552 1171.46 143.232 1171.46 Q141.056 1171.46 138.788 1171.09 Q136.542 1170.72 134.135 1169.98 L134.135 1165.28 Q136.218 1166.41 138.441 1166.97 Q140.663 1167.53 143.14 1167.53 Q147.144 1167.53 149.482 1165.42 Q151.82 1163.31 151.82 1159.7 Q151.82 1156.09 149.482 1153.98 Q147.144 1151.88 143.14 1151.88 Q141.265 1151.88 139.39 1152.29 Q137.538 1152.71 135.593 1153.59 L135.593 1136.23 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M99.3204 900.973 Q95.7093 900.973 93.8806 904.538 Q92.075 908.08 92.075 915.209 Q92.075 922.316 93.8806 925.88 Q95.7093 929.422 99.3204 929.422 Q102.955 929.422 104.76 925.88 Q106.589 922.316 106.589 915.209 Q106.589 908.08 104.76 904.538 Q102.955 900.973 99.3204 900.973 M99.3204 897.27 Q105.131 897.27 108.186 901.876 Q111.265 906.459 111.265 915.209 Q111.265 923.936 108.186 928.543 Q105.131 933.126 99.3204 933.126 Q93.5102 933.126 90.4315 928.543 Q87.376 923.936 87.376 915.209 Q87.376 906.459 90.4315 901.876 Q93.5102 897.27 99.3204 897.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M119.482 926.575 L124.367 926.575 L124.367 932.455 L119.482 932.455 L119.482 926.575 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M144.552 900.973 Q140.941 900.973 139.112 904.538 Q137.306 908.08 137.306 915.209 Q137.306 922.316 139.112 925.88 Q140.941 929.422 144.552 929.422 Q148.186 929.422 149.991 925.88 Q151.82 922.316 151.82 915.209 Q151.82 908.08 149.991 904.538 Q148.186 900.973 144.552 900.973 M144.552 897.27 Q150.362 897.27 153.417 901.876 Q156.496 906.459 156.496 915.209 Q156.496 923.936 153.417 928.543 Q150.362 933.126 144.552 933.126 Q138.741 933.126 135.663 928.543 Q132.607 923.936 132.607 915.209 Q132.607 906.459 135.663 901.876 Q138.741 897.27 144.552 897.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M94.3436 690.184 L110.663 690.184 L110.663 694.119 L88.7186 694.119 L88.7186 690.184 Q91.3806 687.429 95.9639 682.8 Q100.57 678.147 101.751 676.804 Q103.996 674.281 104.876 672.545 Q105.779 670.786 105.779 669.096 Q105.779 666.341 103.834 664.605 Q101.913 662.869 98.8111 662.869 Q96.6121 662.869 94.1584 663.633 Q91.7278 664.397 88.9501 665.948 L88.9501 661.226 Q91.7741 660.092 94.2278 659.513 Q96.6815 658.934 98.7185 658.934 Q104.089 658.934 107.283 661.619 Q110.478 664.304 110.478 668.795 Q110.478 670.925 109.668 672.846 Q108.881 674.744 106.774 677.337 Q106.195 678.008 103.094 681.226 Q99.9917 684.42 94.3436 690.184 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M120.478 688.24 L125.362 688.24 L125.362 694.119 L120.478 694.119 L120.478 688.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M135.593 659.559 L153.95 659.559 L153.95 663.494 L139.876 663.494 L139.876 671.966 Q140.894 671.619 141.913 671.457 Q142.931 671.272 143.95 671.272 Q149.737 671.272 153.116 674.443 Q156.496 677.615 156.496 683.031 Q156.496 688.61 153.024 691.712 Q149.552 694.79 143.232 694.79 Q141.056 694.79 138.788 694.42 Q136.542 694.05 134.135 693.309 L134.135 688.61 Q136.218 689.744 138.441 690.3 Q140.663 690.855 143.14 690.855 Q147.144 690.855 149.482 688.749 Q151.82 686.642 151.82 683.031 Q151.82 679.42 149.482 677.314 Q147.144 675.207 143.14 675.207 Q141.265 675.207 139.39 675.624 Q137.538 676.04 135.593 676.92 L135.593 659.559 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M89.3667 421.224 L107.723 421.224 L107.723 425.159 L93.6491 425.159 L93.6491 433.631 Q94.6676 433.284 95.6861 433.122 Q96.7047 432.937 97.7232 432.937 Q103.51 432.937 106.89 436.108 Q110.269 439.279 110.269 444.696 Q110.269 450.274 106.797 453.376 Q103.325 456.455 97.0056 456.455 Q94.8297 456.455 92.5612 456.085 Q90.3158 455.714 87.9084 454.973 L87.9084 450.274 Q89.9917 451.409 92.2139 451.964 Q94.4361 452.52 96.913 452.52 Q100.918 452.52 103.256 450.413 Q105.593 448.307 105.593 444.696 Q105.593 441.085 103.256 438.978 Q100.918 436.872 96.913 436.872 Q95.038 436.872 93.163 437.288 Q91.3112 437.705 89.3667 438.585 L89.3667 421.224 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M119.482 449.904 L124.367 449.904 L124.367 455.784 L119.482 455.784 L119.482 449.904 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M144.552 424.302 Q140.941 424.302 139.112 427.867 Q137.306 431.409 137.306 438.538 Q137.306 445.645 139.112 449.21 Q140.941 452.751 144.552 452.751 Q148.186 452.751 149.991 449.21 Q151.82 445.645 151.82 438.538 Q151.82 431.409 149.991 427.867 Q148.186 424.302 144.552 424.302 M144.552 420.599 Q150.362 420.599 153.417 425.205 Q156.496 429.788 156.496 438.538 Q156.496 447.265 153.417 451.872 Q150.362 456.455 144.552 456.455 Q138.741 456.455 135.663 451.872 Q132.607 447.265 132.607 438.538 Q132.607 429.788 135.663 425.205 Q138.741 420.599 144.552 420.599 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M89.1352 182.888 L111.357 182.888 L111.357 184.879 L98.8111 217.448 L93.9269 217.448 L105.732 186.823 L89.1352 186.823 L89.1352 182.888 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M120.478 211.569 L125.362 211.569 L125.362 217.448 L120.478 217.448 L120.478 211.569 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip030)" d="M135.593 182.888 L153.95 182.888 L153.95 186.823 L139.876 186.823 L139.876 195.296 Q140.894 194.948 141.913 194.786 Q142.931 194.601 143.95 194.601 Q149.737 194.601 153.116 197.772 Q156.496 200.944 156.496 206.36 Q156.496 211.939 153.024 215.041 Q149.552 218.12 143.232 218.12 Q141.056 218.12 138.788 217.749 Q136.542 217.379 134.135 216.638 L134.135 211.939 Q136.218 213.073 138.441 213.629 Q140.663 214.184 143.14 214.184 Q147.144 214.184 149.482 212.078 Q151.82 209.971 151.82 206.36 Q151.82 202.749 149.482 200.643 Q147.144 198.536 143.14 198.536 Q141.265 198.536 139.39 198.953 Q137.538 199.37 135.593 200.249 L135.593 182.888 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip032)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1233.98 268.292,1564.08 270.6,1294.93 272.908,1363.21 275.216,1307.7 277.524,1449.97 279.832,1469.59 282.139,1359.73 284.447,1359.92 286.755,1357.76 289.063,1544.37 291.371,1474.86 293.679,1377.76 295.987,1455.11 298.295,1390.5 300.603,1287.92 302.911,1416.09 305.219,1386.75 307.527,1469.02 309.834,1314.58 312.142,1341.53 314.45,1248.81 316.758,1282.89 319.066,1269.93 321.374,1373.53 323.682,1273.06 325.99,1463.73 328.298,1427.9 330.606,1377.59 332.914,1544.55 335.221,1455.68 337.529,1404.49 339.837,1256.25 342.145,1343.37 344.453,1220.39 346.761,1402.63 349.069,1468.25 351.377,1388.45 353.685,1138.51 355.993,1442.47 358.301,1353.3 360.608,1376.12 362.916,1395.08 365.224,1447.61 367.532,1486.21 369.84,1311.02 372.148,1419.02 374.456,1558.16 376.764,1359 379.072,1080.4 381.38,1347.26 383.688,1344.6 385.996,1392.24 388.303,1412.6 390.611,1453.72 392.919,1429.23 395.227,1288.96 397.535,1422.82 399.843,1481.58 402.151,1304.53 404.459,1529.36 406.767,1503.55 409.075,1499.28 411.383,1438.66 413.69,1294.42 415.998,1455 418.306,1408.45 420.614,1360.42 422.922,1561.51 425.23,1551.74 427.538,1468.13 429.846,1386.69 432.154,1338.98 434.462,1324.95 436.77,1347.69 439.077,1335.38 441.385,1395.2 443.693,1383.37 446.001,1385.52 448.309,1363.87 450.617,1414.58 452.925,1411.44 455.233,1551.88 457.541,1415.62 459.849,1416.23 462.157,1378.73 464.465,1453.57 466.772,1402.83 469.08,1322.67 471.388,1249.55 473.696,1344.36 476.004,1352.92 478.312,1349.55 480.62,1368.47 482.928,1309.2 485.236,1370.85 487.544,1380.24 489.852,1329.71 492.159,1505.57 494.467,1437.22 496.775,1222.63 499.083,1337.94 501.391,1334.64 503.699,1316.8 506.007,1438.55 508.315,1335.69 510.623,1234.04 512.931,1361.55 515.239,1304.42 517.546,1183.38 519.854,1397.01 522.162,1436.31 524.47,1222.1 526.778,1466.01 529.086,1215.95 531.394,1324.78 533.702,1343.6 536.01,1426.99 538.318,1385.33 540.626,1492.69 542.933,1159.33 545.241,1187.22 547.549,1371.14 549.857,1426.82 552.165,1524.49 554.473,1371.22 556.781,1238.33 559.089,1373.58 561.397,1361.21 563.705,1385.92 566.013,1471.53 568.321,1487.77 570.628,1623.14 572.936,1404.12 575.244,1290.69 577.552,1444.64 579.86,1303.84 582.168,1358.07 584.476,1467.4 586.784,1244.45 589.092,1432.54 591.4,1408.4 593.708,1349.01 596.015,1360.02 598.323,1527.6 600.631,1442.88 602.939,1425.68 605.247,1387.69 607.555,1367.56 609.863,1389.72 612.171,1488.43 614.479,1333.27 616.787,1387.79 619.095,1322.96 621.402,1449.5 623.71,1396.81 626.018,1235.65 628.326,1438.5 630.634,1245.93 632.942,1344.89 635.25,1496.27 637.558,1359.38 639.866,1431.36 642.174,1372.12 644.482,1302.55 646.79,1475.58 649.097,1367.97 651.405,1358.27 653.713,1379.73 656.021,1306.54 658.329,1349.62 660.637,1489.54 662.945,1392.1 665.253,1489.18 667.561,1287.1 669.869,1403.18 672.177,1385.43 674.484,1369.69 676.792,1339.68 679.1,1389.21 681.408,1335.87 683.716,1183.44 686.024,1391.3 688.332,1496.78 690.64,1416.69 692.948,1434.73 695.256,1377.37 697.564,1342.82 699.871,1521.46 702.179,1387.61 704.487,1312.17 706.795,1272.41 709.103,1380.42 711.411,1451.15 713.719,1467.5 716.027,1242.28 718.335,1494.56 720.643,1454.18 722.951,1463.43 725.259,1362.25 727.566,1374.51 729.874,1274.92 732.182,1429.42 734.49,1332.44 736.798,1075.79 739.106,1622.41 741.414,1410.94 743.722,1378.49 746.03,1315.5 748.338,1479.78 750.646,1284.51 752.953,1428.57 755.261,1344.96 757.569,1278.42 759.877,1386.36 762.185,1390.22 764.493,1264.74 766.801,1358.32 769.109,1244.57 771.417,1519.53 773.725,1482.3 776.033,1410.2 778.34,1382.94 780.648,1551.97 782.956,1429.99 785.264,1249 787.572,1514.27 789.88,1474.9 792.188,1477.98 794.496,1426.12 796.804,1464.94 799.112,1442.87 801.42,1249.24 803.728,1557.73 806.035,1422.92 808.343,1407.78 810.651,1362 812.959,1412.64 815.267,1155.03 817.575,1446.59 819.883,1370.75 822.191,1362.98 824.499,1309.24 826.807,1615.68 829.115,1549.27 831.422,1473.96 833.73,1567.88 836.038,1256.72 838.346,1446.54 840.654,1326.85 842.962,1249.44 845.27,1484.46 847.578,1516.99 849.886,1329.35 852.194,1271.43 854.502,1413.29 856.809,1346.7 859.117,1403.64 861.425,1232.07 863.733,1385.55 866.041,1229.46 868.349,1411.9 870.657,1458.74 872.965,1446.33 875.273,1453.63 877.581,1512.7 879.889,1226.15 882.197,1555.88 884.504,1529.72 886.812,1261.45 889.12,1330.21 891.428,1335.81 893.736,1392.49 896.044,1434.34 898.352,1535.35 900.66,1372.23 902.968,1432.17 905.276,1546.88 907.584,1563.58 909.891,1394.88 912.199,1434.16 914.507,1341.7 916.815,1383.17 919.123,1339.26 921.431,1601.64 923.739,1513.06 926.047,1353.53 928.355,1291.54 930.663,1360.2 932.971,1427.01 935.278,1228.17 937.586,1468.63 939.894,1272.11 942.202,1537.96 944.51,1425.6 946.818,1442.21 949.126,1265.88 951.434,1553.88 953.742,1372.59 956.05,1261.43 958.358,1409.49 960.665,1511.73 962.973,1268.61 965.281,1373.37 967.589,1520.1 969.897,1462.25 972.205,1285.97 974.513,1457.72 976.821,1443.8 979.129,1334.66 981.437,1342.86 983.745,1356.82 986.053,1349.81 988.36,1438.68 990.668,1411.79 992.976,1510.36 995.284,1330.65 997.592,1258.02 999.9,1291.09 1002.21,1340.08 1004.52,1417.3 1006.82,1458.51 1009.13,1392.38 1011.44,1399.38 1013.75,1360.47 1016.06,1237.97 1018.36,1323.21 1020.67,1484.62 1022.98,1418.84 1025.29,1239.61 1027.59,1323.93 1029.9,1391.79 1032.21,1286.2 1034.52,1478.48 1036.83,1546.26 1039.13,1272.76 1041.44,1369.08 1043.75,1329.53 1046.06,1537.7 1048.37,1465.4 1050.67,1429.78 1052.98,1414.93 1055.29,1245.4 1057.6,1375.52 1059.91,1569.36 1062.21,1480.95 1064.52,1423.83 1066.83,1372.17 1069.14,1472.74 1071.45,1418.68 1073.75,1301.24 1076.06,1482.51 1078.37,1479.46 1080.68,1405.6 1082.98,1410.5 1085.29,1285.95 1087.6,1429.03 1089.91,1357.42 1092.22,1203.93 1094.52,1368.23 1096.83,1216.46 1099.14,1263.06 1101.45,1511.26 1103.76,1459.67 1106.06,1398.64 1108.37,1427.76 1110.68,1325.52 1112.99,1476.47 1115.3,1348.18 1117.6,1512.35 1119.91,1397.76 1122.22,1448.75 1124.53,1305.73 1126.84,1670.4 1129.14,1483.81 1131.45,1442.45 1133.76,1409.77 1136.07,1362.83 1138.37,1459.26 1140.68,1477.14 1142.99,1358.8 1145.3,1409.97 1147.61,1257.05 1149.91,1347.24 1152.22,1318.1 1154.53,1228.01 1156.84,1481.69 1159.15,1373.57 1161.45,1365.51 1163.76,1436.2 1166.07,1356.87 1168.38,1328.83 1170.69,1172.69 1172.99,1408.41 1175.3,1431.12 1177.61,1248.95 1179.92,1528.84 1182.23,1374.04 1184.53,1402.98 1186.84,1311.88 1189.15,1395.89 1191.46,1645.84 1193.76,1228.61 1196.07,1316.35 1198.38,1459.55 1200.69,1271.99 1203,1283.03 1205.3,1346.06 1207.61,1303.01 1209.92,1430.24 1212.23,1368.24 1214.54,1372.77 1216.84,1410.56 1219.15,1406.88 1221.46,1482.54 1223.77,1659.99 1226.08,1389.66 1228.38,1271.85 1230.69,1454.27 1233,1387.2 1235.31,1369.95 1237.61,1326.94 1239.92,1348.35 1242.23,1369.86 1244.54,1477.54 1246.85,1315 1249.15,1342.7 1251.46,1543.2 1253.77,1393.98 1256.08,1270.21 1258.39,1555.92 1260.69,1273.39 1263,1430.27 1265.31,1286.83 1267.62,1343.82 1269.93,1461.92 1272.23,1206.33 1274.54,1288.85 1276.85,1247.75 1279.16,1392.76 1281.47,1514.06 1283.77,1318.17 1286.08,1322.96 1288.39,1345.37 1290.7,1247.25 1293,1223.8 1295.31,1397 1297.62,1372.77 1299.93,1319.51 1302.24,1623.47 1304.54,1308.76 1306.85,1407.94 1309.16,1519.57 1311.47,1566.8 1313.78,1232.65 1316.08,1490.27 1318.39,1315.71 1320.7,1262.23 1323.01,1333.52 1325.32,1490.84 1327.62,1387.76 1329.93,1427.05 1332.24,1343.58 1334.55,1353.42 1336.86,1423.54 1339.16,1360.02 1341.47,1455.48 1343.78,1384.98 1346.09,1436.99 1348.39,1375.42 1350.7,1383.09 1353.01,1448.73 1355.32,1349.99 1357.63,1275.38 1359.93,1393.11 1362.24,1370.68 1364.55,1459.98 1366.86,1324.12 1369.17,1314.29 1371.47,1344.85 1373.78,1262.68 1376.09,1458.92 1378.4,1502.76 1380.71,1435.59 1383.01,1203.41 1385.32,1282.76 1387.63,1343.2 1389.94,1280.71 1392.24,1300.51 1394.55,1446.72 1396.86,1324.89 1399.17,1443.59 1401.48,1397.97 1403.78,1495.91 1406.09,1395.81 1408.4,1345.69 1410.71,1415.15 1413.02,1402.88 1415.32,1415.28 1417.63,1298.1 1419.94,1698.41 1422.25,1403.48 1424.56,1506.76 1426.86,1464.01 1429.17,1413.4 1431.48,1458.55 1433.79,1414.98 1436.1,1348.42 1438.4,1385.69 1440.71,1468.6 1443.02,1404.9 1445.33,1255.3 1447.63,1515.57 1449.94,1445.57 1452.25,1334.37 1454.56,1546.13 1456.87,1447.74 1459.17,1604.31 1461.48,1399.37 1463.79,1509.02 1466.1,1547.41 1468.41,1351.72 1470.71,1428.08 1473.02,1408.12 1475.33,1209.91 1477.64,1261.58 1479.95,1410.52 1482.25,1421.81 1484.56,1247.68 1486.87,1379.22 1489.18,1343.41 1491.49,1375.28 1493.79,1406.7 1496.1,1418.92 1498.41,1370.79 1500.72,1389.43 1503.02,1509.18 1505.33,1340.16 1507.64,1431.77 1509.95,1479.81 1512.26,1440.92 1514.56,1185.89 1516.87,1409.57 1519.18,1410.04 1521.49,1308.89 1523.8,1571.21 1526.1,1396.14 1528.41,1349.26 1530.72,1496.6 1533.03,1429.78 1535.34,1437.81 1537.64,1344.4 1539.95,1498.06 1542.26,1329.46 1544.57,1487.42 1546.88,1279.46 1549.18,1312.15 1551.49,1182.35 1553.8,1514.12 1556.11,1573.14 1558.41,1554.1 1560.72,1324.12 1563.03,1591.65 1565.34,1404.83 1567.65,1611.25 1569.95,1359.21 1572.26,1394.94 1574.57,1350.47 1576.88,1283.51 1579.19,1348.34 1581.49,1275.62 1583.8,1617.06 1586.11,1433.55 1588.42,1473.52 1590.73,1230.97 1593.03,1249.68 1595.34,1315.07 1597.65,1414.54 1599.96,1293.42 1602.26,1400.37 1604.57,1299.71 1606.88,1458.12 1609.19,1240.14 1611.5,1357.63 1613.8,1250.07 1616.11,1420.03 1618.42,1181.88 1620.73,1423.21 1623.04,1290.51 1625.34,1280.13 1627.65,1335.74 1629.96,1535.59 1632.27,1581.66 1634.58,1308.1 1636.88,1465.75 1639.19,1367.82 1641.5,1300.53 1643.81,1365.44 1646.12,1345.9 1648.42,1360.52 1650.73,1490.88 1653.04,1448.39 1655.35,1484.82 1657.65,1427.33 1659.96,1496.66 1662.27,1344.18 1664.58,1475.86 1666.89,1474.27 1669.19,1389.43 1671.5,1325.34 1673.81,1320.6 1676.12,1437.23 1678.43,1631.1 1680.73,1278.3 1683.04,1352.87 1685.35,1409.95 1687.66,1289.27 1689.97,1396.72 1692.27,1526.56 1694.58,1408.77 1696.89,1451.57 1699.2,1493.1 1701.51,1398.33 1703.81,1384.72 1706.12,1313.38 1708.43,1423.03 1710.74,1374.96 1713.04,1570.5 1715.35,1326.66 1717.66,1213.32 1719.97,1496 1722.28,1366.53 1724.58,1386.12 1726.89,1288.29 1729.2,1259.4 1731.51,1285.01 1733.82,1368.23 1736.12,1322.92 1738.43,1274.86 1740.74,1275.48 1743.05,1474.43 1745.36,1466.51 1747.66,1250.67 1749.97,1421.76 1752.28,1404.2 1754.59,1427.43 1756.9,1458.9 1759.2,1277 1761.51,1342.74 1763.82,1437.1 1766.13,1311.32 1768.43,1541.58 1770.74,1504.27 1773.05,1463.48 1775.36,1265.73 1777.67,1474.52 1779.97,1340.98 1782.28,1535.33 1784.59,1164.54 1786.9,1395.43 1789.21,1390.33 1791.51,1368.24 1793.82,1449.77 1796.13,1346.58 1798.44,1312.5 1800.75,1276.28 1803.05,1507.38 1805.36,1341.2 1807.67,1411.16 1809.98,1347.39 1812.28,1258.99 1814.59,1332.05 1816.9,1457.03 1819.21,1395.31 1821.52,1370.82 1823.82,1574.74 1826.13,1401 1828.44,1237.36 1830.75,1562.87 1833.06,1534.05 1835.36,1272.68 1837.67,1319.4 1839.98,1487 1842.29,1312.04 1844.6,1446.82 1846.9,1294.25 1849.21,1346.45 1851.52,1283.06 1853.83,1312.36 1856.14,1425.05 1858.44,1333.53 1860.75,1262.07 1863.06,1287.43 1865.37,1432.37 1867.67,1452.46 1869.98,1059.26 1872.29,1253.7 1874.6,1291.11 1876.91,1585.84 1879.21,1331.44 1881.52,1293.66 1883.83,1340.75 1886.14,1541.1 1888.45,1419.74 1890.75,1549.66 1893.06,1447.43 1895.37,1528.63 1897.68,1374.94 1899.99,1498.54 1902.29,1380.53 1904.6,1410.91 1906.91,1335.76 1909.22,1498.69 1911.53,1296.57 1913.83,1324.73 1916.14,1299.62 1918.45,1391.05 1920.76,1474.16 1923.06,1342.24 1925.37,1498.28 1927.68,1310 1929.99,1580.34 1932.3,1414.96 1934.6,1360.44 1936.91,1327.83 1939.22,1300.32 1941.53,1407.22 1943.84,1377.12 1946.14,1560.48 1948.45,1520.17 1950.76,1610.89 1953.07,1433.77 1955.38,1469.64 1957.68,1506.33 1959.99,1500.32 1962.3,1381.1 1964.61,1414.01 1966.91,1464.62 1969.22,1326.29 1971.53,1370.06 1973.84,1406.79 1976.15,1562.3 1978.45,1488.12 1980.76,1471.62 1983.07,1388.57 1985.38,1379.25 1987.69,1383.59 1989.99,1509.52 1992.3,1159.07 1994.61,1359.83 1996.92,1407.9 1999.23,1356.18 2001.53,1306.82 2003.84,1410.02 2006.15,1324.32 2008.46,1246.81 2010.77,1459.07 2013.07,1472.02 2015.38,1301.68 2017.69,1296.65 2020,1449.72 2022.3,1474.14 2024.61,1477.86 2026.92,1576.94 2029.23,1449.42 2031.54,1406.32 2033.84,1420.99 2036.15,1366.82 2038.46,1321.95 2040.77,1211.1 2043.08,1354.54 2045.38,1383.94 2047.69,1485.42 2050,1459 2052.31,1269.59 2054.62,1468.51 2056.92,1418.14 2059.23,1444.04 2061.54,1421.07 2063.85,1441.97 2066.16,1592.24 2068.46,1451.32 2070.77,1160.91 2073.08,1392.58 2075.39,1574.34 2077.69,1327.56 2080,1251.64 2082.31,1501.21 2084.62,1463.86 2086.93,1383.99 2089.23,1304 2091.54,1340.33 2093.85,1451.94 2096.16,1361.32 2098.47,1360.95 2100.77,1584.59 2103.08,1355.82 2105.39,1452.11 2107.7,1278.5 2110.01,1399.99 2112.31,1450.51 2114.62,1337.33 2116.93,1434.02 2119.24,1538.58 2121.55,1216.81 2123.85,1455.66 2126.16,1301.45 2128.47,1354.68 2130.78,1342.42 2133.08,1555.85 2135.39,1398.62 2137.7,1446.11 2140.01,1522.08 2142.32,1433.16 2144.62,1292.9 2146.93,1623.22 2149.24,1426.17 2151.55,1288.7 2153.86,1360.59 2156.16,1401.81 2158.47,1404.69 2160.78,1456.67 2163.09,1352.45 2165.4,1435.52 2167.7,1432.46 2170.01,1305.92 2172.32,1391.2 2174.63,1414 2176.93,1417.43 2179.24,1362.14 2181.55,1376.55 2183.86,1334.45 2186.17,1420.24 2188.47,1361.97 2190.78,1690.62 2193.09,1307 2195.4,1592.06 2197.71,1444.09 2200.01,1580.83 2202.32,1388.66 2204.63,1342.67 2206.94,1412.75 2209.25,1460.55 2211.55,1312.59 2213.86,1612.74 2216.17,1348.56 2218.48,1392.17 2220.79,1167.36 2223.09,1374.89 2225.4,1275.45 2227.71,1256.63 2230.02,1408.88 2232.32,1430.67 2234.63,1447.32 2236.94,1279.23 2239.25,1510.28 2241.56,1546.56 2243.86,1316.4 2246.17,1404.55 2248.48,1331.22 2250.79,1331.94 2253.1,1308.11 2255.4,1312.46 2257.71,1412.24 2260.02,1384.07 2262.33,1325.09 2264.64,1472.25 2266.94,1441.73 2269.25,1200.75 2271.56,1751.15 2273.87,1236.99 2276.18,1370.06 2278.48,1283.09 2280.79,1416.13 2283.1,1479.19 2285.41,1309.47 2287.71,1435.59 2290.02,1561.49 2292.33,1394.21 2294.64,1438.43 2296.95,1379.46 2299.25,1391.99 2301.56,1420.23 2303.87,1433.5 2306.18,1454.54 2308.49,1444.93 2310.79,1430.2 2313.1,1374.21 2315.41,1447.11 2317.72,1407.32 2320.03,1528.64 2322.33,1410.11 2324.64,1350.08 2326.95,1560.83 2329.26,1394.22 2331.56,1425.57 2333.87,1345.45 2336.18,1301.44 2338.49,1451.81 2340.8,1403.81 2343.1,1379.3 2345.41,1504.82 2347.72,1298.48 2350.03,1376.33 2352.34,1345.93 2354.64,1449.92 2356.95,1292.48 2359.26,1553.29 2361.57,1261.27 2363.88,1447.39 2366.18,1438.31 2368.49,1450.3 2370.8,1482.78 2373.11,1421.18 2375.42,1333.67 2377.72,1487.65 2380.03,1401.6 2382.34,1388.71 2384.65,1305.11 2386.95,1378.66 2389.26,1384.46 2391.57,1415.24 2393.88,1436.06 2396.19,1338.09 2398.49,1303.98 2400.8,1273.73 2403.11,1403.21 2405.42,1386.99 2407.73,1354.77 2410.03,1441.57 2412.34,1322.35 2414.65,1289.36 2416.96,1411.3 2419.27,1564.97 2421.57,1425.86 2423.88,1278.39 2426.19,1329.16 2428.5,1436.7 2430.81,1442.11 2433.11,1285.72 2435.42,1408.06 2437.73,1594.28 2440.04,1401.89 2442.34,1413.31 2444.65,1425.13 2446.96,1468.17 2449.27,1508.02 2451.58,1403.04 2453.88,1319.02 2456.19,1546.91 2458.5,1443.45 2460.81,1306.89 2463.12,1491.25 2465.42,1375.58 2467.73,1303.87 2470.04,1404.27 2472.35,1322.13 2474.66,1233.84 2476.96,1464.86 2479.27,1358.23 2481.58,1322.93 2483.89,1385.13 2486.2,1448.16 2488.5,1371.57 2490.81,1330.12 2493.12,1483.44 2495.43,1426.91 2497.73,1494.57 2500.04,1387.73 2502.35,1532.59 2504.66,1472.9 2506.97,1237.75 2509.27,1505.62 2511.58,1341.59 2513.89,1456.57 2516.2,1517.5 2518.51,1283.51 2520.81,1237 2523.12,1502.09 2525.43,1699.49 2527.74,1392.66 2530.05,1370.59 2532.35,1384.45 2534.66,1209.84 2536.97,1297.12 2539.28,1526.33 2541.58,1317.76 2543.89,1262.07 2546.2,1412.9 2548.51,1507.49 2550.82,1438.95 2553.12,1303.02 2555.43,1381.75 2557.74,1490.46 2560.05,1346.55 2562.36,1454.96 2564.66,1263.69 2566.97,1360.7 2569.28,1372.33 2571.59,1544.42 "></polyline>
<polyline clip-path="url(#clip032)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1041.28 268.292,970.291 270.6,1034.7 272.908,931.016 275.216,946.974 277.524,827.663 279.832,771.664 282.139,925.753 284.447,860.799 286.755,813.401 289.063,1100.05 291.371,885.913 293.679,827.501 295.987,877.044 298.295,902.379 300.603,773.654 302.911,817.681 305.219,959.078 307.527,901.915 309.834,915.084 312.142,931.483 314.45,973.568 316.758,823.95 319.066,890.113 321.374,932.738 323.682,992.889 325.99,1001.67 328.298,926.196 330.606,939.767 332.914,971.212 335.221,760.807 337.529,799.532 339.837,920.265 342.145,919.013 344.453,921.347 346.761,1008.61 349.069,916.409 351.377,910.28 353.685,996.137 355.993,1015.07 358.301,912.049 360.608,787.469 362.916,815.18 365.224,947.101 367.532,1087.6 369.84,974.042 372.148,942.579 374.456,777.191 376.764,835.188 379.072,822.355 381.38,923.098 383.688,1068.21 385.996,910.826 388.303,846.908 390.611,782.6 392.919,1033.29 395.227,949.346 397.535,793.875 399.843,952.087 402.151,811.228 404.459,884.378 406.767,856.392 409.075,895.567 411.383,818.935 413.69,867.332 415.998,839.862 418.306,731.177 420.614,960.981 422.922,956.001 425.23,818.25 427.538,1126.58 429.846,1044.68 432.154,1046.47 434.462,1021.52 436.77,1018.29 439.077,862.553 441.385,901.15 443.693,861.562 446.001,821.541 448.309,854.361 450.617,942.896 452.925,884.155 455.233,987.617 457.541,931.294 459.849,925.309 462.157,991.932 464.465,741.06 466.772,1035.29 469.08,989.922 471.388,1095.21 473.696,1001.84 476.004,1021.52 478.312,914.587 480.62,868.912 482.928,972.571 485.236,922.011 487.544,849.833 489.852,1030.91 492.159,979.457 494.467,1029.19 496.775,810.548 499.083,736.419 501.391,886.879 503.699,613.379 506.007,896.564 508.315,827.862 510.623,802.901 512.931,903.533 515.239,1049.89 517.546,854.648 519.854,875.686 522.162,880.899 524.47,906.012 526.778,774.517 529.086,887.489 531.394,915.449 533.702,947.01 536.01,736.911 538.318,886.696 540.626,890.615 542.933,992.906 545.241,898.68 547.549,1007.64 549.857,942.69 552.165,799.814 554.473,1025.45 556.781,890.673 559.089,990.876 561.397,870.045 563.705,893.154 566.013,917.411 568.321,776.841 570.628,832.464 572.936,761.474 575.244,905.395 577.552,735.579 579.86,957.583 582.168,949.252 584.476,876.219 586.784,884.109 589.092,1040.62 591.4,784.608 593.708,993.003 596.015,1059.36 598.323,813.18 600.631,905.375 602.939,880.798 605.247,716.232 607.555,922.382 609.863,1013.57 612.171,864.527 614.479,897.963 616.787,956.965 619.095,933.233 621.402,995.851 623.71,926.978 626.018,829.292 628.326,1011.32 630.634,862.964 632.942,784.607 635.25,877.376 637.558,1051.07 639.866,960.242 642.174,1057.66 644.482,889.014 646.79,958.8 649.097,858.373 651.405,930.672 653.713,854.338 656.021,1030.86 658.329,914.394 660.637,1020.89 662.945,935.52 665.253,924.688 667.561,920.872 669.869,912.416 672.177,869.431 674.484,1072.76 676.792,945.773 679.1,987.962 681.408,977.625 683.716,898.395 686.024,713.875 688.332,897.252 690.64,939.518 692.948,934.288 695.256,905.725 697.564,1003.29 699.871,941.335 702.179,849.272 704.487,763.658 706.795,832.068 709.103,899.475 711.411,979.177 713.719,942.038 716.027,908.555 718.335,836.365 720.643,1086.84 722.951,821.19 725.259,850.191 727.566,833.644 729.874,864.676 732.182,1108.41 734.49,724.828 736.798,773.029 739.106,895.386 741.414,965.43 743.722,891.353 746.03,1056.21 748.338,766.226 750.646,774.506 752.953,904.811 755.261,970.659 757.569,866.863 759.877,971.566 762.185,874.317 764.493,1091.84 766.801,994.161 769.109,1033.1 771.417,996.49 773.725,966.018 776.033,795.288 778.34,935.526 780.648,786.274 782.956,1014.61 785.264,857.347 787.572,970.473 789.88,874.654 792.188,1104.3 794.496,1045.32 796.804,853.483 799.112,828.983 801.42,919.76 803.728,995.54 806.035,795.854 808.343,912.452 810.651,982.852 812.959,812.692 815.267,1070.27 817.575,1062.89 819.883,972.981 822.191,775.431 824.499,914.035 826.807,971.664 829.115,731.206 831.422,939.41 833.73,783.21 836.038,789.532 838.346,999.932 840.654,883.856 842.962,898.538 845.27,916.124 847.578,869.192 849.886,932.939 852.194,864.713 854.502,956.276 856.809,830.172 859.117,947.026 861.425,798.39 863.733,942.092 866.041,951.72 868.349,902.081 870.657,797.513 872.965,848.042 875.273,951.43 877.581,1004.52 879.889,805.47 882.197,715.142 884.504,904.551 886.812,990.483 889.12,770.695 891.428,774.397 893.736,873.079 896.044,792.285 898.352,719.738 900.66,712.096 902.968,855.973 905.276,853.363 907.584,934.887 909.891,931.216 912.199,806.832 914.507,849.804 916.815,639.438 919.123,790.779 921.431,940.122 923.739,897.435 926.047,881.638 928.355,941.454 930.663,964.588 932.971,737.969 935.278,820.906 937.586,892.751 939.894,852.555 942.202,865.885 944.51,1189.43 946.818,862.413 949.126,959.067 951.434,844.024 953.742,944.24 956.05,870.894 958.358,820.891 960.665,794.171 962.973,938.564 965.281,803.291 967.589,865.6 969.897,915.332 972.205,880.204 974.513,903.203 976.821,853.601 979.129,746.298 981.437,940.751 983.745,913.884 986.053,900.318 988.36,1018.9 990.668,890.684 992.976,980.476 995.284,841.886 997.592,847.037 999.9,753.875 1002.21,868.089 1004.52,849.588 1006.82,731.147 1009.13,905.996 1011.44,830.359 1013.75,1046.64 1016.06,905.033 1018.36,865.373 1020.67,918.096 1022.98,832.327 1025.29,810.236 1027.59,928.094 1029.9,1023.71 1032.21,824.86 1034.52,849.248 1036.83,1065.03 1039.13,1015.97 1041.44,802.115 1043.75,956.937 1046.06,895.804 1048.37,880.526 1050.67,885.922 1052.98,789.677 1055.29,830.086 1057.6,1062.83 1059.91,990.828 1062.21,1034.68 1064.52,899.185 1066.83,988.722 1069.14,922.352 1071.45,968.51 1073.75,950.566 1076.06,1017.52 1078.37,893.923 1080.68,959.909 1082.98,874.159 1085.29,1057.84 1087.6,793.417 1089.91,953.201 1092.22,723.62 1094.52,794.711 1096.83,1047.55 1099.14,1057.87 1101.45,689.852 1103.76,917.278 1106.06,841.959 1108.37,966.24 1110.68,841.124 1112.99,904.42 1115.3,919.645 1117.6,980.317 1119.91,788.644 1122.22,833.291 1124.53,824.357 1126.84,950.915 1129.14,969.161 1131.45,844.489 1133.76,1009.24 1136.07,1008.7 1138.37,1010.38 1140.68,892.497 1142.99,1030.14 1145.3,985.537 1147.61,983.646 1149.91,988.3 1152.22,949.362 1154.53,935.706 1156.84,936.628 1159.15,879.093 1161.45,1005.86 1163.76,954.934 1166.07,823.631 1168.38,1196.96 1170.69,868.236 1172.99,955.576 1175.3,948.004 1177.61,973.16 1179.92,788.869 1182.23,1044 1184.53,916.379 1186.84,959.143 1189.15,846.827 1191.46,913.657 1193.76,943.058 1196.07,769.054 1198.38,1026.52 1200.69,829.765 1203,975.074 1205.3,746.408 1207.61,901.04 1209.92,783.434 1212.23,972.764 1214.54,858.47 1216.84,1008.96 1219.15,969.797 1221.46,912.032 1223.77,904.564 1226.08,844.707 1228.38,895.7 1230.69,851.54 1233,927.769 1235.31,863.241 1237.61,1042.05 1239.92,900.515 1242.23,804.145 1244.54,926.679 1246.85,714.588 1249.15,927.265 1251.46,1015.43 1253.77,1019.59 1256.08,779.85 1258.39,945.815 1260.69,1032.88 1263,889.074 1265.31,917.542 1267.62,855.131 1269.93,838.267 1272.23,941.202 1274.54,1111.77 1276.85,823.121 1279.16,910.85 1281.47,825.311 1283.77,901.539 1286.08,892.126 1288.39,710.63 1290.7,1015.28 1293,943.401 1295.31,792.792 1297.62,814.827 1299.93,938.395 1302.24,977.93 1304.54,882.822 1306.85,845.901 1309.16,912.973 1311.47,756.729 1313.78,938.881 1316.08,904.249 1318.39,925.804 1320.7,823.767 1323.01,827.183 1325.32,873.667 1327.62,817.153 1329.93,1092.91 1332.24,1148.41 1334.55,906.528 1336.86,927.419 1339.16,880.722 1341.47,853.774 1343.78,742.25 1346.09,967.305 1348.39,808.035 1350.7,872.897 1353.01,933.392 1355.32,958.55 1357.63,994.981 1359.93,1025.95 1362.24,780.288 1364.55,934.925 1366.86,913.453 1369.17,799.134 1371.47,861.508 1373.78,805.458 1376.09,938.656 1378.4,829.636 1380.71,923.547 1383.01,930.287 1385.32,887.413 1387.63,1139.61 1389.94,891.798 1392.24,1052.64 1394.55,810.535 1396.86,979.721 1399.17,764.255 1401.48,783.4 1403.78,790.89 1406.09,747.218 1408.4,818.498 1410.71,959.235 1413.02,692.63 1415.32,1036.32 1417.63,708.258 1419.94,939.65 1422.25,1098.64 1424.56,979.482 1426.86,1018.46 1429.17,785.12 1431.48,864.146 1433.79,1137.85 1436.1,794.565 1438.4,866.316 1440.71,1038.26 1443.02,985.39 1445.33,1170.91 1447.63,992.015 1449.94,1017.71 1452.25,958.164 1454.56,876.562 1456.87,820.366 1459.17,838.34 1461.48,934.485 1463.79,1127.76 1466.1,807.652 1468.41,795.02 1470.71,792.169 1473.02,944.309 1475.33,1015.82 1477.64,906.684 1479.95,767.529 1482.25,901.758 1484.56,843.396 1486.87,802.293 1489.18,777.919 1491.49,978.347 1493.79,837.805 1496.1,973.042 1498.41,826.545 1500.72,1017.19 1503.02,930.424 1505.33,858.354 1507.64,825.928 1509.95,976.896 1512.26,891.79 1514.56,798.307 1516.87,902 1519.18,1143.24 1521.49,1034.21 1523.8,970.655 1526.1,904.533 1528.41,1013.88 1530.72,845.226 1533.03,1010.66 1535.34,942.753 1537.64,900.564 1539.95,1031.9 1542.26,1028.19 1544.57,963.49 1546.88,965.553 1549.18,805.458 1551.49,932.047 1553.8,911.77 1556.11,916.467 1558.41,1049.19 1560.72,840.739 1563.03,887.965 1565.34,772.767 1567.65,952.982 1569.95,951.006 1572.26,1012.26 1574.57,945.705 1576.88,832.708 1579.19,1022.28 1581.49,754.608 1583.8,880.88 1586.11,887.149 1588.42,1119.2 1590.73,966.348 1593.03,827.093 1595.34,753.968 1597.65,824.364 1599.96,824.245 1602.26,879.679 1604.57,850.085 1606.88,839.088 1609.19,778.225 1611.5,1093.17 1613.8,1041.88 1616.11,866.361 1618.42,869.91 1620.73,923.4 1623.04,960.313 1625.34,997.445 1627.65,870.369 1629.96,909.804 1632.27,908.305 1634.58,978.703 1636.88,819.311 1639.19,1156.56 1641.5,1010.84 1643.81,800.373 1646.12,929.774 1648.42,990.6 1650.73,907.151 1653.04,888.295 1655.35,835.681 1657.65,918.153 1659.96,815.921 1662.27,977.338 1664.58,749.251 1666.89,1036.41 1669.19,920.477 1671.5,876.024 1673.81,1048.83 1676.12,862.539 1678.43,938.986 1680.73,968.313 1683.04,868.986 1685.35,1073.6 1687.66,1052.07 1689.97,799.728 1692.27,967.679 1694.58,910.432 1696.89,777.281 1699.2,1077.45 1701.51,848.254 1703.81,1024.86 1706.12,988.759 1708.43,906.937 1710.74,942.538 1713.04,871.382 1715.35,991.302 1717.66,812.742 1719.97,837.001 1722.28,1032.86 1724.58,980.232 1726.89,939.705 1729.2,964.088 1731.51,950.019 1733.82,882.003 1736.12,959.155 1738.43,852.456 1740.74,940.848 1743.05,991.813 1745.36,1014.36 1747.66,945.297 1749.97,954.422 1752.28,1094.84 1754.59,873.005 1756.9,847.27 1759.2,917.577 1761.51,970.755 1763.82,1139.19 1766.13,871.788 1768.43,884.363 1770.74,1088.41 1773.05,1182.38 1775.36,906.142 1777.67,977.437 1779.97,871.29 1782.28,978.627 1784.59,1032.97 1786.9,883.999 1789.21,844.088 1791.51,779.77 1793.82,916.064 1796.13,830.888 1798.44,1002.04 1800.75,990.63 1803.05,915.897 1805.36,826.512 1807.67,965.17 1809.98,885.176 1812.28,989.79 1814.59,836.51 1816.9,1146.66 1819.21,980.244 1821.52,784.148 1823.82,986.619 1826.13,822.041 1828.44,841.177 1830.75,939.405 1833.06,840.168 1835.36,1085.63 1837.67,916.175 1839.98,1020.51 1842.29,1106.03 1844.6,989.789 1846.9,781.627 1849.21,1108.21 1851.52,987.239 1853.83,883.492 1856.14,765.416 1858.44,1096.47 1860.75,888.278 1863.06,929.824 1865.37,911.736 1867.67,822.961 1869.98,961.856 1872.29,1062.29 1874.6,829.856 1876.91,941.307 1879.21,1093.23 1881.52,733.571 1883.83,992.771 1886.14,787.241 1888.45,912.139 1890.75,982.837 1893.06,1005.12 1895.37,990.856 1897.68,857.642 1899.99,979.857 1902.29,738.574 1904.6,896.043 1906.91,965.494 1909.22,956.899 1911.53,759.641 1913.83,891.989 1916.14,721.036 1918.45,782.25 1920.76,865.668 1923.06,881.889 1925.37,900.826 1927.68,903.686 1929.99,763.894 1932.3,887.725 1934.6,898.231 1936.91,948.807 1939.22,1018.78 1941.53,880.844 1943.84,886.903 1946.14,868.331 1948.45,953.245 1950.76,886.544 1953.07,941.683 1955.38,900.979 1957.68,729.754 1959.99,952.16 1962.3,978.443 1964.61,954.657 1966.91,875.255 1969.22,1080.73 1971.53,968.138 1973.84,918.284 1976.15,876.968 1978.45,911.619 1980.76,902.711 1983.07,873.258 1985.38,999.882 1987.69,793.2 1989.99,1056.64 1992.3,845.789 1994.61,822.18 1996.92,871.201 1999.23,983.606 2001.53,848.636 2003.84,895.37 2006.15,963.277 2008.46,844.466 2010.77,752.538 2013.07,841.085 2015.38,884.398 2017.69,870.072 2020,874.034 2022.3,983.397 2024.61,751.914 2026.92,795.623 2029.23,814.274 2031.54,747.775 2033.84,921.545 2036.15,837.135 2038.46,910.863 2040.77,887.446 2043.08,1036.38 2045.38,822.907 2047.69,903.122 2050,836.629 2052.31,758.892 2054.62,948.903 2056.92,740.738 2059.23,1041.95 2061.54,979.511 2063.85,963.717 2066.16,1034.34 2068.46,1054.05 2070.77,982.16 2073.08,775.077 2075.39,897.362 2077.69,1019.92 2080,769.053 2082.31,889.661 2084.62,939.138 2086.93,982.998 2089.23,899.973 2091.54,937.847 2093.85,867.8 2096.16,990.226 2098.47,891.584 2100.77,908.186 2103.08,958.868 2105.39,813.973 2107.7,1015.91 2110.01,854.155 2112.31,1023.42 2114.62,850.206 2116.93,919.427 2119.24,899.668 2121.55,878.734 2123.85,957.193 2126.16,889.326 2128.47,893.779 2130.78,876.619 2133.08,895.085 2135.39,1026 2137.7,928.499 2140.01,1046.05 2142.32,945.656 2144.62,940.099 2146.93,899.231 2149.24,931.152 2151.55,942.552 2153.86,910.72 2156.16,826.901 2158.47,823.319 2160.78,1059.3 2163.09,1099.36 2165.4,1005.32 2167.7,945.846 2170.01,844.351 2172.32,782.235 2174.63,866.035 2176.93,717.357 2179.24,775.43 2181.55,1031.26 2183.86,956.748 2186.17,904.223 2188.47,880.258 2190.78,1052.9 2193.09,822.716 2195.4,1068.42 2197.71,771.585 2200.01,808.029 2202.32,864.072 2204.63,852.346 2206.94,887.742 2209.25,760.604 2211.55,828.811 2213.86,992.481 2216.17,880.366 2218.48,1096.79 2220.79,765.291 2223.09,756.831 2225.4,991.645 2227.71,1008.05 2230.02,922.153 2232.32,926.085 2234.63,1074.81 2236.94,916.89 2239.25,917.445 2241.56,915.394 2243.86,827.658 2246.17,895.047 2248.48,918.453 2250.79,876.39 2253.1,962.291 2255.4,839.796 2257.71,827.757 2260.02,1115.31 2262.33,839.102 2264.64,1018.92 2266.94,931.253 2269.25,1064.92 2271.56,1040.96 2273.87,954.457 2276.18,891.03 2278.48,889.326 2280.79,740.485 2283.1,1058.16 2285.41,777.328 2287.71,916.225 2290.02,826.338 2292.33,1053.3 2294.64,1046.88 2296.95,866.898 2299.25,803.22 2301.56,829.537 2303.87,959.964 2306.18,1014.98 2308.49,1001.73 2310.79,924.335 2313.1,919.126 2315.41,978.256 2317.72,996.179 2320.03,963.074 2322.33,889.802 2324.64,1027.76 2326.95,958.181 2329.26,914.864 2331.56,799.576 2333.87,809.373 2336.18,940.969 2338.49,798.324 2340.8,727.777 2343.1,973.143 2345.41,989.125 2347.72,851.609 2350.03,1061.61 2352.34,1019.75 2354.64,909.765 2356.95,819.195 2359.26,812.771 2361.57,826.563 2363.88,876.458 2366.18,930.09 2368.49,772.03 2370.8,836.933 2373.11,930 2375.42,889.668 2377.72,871.496 2380.03,773.891 2382.34,908.576 2384.65,829.543 2386.95,1059.83 2389.26,867.581 2391.57,958.656 2393.88,1136.19 2396.19,845.78 2398.49,822.416 2400.8,808.012 2403.11,1162.08 2405.42,1066.68 2407.73,868.447 2410.03,967.171 2412.34,912.649 2414.65,947.292 2416.96,764.292 2419.27,998.257 2421.57,913.151 2423.88,801.153 2426.19,962.827 2428.5,1004.7 2430.81,948.561 2433.11,890.538 2435.42,894.899 2437.73,944.236 2440.04,962.288 2442.34,1015.47 2444.65,1002.04 2446.96,880.814 2449.27,1031.68 2451.58,805.867 2453.88,1013.88 2456.19,1025.45 2458.5,838.187 2460.81,976.475 2463.12,901.191 2465.42,883.359 2467.73,846.459 2470.04,870.107 2472.35,733.083 2474.66,936.39 2476.96,1071.53 2479.27,946.311 2481.58,710.958 2483.89,992.666 2486.2,861.795 2488.5,730.371 2490.81,1078.17 2493.12,750.605 2495.43,706.883 2497.73,904.927 2500.04,1065.37 2502.35,1012.52 2504.66,898.643 2506.97,1018.98 2509.27,925.185 2511.58,985.605 2513.89,962.317 2516.2,865.126 2518.51,896.315 2520.81,611.325 2523.12,744.079 2525.43,911.724 2527.74,881.408 2530.05,958.129 2532.35,866.081 2534.66,950.836 2536.97,877.731 2539.28,894.262 2541.58,981.439 2543.89,1072.4 2546.2,867.328 2548.51,1067.32 2550.82,991.373 2553.12,925.416 2555.43,1044.96 2557.74,974.545 2560.05,1078.79 2562.36,800.687 2564.66,878.312 2566.97,916.263 2569.28,937.028 2571.59,840.977 "></polyline>
<polyline clip-path="url(#clip032)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,511.517 268.292,456.799 270.6,400.551 272.908,378.357 275.216,272.009 277.524,540.317 279.832,415.843 282.139,517.081 284.447,458.04 286.755,612.504 289.063,507.144 291.371,398.765 293.679,340.136 295.987,266.93 298.295,511.125 300.603,512.279 302.911,387.335 305.219,405.515 307.527,401.118 309.834,468.525 312.142,390.181 314.45,554.12 316.758,380.786 319.066,286.029 321.374,535.834 323.682,558.003 325.99,354.432 328.298,353.864 330.606,357.061 332.914,539.559 335.221,367.038 337.529,294.619 339.837,484.891 342.145,537.535 344.453,496.793 346.761,419.685 349.069,231.712 351.377,460.381 353.685,516.298 355.993,414.387 358.301,240.96 360.608,379.831 362.916,366.829 365.224,376.325 367.532,405.202 369.84,272.201 372.148,474.811 374.456,617.773 376.764,442.015 379.072,403.409 381.38,456.493 383.688,388.733 385.996,370.992 388.303,477.126 390.611,455.016 392.919,568.927 395.227,486.716 397.535,412.335 399.843,331.799 402.151,467.724 404.459,332.317 406.767,547.518 409.075,459.06 411.383,267.45 413.69,363.736 415.998,525.798 418.306,532.476 420.614,405.609 422.922,470.877 425.23,125.476 427.538,277.05 429.846,477.071 432.154,316.711 434.462,481.036 436.77,528.851 439.077,619.386 441.385,468.085 443.693,425.991 446.001,327.695 448.309,485.831 450.617,548.226 452.925,425.017 455.233,344.881 457.541,516.923 459.849,328.213 462.157,412.062 464.465,522.53 466.772,412.821 469.08,610.33 471.388,493.922 473.696,398.442 476.004,403.873 478.312,557.98 480.62,582.094 482.928,600.332 485.236,344.638 487.544,530.519 489.852,461.276 492.159,585.272 494.467,450.101 496.775,472.003 499.083,436.58 501.391,290.816 503.699,368.652 506.007,406.27 508.315,679.532 510.623,408.404 512.931,364.232 515.239,475.117 517.546,420.212 519.854,438.882 522.162,478.531 524.47,555.284 526.778,407.273 529.086,304.947 531.394,357.266 533.702,338.886 536.01,444.132 538.318,354.819 540.626,285.026 542.933,497.199 545.241,328.948 547.549,599.863 549.857,549.253 552.165,424.016 554.473,481.692 556.781,335.536 559.089,349.068 561.397,452.635 563.705,425.981 566.013,275.522 568.321,493.578 570.628,434.451 572.936,400.156 575.244,456.629 577.552,378.754 579.86,463.932 582.168,439.125 584.476,311.077 586.784,424.51 589.092,350.025 591.4,318.184 593.708,501.572 596.015,250.19 598.323,558.681 600.631,412.142 602.939,442.42 605.247,393.374 607.555,507.534 609.863,405.361 612.171,302.148 614.479,637.271 616.787,408.632 619.095,478.615 621.402,423.174 623.71,382.67 626.018,525.526 628.326,333.846 630.634,474.726 632.942,381.558 635.25,387.708 637.558,437.782 639.866,579.342 642.174,347.147 644.482,412.015 646.79,418.23 649.097,349.543 651.405,634.873 653.713,403.042 656.021,621.152 658.329,391.217 660.637,474.435 662.945,307.193 665.253,509.956 667.561,300.947 669.869,452.634 672.177,447.039 674.484,590.369 676.792,434.464 679.1,381.557 681.408,363.205 683.716,343.868 686.024,419.622 688.332,441.635 690.64,393.477 692.948,559.411 695.256,180.948 697.564,446.428 699.871,650.42 702.179,248.832 704.487,398.905 706.795,484.526 709.103,417.202 711.411,497.65 713.719,370.508 716.027,256.766 718.335,483.384 720.643,282.227 722.951,456.62 725.259,485.967 727.566,559.9 729.874,422.824 732.182,431.091 734.49,401.919 736.798,346.488 739.106,422.448 741.414,535.451 743.722,406.396 746.03,561.643 748.338,463.223 750.646,564.584 752.953,483.249 755.261,513.995 757.569,415.009 759.877,550.783 762.185,562.422 764.493,472.677 766.801,387.056 769.109,569.92 771.417,409.422 773.725,265.528 776.033,305.586 778.34,377.269 780.648,213.186 782.956,358.877 785.264,310.42 787.572,625.653 789.88,543.079 792.188,257.072 794.496,278.403 796.804,528.01 799.112,641.111 801.42,475.725 803.728,519.481 806.035,588.309 808.343,543.644 810.651,483.612 812.959,397.538 815.267,509.603 817.575,413.268 819.883,432.757 822.191,384.372 824.499,500.811 826.807,492.261 829.115,531.817 831.422,496.438 833.73,315.756 836.038,661.481 838.346,301.288 840.654,465.806 842.962,406.15 845.27,475.605 847.578,575.05 849.886,408.776 852.194,529.632 854.502,440.444 856.809,335.116 859.117,224.123 861.425,302.973 863.733,490.97 866.041,528.143 868.349,479.791 870.657,399.231 872.965,96.8724 875.273,442.741 877.581,632.735 879.889,388.672 882.197,489.921 884.504,571.61 886.812,482.22 889.12,539.814 891.428,373.65 893.736,448.865 896.044,330.257 898.352,440.494 900.66,451.786 902.968,388.694 905.276,611.408 907.584,384.653 909.891,441.791 912.199,476.027 914.507,482.851 916.815,396.369 919.123,487.774 921.431,522.544 923.739,511.465 926.047,598.499 928.355,398.334 930.663,498.78 932.971,436.045 935.278,259.451 937.586,374.6 939.894,722.591 942.202,237.956 944.51,360.275 946.818,422.489 949.126,359.157 951.434,382.492 953.742,510.215 956.05,471.913 958.358,333.119 960.665,467.648 962.973,462.924 965.281,488.736 967.589,339.196 969.897,518.47 972.205,409.915 974.513,398.101 976.821,392.182 979.129,420.613 981.437,429.433 983.745,363.402 986.053,565.781 988.36,446.632 990.668,508.191 992.976,482.111 995.284,385.769 997.592,520.62 999.9,292.644 1002.21,524.728 1004.52,453.175 1006.82,624.562 1009.13,267.416 1011.44,372.202 1013.75,552.823 1016.06,356.862 1018.36,578.72 1020.67,403.261 1022.98,385.989 1025.29,463.993 1027.59,520.56 1029.9,285.616 1032.21,355.266 1034.52,249.293 1036.83,387.627 1039.13,676.796 1041.44,485.943 1043.75,189.234 1046.06,525.627 1048.37,292.503 1050.67,301.705 1052.98,580.01 1055.29,488.264 1057.6,485.249 1059.91,523.167 1062.21,445.58 1064.52,347.749 1066.83,441.917 1069.14,399.13 1071.45,509.763 1073.75,394.87 1076.06,489.287 1078.37,312.661 1080.68,559.808 1082.98,424.846 1085.29,467.259 1087.6,447.119 1089.91,563.673 1092.22,352.542 1094.52,568.937 1096.83,542.422 1099.14,268.372 1101.45,476.7 1103.76,500.657 1106.06,593.633 1108.37,369.806 1110.68,514.904 1112.99,327.326 1115.3,434.913 1117.6,257.713 1119.91,467.878 1122.22,241.164 1124.53,437.969 1126.84,481.346 1129.14,604.616 1131.45,343.417 1133.76,387.248 1136.07,419.708 1138.37,220.8 1140.68,608.006 1142.99,446.994 1145.3,418.81 1147.61,382.592 1149.91,327.86 1152.22,523.088 1154.53,447.34 1156.84,549.522 1159.15,306.188 1161.45,197.947 1163.76,329.15 1166.07,445.653 1168.38,478.61 1170.69,342.926 1172.99,468.938 1175.3,414.176 1177.61,453.331 1179.92,534.557 1182.23,508.987 1184.53,422.581 1186.84,491.186 1189.15,435.251 1191.46,551.773 1193.76,342.856 1196.07,266.606 1198.38,433.179 1200.69,405.146 1203,249.3 1205.3,520.929 1207.61,574.794 1209.92,365.736 1212.23,532.649 1214.54,458.788 1216.84,403.14 1219.15,561.11 1221.46,431.983 1223.77,595.783 1226.08,498.282 1228.38,475.583 1230.69,392.635 1233,392.664 1235.31,213.417 1237.61,537.738 1239.92,386.407 1242.23,327.88 1244.54,300.435 1246.85,569.912 1249.15,458.085 1251.46,409.419 1253.77,644.35 1256.08,355.915 1258.39,513.082 1260.69,436.275 1263,443.051 1265.31,416.865 1267.62,661.268 1269.93,307.096 1272.23,307.801 1274.54,523.781 1276.85,305.026 1279.16,338.889 1281.47,277.832 1283.77,290.186 1286.08,433.087 1288.39,425.882 1290.7,530.804 1293,622.703 1295.31,395.976 1297.62,363.924 1299.93,563.17 1302.24,478.688 1304.54,438.584 1306.85,486.019 1309.16,406.457 1311.47,361.369 1313.78,478.486 1316.08,442.767 1318.39,466.701 1320.7,338.655 1323.01,450.852 1325.32,297.122 1327.62,229.607 1329.93,485.671 1332.24,146.071 1334.55,515.519 1336.86,519.939 1339.16,372.742 1341.47,442.879 1343.78,269.649 1346.09,366.977 1348.39,416.43 1350.7,319.775 1353.01,225.818 1355.32,530.829 1357.63,492.396 1359.93,605.681 1362.24,485.152 1364.55,548.196 1366.86,457.366 1369.17,420.796 1371.47,481.659 1373.78,486.362 1376.09,436.271 1378.4,545.48 1380.71,294.621 1383.01,399.171 1385.32,427.971 1387.63,512.325 1389.94,481.938 1392.24,358.01 1394.55,356.469 1396.86,574.62 1399.17,376.885 1401.48,694.91 1403.78,471.09 1406.09,386.577 1408.4,490.721 1410.71,558.043 1413.02,579.938 1415.32,382.458 1417.63,394.819 1419.94,456.449 1422.25,252.126 1424.56,381.312 1426.86,464.541 1429.17,676.264 1431.48,444.039 1433.79,223.58 1436.1,280.464 1438.4,564.9 1440.71,454.943 1443.02,418.395 1445.33,502.148 1447.63,556.811 1449.94,409.396 1452.25,518.93 1454.56,295.079 1456.87,402.312 1459.17,326.492 1461.48,475.554 1463.79,442.178 1466.1,393.948 1468.41,436.044 1470.71,286.016 1473.02,418.028 1475.33,385.778 1477.64,427.014 1479.95,484.944 1482.25,496.02 1484.56,489.006 1486.87,418.13 1489.18,475.397 1491.49,534.222 1493.79,437.684 1496.1,520.763 1498.41,502.524 1500.72,461.906 1503.02,374.109 1505.33,520.128 1507.64,439.419 1509.95,540.578 1512.26,443.234 1514.56,269.807 1516.87,588.39 1519.18,484.824 1521.49,477.772 1523.8,384.893 1526.1,548.786 1528.41,469.748 1530.72,555.02 1533.03,475 1535.34,222.96 1537.64,461.078 1539.95,425.198 1542.26,518.616 1544.57,371.222 1546.88,478.382 1549.18,380.333 1551.49,334.377 1553.8,408.458 1556.11,343.608 1558.41,426.427 1560.72,463.074 1563.03,484.8 1565.34,331.495 1567.65,407.932 1569.95,585.819 1572.26,402.768 1574.57,500.098 1576.88,435.174 1579.19,435.883 1581.49,352.556 1583.8,604.669 1586.11,478.888 1588.42,338.364 1590.73,436.62 1593.03,451.519 1595.34,617.229 1597.65,505.947 1599.96,299.797 1602.26,463.277 1604.57,308.359 1606.88,342.379 1609.19,466.144 1611.5,457.174 1613.8,577.706 1616.11,418.295 1618.42,406.729 1620.73,238.17 1623.04,357.34 1625.34,544.717 1627.65,283.036 1629.96,454.967 1632.27,536.24 1634.58,340.948 1636.88,348.409 1639.19,362.638 1641.5,436.244 1643.81,465.199 1646.12,521.098 1648.42,575.436 1650.73,459.385 1653.04,562.77 1655.35,428.261 1657.65,398.611 1659.96,265.584 1662.27,296.998 1664.58,519.803 1666.89,487.884 1669.19,431.925 1671.5,516.146 1673.81,398.044 1676.12,234.835 1678.43,216.745 1680.73,451.551 1683.04,628.482 1685.35,352.139 1687.66,288.766 1689.97,371.498 1692.27,383.503 1694.58,395.056 1696.89,571.227 1699.2,421.464 1701.51,510.057 1703.81,498.896 1706.12,445.095 1708.43,463.304 1710.74,500.327 1713.04,406.393 1715.35,393.472 1717.66,519.147 1719.97,374.352 1722.28,502.288 1724.58,468.473 1726.89,411.623 1729.2,423.544 1731.51,552.034 1733.82,372.634 1736.12,477.474 1738.43,450.585 1740.74,525.97 1743.05,286.319 1745.36,237.975 1747.66,414.809 1749.97,361.925 1752.28,297.717 1754.59,578.284 1756.9,484.495 1759.2,369.585 1761.51,465.868 1763.82,334.194 1766.13,578.052 1768.43,468.122 1770.74,456.101 1773.05,290.322 1775.36,400.501 1777.67,431.379 1779.97,660.439 1782.28,385.941 1784.59,336.773 1786.9,376.995 1789.21,371.517 1791.51,508.816 1793.82,602.06 1796.13,431.207 1798.44,346.742 1800.75,287.695 1803.05,330.921 1805.36,342.675 1807.67,523.093 1809.98,397.857 1812.28,318.043 1814.59,322.151 1816.9,260.472 1819.21,533.354 1821.52,432.528 1823.82,236.775 1826.13,428.025 1828.44,539.451 1830.75,371.027 1833.06,329.786 1835.36,449.912 1837.67,380.407 1839.98,374.362 1842.29,535.211 1844.6,431.438 1846.9,463.468 1849.21,512.775 1851.52,409.856 1853.83,544.378 1856.14,303.977 1858.44,422.851 1860.75,568.086 1863.06,393.291 1865.37,404.243 1867.67,247.582 1869.98,429.789 1872.29,503.272 1874.6,276.219 1876.91,363.176 1879.21,310.652 1881.52,426.674 1883.83,437.954 1886.14,420.863 1888.45,459.715 1890.75,405.214 1893.06,390.149 1895.37,498.733 1897.68,500.632 1899.99,520.071 1902.29,519.821 1904.6,688.174 1906.91,232.137 1909.22,410.222 1911.53,162.441 1913.83,426.407 1916.14,274.196 1918.45,515.731 1920.76,658.007 1923.06,439.326 1925.37,191.082 1927.68,463.627 1929.99,352.016 1932.3,448.543 1934.6,411.336 1936.91,519.181 1939.22,333.939 1941.53,471.348 1943.84,494.401 1946.14,373.112 1948.45,319.42 1950.76,313.986 1953.07,415.141 1955.38,467.148 1957.68,445.098 1959.99,358.138 1962.3,606.187 1964.61,417.609 1966.91,360.036 1969.22,366.853 1971.53,378.727 1973.84,496.828 1976.15,334.843 1978.45,556.171 1980.76,324.166 1983.07,546.412 1985.38,419.461 1987.69,303.074 1989.99,343.566 1992.3,385.064 1994.61,562.243 1996.92,353.659 1999.23,530.165 2001.53,495.085 2003.84,341.569 2006.15,204.441 2008.46,346.226 2010.77,467.111 2013.07,602.553 2015.38,369.664 2017.69,495.489 2020,306.878 2022.3,476.955 2024.61,289.424 2026.92,531.331 2029.23,493.68 2031.54,415.133 2033.84,515.69 2036.15,328.691 2038.46,402.323 2040.77,487.881 2043.08,534.553 2045.38,404.183 2047.69,489.506 2050,547.866 2052.31,331.687 2054.62,466.812 2056.92,469.85 2059.23,366.232 2061.54,440.015 2063.85,546.802 2066.16,470.212 2068.46,237.748 2070.77,388.874 2073.08,265.7 2075.39,538.269 2077.69,394.32 2080,287.795 2082.31,408.591 2084.62,569.297 2086.93,284.87 2089.23,455.669 2091.54,478.716 2093.85,375.809 2096.16,392.012 2098.47,319.322 2100.77,374.924 2103.08,481.028 2105.39,454.948 2107.7,406.764 2110.01,484.941 2112.31,453.173 2114.62,414.201 2116.93,451.526 2119.24,393.101 2121.55,320.75 2123.85,343.478 2126.16,345.91 2128.47,427.337 2130.78,428.274 2133.08,471.877 2135.39,401.72 2137.7,544.359 2140.01,457.83 2142.32,579.106 2144.62,419.237 2146.93,383.656 2149.24,486.905 2151.55,576.004 2153.86,514.205 2156.16,422.572 2158.47,525.407 2160.78,287.865 2163.09,413.469 2165.4,426.842 2167.7,430.794 2170.01,345.831 2172.32,552.198 2174.63,492.424 2176.93,610.792 2179.24,554.212 2181.55,406.247 2183.86,534.85 2186.17,314.18 2188.47,498.29 2190.78,407.051 2193.09,526.542 2195.4,324.767 2197.71,369.642 2200.01,331.803 2202.32,428.31 2204.63,456.046 2206.94,353.219 2209.25,475.74 2211.55,332.776 2213.86,511.351 2216.17,432.684 2218.48,557.429 2220.79,430.683 2223.09,438.37 2225.4,477.536 2227.71,488.118 2230.02,481.413 2232.32,456.354 2234.63,438.903 2236.94,321.107 2239.25,363.259 2241.56,452.338 2243.86,344.804 2246.17,489.152 2248.48,325.078 2250.79,390.321 2253.1,475.211 2255.4,574.012 2257.71,449.434 2260.02,467.842 2262.33,461.142 2264.64,490.721 2266.94,472.382 2269.25,454.167 2271.56,581.249 2273.87,382.197 2276.18,460.813 2278.48,476.492 2280.79,524.085 2283.1,488.806 2285.41,370.562 2287.71,354.535 2290.02,423.366 2292.33,423.594 2294.64,451.418 2296.95,373.495 2299.25,413.471 2301.56,491.501 2303.87,306.738 2306.18,521.121 2308.49,423.284 2310.79,554.104 2313.1,375.872 2315.41,487.488 2317.72,416.845 2320.03,536.128 2322.33,489.602 2324.64,576.13 2326.95,451.507 2329.26,647.282 2331.56,478.103 2333.87,558.068 2336.18,583.038 2338.49,219.875 2340.8,487.184 2343.1,399.943 2345.41,400.023 2347.72,574.431 2350.03,542.939 2352.34,500.025 2354.64,446.887 2356.95,510.739 2359.26,463.775 2361.57,525.454 2363.88,210.154 2366.18,411.758 2368.49,470.229 2370.8,566.4 2373.11,528.095 2375.42,453.03 2377.72,579.612 2380.03,466.83 2382.34,495.87 2384.65,580.409 2386.95,367.463 2389.26,406.076 2391.57,503.846 2393.88,428.689 2396.19,451.611 2398.49,432.122 2400.8,397.149 2403.11,195.994 2405.42,398.593 2407.73,424.968 2410.03,328.83 2412.34,437.145 2414.65,358.989 2416.96,622.189 2419.27,713.145 2421.57,371.493 2423.88,312.468 2426.19,434.951 2428.5,524.539 2430.81,448.883 2433.11,275.604 2435.42,354.48 2437.73,456.938 2440.04,380.804 2442.34,425.549 2444.65,257.404 2446.96,493.446 2449.27,438.591 2451.58,398.772 2453.88,310.551 2456.19,529.681 2458.5,423.931 2460.81,336.848 2463.12,339.879 2465.42,470.06 2467.73,422.943 2470.04,403.634 2472.35,481.287 2474.66,419.863 2476.96,419.373 2479.27,348.89 2481.58,462.265 2483.89,523.564 2486.2,502.112 2488.5,635.894 2490.81,417.452 2493.12,573.362 2495.43,623.539 2497.73,532.384 2500.04,600.467 2502.35,387.975 2504.66,442.691 2506.97,437.446 2509.27,477.86 2511.58,423.757 2513.89,565.055 2516.2,435.692 2518.51,365.226 2520.81,294.81 2523.12,391.15 2525.43,463.38 2527.74,399.074 2530.05,361.348 2532.35,631.128 2534.66,419.342 2536.97,464.666 2539.28,426.254 2541.58,352.784 2543.89,331.757 2546.2,400.954 2548.51,469.981 2550.82,417.649 2553.12,420.405 2555.43,304.62 2557.74,407.163 2560.05,300.445 2562.36,485.885 2564.66,252.665 2566.97,472.716 2569.28,543.58 2571.59,146.546 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -2.84085   -3.75293  -3.75293  -4.88322   …  -4.85081   -4.85081   -3.98734
 -0.597399  -0.92033  -0.92033  -0.591664      0.252692   0.252692  -1.26984
  2.75712    5.04985   5.04985   4.5964        5.70846    5.70846    5.25302

[:, :, 2] =
 -3.78938   -4.9395   -4.91041   …  -3.64226   -4.26466   -5.10408
 -0.770048  -2.32234  -0.911954      0.400825  -0.735946   0.536435
  2.75789    5.1066    4.55389       3.63696    5.23553    4.02144

[:, :, 3] =
 -3.83697  -4.71438  -4.39456   -3.56344   …  -5.12393   -3.5836    -4.5523
 -2.50211  -2.08838   0.811545   0.947112      0.843341   0.452678   0.69313
  1.06888   1.99661   4.28997    3.42788       5.05352    4.66785    5.40934

[:, :, 4] =
 -3.98244   -5.62198  -6.54087   …  -4.96908   -5.01494   -5.01494
 -0.585468  -1.20049   0.196536     -0.546949   0.142287   0.142287
  0.73511    2.73652   4.775         6.53606    5.89312    5.89312</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.9835     1.00776
  0.0483414  1.00007
  4.98771    0.997674</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.49 seconds
Compute duration  = 2.49 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -5.0095    0.9893    0.0173   3259.1255   5274.3075    0.9999   ⋯
        x[2]    0.0060    0.9900    0.0175   3216.0829   5121.2050    1.0003   ⋯
        x[3]    4.9944    0.9725    0.0170   3270.2452   4840.2476    1.0000   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -6.9101   -5.6725   -5.0173   -4.3221   -3.0805
        x[2]   -1.9198   -0.6717    0.0195    0.6913    1.9280
        x[3]    3.0824    4.3490    4.9974    5.6595    6.8682</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.45 seconds
Compute duration  = 1.45 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.4967    0.1893    0.0029   4272.4875   5832.7388    1.0001   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1457    0.3563    0.4934    0.6365    0.8532</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.24 seconds
Compute duration  = 0.24 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

           x    0.4998    0.1532    0.0177    68.2595        NaN    1.0502     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.2537    0.3809    0.4985    0.6233    0.7791</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(-0.2471229957583797, "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with -0.2471229957583797:
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/uuqsE/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/uuqsE/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/uuqsE/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/uuqsE/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/uuqsE/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/DvdZw/src/compiler.jl:579 [inlined]
  [7] demo(__model__::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, __varinfo__::DynamicPPL.ThreadSafeVarInfo{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, Vector{Base.RefValue{Float64}}}, __context__::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:593
  [8] _evaluate!!
    @ ~/.julia/packages/DynamicPPL/DvdZw/src/model.jl:973 [inlined]
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, context::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/DvdZw/src/model.jl:962
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/DvdZw/src/model.jl:892 [inlined]
 [11] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/DvdZw/src/values_as_in_model.jl:196 [inlined]
 [12] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/DvdZw/src/values_as_in_model.jl:195 [inlined]
 [13] getparams(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64})
    @ Turing.Inference ~/.julia/packages/Turing/QN7BL/src/mcmc/Inference.jl:343
 [14] Turing.Inference.Transition(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, t::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/QN7BL/src/mcmc/Inference.jl:226
 [15] transition_to_turing
    @ ~/.julia/packages/Turing/QN7BL/src/mcmc/abstractmcmc.jl:12 [inlined]
 [16] transition_to_turing(f::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, transition::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/QN7BL/src/mcmc/abstractmcmc.jl:17
 [17] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}; initial_state::Nothing, initial_params::Nothing, kwargs::@Kwargs{})
    @ Turing.Inference ~/.julia/packages/Turing/QN7BL/src/mcmc/abstractmcmc.jl:147
 [18] macro expansion
    @ ~/.julia/packages/AbstractMCMC/z1nwm/src/sample.jl:0 [inlined]
 [19] macro expansion
    @ ~/.julia/packages/AbstractMCMC/z1nwm/src/logging.jl:16 [inlined]
 [20] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, num_warmup::Int64, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/z1nwm/src/sample.jl:142
 [21] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/DvdZw/src/sampler.jl:93
 [22] sample
    @ ~/.julia/packages/DynamicPPL/DvdZw/src/sampler.jl:83 [inlined]
 [23] #sample#4
    @ ~/.julia/packages/Turing/QN7BL/src/mcmc/Inference.jl:276 [inlined]
 [24] sample
    @ ~/.julia/packages/Turing/QN7BL/src/mcmc/Inference.jl:267 [inlined]
 [25] #sample#3
    @ ~/.julia/packages/Turing/QN7BL/src/mcmc/Inference.jl:264 [inlined]
 [26] top-level scope
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:595</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.58 seconds
Compute duration  = 1.58 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8668    0.5474    0.0200   596.6757   340.5118    1.0002     ⋯
           x   -0.0559    0.9154    0.0340   851.9452   534.8900    1.0012     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1202    0.4269    0.7638    1.2242    2.1863
           x   -2.2214   -0.4724   -0.0073    0.4035    1.7662</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.84 seconds
Compute duration  = 2.84 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8385    0.5745    0.0358   164.5503    56.8596    1.0028     ⋯
           x   -0.0462    0.9980    0.0551   419.0783   306.7892    1.0017     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.0687    0.3575    0.7404    1.1839    2.1891
           x   -2.5275   -0.4294   -0.0008    0.3581    2.0697</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>