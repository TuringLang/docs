<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.13">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing Samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../developers/inference/variational-inference/index.html" rel="prev">
<link href="../../../assets/favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-66ab7fd5e73b7f0a764e0d49b3e29ab1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark-7a0e04ec82617701cd34937292aa414e.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-f80257e2a36ff81c57cea0ffaf822744.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark-3042bfe894fb86cfc239603025ade02d.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../tutorials/coin-flipping/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.35" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.35</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.35">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../developers/contributing/index.html">Developers</a></li><li class="breadcrumb-item"><a href="../../../developers/inference/abstractmcmc-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../../developers/inference/implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../core-functionality/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Core Functionality</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">User Guide</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/automatic-differentiation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/custom-distribution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Custom Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/probability-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Querying Model Probabilities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/modifying-logprob/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modifying the Log Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/generated-quantities/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generated Quantities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/sampler-visualisation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/coin-flipping/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction: Coin Flipping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/gaussian-mixture-models/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/bayesian-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/bayesian-neural-networks/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/hidden-markov-models/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/bayesian-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/infinite-mixture-models/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/bayesian-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/bayesian-time-series-analysis/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/gaussian-processes-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Processes: Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/gaussian-process-latent-variable-models/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/contributing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contributing</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">DynamicPPL’s Compiler</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/compiler/model-manual/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manually Defining a Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/compiler/minituring-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/compiler/minituring-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/compiler/design-overview/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design (Outdated)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Inference (note: outdated)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/inference/abstractmcmc-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/inference/abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing Implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/inference/variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/inference/implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/developers/inference/implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../developers/contributing/index.html">Developers</a></li><li class="breadcrumb-item"><a href="../../../developers/inference/abstractmcmc-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../../developers/inference/implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing Samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-16.490851092673573</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-16.490851092673573</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([0.0, 0.0, 0.0]), MALAState{Vector{Float64}}([0.0, 0.0, 0.0]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -1.38508   -3.90253  -3.97506    …  -4.05123   -5.47278   -5.36311
  0.970707  -2.1212    0.0361927      0.676845  -0.555801  -0.261767
  4.9092     4.06253   3.24971        3.9259     3.74442    4.60268</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -5.00255    1.01169
 -0.0194233  1.00556
  5.0107     0.9923</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip680">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip680)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip681">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip680)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip682">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1629.6 2640.76,1629.6 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1391.94 2640.76,1391.94 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1154.27 2640.76,1154.27 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,916.608 2640.76,916.608 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,678.944 2640.76,678.944 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,441.28 2640.76,441.28 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,203.615 2640.76,203.615 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip680)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1629.6 215.714,1629.6 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1391.94 215.714,1391.94 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1154.27 215.714,1154.27 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,916.608 215.714,916.608 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,678.944 215.714,678.944 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,441.28 215.714,441.28 "></polyline>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,203.615 215.714,203.615 "></polyline>
<path clip-path="url(#clip680)" d="M50.5475 1630.05 L80.2233 1630.05 L80.2233 1633.99 L50.5475 1633.99 L50.5475 1630.05 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M89.1352 1612.32 L111.357 1612.32 L111.357 1614.31 L98.8111 1646.88 L93.9269 1646.88 L105.732 1616.26 L89.1352 1616.26 L89.1352 1612.32 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M120.478 1641 L125.362 1641 L125.362 1646.88 L120.478 1646.88 L120.478 1641 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M135.593 1612.32 L153.95 1612.32 L153.95 1616.26 L139.876 1616.26 L139.876 1624.73 Q140.894 1624.38 141.913 1624.22 Q142.931 1624.03 143.95 1624.03 Q149.737 1624.03 153.116 1627.2 Q156.496 1630.38 156.496 1635.79 Q156.496 1641.37 153.024 1644.47 Q149.552 1647.55 143.232 1647.55 Q141.056 1647.55 138.788 1647.18 Q136.542 1646.81 134.135 1646.07 L134.135 1641.37 Q136.218 1642.5 138.441 1643.06 Q140.663 1643.62 143.14 1643.62 Q147.144 1643.62 149.482 1641.51 Q151.82 1639.4 151.82 1635.79 Q151.82 1632.18 149.482 1630.07 Q147.144 1627.97 143.14 1627.97 Q141.265 1627.97 139.39 1628.38 Q137.538 1628.8 135.593 1629.68 L135.593 1612.32 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M49.5521 1392.39 L79.2279 1392.39 L79.2279 1396.32 L49.5521 1396.32 L49.5521 1392.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M89.3667 1374.66 L107.723 1374.66 L107.723 1378.59 L93.6491 1378.59 L93.6491 1387.06 Q94.6676 1386.72 95.6861 1386.55 Q96.7047 1386.37 97.7232 1386.37 Q103.51 1386.37 106.89 1389.54 Q110.269 1392.71 110.269 1398.13 Q110.269 1403.71 106.797 1406.81 Q103.325 1409.89 97.0056 1409.89 Q94.8297 1409.89 92.5612 1409.52 Q90.3158 1409.15 87.9084 1408.41 L87.9084 1403.71 Q89.9917 1404.84 92.2139 1405.4 Q94.4361 1405.95 96.913 1405.95 Q100.918 1405.95 103.256 1403.85 Q105.593 1401.74 105.593 1398.13 Q105.593 1394.52 103.256 1392.41 Q100.918 1390.3 96.913 1390.3 Q95.038 1390.3 93.163 1390.72 Q91.3112 1391.14 89.3667 1392.02 L89.3667 1374.66 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M119.482 1403.34 L124.367 1403.34 L124.367 1409.22 L119.482 1409.22 L119.482 1403.34 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M144.552 1377.73 Q140.941 1377.73 139.112 1381.3 Q137.306 1384.84 137.306 1391.97 Q137.306 1399.08 139.112 1402.64 Q140.941 1406.18 144.552 1406.18 Q148.186 1406.18 149.991 1402.64 Q151.82 1399.08 151.82 1391.97 Q151.82 1384.84 149.991 1381.3 Q148.186 1377.73 144.552 1377.73 M144.552 1374.03 Q150.362 1374.03 153.417 1378.64 Q156.496 1383.22 156.496 1391.97 Q156.496 1400.7 153.417 1405.3 Q150.362 1409.89 144.552 1409.89 Q138.741 1409.89 135.663 1405.3 Q132.607 1400.7 132.607 1391.97 Q132.607 1383.22 135.663 1378.64 Q138.741 1374.03 144.552 1374.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M50.5475 1154.72 L80.2233 1154.72 L80.2233 1158.66 L50.5475 1158.66 L50.5475 1154.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M94.3436 1167.62 L110.663 1167.62 L110.663 1171.55 L88.7186 1171.55 L88.7186 1167.62 Q91.3806 1164.86 95.9639 1160.23 Q100.57 1155.58 101.751 1154.24 Q103.996 1151.71 104.876 1149.98 Q105.779 1148.22 105.779 1146.53 Q105.779 1143.77 103.834 1142.04 Q101.913 1140.3 98.8111 1140.3 Q96.6121 1140.3 94.1584 1141.07 Q91.7278 1141.83 88.9501 1143.38 L88.9501 1138.66 Q91.7741 1137.52 94.2278 1136.95 Q96.6815 1136.37 98.7185 1136.37 Q104.089 1136.37 107.283 1139.05 Q110.478 1141.74 110.478 1146.23 Q110.478 1148.36 109.668 1150.28 Q108.881 1152.18 106.774 1154.77 Q106.195 1155.44 103.094 1158.66 Q99.9917 1161.85 94.3436 1167.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M120.478 1165.67 L125.362 1165.67 L125.362 1171.55 L120.478 1171.55 L120.478 1165.67 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M135.593 1136.99 L153.95 1136.99 L153.95 1140.93 L139.876 1140.93 L139.876 1149.4 Q140.894 1149.05 141.913 1148.89 Q142.931 1148.7 143.95 1148.7 Q149.737 1148.7 153.116 1151.88 Q156.496 1155.05 156.496 1160.46 Q156.496 1166.04 153.024 1169.14 Q149.552 1172.22 143.232 1172.22 Q141.056 1172.22 138.788 1171.85 Q136.542 1171.48 134.135 1170.74 L134.135 1166.04 Q136.218 1167.18 138.441 1167.73 Q140.663 1168.29 143.14 1168.29 Q147.144 1168.29 149.482 1166.18 Q151.82 1164.07 151.82 1160.46 Q151.82 1156.85 149.482 1154.75 Q147.144 1152.64 143.14 1152.64 Q141.265 1152.64 139.39 1153.06 Q137.538 1153.47 135.593 1154.35 L135.593 1136.99 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M99.3204 902.406 Q95.7093 902.406 93.8806 905.971 Q92.075 909.513 92.075 916.642 Q92.075 923.749 93.8806 927.314 Q95.7093 930.855 99.3204 930.855 Q102.955 930.855 104.76 927.314 Q106.589 923.749 106.589 916.642 Q106.589 909.513 104.76 905.971 Q102.955 902.406 99.3204 902.406 M99.3204 898.703 Q105.131 898.703 108.186 903.309 Q111.265 907.892 111.265 916.642 Q111.265 925.369 108.186 929.976 Q105.131 934.559 99.3204 934.559 Q93.5102 934.559 90.4315 929.976 Q87.376 925.369 87.376 916.642 Q87.376 907.892 90.4315 903.309 Q93.5102 898.703 99.3204 898.703 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M119.482 928.008 L124.367 928.008 L124.367 933.888 L119.482 933.888 L119.482 928.008 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M144.552 902.406 Q140.941 902.406 139.112 905.971 Q137.306 909.513 137.306 916.642 Q137.306 923.749 139.112 927.314 Q140.941 930.855 144.552 930.855 Q148.186 930.855 149.991 927.314 Q151.82 923.749 151.82 916.642 Q151.82 909.513 149.991 905.971 Q148.186 902.406 144.552 902.406 M144.552 898.703 Q150.362 898.703 153.417 903.309 Q156.496 907.892 156.496 916.642 Q156.496 925.369 153.417 929.976 Q150.362 934.559 144.552 934.559 Q138.741 934.559 135.663 929.976 Q132.607 925.369 132.607 916.642 Q132.607 907.892 135.663 903.309 Q138.741 898.703 144.552 898.703 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M94.3436 692.288 L110.663 692.288 L110.663 696.224 L88.7186 696.224 L88.7186 692.288 Q91.3806 689.534 95.9639 684.904 Q100.57 680.251 101.751 678.909 Q103.996 676.386 104.876 674.65 Q105.779 672.89 105.779 671.201 Q105.779 668.446 103.834 666.71 Q101.913 664.974 98.8111 664.974 Q96.6121 664.974 94.1584 665.738 Q91.7278 666.502 88.9501 668.052 L88.9501 663.33 Q91.7741 662.196 94.2278 661.617 Q96.6815 661.039 98.7185 661.039 Q104.089 661.039 107.283 663.724 Q110.478 666.409 110.478 670.9 Q110.478 673.029 109.668 674.951 Q108.881 676.849 106.774 679.441 Q106.195 680.113 103.094 683.33 Q99.9917 686.525 94.3436 692.288 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M120.478 690.344 L125.362 690.344 L125.362 696.224 L120.478 696.224 L120.478 690.344 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M135.593 661.664 L153.95 661.664 L153.95 665.599 L139.876 665.599 L139.876 674.071 Q140.894 673.724 141.913 673.562 Q142.931 673.377 143.95 673.377 Q149.737 673.377 153.116 676.548 Q156.496 679.719 156.496 685.136 Q156.496 690.714 153.024 693.816 Q149.552 696.895 143.232 696.895 Q141.056 696.895 138.788 696.525 Q136.542 696.154 134.135 695.413 L134.135 690.714 Q136.218 691.849 138.441 692.404 Q140.663 692.96 143.14 692.96 Q147.144 692.96 149.482 690.853 Q151.82 688.747 151.82 685.136 Q151.82 681.525 149.482 679.418 Q147.144 677.312 143.14 677.312 Q141.265 677.312 139.39 677.728 Q137.538 678.145 135.593 679.025 L135.593 661.664 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M89.3667 424 L107.723 424 L107.723 427.935 L93.6491 427.935 L93.6491 436.407 Q94.6676 436.06 95.6861 435.898 Q96.7047 435.712 97.7232 435.712 Q103.51 435.712 106.89 438.884 Q110.269 442.055 110.269 447.472 Q110.269 453.05 106.797 456.152 Q103.325 459.231 97.0056 459.231 Q94.8297 459.231 92.5612 458.86 Q90.3158 458.49 87.9084 457.749 L87.9084 453.05 Q89.9917 454.185 92.2139 454.74 Q94.4361 455.296 96.913 455.296 Q100.918 455.296 103.256 453.189 Q105.593 451.083 105.593 447.472 Q105.593 443.861 103.256 441.754 Q100.918 439.648 96.913 439.648 Q95.038 439.648 93.163 440.064 Q91.3112 440.481 89.3667 441.361 L89.3667 424 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M119.482 452.68 L124.367 452.68 L124.367 458.56 L119.482 458.56 L119.482 452.68 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M144.552 427.078 Q140.941 427.078 139.112 430.643 Q137.306 434.185 137.306 441.314 Q137.306 448.421 139.112 451.985 Q140.941 455.527 144.552 455.527 Q148.186 455.527 149.991 451.985 Q151.82 448.421 151.82 441.314 Q151.82 434.185 149.991 430.643 Q148.186 427.078 144.552 427.078 M144.552 423.375 Q150.362 423.375 153.417 427.981 Q156.496 432.564 156.496 441.314 Q156.496 450.041 153.417 454.648 Q150.362 459.231 144.552 459.231 Q138.741 459.231 135.663 454.648 Q132.607 450.041 132.607 441.314 Q132.607 432.564 135.663 427.981 Q138.741 423.375 144.552 423.375 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M89.1352 186.335 L111.357 186.335 L111.357 188.326 L98.8111 220.895 L93.9269 220.895 L105.732 190.271 L89.1352 190.271 L89.1352 186.335 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M120.478 215.016 L125.362 215.016 L125.362 220.895 L120.478 220.895 L120.478 215.016 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip680)" d="M135.593 186.335 L153.95 186.335 L153.95 190.271 L139.876 190.271 L139.876 198.743 Q140.894 198.396 141.913 198.234 Q142.931 198.048 143.95 198.048 Q149.737 198.048 153.116 201.22 Q156.496 204.391 156.496 209.808 Q156.496 215.386 153.024 218.488 Q149.552 221.567 143.232 221.567 Q141.056 221.567 138.788 221.196 Q136.542 220.826 134.135 220.085 L134.135 215.386 Q136.218 216.52 138.441 217.076 Q140.663 217.632 143.14 217.632 Q147.144 217.632 149.482 215.525 Q151.82 213.419 151.82 209.808 Q151.82 206.196 149.482 204.09 Q147.144 201.984 143.14 201.984 Q141.265 201.984 139.39 202.4 Q137.538 202.817 135.593 203.696 L135.593 186.335 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip682)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1048.28 268.292,1446.57 270.6,1421.47 272.908,1358.6 275.216,1284.61 277.524,1479.96 279.832,1468.88 282.139,1443.01 284.447,1361.28 286.755,1497.15 289.063,1451.52 291.371,1334.01 293.679,1362.85 295.987,1283.32 298.295,1372.16 300.603,1428.97 302.911,1402.49 305.219,1435.89 307.527,1481.07 309.834,1438.95 312.142,1434.6 314.45,1364.76 316.758,1344.52 319.066,1268.08 321.374,1444.47 323.682,1353.31 325.99,1352.96 328.298,1318.35 330.606,1343.2 332.914,1383.15 335.221,1384.79 337.529,1372.24 339.837,1354.01 342.145,1342.74 344.453,1523.33 346.761,1292.19 349.069,1467.3 351.377,1228.8 353.685,1336.25 355.993,1203.59 358.301,1373.11 360.608,1325.75 362.916,1567.44 365.224,1539.41 367.532,1506.13 369.84,1439.93 372.148,1471.39 374.456,1276.03 376.764,1361.21 379.072,1375.38 381.38,1415.05 383.688,1335.44 385.996,1252.1 388.303,1478.8 390.611,1370.42 392.919,1334.48 395.227,1324.64 397.535,1349.7 399.843,1385.61 402.151,1470.1 404.459,1469.14 406.767,1327.19 409.075,1568.57 411.383,1512.9 413.69,1382.38 415.998,1461.28 418.306,1305.12 420.614,1477.64 422.922,1383.71 425.23,1334.37 427.538,1467.9 429.846,1232.77 432.154,1310.36 434.462,1293.26 436.77,1293.18 439.077,1364.59 441.385,1275.36 443.693,1405.41 446.001,1256.46 448.309,1414.51 450.617,1383.8 452.925,1431.91 455.233,1431.06 457.541,1414.69 459.849,1300.59 462.157,1362.29 464.465,1330.35 466.772,1439.45 469.08,1338.41 471.388,1432.55 473.696,1331.02 476.004,1314.02 478.312,1334.98 480.62,1295.81 482.928,1411.52 485.236,1426.39 487.544,1383.42 489.852,1506.39 492.159,1364.99 494.467,1348.04 496.775,1337.94 499.083,1112.51 501.391,1330.43 503.699,1296.22 506.007,1253.37 508.315,1399.59 510.623,1487.97 512.931,1321.45 515.239,1440.22 517.546,1469.57 519.854,1303.76 522.162,1464.62 524.47,1317.88 526.778,1530.06 529.086,1320.93 531.394,1538.55 533.702,1246.59 536.01,1347.15 538.318,1277.95 540.626,1375.29 542.933,1526.25 545.241,1398.34 547.549,1562.08 549.857,1285.63 552.165,1460.08 554.473,1236.7 556.781,1508.83 559.089,1384.52 561.397,1107.59 563.705,1353.22 566.013,1457.96 568.321,1444.6 570.628,1455.67 572.936,1359.59 575.244,1485.29 577.552,1373.09 579.86,1319.92 582.168,1447.48 584.476,1362.73 586.784,1358.1 589.092,1398.7 591.4,1479.06 593.708,1388.05 596.015,1273.32 598.323,1253.3 600.631,1531.58 602.939,1464.69 605.247,1380.53 607.555,1403.32 609.863,1175.31 612.171,1486.49 614.479,1514.81 616.787,1263.22 619.095,1493.74 621.402,1464.37 623.71,1452.15 626.018,1440.45 628.326,1500.48 630.634,1367.17 632.942,1479.62 635.25,1335.82 637.558,1345.03 639.866,1359.18 642.174,1371.93 644.482,1318.22 646.79,1551.55 649.097,1180.77 651.405,1454.37 653.713,1337.08 656.021,1425.66 658.329,1303.26 660.637,1482.11 662.945,1344.07 665.253,1416.1 667.561,1453.32 669.869,1294.59 672.177,1468.03 674.484,1357 676.792,1394.59 679.1,1213.94 681.408,1592.61 683.716,1348.93 686.024,1364.35 688.332,1447.45 690.64,1468.81 692.948,1252.38 695.256,1463.82 697.564,1539.08 699.871,1473.34 702.179,1342.13 704.487,1302.61 706.795,1441.51 709.103,1514.79 711.411,1481.13 713.719,1377.8 716.027,1416.21 718.335,1402.09 720.643,1600.92 722.951,1505.12 725.259,1457.3 727.566,1288.8 729.874,1189.49 732.182,1394.03 734.49,1376.8 736.798,1444.4 739.106,1426.36 741.414,1228.78 743.722,1372.4 746.03,1337.68 748.338,1248.17 750.646,1521.83 752.953,1272.98 755.261,1405.81 757.569,1371.06 759.877,1296.46 762.185,1449.72 764.493,1283.23 766.801,1456.86 769.109,1425.6 771.417,1393.71 773.725,1452.66 776.033,1383.3 778.34,1414.19 780.648,1483.2 782.956,1422.56 785.264,1348.84 787.572,1362.14 789.88,1425.6 792.188,1455.14 794.496,1324.43 796.804,1355.12 799.112,1386.9 801.42,1341.06 803.728,1565.45 806.035,1390.4 808.343,1377.2 810.651,1501.11 812.959,1439.18 815.267,1431.06 817.575,1297.5 819.883,1319.93 822.191,1275.11 824.499,1486.53 826.807,1480.25 829.115,1201.63 831.422,1398 833.73,1336.53 836.038,1455.57 838.346,1314.95 840.654,1454.02 842.962,1439.86 845.27,1379.58 847.578,1369.98 849.886,1417.42 852.194,1436.25 854.502,1454.59 856.809,1337.07 859.117,1385.78 861.425,1593.14 863.733,1423.26 866.041,1304.75 868.349,1529.71 870.657,1356.5 872.965,1460.46 875.273,1273.08 877.581,1348.5 879.889,1451.31 882.197,1402.32 884.504,1317.61 886.812,1520.09 889.12,1507.48 891.428,1410.13 893.736,1407.6 896.044,1533.74 898.352,1544.1 900.66,1515.46 902.968,1298.57 905.276,1496.13 907.584,1378.16 909.891,1483.69 912.199,1407.81 914.507,1524.9 916.815,1497.72 919.123,1308.76 921.431,1257.59 923.739,1413.34 926.047,1390.44 928.355,1187.89 930.663,1276.83 932.971,1445.42 935.278,1339.42 937.586,1240.65 939.894,1508.35 942.202,1574.11 944.51,1552.68 946.818,1329.39 949.126,1346.14 951.434,1352.6 953.742,1200.5 956.05,1398.68 958.358,1405.14 960.665,1201.81 962.973,1322.96 965.281,1415.28 967.589,1360.36 969.897,1515.05 972.205,1543.26 974.513,1314.51 976.821,1338.29 979.129,1305.81 981.437,1408.54 983.745,1234.26 986.053,1481.02 988.36,1238.09 990.668,1388.05 992.976,1526.06 995.284,1353.99 997.592,1325.93 999.9,1241.99 1002.21,1412.12 1004.52,1498.7 1006.82,1427.43 1009.13,1383.13 1011.44,1270.19 1013.75,1459.72 1016.06,1321.72 1018.36,1456.33 1020.67,1252.76 1022.98,1403.96 1025.29,1545.29 1027.59,1330.47 1029.9,1512.22 1032.21,1464.56 1034.52,1354.62 1036.83,1294.94 1039.13,1493.45 1041.44,1408.2 1043.75,1400.23 1046.06,1422.16 1048.37,1417.64 1050.67,1323.05 1052.98,1404.68 1055.29,1364.29 1057.6,1249.57 1059.91,1441.32 1062.21,1452.64 1064.52,1516.86 1066.83,1402.62 1069.14,1454.08 1071.45,1470.04 1073.75,1365.71 1076.06,1409.66 1078.37,1415.56 1080.68,1394.65 1082.98,1509.8 1085.29,1419.09 1087.6,1372.28 1089.91,1366.36 1092.22,1485.67 1094.52,1292.31 1096.83,1513.62 1099.14,1314.52 1101.45,1453.35 1103.76,1363.26 1106.06,1327.43 1108.37,1405.25 1110.68,1317.26 1112.99,1458.24 1115.3,1362.9 1117.6,1417.79 1119.91,1492.36 1122.22,1398.06 1124.53,1360.19 1126.84,1397.34 1129.14,1376.87 1131.45,1594.37 1133.76,1409.79 1136.07,1402.21 1138.37,1366.79 1140.68,1420.85 1142.99,1326.18 1145.3,1398.99 1147.61,1314.82 1149.91,1367.92 1152.22,1307.58 1154.53,1387.59 1156.84,1259.14 1159.15,1368.11 1161.45,1239.26 1163.76,1380.85 1166.07,1541.83 1168.38,1380.03 1170.69,1398.73 1172.99,1222.99 1175.3,1338.8 1177.61,1545.02 1179.92,1307.04 1182.23,1244.37 1184.53,1364.58 1186.84,1312.37 1189.15,1420.67 1191.46,1346.71 1193.76,1306.97 1196.07,1334.82 1198.38,1277.01 1200.69,1356.45 1203,1372.19 1205.3,1357.74 1207.61,1315.2 1209.92,1539.92 1212.23,1322.89 1214.54,1426.32 1216.84,1327.43 1219.15,1393.42 1221.46,1474.86 1223.77,1323.05 1226.08,1361.56 1228.38,1226.41 1230.69,1098.87 1233,1303.62 1235.31,1409.44 1237.61,1529.64 1239.92,1421.89 1242.23,1417.38 1244.54,1430.99 1246.85,1514.91 1249.15,1333.93 1251.46,1338.67 1253.77,1387.62 1256.08,1291.29 1258.39,1309.18 1260.69,1412.65 1263,1275.58 1265.31,1259.85 1267.62,1313.17 1269.93,1212.69 1272.23,1591.51 1274.54,1453.78 1276.85,1329.73 1279.16,1476.73 1281.47,1293.12 1283.77,1290.62 1286.08,1444.8 1288.39,1359.51 1290.7,1351.92 1293,1329.01 1295.31,1328.29 1297.62,1402.25 1299.93,1413.72 1302.24,1408.86 1304.54,1448.41 1306.85,1208.53 1309.16,1400.55 1311.47,1438.29 1313.78,1357.17 1316.08,1392.11 1318.39,1452.31 1320.7,1421.87 1323.01,1566.82 1325.32,1437.4 1327.62,1507.81 1329.93,1419.05 1332.24,1455.09 1334.55,1458.71 1336.86,1483.58 1339.16,1527.48 1341.47,1255.38 1343.78,1309.25 1346.09,1484.76 1348.39,1513.53 1350.7,1270.25 1353.01,1317.45 1355.32,1328.4 1357.63,1320.38 1359.93,1322.8 1362.24,1423.71 1364.55,1566.08 1366.86,1506.01 1369.17,1428.73 1371.47,1616.14 1373.78,1466.66 1376.09,1440.8 1378.4,1266.66 1380.71,1378.09 1383.01,1446.06 1385.32,1500.49 1387.63,1283.33 1389.94,1246.16 1392.24,1230.83 1394.55,1483.41 1396.86,1476.85 1399.17,1419.47 1401.48,1303.63 1403.78,1505.88 1406.09,1395.12 1408.4,1268.65 1410.71,1431.12 1413.02,1364.43 1415.32,1491.05 1417.63,1412.08 1419.94,1410.47 1422.25,1411.72 1424.56,1191.85 1426.86,1592.76 1429.17,1392.85 1431.48,1531.42 1433.79,1271.01 1436.1,1404.7 1438.4,1334.34 1440.71,1628.39 1443.02,1407.27 1445.33,1378.65 1447.63,1427.57 1449.94,1143.74 1452.25,1329.88 1454.56,1406.24 1456.87,1372.56 1459.17,1303.43 1461.48,1250.9 1463.79,1444.68 1466.1,1377.48 1468.41,1409.61 1470.71,1379.46 1473.02,1431.08 1475.33,1315.11 1477.64,1355.98 1479.95,1420.54 1482.25,1405.55 1484.56,1284.23 1486.87,1413.36 1489.18,1403.33 1491.49,1180.83 1493.79,1356.41 1496.1,1169.28 1498.41,1444.05 1500.72,1422.86 1503.02,1406.98 1505.33,1426.44 1507.64,1296.72 1509.95,1491.53 1512.26,1380.71 1514.56,1309.36 1516.87,1388.82 1519.18,1415.06 1521.49,1437.37 1523.8,1284.99 1526.1,1160.5 1528.41,1197.29 1530.72,1483.43 1533.03,1367.61 1535.34,1488.4 1537.64,1353.01 1539.95,1312.38 1542.26,1163.29 1544.57,1312.89 1546.88,1511.62 1549.18,1492.43 1551.49,1501.25 1553.8,1385.16 1556.11,1468.22 1558.41,1443.29 1560.72,1332.45 1563.03,1456.58 1565.34,1751.15 1567.65,1461.34 1569.95,1380.34 1572.26,1321.25 1574.57,1377.07 1576.88,1459.47 1579.19,1343.07 1581.49,1459 1583.8,1470.67 1586.11,1472.24 1588.42,1422.01 1590.73,1422.59 1593.03,1313.75 1595.34,1374.49 1597.65,1229.45 1599.96,1491.84 1602.26,1402.99 1604.57,1394.84 1606.88,1375.97 1609.19,1320.25 1611.5,1405.96 1613.8,1320.99 1616.11,1380.37 1618.42,1351.81 1620.73,1297.83 1623.04,1360.22 1625.34,1313.8 1627.65,1347.95 1629.96,1468.31 1632.27,1532.42 1634.58,1482.76 1636.88,1370.76 1639.19,1569.1 1641.5,1424.14 1643.81,1295.16 1646.12,1349.1 1648.42,1337.06 1650.73,1383.18 1653.04,1566.08 1655.35,1482.69 1657.65,1420.99 1659.96,1397.13 1662.27,1277.24 1664.58,1282.59 1666.89,1496.44 1669.19,1334.22 1671.5,1242.42 1673.81,1366.69 1676.12,1204.04 1678.43,1345.11 1680.73,1451.23 1683.04,1455.69 1685.35,1313 1687.66,1421.19 1689.97,1515.07 1692.27,1321.98 1694.58,1230.77 1696.89,1389.45 1699.2,1312.48 1701.51,1497.58 1703.81,1379.18 1706.12,1523.61 1708.43,1436.15 1710.74,1445.35 1713.04,1382.48 1715.35,1189.91 1717.66,1420.44 1719.97,1335.51 1722.28,1298.15 1724.58,1365.25 1726.89,1270.68 1729.2,1350.11 1731.51,1512.05 1733.82,1347.51 1736.12,1397.28 1738.43,1296.59 1740.74,1568.25 1743.05,1470.63 1745.36,1296.58 1747.66,1482.69 1749.97,1473.52 1752.28,1472.71 1754.59,1431.17 1756.9,1292.1 1759.2,1373.63 1761.51,1344.26 1763.82,1316.1 1766.13,1391.35 1768.43,1246.8 1770.74,1402.55 1773.05,1418.76 1775.36,1301.48 1777.67,1286.12 1779.97,1412.29 1782.28,1312.79 1784.59,1558.01 1786.9,1268.51 1789.21,1422.98 1791.51,1315.38 1793.82,1463.68 1796.13,1261.89 1798.44,1259.21 1800.75,1546.81 1803.05,1408.23 1805.36,1362.04 1807.67,1489.95 1809.98,1407.24 1812.28,1494.3 1814.59,1378.66 1816.9,1443.28 1819.21,1365.74 1821.52,1524.26 1823.82,1199.03 1826.13,1297.79 1828.44,1436.49 1830.75,1491.44 1833.06,1375.23 1835.36,1327.42 1837.67,1406.36 1839.98,1407.62 1842.29,1325.51 1844.6,1378.76 1846.9,1342.23 1849.21,1482.38 1851.52,1335.35 1853.83,1473.13 1856.14,1311.02 1858.44,1391.55 1860.75,1119.61 1863.06,1350.7 1865.37,1371.63 1867.67,1363.27 1869.98,1488.35 1872.29,1398.3 1874.6,1530.11 1876.91,1565.4 1879.21,1447.74 1881.52,1393.58 1883.83,1239.66 1886.14,1422.05 1888.45,1445.53 1890.75,1519.81 1893.06,1355.99 1895.37,1427.29 1897.68,1312.48 1899.99,1522.72 1902.29,1159.83 1904.6,1520.55 1906.91,1425.4 1909.22,1386.17 1911.53,1530.2 1913.83,1417.42 1916.14,1464.04 1918.45,1352.97 1920.76,1576.66 1923.06,1583.34 1925.37,1398.23 1927.68,1513.42 1929.99,1259 1932.3,1166.13 1934.6,1154.48 1936.91,1438.46 1939.22,1468.12 1941.53,1322.69 1943.84,1336.86 1946.14,1464.41 1948.45,1263.23 1950.76,1364.84 1953.07,1209.24 1955.38,1546.35 1957.68,1519.13 1959.99,1576.05 1962.3,1602.6 1964.61,1307.54 1966.91,1583.45 1969.22,1240.79 1971.53,1290.41 1973.84,1405.33 1976.15,1366.26 1978.45,1323.44 1980.76,1468.21 1983.07,1352.04 1985.38,1303.88 1987.69,1342.24 1989.99,1459.47 1992.3,1412.83 1994.61,1206.22 1996.92,1467.99 1999.23,1365.03 2001.53,1298.24 2003.84,1487.99 2006.15,1331.2 2008.46,1297.83 2010.77,1461.5 2013.07,1284.53 2015.38,1421.61 2017.69,1359.07 2020,1466.74 2022.3,1372.62 2024.61,1460.53 2026.92,1370.59 2029.23,1430.52 2031.54,1484.93 2033.84,1448.28 2036.15,1544.38 2038.46,1302.55 2040.77,1368.24 2043.08,1393.83 2045.38,1366.02 2047.69,1424.38 2050,1516.69 2052.31,1410.22 2054.62,1392.73 2056.92,1280.05 2059.23,1290.86 2061.54,1391.51 2063.85,1324.42 2066.16,1343.49 2068.46,1290.46 2070.77,1440.21 2073.08,1411.28 2075.39,1161.39 2077.69,1390.21 2080,1271 2082.31,1367.87 2084.62,1442.2 2086.93,1410.85 2089.23,1412.86 2091.54,1349.67 2093.85,1508.4 2096.16,1530.42 2098.47,1216.64 2100.77,1413.43 2103.08,1396.32 2105.39,1444.55 2107.7,1280.94 2110.01,1342.4 2112.31,1430.19 2114.62,1304.45 2116.93,1505.26 2119.24,1326.3 2121.55,1386.43 2123.85,1472.65 2126.16,1586.7 2128.47,1446.38 2130.78,1479.21 2133.08,1377.5 2135.39,1581.63 2137.7,1511.03 2140.01,1341.64 2142.32,1318.89 2144.62,1308.46 2146.93,1472.88 2149.24,1425.06 2151.55,1449.95 2153.86,1465.57 2156.16,1394.27 2158.47,1372.18 2160.78,1463.36 2163.09,1365.74 2165.4,1344.87 2167.7,1399.79 2170.01,1170.93 2172.32,1484.29 2174.63,1367.76 2176.93,1674.17 2179.24,1450.46 2181.55,1400.25 2183.86,1386.01 2186.17,1415.24 2188.47,1529.56 2190.78,1455.35 2193.09,1362.93 2195.4,1241.4 2197.71,1475.38 2200.01,1430.37 2202.32,1441.56 2204.63,1363.82 2206.94,1439.86 2209.25,1395.63 2211.55,1285.55 2213.86,1483.61 2216.17,1368.03 2218.48,1484.24 2220.79,1440.89 2223.09,1251.65 2225.4,1464.13 2227.71,1401.1 2230.02,1243.28 2232.32,1454.79 2234.63,1350.35 2236.94,1458.12 2239.25,1409.78 2241.56,1270.41 2243.86,1340.49 2246.17,1380.75 2248.48,1401.43 2250.79,1377.1 2253.1,1312.62 2255.4,1485.43 2257.71,1481.47 2260.02,1351.19 2262.33,1619.1 2264.64,1409.11 2266.94,1394.63 2269.25,1446.17 2271.56,1242.43 2273.87,1478.71 2276.18,1319.37 2278.48,1363.8 2280.79,1255.92 2283.1,1331.31 2285.41,1530.71 2287.71,1221.22 2290.02,1380.69 2292.33,1310.35 2294.64,1376.71 2296.95,1222.59 2299.25,1313.64 2301.56,1436.11 2303.87,1317.53 2306.18,1386.55 2308.49,1517.16 2310.79,1329.33 2313.1,1630.73 2315.41,1288.64 2317.72,1439.71 2320.03,1493 2322.33,1216.77 2324.64,1194.08 2326.95,1373.44 2329.26,1566.96 2331.56,1343.75 2333.87,1324.07 2336.18,1409.15 2338.49,1339.89 2340.8,1403.1 2343.1,1380.53 2345.41,1381.44 2347.72,1418.33 2350.03,1388.54 2352.34,1547.4 2354.64,1438.82 2356.95,1351.03 2359.26,1330.81 2361.57,1217.75 2363.88,1358.33 2366.18,1384.36 2368.49,1368.12 2370.8,1437.82 2373.11,1416.42 2375.42,1174.41 2377.72,1376.03 2380.03,1299.62 2382.34,1274.51 2384.65,1382.74 2386.95,1375.57 2389.26,1444.18 2391.57,1375.36 2393.88,1291.41 2396.19,1399.3 2398.49,1334.25 2400.8,1578.8 2403.11,1415.65 2405.42,1395.69 2407.73,1727.86 2410.03,1519.56 2412.34,1472 2414.65,1392.04 2416.96,1420.14 2419.27,1495.62 2421.57,1505.29 2423.88,1642.3 2426.19,1407.93 2428.5,1409.66 2430.81,1434.53 2433.11,1542.09 2435.42,1345 2437.73,1317.7 2440.04,1417.1 2442.34,1455.59 2444.65,1465.23 2446.96,1325.81 2449.27,1305.26 2451.58,1522.27 2453.88,1375.96 2456.19,1349.22 2458.5,1272.8 2460.81,1352.31 2463.12,1313.11 2465.42,1440.69 2467.73,1524.38 2470.04,1375.28 2472.35,1558.28 2474.66,1270.7 2476.96,1427.3 2479.27,1458.63 2481.58,1341.82 2483.89,1426.5 2486.2,1556.41 2488.5,1333.43 2490.81,1321.59 2493.12,1436.47 2495.43,1392.97 2497.73,1489.57 2500.04,1484.79 2502.35,1209.03 2504.66,1287 2506.97,1318.58 2509.27,1531.05 2511.58,1305.01 2513.89,1318.9 2516.2,1363.22 2518.51,1467.55 2520.81,1464.49 2523.12,1417.78 2525.43,1357.08 2527.74,1512.73 2530.05,1295.23 2532.35,1464.38 2534.66,1276.62 2536.97,1560.23 2539.28,1420.39 2541.58,1459.69 2543.89,1167.4 2546.2,1368.96 2548.51,1530.18 2550.82,1270.38 2553.12,1517.12 2555.43,1332.47 2557.74,1546.4 2560.05,1529.43 2562.36,1360.16 2564.66,1349.86 2566.97,1420.66 2569.28,1262.05 2571.59,1294.57 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,824.327 268.292,988.961 270.6,1018.8 272.908,760.891 275.216,904.464 277.524,962.29 279.832,899.36 282.139,963.307 284.447,1013.96 286.755,949.209 289.063,943.767 291.371,874.335 293.679,1037.76 295.987,772.242 298.295,1175.45 300.603,964.576 302.911,1011.99 305.219,974.565 307.527,938.331 309.834,809.81 312.142,902.702 314.45,1045.48 316.758,919.174 319.066,828.538 321.374,892.914 323.682,851.192 325.99,1054.64 328.298,763.273 330.606,953.547 332.914,901.656 335.221,757.001 337.529,842.346 339.837,724.969 342.145,839.98 344.453,999.174 346.761,841.803 349.069,1087.34 351.377,905.81 353.685,917.439 355.993,882.406 358.301,949.088 360.608,1048.59 362.916,844.282 365.224,998.825 367.532,829.641 369.84,907.306 372.148,844.622 374.456,859.649 376.764,917.982 379.072,1044.13 381.38,1069.49 383.688,986.954 385.996,917.906 388.303,984.666 390.611,1151.9 392.919,1015.16 395.227,915.222 397.535,686.019 399.843,900.163 402.151,938.084 404.459,946.632 406.767,985.141 409.075,953.341 411.383,908.597 413.69,964.794 415.998,906.166 418.306,867.197 420.614,961.784 422.922,983.196 425.23,972.932 427.538,931.534 429.846,992.471 432.154,1005.02 434.462,1001.42 436.77,999.954 439.077,915.65 441.385,760.075 443.693,745.684 446.001,1113.19 448.309,1024.37 450.617,961.95 452.925,959.379 455.233,897.027 457.541,863.154 459.849,929.009 462.157,1069.25 464.465,1067.15 466.772,923.025 469.08,850.905 471.388,962.52 473.696,929.112 476.004,947.025 478.312,883.081 480.62,939.144 482.928,972.626 485.236,1035.98 487.544,1031.18 489.852,880.451 492.159,838.5 494.467,943.714 496.775,980.227 499.083,960.264 501.391,961.829 503.699,905.758 506.007,986.706 508.315,1098.88 510.623,871.838 512.931,872.349 515.239,857.907 517.546,796.963 519.854,970.989 522.162,842.994 524.47,936.903 526.778,990.809 529.086,957.239 531.394,1095.21 533.702,862.025 536.01,959.276 538.318,697.402 540.626,952.93 542.933,1056.51 545.241,928.072 547.549,1052.27 549.857,734.4 552.165,889.721 554.473,857.294 556.781,1046.75 559.089,984.855 561.397,819.961 563.705,958.584 566.013,999.298 568.321,1019.21 570.628,899.032 572.936,1002.34 575.244,874.171 577.552,969 579.86,829.937 582.168,1003.99 584.476,889.003 586.784,1077.47 589.092,849.945 591.4,1048.02 593.708,970.025 596.015,818.313 598.323,1036.34 600.631,941.53 602.939,953.949 605.247,819.208 607.555,898.793 609.863,969.571 612.171,844.122 614.479,929.391 616.787,820.493 619.095,727.314 621.402,1067.27 623.71,839.829 626.018,958.059 628.326,1026.6 630.634,1089.75 632.942,761.317 635.25,909.769 637.558,734.388 639.866,895.328 642.174,860.104 644.482,1013.49 646.79,843.703 649.097,801.797 651.405,926.78 653.713,892.318 656.021,892.986 658.329,921.408 660.637,1081.07 662.945,1000.67 665.253,1068.17 667.561,918.535 669.869,1131.05 672.177,844.925 674.484,837.415 676.792,879.421 679.1,891.782 681.408,850.79 683.716,1089.05 686.024,925.758 688.332,936.849 690.64,841.7 692.948,783.29 695.256,872.105 697.564,968.098 699.871,876.109 702.179,1013.83 704.487,1045.73 706.795,919.293 709.103,884.329 711.411,958.785 713.719,905.499 716.027,998.499 718.335,885.605 720.643,857.521 722.951,820.662 725.259,919.647 727.566,878.556 729.874,859.087 732.182,851.777 734.49,842.884 736.798,879.388 739.106,774.078 741.414,1046.27 743.722,885.781 746.03,839.078 748.338,883.056 750.646,888.728 752.953,1158.73 755.261,1008.86 757.569,789.158 759.877,997.912 762.185,1034.64 764.493,1009.5 766.801,895.1 769.109,1125.85 771.417,862.955 773.725,941.365 776.033,906.875 778.34,1030.34 780.648,1116.46 782.956,867.878 785.264,907.9 787.572,976.949 789.88,891.834 792.188,1041.23 794.496,809.698 796.804,755.961 799.112,1046.35 801.42,958.905 803.728,924.393 806.035,874.363 808.343,1049.76 810.651,958.639 812.959,771.571 815.267,811.754 817.575,991.674 819.883,901.394 822.191,853.081 824.499,859.889 826.807,867.76 829.115,967.256 831.422,840.865 833.73,760.833 836.038,1141.53 838.346,1067.27 840.654,1074.17 842.962,1066.05 845.27,976.253 847.578,1125.6 849.886,901.607 852.194,878.148 854.502,1015.25 856.809,900.204 859.117,764.888 861.425,925.296 863.733,948.974 866.041,965.221 868.349,1034.91 870.657,843.982 872.965,971.26 875.273,971.508 877.581,1027.63 879.889,926.529 882.197,869.428 884.504,921.562 886.812,779.732 889.12,902.107 891.428,1031.21 893.736,859.115 896.044,985.914 898.352,1004.61 900.66,820.336 902.968,870.358 905.276,1081.17 907.584,1002.19 909.891,915.806 912.199,811.463 914.507,923.896 916.815,716.061 919.123,877.598 921.431,1066.55 923.739,847.823 926.047,976.678 928.355,866.056 930.663,812.137 932.971,850.251 935.278,1007.48 937.586,1014.76 939.894,960.741 942.202,845.461 944.51,848.433 946.818,769.301 949.126,924.438 951.434,1081.61 953.742,1001.7 956.05,806.285 958.358,994.154 960.665,812.442 962.973,868.359 965.281,929.842 967.589,907.097 969.897,894.482 972.205,1143.06 974.513,945.959 976.821,814.807 979.129,925.066 981.437,1008.77 983.745,953.46 986.053,915.817 988.36,826.432 990.668,822.436 992.976,800.822 995.284,860.213 997.592,993.228 999.9,939.987 1002.21,967.538 1004.52,880.218 1006.82,1056.87 1009.13,735.531 1011.44,959.409 1013.75,949.955 1016.06,1022.59 1018.36,925.417 1020.67,858.928 1022.98,887.801 1025.29,934.914 1027.59,987.086 1029.9,910.297 1032.21,943.232 1034.52,1001.28 1036.83,974.581 1039.13,1065.38 1041.44,658.902 1043.75,887.063 1046.06,779.948 1048.37,943.761 1050.67,1062.61 1052.98,939.222 1055.29,1078.25 1057.6,917.744 1059.91,986.144 1062.21,886.201 1064.52,882.75 1066.83,972.094 1069.14,938.864 1071.45,838.333 1073.75,963.341 1076.06,806.876 1078.37,924.341 1080.68,857.499 1082.98,1021.92 1085.29,981.278 1087.6,1121.59 1089.91,935.158 1092.22,1020.33 1094.52,1116.76 1096.83,867.719 1099.14,1049.16 1101.45,850.007 1103.76,741.03 1106.06,928.886 1108.37,1023.67 1110.68,883.486 1112.99,826.05 1115.3,883.865 1117.6,884.735 1119.91,1052.06 1122.22,1049.57 1124.53,910.927 1126.84,914.117 1129.14,893.318 1131.45,997.548 1133.76,815.701 1136.07,876.159 1138.37,972.87 1140.68,852.686 1142.99,906.35 1145.3,840.382 1147.61,878.46 1149.91,944.371 1152.22,815.871 1154.53,685.189 1156.84,1059.36 1159.15,904.567 1161.45,971.669 1163.76,820.195 1166.07,976.965 1168.38,930.653 1170.69,876.811 1172.99,1032.09 1175.3,848.048 1177.61,985.031 1179.92,861.317 1182.23,851.495 1184.53,977.819 1186.84,851.792 1189.15,869.312 1191.46,1013.75 1193.76,898.084 1196.07,926.922 1198.38,936.734 1200.69,741.832 1203,805.262 1205.3,930.596 1207.61,927.624 1209.92,814.234 1212.23,793.717 1214.54,1040.93 1216.84,1003.86 1219.15,830.454 1221.46,1151.91 1223.77,1065.77 1226.08,837.984 1228.38,865.144 1230.69,1072.72 1233,1004.36 1235.31,936.453 1237.61,865.877 1239.92,1215.08 1242.23,1089.18 1244.54,687.213 1246.85,883.898 1249.15,908.473 1251.46,930.643 1253.77,954.214 1256.08,945.48 1258.39,1009.97 1260.69,833.875 1263,877.521 1265.31,974.085 1267.62,996.42 1269.93,1046.78 1272.23,915.854 1274.54,901.529 1276.85,1007.34 1279.16,928.514 1281.47,855.628 1283.77,774.161 1286.08,771.419 1288.39,907.479 1290.7,786.606 1293,918.255 1295.31,805.436 1297.62,1011.93 1299.93,985.033 1302.24,848.908 1304.54,988.052 1306.85,877.735 1309.16,973.825 1311.47,1008.14 1313.78,843.421 1316.08,834.923 1318.39,1004.66 1320.7,917.996 1323.01,960.721 1325.32,841.997 1327.62,836.54 1329.93,1174.62 1332.24,918.953 1334.55,1019.35 1336.86,1083.55 1339.16,845.694 1341.47,877.298 1343.78,854.421 1346.09,765.034 1348.39,873.034 1350.7,947.16 1353.01,924.615 1355.32,831.372 1357.63,902.243 1359.93,854.287 1362.24,864.867 1364.55,857.027 1366.86,912.529 1369.17,842.218 1371.47,880.636 1373.78,864.274 1376.09,798.046 1378.4,898.474 1380.71,945.399 1383.01,895.647 1385.32,906.051 1387.63,908.163 1389.94,869.26 1392.24,933.493 1394.55,862.263 1396.86,868.661 1399.17,819.954 1401.48,910.307 1403.78,983.366 1406.09,896.887 1408.4,949.622 1410.71,870.214 1413.02,799.306 1415.32,963.587 1417.63,1014.75 1419.94,953.468 1422.25,967.416 1424.56,927.053 1426.86,1005.56 1429.17,904.806 1431.48,823.927 1433.79,850.059 1436.1,871.921 1438.4,809.155 1440.71,1051.39 1443.02,936.988 1445.33,875.845 1447.63,1000.66 1449.94,1060.32 1452.25,861.125 1454.56,851.643 1456.87,877.622 1459.17,835.36 1461.48,944.282 1463.79,893.23 1466.1,877.911 1468.41,977.64 1470.71,928.803 1473.02,791.045 1475.33,952.76 1477.64,1008.96 1479.95,896.003 1482.25,884.37 1484.56,989.805 1486.87,783.665 1489.18,870.526 1491.49,974.039 1493.79,909.952 1496.1,947.389 1498.41,926.998 1500.72,823.159 1503.02,839.504 1505.33,814.183 1507.64,937.8 1509.95,934.365 1512.26,981.177 1514.56,976.798 1516.87,1077.16 1519.18,843.989 1521.49,959.547 1523.8,935.376 1526.1,993.59 1528.41,919.887 1530.72,930.24 1533.03,970.187 1535.34,964.681 1537.64,822.996 1539.95,936.218 1542.26,960.274 1544.57,956.818 1546.88,906.813 1549.18,905.506 1551.49,1068.2 1553.8,847.964 1556.11,770.679 1558.41,1097.6 1560.72,792.853 1563.03,844.019 1565.34,897.963 1567.65,964.165 1569.95,927.309 1572.26,1068.27 1574.57,1038.07 1576.88,891.349 1579.19,860.184 1581.49,866.288 1583.8,922.585 1586.11,905.98 1588.42,819.493 1590.73,916.733 1593.03,874.702 1595.34,874.699 1597.65,1006.82 1599.96,863.764 1602.26,914.363 1604.57,1009.25 1606.88,1043.93 1609.19,855.83 1611.5,1055.45 1613.8,853.286 1616.11,796.73 1618.42,1081.43 1620.73,856.415 1623.04,1012.16 1625.34,916.452 1627.65,956.874 1629.96,792.47 1632.27,707.294 1634.58,973.005 1636.88,976.055 1639.19,1037.81 1641.5,853.255 1643.81,676.452 1646.12,945.58 1648.42,921.9 1650.73,845.114 1653.04,956.002 1655.35,737.552 1657.65,935.402 1659.96,853.704 1662.27,825.668 1664.58,851.149 1666.89,918.328 1669.19,973.774 1671.5,925.175 1673.81,823.713 1676.12,918.818 1678.43,859.845 1680.73,871.727 1683.04,874.945 1685.35,1020.57 1687.66,883.147 1689.97,774.944 1692.27,901.055 1694.58,864.524 1696.89,875.363 1699.2,768.446 1701.51,1051.06 1703.81,798.655 1706.12,913.954 1708.43,824.298 1710.74,766.312 1713.04,905.516 1715.35,822.567 1717.66,984.661 1719.97,1014.59 1722.28,795.214 1724.58,963.219 1726.89,1024.66 1729.2,945.644 1731.51,977.145 1733.82,877.918 1736.12,931.486 1738.43,847.666 1740.74,928.026 1743.05,1106.75 1745.36,1121.29 1747.66,915.983 1749.97,863.819 1752.28,1085.03 1754.59,994.395 1756.9,1029.04 1759.2,902.157 1761.51,1074.7 1763.82,845.421 1766.13,850.287 1768.43,1019.03 1770.74,679.257 1773.05,1095.21 1775.36,1054.04 1777.67,804.223 1779.97,819.246 1782.28,863.26 1784.59,799.044 1786.9,610.715 1789.21,822.62 1791.51,974.685 1793.82,908.243 1796.13,896.48 1798.44,1036.74 1800.75,934.552 1803.05,823.69 1805.36,927.682 1807.67,850.108 1809.98,1051.74 1812.28,837.165 1814.59,1151.95 1816.9,824.092 1819.21,991.36 1821.52,811.641 1823.82,704.127 1826.13,964.578 1828.44,842.687 1830.75,869.109 1833.06,945.378 1835.36,889.11 1837.67,991.571 1839.98,837.176 1842.29,871.441 1844.6,953.358 1846.9,913.062 1849.21,980.068 1851.52,1008.61 1853.83,1096.52 1856.14,930.705 1858.44,857.719 1860.75,823.906 1863.06,861.552 1865.37,1028.11 1867.67,1045.21 1869.98,953.519 1872.29,813.394 1874.6,825.396 1876.91,1028.99 1879.21,1020.29 1881.52,758.645 1883.83,919.028 1886.14,951.638 1888.45,953.842 1890.75,932.563 1893.06,958.288 1895.37,950.71 1897.68,826.84 1899.99,948.403 1902.29,757.856 1904.6,982.062 1906.91,927.052 1909.22,897.186 1911.53,856.387 1913.83,957.839 1916.14,977.704 1918.45,1095.31 1920.76,808.17 1923.06,805 1925.37,921.108 1927.68,897.181 1929.99,795.369 1932.3,903.718 1934.6,765.046 1936.91,910.446 1939.22,763.219 1941.53,959.156 1943.84,1122.66 1946.14,774.072 1948.45,1023.8 1950.76,934.408 1953.07,945.167 1955.38,844.741 1957.68,971.93 1959.99,871.075 1962.3,875.749 1964.61,820.162 1966.91,935.758 1969.22,835.034 1971.53,904.394 1973.84,941.004 1976.15,1073.93 1978.45,1088.5 1980.76,1034.75 1983.07,838.164 1985.38,843.381 1987.69,780.282 1989.99,935.596 1992.3,894.648 1994.61,833.692 1996.92,951.957 1999.23,1040.98 2001.53,901.842 2003.84,915.62 2006.15,990.571 2008.46,958.214 2010.77,763.947 2013.07,1082.42 2015.38,802.742 2017.69,747.32 2020,931.393 2022.3,1046.39 2024.61,920.632 2026.92,902.353 2029.23,993.309 2031.54,929.492 2033.84,887.774 2036.15,1069.42 2038.46,930.148 2040.77,852.323 2043.08,1013.47 2045.38,891.111 2047.69,864.993 2050,832.66 2052.31,927.568 2054.62,740.071 2056.92,1074.77 2059.23,854.62 2061.54,914.736 2063.85,930.321 2066.16,975.729 2068.46,933.272 2070.77,709.003 2073.08,922.532 2075.39,892.406 2077.69,978.318 2080,1040.89 2082.31,820.837 2084.62,823.349 2086.93,856.287 2089.23,902.008 2091.54,919.805 2093.85,1025.35 2096.16,1097.43 2098.47,934.637 2100.77,805.717 2103.08,986.664 2105.39,809.517 2107.7,812.246 2110.01,705.813 2112.31,840.468 2114.62,799.158 2116.93,816.285 2119.24,894.99 2121.55,1028.65 2123.85,916.048 2126.16,853.602 2128.47,857.987 2130.78,803.739 2133.08,872.505 2135.39,1042 2137.7,1154.41 2140.01,715.544 2142.32,871.416 2144.62,901.862 2146.93,821.848 2149.24,844.788 2151.55,1081.36 2153.86,786.831 2156.16,914.354 2158.47,888.136 2160.78,858.459 2163.09,791.222 2165.4,912.345 2167.7,901 2170.01,869.615 2172.32,947.252 2174.63,890 2176.93,699.608 2179.24,779.646 2181.55,977.139 2183.86,764.311 2186.17,826.604 2188.47,756.686 2190.78,1110.36 2193.09,846.839 2195.4,930.204 2197.71,1054 2200.01,890.765 2202.32,961.998 2204.63,985.197 2206.94,866.33 2209.25,848.528 2211.55,752.613 2213.86,1228.68 2216.17,890.884 2218.48,1038.67 2220.79,821.042 2223.09,898.485 2225.4,1074.97 2227.71,1039.29 2230.02,892.556 2232.32,938.074 2234.63,892.117 2236.94,849.133 2239.25,924.252 2241.56,912.395 2243.86,1087.78 2246.17,944.529 2248.48,731.875 2250.79,937.363 2253.1,798.003 2255.4,916.728 2257.71,831.943 2260.02,870.93 2262.33,941.545 2264.64,920.982 2266.94,884.71 2269.25,1162.22 2271.56,956.047 2273.87,998.919 2276.18,997.814 2278.48,854.095 2280.79,832.407 2283.1,830.299 2285.41,913.739 2287.71,909.66 2290.02,933.2 2292.33,884.817 2294.64,898.44 2296.95,965.968 2299.25,986.771 2301.56,1014.08 2303.87,737.762 2306.18,844.56 2308.49,855.167 2310.79,892.237 2313.1,822.993 2315.41,823.775 2317.72,988.049 2320.03,929.248 2322.33,944.284 2324.64,978.789 2326.95,907.065 2329.26,786.389 2331.56,1002.68 2333.87,880.861 2336.18,1033.7 2338.49,826.034 2340.8,791.706 2343.1,970.711 2345.41,829.07 2347.72,879.109 2350.03,907.112 2352.34,952.254 2354.64,927.887 2356.95,775.223 2359.26,768.95 2361.57,1036.65 2363.88,916.765 2366.18,886.743 2368.49,1047.02 2370.8,821.578 2373.11,953.387 2375.42,900.087 2377.72,1078.2 2380.03,900.537 2382.34,919.496 2384.65,800.139 2386.95,977.234 2389.26,900.801 2391.57,1002.36 2393.88,759.513 2396.19,974.021 2398.49,826.806 2400.8,938.674 2403.11,884.084 2405.42,1072.71 2407.73,1000.59 2410.03,908.06 2412.34,902.214 2414.65,946.842 2416.96,948.326 2419.27,982.525 2421.57,950.758 2423.88,826.863 2426.19,992.95 2428.5,880.582 2430.81,1013.46 2433.11,913.414 2435.42,1188.3 2437.73,865.385 2440.04,1001.96 2442.34,954.739 2444.65,820.291 2446.96,860.166 2449.27,930.081 2451.58,973.209 2453.88,895.255 2456.19,938.643 2458.5,782.987 2460.81,927.676 2463.12,809.955 2465.42,855.568 2467.73,772.607 2470.04,1006.7 2472.35,945.97 2474.66,962.645 2476.96,731.111 2479.27,998.011 2481.58,1087.92 2483.89,873.521 2486.2,831.647 2488.5,864.802 2490.81,1061.86 2493.12,977.499 2495.43,812.835 2497.73,825.41 2500.04,898.742 2502.35,825.066 2504.66,847.251 2506.97,879.968 2509.27,854.144 2511.58,935.722 2513.89,798.536 2516.2,828.174 2518.51,815.471 2520.81,1026.24 2523.12,1122.03 2525.43,832.125 2527.74,897.668 2530.05,984.464 2532.35,1003.85 2534.66,783.903 2536.97,839.703 2539.28,806.848 2541.58,927.931 2543.89,934.157 2546.2,777.014 2548.51,890.266 2550.82,908.479 2553.12,883.977 2555.43,1077.4 2557.74,845.754 2560.05,915.171 2562.36,1048.48 2564.66,897.36 2566.97,955.503 2569.28,966.636 2571.59,911.893 "></polyline>
<polyline clip-path="url(#clip682)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,449.912 268.292,471.247 270.6,539.516 272.908,496.168 275.216,474.563 277.524,372.39 279.832,285.824 282.139,587.782 284.447,363.2 286.755,279.903 289.063,515.848 291.371,291.888 293.679,406.918 295.987,431.046 298.295,347.713 300.603,357.123 302.911,455.096 305.219,366.016 307.527,440.297 309.834,418.284 312.142,336.269 314.45,458.967 316.758,356.054 319.066,386.738 321.374,565.326 323.682,553.46 325.99,480.394 328.298,524.479 330.606,482.848 332.914,278.899 335.221,592.707 337.529,556.799 339.837,432.908 342.145,479.482 344.453,410.401 346.761,564.616 349.069,439.269 351.377,550.611 353.685,669.234 355.993,723.584 358.301,438.065 360.608,459.049 362.916,537.617 365.224,399.144 367.532,483.808 369.84,503.215 372.148,379.198 374.456,570.454 376.764,502.137 379.072,604.212 381.38,501.93 383.688,479.241 385.996,395.238 388.303,462.628 390.611,357.933 392.919,383.698 395.227,334.383 397.535,531.508 399.843,453.282 402.151,577.188 404.459,382.996 406.767,330.981 409.075,444.728 411.383,532.142 413.69,376.103 415.998,416.321 418.306,398.048 420.614,487.285 422.922,406.941 425.23,494.76 427.538,408.665 429.846,415.478 432.154,556.979 434.462,276.799 436.77,430.636 439.077,352.177 441.385,430.31 443.693,405.286 446.001,541.95 448.309,455.368 450.617,593.408 452.925,373.3 455.233,431.368 457.541,388.726 459.849,423.217 462.157,409.604 464.465,277.846 466.772,427.377 469.08,410.045 471.388,485.994 473.696,561.436 476.004,371.189 478.312,568.99 480.62,331.765 482.928,462.842 485.236,467.518 487.544,513.481 489.852,516.707 492.159,164.504 494.467,524.273 496.775,410.028 499.083,419.983 501.391,440.238 503.699,433.854 506.007,600.435 508.315,436.387 510.623,342.808 512.931,287.644 515.239,378.372 517.546,485.217 519.854,488.248 522.162,528.237 524.47,467.97 526.778,386.451 529.086,408.159 531.394,417.764 533.702,642.411 536.01,445.824 538.318,404.723 540.626,427.893 542.933,309.912 545.241,496.008 547.549,375.39 549.857,525.545 552.165,518.12 554.473,609.151 556.781,359.69 559.089,426.324 561.397,421.339 563.705,442.366 566.013,428.778 568.321,545.484 570.628,383.82 572.936,423.952 575.244,331.117 577.552,437.971 579.86,526.169 582.168,452.461 584.476,386.37 586.784,520.635 589.092,409.55 591.4,456.185 593.708,313.762 596.015,531.78 598.323,450.246 600.631,445.058 602.939,670.154 605.247,393.561 607.555,415.81 609.863,300.441 612.171,376.929 614.479,395.694 616.787,581.237 619.095,388.017 621.402,392.935 623.71,462.715 626.018,505.284 628.326,465.42 630.634,387.116 632.942,501.876 635.25,420.163 637.558,319.529 639.866,439.974 642.174,434.383 644.482,456.382 646.79,302.229 649.097,637.697 651.405,536.004 653.713,559.45 656.021,255.846 658.329,376.122 660.637,420.665 662.945,519.64 665.253,458.62 667.561,478.399 669.869,518.486 672.177,468.398 674.484,366.16 676.792,363.795 679.1,459.445 681.408,474.981 683.716,508.35 686.024,498.348 688.332,453.124 690.64,737.496 692.948,419.29 695.256,570.547 697.564,505.65 699.871,369.239 702.179,563.745 704.487,407.357 706.795,266.902 709.103,399.789 711.411,493.966 713.719,515.956 716.027,621.318 718.335,295.447 720.643,324.222 722.951,448.374 725.259,413.232 727.566,410.636 729.874,363.775 732.182,482.842 734.49,400.937 736.798,413.909 739.106,394.004 741.414,365.037 743.722,376.945 746.03,289.695 748.338,456.21 750.646,516.962 752.953,519.326 755.261,399.422 757.569,397.36 759.877,409.19 762.185,380.903 764.493,318.347 766.801,425.628 769.109,287.616 771.417,409.533 773.725,312.364 776.033,665.541 778.34,414.161 780.648,274.13 782.956,558.728 785.264,411.905 787.572,521.493 789.88,377.241 792.188,387.229 794.496,377.013 796.804,450.549 799.112,507.206 801.42,307.906 803.728,489.668 806.035,465.055 808.343,602.824 810.651,441.426 812.959,399.639 815.267,186.633 817.575,549.647 819.883,379.512 822.191,344.772 824.499,411.059 826.807,389.128 829.115,574.556 831.422,498.314 833.73,485.797 836.038,420.593 838.346,370.993 840.654,435.561 842.962,173.498 845.27,343.453 847.578,478.471 849.886,363.801 852.194,506.653 854.502,409.104 856.809,331.151 859.117,528.738 861.425,448.992 863.733,582.398 866.041,577.026 868.349,395.833 870.657,217.505 872.965,519.33 875.273,544.713 877.581,454.73 879.889,538.036 882.197,503.474 884.504,537.391 886.812,486.613 889.12,410.833 891.428,320.279 893.736,382.986 896.044,481.188 898.352,422.819 900.66,330.132 902.968,357.73 905.276,393.512 907.584,504.626 909.891,425.028 912.199,371.788 914.507,346.249 916.815,443.616 919.123,433.384 921.431,482.601 923.739,359.231 926.047,397.518 928.355,436.335 930.663,545.284 932.971,432.275 935.278,366.053 937.586,256.442 939.894,528.898 942.202,386.421 944.51,542.579 946.818,409.241 949.126,425.605 951.434,337.875 953.742,421.67 956.05,345.621 958.358,340.716 960.665,625.442 962.973,500.764 965.281,504.844 967.589,443.08 969.897,368.485 972.205,411.437 974.513,356.529 976.821,526.666 979.129,371.345 981.437,434.261 983.745,626.431 986.053,592.387 988.36,534.237 990.668,393.306 992.976,339.374 995.284,312.091 997.592,292.337 999.9,556.888 1002.21,427.291 1004.52,348.241 1006.82,432.881 1009.13,585.879 1011.44,378.172 1013.75,396.034 1016.06,379.728 1018.36,542.828 1020.67,433.673 1022.98,411.423 1025.29,370.804 1027.59,428.019 1029.9,511.93 1032.21,439.757 1034.52,313.199 1036.83,317.094 1039.13,224.008 1041.44,434.84 1043.75,421.412 1046.06,351.562 1048.37,452.302 1050.67,416.192 1052.98,384.879 1055.29,372.03 1057.6,259.943 1059.91,442.422 1062.21,529.177 1064.52,344.475 1066.83,239.44 1069.14,409.987 1071.45,509.015 1073.75,354.724 1076.06,517.074 1078.37,527.156 1080.68,489.253 1082.98,459.091 1085.29,403.975 1087.6,152.3 1089.91,566.079 1092.22,535.103 1094.52,415.123 1096.83,208.166 1099.14,468.077 1101.45,283.169 1103.76,385.304 1106.06,481.489 1108.37,471.873 1110.68,546.024 1112.99,386.219 1115.3,508.108 1117.6,481.26 1119.91,534.768 1122.22,404.049 1124.53,480.137 1126.84,409.227 1129.14,477.622 1131.45,343.842 1133.76,570.059 1136.07,308.638 1138.37,420.502 1140.68,596.468 1142.99,473.066 1145.3,321.36 1147.61,190.054 1149.91,456.903 1152.22,427.968 1154.53,298.431 1156.84,394.406 1159.15,484.248 1161.45,618.341 1163.76,475.81 1166.07,343.986 1168.38,274.802 1170.69,449.83 1172.99,200.363 1175.3,233.757 1177.61,369.794 1179.92,301.059 1182.23,583.682 1184.53,493.537 1186.84,488.384 1189.15,391.648 1191.46,604.434 1193.76,508.277 1196.07,532.705 1198.38,430.671 1200.69,396.684 1203,475.548 1205.3,549.414 1207.61,464.942 1209.92,366.683 1212.23,552.168 1214.54,392.014 1216.84,489.322 1219.15,397.854 1221.46,581.933 1223.77,432.584 1226.08,446.506 1228.38,482.624 1230.69,552.137 1233,452.32 1235.31,374.122 1237.61,422.27 1239.92,621.471 1242.23,360.48 1244.54,415.039 1246.85,490.003 1249.15,449.065 1251.46,462.731 1253.77,684.262 1256.08,356.106 1258.39,530.754 1260.69,433.421 1263,371.584 1265.31,458.159 1267.62,235.681 1269.93,481.551 1272.23,397.346 1274.54,391.084 1276.85,458.373 1279.16,360.701 1281.47,333.979 1283.77,406.777 1286.08,341.82 1288.39,381.924 1290.7,414.71 1293,432.312 1295.31,564.487 1297.62,384.378 1299.93,402.272 1302.24,518.179 1304.54,348.235 1306.85,391.03 1309.16,559.239 1311.47,525.066 1313.78,424.133 1316.08,384.868 1318.39,492.101 1320.7,539 1323.01,435.488 1325.32,479.304 1327.62,407.4 1329.93,376.658 1332.24,527.673 1334.55,485.909 1336.86,311.881 1339.16,301.786 1341.47,412.969 1343.78,576.508 1346.09,398.745 1348.39,349.608 1350.7,448.924 1353.01,436.929 1355.32,535.087 1357.63,476.489 1359.93,471.537 1362.24,416.604 1364.55,707.747 1366.86,321.895 1369.17,591.954 1371.47,505.961 1373.78,196.939 1376.09,317.102 1378.4,369.946 1380.71,409.826 1383.01,600.746 1385.32,538.519 1387.63,427.7 1389.94,221.346 1392.24,399.47 1394.55,518.152 1396.86,330.997 1399.17,448.661 1401.48,340.428 1403.78,383.666 1406.09,488.728 1408.4,527.146 1410.71,199.782 1413.02,508.176 1415.32,557.156 1417.63,539.599 1419.94,347.37 1422.25,402.083 1424.56,459.417 1426.86,522.777 1429.17,502.916 1431.48,508.063 1433.79,427.068 1436.1,383.729 1438.4,569.561 1440.71,477.101 1443.02,399.162 1445.33,593.959 1447.63,611.687 1449.94,298.995 1452.25,449.033 1454.56,423.567 1456.87,332.893 1459.17,572.616 1461.48,276.787 1463.79,461.626 1466.1,532.085 1468.41,509.931 1470.71,550.432 1473.02,408.75 1475.33,433.913 1477.64,317.824 1479.95,402.452 1482.25,475.51 1484.56,528.016 1486.87,317.465 1489.18,404.275 1491.49,534.638 1493.79,369.249 1496.1,345.81 1498.41,304.453 1500.72,510.272 1503.02,289.225 1505.33,415.778 1507.64,483.993 1509.95,453.646 1512.26,269.298 1514.56,629.077 1516.87,636.608 1519.18,230.116 1521.49,316.847 1523.8,376.161 1526.1,564.243 1528.41,384.956 1530.72,257.762 1533.03,608.563 1535.34,552.284 1537.64,318.707 1539.95,493.322 1542.26,430.273 1544.57,254.332 1546.88,585.128 1549.18,584.886 1551.49,545.365 1553.8,292.503 1556.11,356.746 1558.41,422.035 1560.72,505.242 1563.03,487.058 1565.34,388.335 1567.65,536.227 1569.95,288.882 1572.26,461.26 1574.57,448.302 1576.88,224.901 1579.19,246.275 1581.49,263.923 1583.8,479.189 1586.11,467.794 1588.42,501.085 1590.73,272.435 1593.03,465.613 1595.34,408.974 1597.65,563.303 1599.96,457.373 1602.26,533.414 1604.57,490.849 1606.88,472.896 1609.19,266.208 1611.5,432.186 1613.8,625.901 1616.11,443.767 1618.42,502.057 1620.73,512.647 1623.04,503.897 1625.34,490.654 1627.65,381.829 1629.96,509.328 1632.27,459.049 1634.58,555.821 1636.88,536.171 1639.19,377.515 1641.5,354.18 1643.81,444.036 1646.12,198.114 1648.42,530.71 1650.73,355.105 1653.04,470.461 1655.35,612.632 1657.65,380.581 1659.96,464.634 1662.27,96.8724 1664.58,540.201 1666.89,434.831 1669.19,428.467 1671.5,552.737 1673.81,277.439 1676.12,375.924 1678.43,407.455 1680.73,383.859 1683.04,359.897 1685.35,485.418 1687.66,583.779 1689.97,273.792 1692.27,229.626 1694.58,288.737 1696.89,507.225 1699.2,436.921 1701.51,604.757 1703.81,366.606 1706.12,377.292 1708.43,605.404 1710.74,497.21 1713.04,346.074 1715.35,570.376 1717.66,566.341 1719.97,363.21 1722.28,416.934 1724.58,427.226 1726.89,545.18 1729.2,389.533 1731.51,588.838 1733.82,558.82 1736.12,476.687 1738.43,493.573 1740.74,440.138 1743.05,487.962 1745.36,494.799 1747.66,289.309 1749.97,451.977 1752.28,342.982 1754.59,355.998 1756.9,344.993 1759.2,625.26 1761.51,287.532 1763.82,431.757 1766.13,513.89 1768.43,489.368 1770.74,466.976 1773.05,448.166 1775.36,326.454 1777.67,518.932 1779.97,502.8 1782.28,538.755 1784.59,403.882 1786.9,367.994 1789.21,377.743 1791.51,396.606 1793.82,518.19 1796.13,358.598 1798.44,544.144 1800.75,371.395 1803.05,301.076 1805.36,607.261 1807.67,564.872 1809.98,396.915 1812.28,542.537 1814.59,439.88 1816.9,582.116 1819.21,494.279 1821.52,427.022 1823.82,644.29 1826.13,451.729 1828.44,325.464 1830.75,514.985 1833.06,389.767 1835.36,452.485 1837.67,502.647 1839.98,470.896 1842.29,526.638 1844.6,372.243 1846.9,606.93 1849.21,377.029 1851.52,479.949 1853.83,455.351 1856.14,318.666 1858.44,465.772 1860.75,447.465 1863.06,569.852 1865.37,379.696 1867.67,381.694 1869.98,481.727 1872.29,451.713 1874.6,509.617 1876.91,566.743 1879.21,530.815 1881.52,329.41 1883.83,408.114 1886.14,650.761 1888.45,465.91 1890.75,247.188 1893.06,461.287 1895.37,505.325 1897.68,445.552 1899.99,460.042 1902.29,414.651 1904.6,586.102 1906.91,278.592 1909.22,495.2 1911.53,519.009 1913.83,376.211 1916.14,478.101 1918.45,411.548 1920.76,391.22 1923.06,518.485 1925.37,568.435 1927.68,315.797 1929.99,315.194 1932.3,537.549 1934.6,489.14 1936.91,411.44 1939.22,362.753 1941.53,488.235 1943.84,280.528 1946.14,527.548 1948.45,406.871 1950.76,522.268 1953.07,337.735 1955.38,679.822 1957.68,404.247 1959.99,400.322 1962.3,456.683 1964.61,361.578 1966.91,302.1 1969.22,314.691 1971.53,490.662 1973.84,537.238 1976.15,391.397 1978.45,416.119 1980.76,429.221 1983.07,277.469 1985.38,500.804 1987.69,371.189 1989.99,358.207 1992.3,458.709 1994.61,373.876 1996.92,396.425 1999.23,576.911 2001.53,569.701 2003.84,319.339 2006.15,370.525 2008.46,416.248 2010.77,306.546 2013.07,635.415 2015.38,374.293 2017.69,537.759 2020,547.178 2022.3,472.92 2024.61,502.772 2026.92,258.877 2029.23,437 2031.54,501.909 2033.84,520.778 2036.15,420.552 2038.46,633.898 2040.77,328.069 2043.08,387.699 2045.38,509.915 2047.69,450.732 2050,489.235 2052.31,483.283 2054.62,531.934 2056.92,416.541 2059.23,225.192 2061.54,552.677 2063.85,414.972 2066.16,283.266 2068.46,499.67 2070.77,412.824 2073.08,482.099 2075.39,473.899 2077.69,445.038 2080,457.152 2082.31,329.048 2084.62,391.295 2086.93,308.911 2089.23,502.963 2091.54,454.248 2093.85,635.722 2096.16,333.376 2098.47,597.624 2100.77,409.692 2103.08,436.2 2105.39,389.898 2107.7,586.675 2110.01,409.087 2112.31,474.294 2114.62,484.268 2116.93,407.665 2119.24,261.555 2121.55,561.061 2123.85,529.649 2126.16,507.087 2128.47,440.812 2130.78,453.181 2133.08,563.04 2135.39,391.369 2137.7,431.694 2140.01,342.926 2142.32,411.191 2144.62,503.21 2146.93,538.851 2149.24,463.927 2151.55,546.307 2153.86,354.534 2156.16,514.705 2158.47,396.78 2160.78,364.277 2163.09,351.147 2165.4,188.508 2167.7,393.085 2170.01,484.376 2172.32,403.989 2174.63,491.688 2176.93,598.181 2179.24,474.97 2181.55,340.865 2183.86,468.488 2186.17,448.327 2188.47,563.959 2190.78,465.042 2193.09,310.729 2195.4,430.761 2197.71,285.614 2200.01,611.57 2202.32,355.066 2204.63,588.136 2206.94,417.749 2209.25,495.448 2211.55,344.009 2213.86,486.952 2216.17,468.3 2218.48,484.691 2220.79,335.868 2223.09,617.569 2225.4,374.466 2227.71,607.576 2230.02,358.824 2232.32,499.247 2234.63,363.901 2236.94,484.514 2239.25,409.828 2241.56,511.839 2243.86,370.544 2246.17,525.988 2248.48,441.361 2250.79,455.892 2253.1,565.265 2255.4,472.543 2257.71,502.838 2260.02,390.342 2262.33,391.19 2264.64,285.829 2266.94,443.172 2269.25,527.19 2271.56,561.666 2273.87,585.669 2276.18,415.606 2278.48,656.651 2280.79,473.649 2283.1,469.594 2285.41,437.105 2287.71,490.11 2290.02,525.622 2292.33,450.863 2294.64,547.985 2296.95,362.975 2299.25,454.761 2301.56,492.565 2303.87,551.793 2306.18,491.204 2308.49,635.816 2310.79,521.063 2313.1,309.044 2315.41,367.915 2317.72,352.973 2320.03,381.334 2322.33,510.026 2324.64,394.263 2326.95,415.13 2329.26,325.872 2331.56,447.396 2333.87,530.458 2336.18,295.688 2338.49,486.06 2340.8,391.648 2343.1,464.988 2345.41,504.246 2347.72,428.043 2350.03,213.957 2352.34,384.956 2354.64,469.157 2356.95,452.343 2359.26,265.417 2361.57,337.989 2363.88,327.806 2366.18,422.901 2368.49,591.25 2370.8,327.123 2373.11,459.289 2375.42,465.736 2377.72,615.401 2380.03,457.076 2382.34,457.823 2384.65,494.459 2386.95,518.893 2389.26,455.392 2391.57,367.683 2393.88,180.65 2396.19,476.016 2398.49,534.014 2400.8,490.936 2403.11,734.641 2405.42,384.499 2407.73,552.383 2410.03,425.126 2412.34,509.352 2414.65,437.991 2416.96,397.42 2419.27,440.21 2421.57,472.546 2423.88,368.023 2426.19,451.999 2428.5,460.265 2430.81,423.762 2433.11,546.198 2435.42,483.706 2437.73,334.845 2440.04,509.983 2442.34,470.186 2444.65,279.616 2446.96,587.532 2449.27,435.026 2451.58,473.78 2453.88,425.963 2456.19,503.92 2458.5,532.959 2460.81,587.446 2463.12,547.044 2465.42,379.63 2467.73,311.304 2470.04,427.681 2472.35,527.874 2474.66,402.834 2476.96,399.994 2479.27,525.905 2481.58,436.897 2483.89,501.207 2486.2,549.092 2488.5,439.432 2490.81,471.516 2493.12,546.062 2495.43,288.35 2497.73,416.789 2500.04,578.629 2502.35,366.918 2504.66,474.539 2506.97,343.542 2509.27,408.01 2511.58,422.865 2513.89,477.881 2516.2,470.071 2518.51,451.67 2520.81,475.32 2523.12,281.265 2525.43,309.197 2527.74,424.971 2530.05,360.4 2532.35,457.154 2534.66,398.373 2536.97,417.811 2539.28,335.031 2541.58,402.226 2543.89,647.261 2546.2,512.948 2548.51,399.698 2550.82,534.11 2553.12,277.379 2555.43,635.079 2557.74,484.209 2560.05,662.481 2562.36,338.768 2564.66,384.007 2566.97,214 2569.28,470.06 2571.59,389.184 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -3.25202  -4.53385  -4.40957   -2.96381   …  -4.18344   -4.7179   -4.33972
 -1.20609  -2.08421   0.158481   0.229873      0.809679  -1.53091  -0.466109
  1.52271   3.66157   5.45314    5.10176       6.18366    5.81031   5.37885

[:, :, 2] =
 -3.15347  -2.78581  -3.01879  -4.25715   …  -7.00176   -7.00176   -7.00176
  1.00222   1.45352   1.87214   0.271943      0.274616   0.274616   0.274616
  3.34588   3.51456   3.88343   3.34183       4.81662    4.81662    4.81662

[:, :, 3] =
 0.117529  -1.954     -4.64448   …  -4.77944   -4.77944   -4.83755
 0.269478  -0.357296  -0.889554      0.297536   0.297536  -0.450137
 1.40902    3.68903    3.82061       3.89733    3.89733    4.43074

[:, :, 4] =
 -3.17676  -3.06953   -4.76406   -4.27912  …  -5.18966   -4.09837  -6.26615
  0.1164   -0.740388  -0.702985  -1.20836      0.310844  -1.35603   0.286942
  1.4419    4.11416    4.54681    4.00081      8.2376     7.24634   5.47475</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.97709    1.0058
 -0.0158817  0.997066
  4.98958    1.01035</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.9 seconds
Compute duration  = 2.9 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -5.0126    1.0001    0.0190   2764.7925   4835.4328    1.0007   ⋯
        x[2]   -0.0405    1.0056    0.0173   3379.4746   5394.1133    1.0005   ⋯
        x[3]    5.0162    1.0031    0.0168   3552.8426   5692.9045    1.0002   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -6.9517   -5.6882   -5.0076   -4.3279   -3.0681
        x[2]   -2.0019   -0.7249   -0.0421    0.6332    1.9501
        x[3]    3.0545    4.3536    5.0197    5.6876    6.9478</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.9 seconds
Compute duration  = 1.9 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.4959    0.1887    0.0028   4372.4447   5725.7308    1.0000   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1453    0.3538    0.4949    0.6374    0.8507</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.14 seconds
Compute duration  = 0.14 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

           x    0.4282    0.1938    0.0306    35.0800    20.8716    1.1275     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.2031    0.2151    0.4476    0.5765    0.7479</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(-2.6632214070238294, "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with -2.6632214070238294:
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/j0ZcJ/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/j0ZcJ/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/j0ZcJ/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/j0ZcJ/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/j0ZcJ/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/cvlfK/src/compiler.jl:584 [inlined]
  [7] demo
    @ ~/work/docs/docs/developers/inference/implementing-samplers/index.qmd:457 [inlined]
  [8] _evaluate!!
    @ ~/.julia/packages/DynamicPPL/cvlfK/src/model.jl:914 [inlined]
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, context::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/cvlfK/src/model.jl:903
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/cvlfK/src/model.jl:833 [inlined]
 [11] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/cvlfK/src/values_as_in_model.jl:196 [inlined]
 [12] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/cvlfK/src/values_as_in_model.jl:195 [inlined]
 [13] getparams(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64})
    @ Turing.Inference ~/.julia/packages/Turing/NQDYt/src/mcmc/Inference.jl:381
 [14] Turing.Inference.Transition(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, t::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/NQDYt/src/mcmc/Inference.jl:256
 [15] transition_to_turing
    @ ~/.julia/packages/Turing/NQDYt/src/mcmc/abstractmcmc.jl:12 [inlined]
 [16] transition_to_turing(f::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, transition::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/NQDYt/src/mcmc/abstractmcmc.jl:17
 [17] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}; initial_state::Nothing, initial_params::Nothing, kwargs::@Kwargs{})
    @ Turing.Inference ~/.julia/packages/Turing/NQDYt/src/mcmc/abstractmcmc.jl:147
 [18] macro expansion
    @ ~/.julia/packages/AbstractMCMC/FSyVk/src/sample.jl:0 [inlined]
 [19] macro expansion
    @ ~/.julia/packages/AbstractMCMC/FSyVk/src/logging.jl:16 [inlined]
 [20] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, num_warmup::Int64, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/FSyVk/src/sample.jl:142
 [21] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/cvlfK/src/sampler.jl:107
 [22] sample
    @ ~/.julia/packages/DynamicPPL/cvlfK/src/sampler.jl:97 [inlined]
 [23] #sample#4
    @ ~/.julia/packages/Turing/NQDYt/src/mcmc/Inference.jl:303 [inlined]
 [24] sample
    @ ~/.julia/packages/Turing/NQDYt/src/mcmc/Inference.jl:294 [inlined]
 [25] #sample#3
    @ ~/.julia/packages/Turing/NQDYt/src/mcmc/Inference.jl:291 [inlined]
 [26] top-level scope
    @ ~/work/docs/docs/developers/inference/implementing-samplers/index.qmd:459</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.98 seconds
Compute duration  = 1.98 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8657    0.5804    0.0301   176.9726    43.6284    1.0085     ⋯
           x    0.0345    1.0979    0.0744   343.8164   133.2387    1.0006     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1028    0.4010    0.7471    1.2031    2.2648
           x   -2.2056   -0.4373    0.0431    0.4095    3.1265</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 3.78 seconds
Compute duration  = 3.78 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8356    0.6019    0.0361   233.8278   117.2637    1.0005     ⋯
           x   -0.0522    0.9915    0.0626   393.2629   192.7309    1.0002     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1039    0.3656    0.7030    1.1659    2.4054
           x   -2.2569   -0.3943    0.0007    0.3570    1.9141</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/docs\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../../developers/inference/variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/developers/inference/implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>