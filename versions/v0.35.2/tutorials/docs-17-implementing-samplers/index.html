<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.1">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../tutorials/docs-07-for-developers-variational-inference/index.html" rel="prev">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2bb0ec5e928ee8c40b12725cb7836c35.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-31d8df3fb4b3ebd213a509f950828e75.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-5a965d03c83b9a52a3a52c83f34fadca.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-03f81fcb35c69179f531195cac5ac726.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/docs-00-getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/00-introduction/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.35" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.35</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.35">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Users</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-00-getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-12-using-turing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Core Functionality</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Usage Tips</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-10-using-turing-autodiff/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-custom-distribution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Custom Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-probability-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Querying Model Probabilities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-modifying-logprob/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modifying the Log Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-generated-quantities/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generated Quantities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-13-using-turing-performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-15-using-turing-sampler-viz/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-11-using-turing-dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-16-using-turing-external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/00-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction: Coin Flipping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/01-gaussian-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/02-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/03-bayesian-neural-network/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/04-hidden-markov-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/05-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/06-infinite-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/07-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/08-multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/09-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/10-bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/11-probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/13-seasonal-time-series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/15-gaussian-processes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Gaussian Processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/12-gplvm/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Contributing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-01-contributing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to Contribute</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">DynamicPPL in Depth</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/dev-model-manual/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manually Defining a Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-05-for-developers-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/14-minituring/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/16-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Inference (note: outdated)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-06-for-developers-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-33.18884168753046</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-33.18884168753046</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([0.0, 0.0, 0.0]), MALAState{Vector{Float64}}([0.0, 0.0, 0.0]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -1.66606   -2.61372   -3.94747   -3.04187   …  -5.65528  -5.08611  -5.08611
  0.035503   0.227723   0.630457  -0.651959      1.23774   1.49409   1.49409
  1.69814    3.88761    4.06985    5.34273       4.20011   6.49658   6.49658</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -5.00974    0.997088
 -0.0152021  0.982081
  4.99669    1.00228</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip340">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip340)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip341">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip340)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip342">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1647.66 2640.76,1647.66 "></polyline>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1409.92 2640.76,1409.92 "></polyline>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1172.18 2640.76,1172.18 "></polyline>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,934.435 2640.76,934.435 "></polyline>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,696.694 2640.76,696.694 "></polyline>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,458.953 2640.76,458.953 "></polyline>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,221.211 2640.76,221.211 "></polyline>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip340)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1647.66 215.714,1647.66 "></polyline>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1409.92 215.714,1409.92 "></polyline>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1172.18 215.714,1172.18 "></polyline>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,934.435 215.714,934.435 "></polyline>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,696.694 215.714,696.694 "></polyline>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,458.953 215.714,458.953 "></polyline>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,221.211 215.714,221.211 "></polyline>
<path clip-path="url(#clip340)" d="M50.5475 1648.11 L80.2233 1648.11 L80.2233 1652.04 L50.5475 1652.04 L50.5475 1648.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M89.1352 1630.38 L111.357 1630.38 L111.357 1632.37 L98.8111 1664.94 L93.9269 1664.94 L105.732 1634.31 L89.1352 1634.31 L89.1352 1630.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M120.478 1659.06 L125.362 1659.06 L125.362 1664.94 L120.478 1664.94 L120.478 1659.06 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M135.593 1630.38 L153.95 1630.38 L153.95 1634.31 L139.876 1634.31 L139.876 1642.79 Q140.894 1642.44 141.913 1642.28 Q142.931 1642.09 143.95 1642.09 Q149.737 1642.09 153.116 1645.26 Q156.496 1648.43 156.496 1653.85 Q156.496 1659.43 153.024 1662.53 Q149.552 1665.61 143.232 1665.61 Q141.056 1665.61 138.788 1665.24 Q136.542 1664.87 134.135 1664.13 L134.135 1659.43 Q136.218 1660.56 138.441 1661.12 Q140.663 1661.67 143.14 1661.67 Q147.144 1661.67 149.482 1659.57 Q151.82 1657.46 151.82 1653.85 Q151.82 1650.24 149.482 1648.13 Q147.144 1646.03 143.14 1646.03 Q141.265 1646.03 139.39 1646.44 Q137.538 1646.86 135.593 1647.74 L135.593 1630.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M49.5521 1410.37 L79.2279 1410.37 L79.2279 1414.3 L49.5521 1414.3 L49.5521 1410.37 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M89.3667 1392.64 L107.723 1392.64 L107.723 1396.57 L93.6491 1396.57 L93.6491 1405.04 Q94.6676 1404.7 95.6861 1404.53 Q96.7047 1404.35 97.7232 1404.35 Q103.51 1404.35 106.89 1407.52 Q110.269 1410.69 110.269 1416.11 Q110.269 1421.69 106.797 1424.79 Q103.325 1427.87 97.0056 1427.87 Q94.8297 1427.87 92.5612 1427.5 Q90.3158 1427.13 87.9084 1426.39 L87.9084 1421.69 Q89.9917 1422.82 92.2139 1423.38 Q94.4361 1423.93 96.913 1423.93 Q100.918 1423.93 103.256 1421.83 Q105.593 1419.72 105.593 1416.11 Q105.593 1412.5 103.256 1410.39 Q100.918 1408.28 96.913 1408.28 Q95.038 1408.28 93.163 1408.7 Q91.3112 1409.12 89.3667 1410 L89.3667 1392.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M119.482 1421.32 L124.367 1421.32 L124.367 1427.2 L119.482 1427.2 L119.482 1421.32 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M144.552 1395.72 Q140.941 1395.72 139.112 1399.28 Q137.306 1402.82 137.306 1409.95 Q137.306 1417.06 139.112 1420.62 Q140.941 1424.16 144.552 1424.16 Q148.186 1424.16 149.991 1420.62 Q151.82 1417.06 151.82 1409.95 Q151.82 1402.82 149.991 1399.28 Q148.186 1395.72 144.552 1395.72 M144.552 1392.01 Q150.362 1392.01 153.417 1396.62 Q156.496 1401.2 156.496 1409.95 Q156.496 1418.68 153.417 1423.28 Q150.362 1427.87 144.552 1427.87 Q138.741 1427.87 135.663 1423.28 Q132.607 1418.68 132.607 1409.95 Q132.607 1401.2 135.663 1396.62 Q138.741 1392.01 144.552 1392.01 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M50.5475 1172.63 L80.2233 1172.63 L80.2233 1176.56 L50.5475 1176.56 L50.5475 1172.63 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M94.3436 1185.52 L110.663 1185.52 L110.663 1189.46 L88.7186 1189.46 L88.7186 1185.52 Q91.3806 1182.77 95.9639 1178.14 Q100.57 1173.48 101.751 1172.14 Q103.996 1169.62 104.876 1167.88 Q105.779 1166.12 105.779 1164.43 Q105.779 1161.68 103.834 1159.94 Q101.913 1158.21 98.8111 1158.21 Q96.6121 1158.21 94.1584 1158.97 Q91.7278 1159.73 88.9501 1161.28 L88.9501 1156.56 Q91.7741 1155.43 94.2278 1154.85 Q96.6815 1154.27 98.7185 1154.27 Q104.089 1154.27 107.283 1156.96 Q110.478 1159.64 110.478 1164.13 Q110.478 1166.26 109.668 1168.18 Q108.881 1170.08 106.774 1172.67 Q106.195 1173.34 103.094 1176.56 Q99.9917 1179.76 94.3436 1185.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M120.478 1183.58 L125.362 1183.58 L125.362 1189.46 L120.478 1189.46 L120.478 1183.58 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M135.593 1154.9 L153.95 1154.9 L153.95 1158.83 L139.876 1158.83 L139.876 1167.3 Q140.894 1166.96 141.913 1166.79 Q142.931 1166.61 143.95 1166.61 Q149.737 1166.61 153.116 1169.78 Q156.496 1172.95 156.496 1178.37 Q156.496 1183.95 153.024 1187.05 Q149.552 1190.13 143.232 1190.13 Q141.056 1190.13 138.788 1189.76 Q136.542 1189.39 134.135 1188.65 L134.135 1183.95 Q136.218 1185.08 138.441 1185.64 Q140.663 1186.19 143.14 1186.19 Q147.144 1186.19 149.482 1184.09 Q151.82 1181.98 151.82 1178.37 Q151.82 1174.76 149.482 1172.65 Q147.144 1170.54 143.14 1170.54 Q141.265 1170.54 139.39 1170.96 Q137.538 1171.38 135.593 1172.26 L135.593 1154.9 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M99.3204 920.233 Q95.7093 920.233 93.8806 923.798 Q92.075 927.34 92.075 934.469 Q92.075 941.576 93.8806 945.141 Q95.7093 948.682 99.3204 948.682 Q102.955 948.682 104.76 945.141 Q106.589 941.576 106.589 934.469 Q106.589 927.34 104.76 923.798 Q102.955 920.233 99.3204 920.233 M99.3204 916.53 Q105.131 916.53 108.186 921.136 Q111.265 925.719 111.265 934.469 Q111.265 943.196 108.186 947.803 Q105.131 952.386 99.3204 952.386 Q93.5102 952.386 90.4315 947.803 Q87.376 943.196 87.376 934.469 Q87.376 925.719 90.4315 921.136 Q93.5102 916.53 99.3204 916.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M119.482 945.835 L124.367 945.835 L124.367 951.715 L119.482 951.715 L119.482 945.835 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M144.552 920.233 Q140.941 920.233 139.112 923.798 Q137.306 927.34 137.306 934.469 Q137.306 941.576 139.112 945.141 Q140.941 948.682 144.552 948.682 Q148.186 948.682 149.991 945.141 Q151.82 941.576 151.82 934.469 Q151.82 927.34 149.991 923.798 Q148.186 920.233 144.552 920.233 M144.552 916.53 Q150.362 916.53 153.417 921.136 Q156.496 925.719 156.496 934.469 Q156.496 943.196 153.417 947.803 Q150.362 952.386 144.552 952.386 Q138.741 952.386 135.663 947.803 Q132.607 943.196 132.607 934.469 Q132.607 925.719 135.663 921.136 Q138.741 916.53 144.552 916.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M94.3436 710.038 L110.663 710.038 L110.663 713.974 L88.7186 713.974 L88.7186 710.038 Q91.3806 707.284 95.9639 702.654 Q100.57 698.001 101.751 696.659 Q103.996 694.136 104.876 692.4 Q105.779 690.64 105.779 688.951 Q105.779 686.196 103.834 684.46 Q101.913 682.724 98.8111 682.724 Q96.6121 682.724 94.1584 683.488 Q91.7278 684.252 88.9501 685.802 L88.9501 681.08 Q91.7741 679.946 94.2278 679.367 Q96.6815 678.789 98.7185 678.789 Q104.089 678.789 107.283 681.474 Q110.478 684.159 110.478 688.65 Q110.478 690.779 109.668 692.701 Q108.881 694.599 106.774 697.191 Q106.195 697.863 103.094 701.08 Q99.9917 704.275 94.3436 710.038 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M120.478 708.094 L125.362 708.094 L125.362 713.974 L120.478 713.974 L120.478 708.094 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M135.593 679.414 L153.95 679.414 L153.95 683.349 L139.876 683.349 L139.876 691.821 Q140.894 691.474 141.913 691.312 Q142.931 691.126 143.95 691.126 Q149.737 691.126 153.116 694.298 Q156.496 697.469 156.496 702.886 Q156.496 708.464 153.024 711.566 Q149.552 714.645 143.232 714.645 Q141.056 714.645 138.788 714.275 Q136.542 713.904 134.135 713.163 L134.135 708.464 Q136.218 709.599 138.441 710.154 Q140.663 710.71 143.14 710.71 Q147.144 710.71 149.482 708.603 Q151.82 706.497 151.82 702.886 Q151.82 699.275 149.482 697.168 Q147.144 695.062 143.14 695.062 Q141.265 695.062 139.39 695.478 Q137.538 695.895 135.593 696.775 L135.593 679.414 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M89.3667 441.673 L107.723 441.673 L107.723 445.608 L93.6491 445.608 L93.6491 454.08 Q94.6676 453.733 95.6861 453.571 Q96.7047 453.385 97.7232 453.385 Q103.51 453.385 106.89 456.557 Q110.269 459.728 110.269 465.145 Q110.269 470.723 106.797 473.825 Q103.325 476.904 97.0056 476.904 Q94.8297 476.904 92.5612 476.533 Q90.3158 476.163 87.9084 475.422 L87.9084 470.723 Q89.9917 471.858 92.2139 472.413 Q94.4361 472.969 96.913 472.969 Q100.918 472.969 103.256 470.862 Q105.593 468.756 105.593 465.145 Q105.593 461.534 103.256 459.427 Q100.918 457.321 96.913 457.321 Q95.038 457.321 93.163 457.737 Q91.3112 458.154 89.3667 459.034 L89.3667 441.673 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M119.482 470.353 L124.367 470.353 L124.367 476.233 L119.482 476.233 L119.482 470.353 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M144.552 444.751 Q140.941 444.751 139.112 448.316 Q137.306 451.858 137.306 458.987 Q137.306 466.094 139.112 469.658 Q140.941 473.2 144.552 473.2 Q148.186 473.2 149.991 469.658 Q151.82 466.094 151.82 458.987 Q151.82 451.858 149.991 448.316 Q148.186 444.751 144.552 444.751 M144.552 441.048 Q150.362 441.048 153.417 445.654 Q156.496 450.237 156.496 458.987 Q156.496 467.714 153.417 472.32 Q150.362 476.904 144.552 476.904 Q138.741 476.904 135.663 472.32 Q132.607 467.714 132.607 458.987 Q132.607 450.237 135.663 445.654 Q138.741 441.048 144.552 441.048 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M89.1352 203.931 L111.357 203.931 L111.357 205.922 L98.8111 238.491 L93.9269 238.491 L105.732 207.867 L89.1352 207.867 L89.1352 203.931 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M120.478 232.612 L125.362 232.612 L125.362 238.491 L120.478 238.491 L120.478 232.612 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip340)" d="M135.593 203.931 L153.95 203.931 L153.95 207.867 L139.876 207.867 L139.876 216.339 Q140.894 215.992 141.913 215.829 Q142.931 215.644 143.95 215.644 Q149.737 215.644 153.116 218.816 Q156.496 221.987 156.496 227.404 Q156.496 232.982 153.024 236.084 Q149.552 239.163 143.232 239.163 Q141.056 239.163 138.788 238.792 Q136.542 238.422 134.135 237.681 L134.135 232.982 Q136.218 234.116 138.441 234.672 Q140.663 235.228 143.14 235.228 Q147.144 235.228 149.482 233.121 Q151.82 231.015 151.82 227.404 Q151.82 223.792 149.482 221.686 Q147.144 219.579 143.14 219.579 Q141.265 219.579 139.39 219.996 Q137.538 220.413 135.593 221.292 L135.593 203.931 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip342)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1092.87 268.292,1370.98 270.6,1325.71 272.908,1259.01 275.216,1424.28 277.524,1585.63 279.832,1323.99 282.139,1458.18 284.447,1415.16 286.755,1365.2 289.063,1238.73 291.371,1292.98 293.679,1228.3 295.987,1479.95 298.295,1381.95 300.603,1412.6 302.911,1515.73 305.219,1519.95 307.527,1519.67 309.834,1522.44 312.142,1461.76 314.45,1269.96 316.758,1453.23 319.066,1331.75 321.374,1475.57 323.682,1327.43 325.99,1375.68 328.298,1423.48 330.606,1464.24 332.914,1531.73 335.221,1351.13 337.529,1375.66 339.837,1490.14 342.145,1438.22 344.453,1289.53 346.761,1375.86 349.069,1298.1 351.377,1549.43 353.685,1443 355.993,1221.66 358.301,1446.43 360.608,1120.51 362.916,1290.92 365.224,1274.07 367.532,1456.9 369.84,1386.21 372.148,1446.79 374.456,1459.17 376.764,1474.08 379.072,1362.02 381.38,1472.66 383.688,1448.93 385.996,1390.89 388.303,1300.66 390.611,1214.12 392.919,1419.3 395.227,1527.25 397.535,1251.19 399.843,1426.77 402.151,1494.45 404.459,1468.82 406.767,1357.02 409.075,1468.71 411.383,1364.64 413.69,1469.34 415.998,1540.26 418.306,1397.06 420.614,1593.48 422.922,1440.13 425.23,1351.97 427.538,1381.94 429.846,1429.7 432.154,1363.03 434.462,1362.12 436.77,1375.88 439.077,1492.04 441.385,1505.79 443.693,1430.14 446.001,1537.77 448.309,1282.06 450.617,1381.54 452.925,1362.85 455.233,1341.86 457.541,1359.72 459.849,1233.44 462.157,1437.85 464.465,1499.13 466.772,1373.71 469.08,1398.92 471.388,1356.46 473.696,1515.97 476.004,1549.83 478.312,1443.12 480.62,1296.44 482.928,1381.43 485.236,1244.5 487.544,1386.35 489.852,1390.14 492.159,1207.55 494.467,1463.85 496.775,1423.31 499.083,1343.72 501.391,1504.42 503.699,1409.68 506.007,1456.17 508.315,1325.72 510.623,1432.08 512.931,1545.3 515.239,1417.72 517.546,1347.77 519.854,1205.06 522.162,1207.31 524.47,1255.86 526.778,1530.33 529.086,1587.72 531.394,1498.37 533.702,1443.22 536.01,1557.8 538.318,1430.05 540.626,1337.9 542.933,1187.14 545.241,1325.22 547.549,1381.1 549.857,1342.15 552.165,1418.64 554.473,1281.86 556.781,1575.92 559.089,1260.39 561.397,1403.47 563.705,1483.18 566.013,1280.09 568.321,1415.08 570.628,1375 572.936,1272.24 575.244,1393.3 577.552,1355.59 579.86,1523.52 582.168,1414.29 584.476,1427.24 586.784,1230.25 589.092,1405.16 591.4,1400.84 593.708,1401.12 596.015,1529.26 598.323,1386.53 600.631,1482.29 602.939,1544.92 605.247,1208.28 607.555,1471.91 609.863,1520.91 612.171,1380.08 614.479,1342.53 616.787,1542.96 619.095,1385.49 621.402,1290.12 623.71,1373.45 626.018,1349.86 628.326,1419.41 630.634,1307.6 632.942,1385.37 635.25,1333.1 637.558,1336.08 639.866,1373.14 642.174,1288.62 644.482,1257.84 646.79,1318.23 649.097,1374.15 651.405,1523.66 653.713,1376.88 656.021,1376.52 658.329,1283.16 660.637,1316.13 662.945,1320.99 665.253,1437.57 667.561,1331.48 669.869,1301.7 672.177,1555.04 674.484,1616.91 676.792,1333.19 679.1,1388.33 681.408,1302.57 683.716,1361.83 686.024,1510.16 688.332,1397.87 690.64,1485.88 692.948,1313.69 695.256,1361.43 697.564,1538.8 699.871,1323.24 702.179,1424.39 704.487,1445.26 706.795,1465.18 709.103,1318.81 711.411,1357.86 713.719,1268.39 716.027,1272.45 718.335,1497 720.643,1435.69 722.951,1517.81 725.259,1410.14 727.566,1364.4 729.874,1320.37 732.182,1366.11 734.49,1406.05 736.798,1319.69 739.106,1531.34 741.414,1539.69 743.722,1505.62 746.03,1340.6 748.338,1441.52 750.646,1484.93 752.953,1350.81 755.261,1374.38 757.569,1372.12 759.877,1444.18 762.185,1365.3 764.493,1532.32 766.801,1415.13 769.109,1301.21 771.417,1449.41 773.725,1521.66 776.033,1393.68 778.34,1419.71 780.648,1283.22 782.956,1409.56 785.264,1387.25 787.572,1435.03 789.88,1295.92 792.188,1564.06 794.496,1395.78 796.804,1533.52 799.112,1450.21 801.42,1345.7 803.728,1452.6 806.035,1440.23 808.343,1497.23 810.651,1352.52 812.959,1288.16 815.267,1337.29 817.575,1708.2 819.883,1332.3 822.191,1222.58 824.499,1426.44 826.807,1357.93 829.115,1280.87 831.422,1321.55 833.73,1461.62 836.038,1454.69 838.346,1515.78 840.654,1636.1 842.962,1342.5 845.27,1372.3 847.578,1345.55 849.886,1347.21 852.194,1478.3 854.502,1419.83 856.809,1533.81 859.117,1398.69 861.425,1395.72 863.733,1339.65 866.041,1433.15 868.349,1390.86 870.657,1327.19 872.965,1410.34 875.273,1279.51 877.581,1387.2 879.889,1542.85 882.197,1352.48 884.504,1398.68 886.812,1489.53 889.12,1481.32 891.428,1368.18 893.736,1173.81 896.044,1312.47 898.352,1332.29 900.66,1494.68 902.968,1358.41 905.276,1511.69 907.584,1399.61 909.891,1325.88 912.199,1240.99 914.507,1434.52 916.815,1428.55 919.123,1508.03 921.431,1315.79 923.739,1420.1 926.047,1409.83 928.355,1444.61 930.663,1535.68 932.971,1407.23 935.278,1496.11 937.586,1372.91 939.894,1479.6 942.202,1349.58 944.51,1444.48 946.818,1263.85 949.126,1375.89 951.434,1419.41 953.742,1192.19 956.05,1468.32 958.358,1349.53 960.665,1344.3 962.973,1583.5 965.281,1485.42 967.589,1598.09 969.897,1307.54 972.205,1344.59 974.513,1391.09 976.821,1367.2 979.129,1302.15 981.437,1336.64 983.745,1544.85 986.053,1512.21 988.36,1438.56 990.668,1395.31 992.976,1451.53 995.284,1478.12 997.592,1453.59 999.9,1222.13 1002.21,1258.5 1004.52,1421.24 1006.82,1376.7 1009.13,1501.05 1011.44,1535.11 1013.75,1366.76 1016.06,1537.83 1018.36,1518.9 1020.67,1432.25 1022.98,1410.39 1025.29,1341.29 1027.59,1570.29 1029.9,1294.76 1032.21,1271.08 1034.52,1476.28 1036.83,1519.56 1039.13,1425.83 1041.44,1349.28 1043.75,1322.74 1046.06,1363.53 1048.37,1409.19 1050.67,1367.79 1052.98,1479.02 1055.29,1419.75 1057.6,1554.58 1059.91,1373.73 1062.21,1421.1 1064.52,1400.13 1066.83,1286.06 1069.14,1274.43 1071.45,1458.76 1073.75,1316.96 1076.06,1483.18 1078.37,1266.01 1080.68,1350.3 1082.98,1516.86 1085.29,1317.06 1087.6,1386.52 1089.91,1751.15 1092.22,1455.25 1094.52,1312.59 1096.83,1333.32 1099.14,1516 1101.45,1386.38 1103.76,1488 1106.06,1450.06 1108.37,1371.54 1110.68,1420.32 1112.99,1503.58 1115.3,1537.18 1117.6,1428.74 1119.91,1354.79 1122.22,1539.96 1124.53,1374.26 1126.84,1430.16 1129.14,1302.46 1131.45,1205.57 1133.76,1537.26 1136.07,1512.09 1138.37,1436.2 1140.68,1508.09 1142.99,1447.73 1145.3,1430.64 1147.61,1339.14 1149.91,1333.13 1152.22,1526.78 1154.53,1253.03 1156.84,1593.27 1159.15,1244.83 1161.45,1484.99 1163.76,1388.59 1166.07,1319.77 1168.38,1245.13 1170.69,1487.43 1172.99,1399.65 1175.3,1436.85 1177.61,1464.31 1179.92,1295.27 1182.23,1306.36 1184.53,1455.02 1186.84,1383.51 1189.15,1433.5 1191.46,1622.71 1193.76,1456.97 1196.07,1676.45 1198.38,1364.42 1200.69,1447.4 1203,1459 1205.3,1425.79 1207.61,1471.68 1209.92,1471.84 1212.23,1360.54 1214.54,1492.08 1216.84,1352.06 1219.15,1534.26 1221.46,1474.6 1223.77,1332.33 1226.08,1171.76 1228.38,1525.13 1230.69,1312.63 1233,1305.76 1235.31,1372.75 1237.61,1640.17 1239.92,1562.87 1242.23,1434.11 1244.54,1533.98 1246.85,1361.82 1249.15,1410.06 1251.46,1575.76 1253.77,1446.69 1256.08,1290.74 1258.39,1555.48 1260.69,1357.72 1263,1456.84 1265.31,1401.84 1267.62,1253.39 1269.93,1418.61 1272.23,1317.68 1274.54,1474.23 1276.85,1331 1279.16,1454.27 1281.47,1432.76 1283.77,1447.9 1286.08,1399.71 1288.39,1481.54 1290.7,1314.91 1293,1266.1 1295.31,1459.47 1297.62,1312.26 1299.93,1378.5 1302.24,1413.57 1304.54,1371.35 1306.85,1283.24 1309.16,1547.38 1311.47,1444.35 1313.78,1425.6 1316.08,1379.37 1318.39,1438.21 1320.7,1382.91 1323.01,1584.32 1325.32,1328.23 1327.62,1394.07 1329.93,1390.96 1332.24,1273.98 1334.55,1398.4 1336.86,1505.83 1339.16,1288.74 1341.47,1507.06 1343.78,1287.62 1346.09,1483.68 1348.39,1441.4 1350.7,1477.09 1353.01,1391.74 1355.32,1437.67 1357.63,1323.77 1359.93,1310.11 1362.24,1599.57 1364.55,1373.11 1366.86,1557.83 1369.17,1390.66 1371.47,1492.35 1373.78,1350.36 1376.09,1397.08 1378.4,1395.14 1380.71,1331.89 1383.01,1573.84 1385.32,1606.84 1387.63,1329.15 1389.94,1309.57 1392.24,1386.99 1394.55,1441.59 1396.86,1371.2 1399.17,1444.67 1401.48,1421.04 1403.78,1417.42 1406.09,1249.1 1408.4,1587.12 1410.71,1355.46 1413.02,1570.84 1415.32,1279.05 1417.63,1513.87 1419.94,1408.75 1422.25,1632.51 1424.56,1503.58 1426.86,1364.53 1429.17,1415.77 1431.48,1382.59 1433.79,1470.12 1436.1,1492.71 1438.4,1412.66 1440.71,1418.69 1443.02,1331.74 1445.33,1417.48 1447.63,1463.61 1449.94,1405.15 1452.25,1327.96 1454.56,1295.35 1456.87,1273.86 1459.17,1437.06 1461.48,1556.05 1463.79,1464.45 1466.1,1311.22 1468.41,1462.13 1470.71,1405.33 1473.02,1480.06 1475.33,1415 1477.64,1383.84 1479.95,1509.69 1482.25,1319.85 1484.56,1443.24 1486.87,1310.24 1489.18,1365.63 1491.49,1410.81 1493.79,1489.76 1496.1,1526.12 1498.41,1591.04 1500.72,1351.22 1503.02,1520.61 1505.33,1549.11 1507.64,1527.56 1509.95,1448.3 1512.26,1566.47 1514.56,1522.76 1516.87,1451.5 1519.18,1491.33 1521.49,1412.23 1523.8,1415.87 1526.1,1475.94 1528.41,1413.6 1530.72,1523.51 1533.03,1396.82 1535.34,1447.92 1537.64,1565.42 1539.95,1461.26 1542.26,1461.36 1544.57,1534.3 1546.88,1493.14 1549.18,1635.51 1551.49,1526.34 1553.8,1209.59 1556.11,1548.76 1558.41,1439.29 1560.72,1339.02 1563.03,1312.34 1565.34,1470.13 1567.65,1458.04 1569.95,1477.27 1572.26,1434.77 1574.57,1415.32 1576.88,1373.52 1579.19,1503.55 1581.49,1300.97 1583.8,1421.82 1586.11,1386.4 1588.42,1404.95 1590.73,1543.79 1593.03,1391.58 1595.34,1291.1 1597.65,1404.54 1599.96,1491.67 1602.26,1563.6 1604.57,1329.61 1606.88,1394.73 1609.19,1506.21 1611.5,1359.98 1613.8,1487.19 1616.11,1390.14 1618.42,1411.71 1620.73,1274.44 1623.04,1284.79 1625.34,1347.65 1627.65,1329.03 1629.96,1359.93 1632.27,1490.84 1634.58,1460.05 1636.88,1288.3 1639.19,1483.13 1641.5,1374.29 1643.81,1519.1 1646.12,1433.97 1648.42,1285.69 1650.73,1510.87 1653.04,1447.42 1655.35,1513.86 1657.65,1307.81 1659.96,1457.39 1662.27,1443.74 1664.58,1484.42 1666.89,1554.39 1669.19,1463.85 1671.5,1420.09 1673.81,1378.23 1676.12,1455.74 1678.43,1405.94 1680.73,1523.26 1683.04,1293.39 1685.35,1376.72 1687.66,1568.61 1689.97,1517.54 1692.27,1392.06 1694.58,1457.87 1696.89,1392.33 1699.2,1345.34 1701.51,1488.62 1703.81,1313.31 1706.12,1372.13 1708.43,1405.04 1710.74,1462.39 1713.04,1301.64 1715.35,1435.6 1717.66,1464.17 1719.97,1362.36 1722.28,1333.36 1724.58,1573.51 1726.89,1495.54 1729.2,1512.9 1731.51,1390.08 1733.82,1467.58 1736.12,1308.17 1738.43,1450.49 1740.74,1441.25 1743.05,1406.76 1745.36,1426.76 1747.66,1427.79 1749.97,1389.05 1752.28,1308.13 1754.59,1423.9 1756.9,1260.08 1759.2,1506.77 1761.51,1323.69 1763.82,1396.66 1766.13,1366.83 1768.43,1431.77 1770.74,1229.61 1773.05,1399.73 1775.36,1500.66 1777.67,1450.37 1779.97,1421 1782.28,1400.5 1784.59,1460.48 1786.9,1464.25 1789.21,1317.7 1791.51,1478.12 1793.82,1313.68 1796.13,1664.08 1798.44,1455.85 1800.75,1225.84 1803.05,1378.46 1805.36,1389.11 1807.67,1405.3 1809.98,1335.69 1812.28,1294.06 1814.59,1433.23 1816.9,1433.53 1819.21,1348.21 1821.52,1479.78 1823.82,1345.63 1826.13,1533.04 1828.44,1350.02 1830.75,1491.75 1833.06,1487.77 1835.36,1492.03 1837.67,1333.16 1839.98,1421.47 1842.29,1289.6 1844.6,1576.54 1846.9,1441.19 1849.21,1453.58 1851.52,1489.84 1853.83,1322.34 1856.14,1311.91 1858.44,1337.53 1860.75,1295.71 1863.06,1457.8 1865.37,1406.08 1867.67,1482.54 1869.98,1443.77 1872.29,1385.03 1874.6,1457.56 1876.91,1353.25 1879.21,1316.13 1881.52,1479.29 1883.83,1353.61 1886.14,1367.68 1888.45,1304.66 1890.75,1374.02 1893.06,1327.37 1895.37,1569.99 1897.68,1296.03 1899.99,1429.75 1902.29,1307.27 1904.6,1414.18 1906.91,1464.99 1909.22,1331.82 1911.53,1541.27 1913.83,1402.82 1916.14,1319.2 1918.45,1441.36 1920.76,1472.33 1923.06,1338.45 1925.37,1503.82 1927.68,1501.69 1929.99,1598.08 1932.3,1265.24 1934.6,1488.62 1936.91,1347.31 1939.22,1248.74 1941.53,1589.97 1943.84,1337.73 1946.14,1581.57 1948.45,1429.32 1950.76,1595.3 1953.07,1385.83 1955.38,1324.6 1957.68,1398.79 1959.99,1469.81 1962.3,1531.52 1964.61,1467.74 1966.91,1383.48 1969.22,1230.87 1971.53,1337.09 1973.84,1507.87 1976.15,1535.68 1978.45,1353.93 1980.76,1386.8 1983.07,1263.85 1985.38,1346 1987.69,1535.08 1989.99,1488.7 1992.3,1429.87 1994.61,1271.67 1996.92,1401.19 1999.23,1461.14 2001.53,1396.18 2003.84,1443.51 2006.15,1420.15 2008.46,1418.9 2010.77,1407.77 2013.07,1393.2 2015.38,1302.23 2017.69,1445.61 2020,1369.45 2022.3,1405.92 2024.61,1386.22 2026.92,1225.85 2029.23,1492.89 2031.54,1370.44 2033.84,1250.44 2036.15,1386.42 2038.46,1471.78 2040.77,1417.6 2043.08,1190.59 2045.38,1507.91 2047.69,1324.7 2050,1328.93 2052.31,1428.45 2054.62,1457.51 2056.92,1305.06 2059.23,1268.52 2061.54,1526.59 2063.85,1428.45 2066.16,1348.18 2068.46,1360.83 2070.77,1359.31 2073.08,1371.58 2075.39,1386.55 2077.69,1382.23 2080,1334.72 2082.31,1399.62 2084.62,1415.17 2086.93,1339.65 2089.23,1397.69 2091.54,1480.54 2093.85,1359.94 2096.16,1376.75 2098.47,1476.63 2100.77,1515.24 2103.08,1444.07 2105.39,1401.94 2107.7,1233.78 2110.01,1469.05 2112.31,1522.74 2114.62,1413.89 2116.93,1485.07 2119.24,1490.49 2121.55,1357.14 2123.85,1469.31 2126.16,1395.06 2128.47,1342.58 2130.78,1328.98 2133.08,1398.7 2135.39,1294.2 2137.7,1336.95 2140.01,1479.97 2142.32,1489.95 2144.62,1336.3 2146.93,1419.26 2149.24,1544.86 2151.55,1428.97 2153.86,1475.12 2156.16,1555.75 2158.47,1426.2 2160.78,1537.16 2163.09,1336.35 2165.4,1509.89 2167.7,1406.48 2170.01,1462.89 2172.32,1346.57 2174.63,1343.36 2176.93,1310.45 2179.24,1526.74 2181.55,1394.82 2183.86,1274.96 2186.17,1415.19 2188.47,1457.06 2190.78,1221.7 2193.09,1388.37 2195.4,1403.3 2197.71,1495.24 2200.01,1530.21 2202.32,1442.72 2204.63,1356.88 2206.94,1136.51 2209.25,1424.59 2211.55,1507.01 2213.86,1412.36 2216.17,1263.53 2218.48,1269.42 2220.79,1283.88 2223.09,1328.39 2225.4,1531.87 2227.71,1470.03 2230.02,1560.15 2232.32,1371.4 2234.63,1559.65 2236.94,1423.77 2239.25,1502.88 2241.56,1342.24 2243.86,1358.93 2246.17,1266.44 2248.48,1324.4 2250.79,1276.13 2253.1,1418.03 2255.4,1370.77 2257.71,1460.75 2260.02,1462.46 2262.33,1357.55 2264.64,1516.03 2266.94,1300.23 2269.25,1354.81 2271.56,1452.59 2273.87,1335.25 2276.18,1315.3 2278.48,1354.99 2280.79,1281.5 2283.1,1314.91 2285.41,1408.03 2287.71,1252.7 2290.02,1509.06 2292.33,1433.29 2294.64,1461.94 2296.95,1232.76 2299.25,1466.27 2301.56,1338.9 2303.87,1378.73 2306.18,1383.14 2308.49,1429.54 2310.79,1402.36 2313.1,1404.89 2315.41,1346.86 2317.72,1313.34 2320.03,1384.52 2322.33,1470.21 2324.64,1462.29 2326.95,1426.95 2329.26,1365.28 2331.56,1424.57 2333.87,1444.61 2336.18,1374.29 2338.49,1342.29 2340.8,1404.76 2343.1,1416.11 2345.41,1353.29 2347.72,1472.74 2350.03,1584.8 2352.34,1364.52 2354.64,1504.52 2356.95,1348.83 2359.26,1263.66 2361.57,1179 2363.88,1499.58 2366.18,1480.53 2368.49,1332.63 2370.8,1373.82 2373.11,1402.31 2375.42,1479.85 2377.72,1357.71 2380.03,1410.2 2382.34,1344.55 2384.65,1473.07 2386.95,1485.67 2389.26,1233.24 2391.57,1406.37 2393.88,1405.15 2396.19,1424.01 2398.49,1408.91 2400.8,1399.23 2403.11,1500.11 2405.42,1225.5 2407.73,1439.95 2410.03,1257.38 2412.34,1511.49 2414.65,1410.01 2416.96,1390.84 2419.27,1235.91 2421.57,1494.62 2423.88,1499.34 2426.19,1304.49 2428.5,1215.77 2430.81,1355.21 2433.11,1458.06 2435.42,1523.97 2437.73,1367.2 2440.04,1501.2 2442.34,1408.97 2444.65,1417.49 2446.96,1311.13 2449.27,1411.26 2451.58,1244.51 2453.88,1370.46 2456.19,1330.47 2458.5,1488.06 2460.81,1453.08 2463.12,1420.61 2465.42,1245.58 2467.73,1407.29 2470.04,1431.07 2472.35,1411.72 2474.66,1709.9 2476.96,1225.19 2479.27,1409.24 2481.58,1374.84 2483.89,1520.33 2486.2,1303.37 2488.5,1373.68 2490.81,1346.92 2493.12,1246.69 2495.43,1434.84 2497.73,1367.51 2500.04,1570.33 2502.35,1460.63 2504.66,1422.67 2506.97,1255.88 2509.27,1580.32 2511.58,1426.83 2513.89,1496.62 2516.2,1364.15 2518.51,1535.4 2520.81,1434.06 2523.12,1333.46 2525.43,1400.33 2527.74,1364.52 2530.05,1597.66 2532.35,1443.71 2534.66,1334.33 2536.97,1445.88 2539.28,1262.98 2541.58,1427.05 2543.89,1341.62 2546.2,1523.53 2548.51,1438.2 2550.82,1399.61 2553.12,1501.28 2555.43,1533.28 2557.74,1475.92 2560.05,1487.43 2562.36,1525.96 2564.66,1416.1 2566.97,1541.38 2569.28,1363.69 2571.59,1348.77 "></polyline>
<polyline clip-path="url(#clip342)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,931.058 268.292,698.094 270.6,1079.25 272.908,1000.6 275.216,842.124 277.524,972.758 279.832,785.506 282.139,921.128 284.447,977.112 286.755,910.224 289.063,838.894 291.371,930.08 293.679,982.255 295.987,930.129 298.295,884.811 300.603,858.083 302.911,863.594 305.219,997.933 307.527,926.048 309.834,1093.41 312.142,891.363 314.45,796.563 316.758,979.125 319.066,921.503 321.374,1070.17 323.682,849.982 325.99,988.908 328.298,930.005 330.606,817.33 332.914,1052.04 335.221,937.479 337.529,1031.6 339.837,955.706 342.145,906.959 344.453,958.384 346.761,940.441 349.069,722.634 351.377,866.215 353.685,1088.78 355.993,943.231 358.301,807.364 360.608,947.756 362.916,885.129 365.224,844.398 367.532,797.6 369.84,1015.28 372.148,998.396 374.456,925.245 376.764,930.905 379.072,921.172 381.38,1030.15 383.688,1007.24 385.996,1051.24 388.303,1109.88 390.611,1114.18 392.919,965.01 395.227,800.996 397.535,855.088 399.843,875.092 402.151,848.02 404.459,941.676 406.767,927.821 409.075,1046.48 411.383,892.504 413.69,958.61 415.998,1001.87 418.306,1078.56 420.614,939.001 422.922,821.177 425.23,981.77 427.538,941.535 429.846,991.651 432.154,913.46 434.462,981.052 436.77,940.343 439.077,956.184 441.385,882.805 443.693,981.492 446.001,997.067 448.309,905.916 450.617,842.866 452.925,998.809 455.233,970.862 457.541,959.682 459.849,759.95 462.157,1014.35 464.465,1016.22 466.772,1023.86 469.08,874.067 471.388,986.119 473.696,947.656 476.004,935.876 478.312,899.126 480.62,907.88 482.928,829.571 485.236,889.957 487.544,1096.78 489.852,900.898 492.159,839.912 494.467,1029.06 496.775,847.68 499.083,1085.7 501.391,761.914 503.699,968.128 506.007,966.259 508.315,918.188 510.623,850.291 512.931,1204.98 515.239,1010.51 517.546,1003.75 519.854,947.124 522.162,920.484 524.47,1031.82 526.778,875.82 529.086,947.156 531.394,938.114 533.702,900.487 536.01,1042.67 538.318,910.159 540.626,926.272 542.933,818.696 545.241,761.644 547.549,1041.43 549.857,717.133 552.165,1012.45 554.473,760.873 556.781,1128.4 559.089,756.894 561.397,1005.54 563.705,1027.61 566.013,1087.6 568.321,1094.41 570.628,655.775 572.936,894.5 575.244,913.783 577.552,888.034 579.86,1045.54 582.168,894.426 584.476,1069.25 586.784,1020.17 589.092,833.751 591.4,1114.67 593.708,1193.81 596.015,932.408 598.323,917.863 600.631,1013.23 602.939,810.463 605.247,969.953 607.555,862.875 609.863,977.071 612.171,1078.54 614.479,966.115 616.787,857.782 619.095,972.247 621.402,975.631 623.71,741.111 626.018,1014.05 628.326,912.063 630.634,940.684 632.942,923.507 635.25,1171.41 637.558,932.294 639.866,942.403 642.174,1007.31 644.482,933.246 646.79,804.19 649.097,854.453 651.405,826.092 653.713,1086.6 656.021,1176.47 658.329,1041.38 660.637,808.002 662.945,936.881 665.253,872.867 667.561,1002.39 669.869,1074.76 672.177,843.648 674.484,922.664 676.792,905.915 679.1,874.222 681.408,956.57 683.716,946.068 686.024,1031.76 688.332,836.54 690.64,939.244 692.948,783.242 695.256,1004.72 697.564,985.391 699.871,762.099 702.179,912.252 704.487,846.144 706.795,827.377 709.103,1003.55 711.411,982.319 713.719,772.798 716.027,897.161 718.335,879.651 720.643,1048.59 722.951,998.344 725.259,795.856 727.566,1029.93 729.874,791.469 732.182,871.133 734.49,892.446 736.798,1034.16 739.106,810.021 741.414,925.43 743.722,774.313 746.03,1024.41 748.338,904.285 750.646,980.111 752.953,950.724 755.261,906.349 757.569,793.263 759.877,1021.93 762.185,883.262 764.493,992.15 766.801,990.569 769.109,1023.07 771.417,951.75 773.725,1149.23 776.033,970.774 778.34,918.439 780.648,999.77 782.956,871.212 785.264,913.508 787.572,732.325 789.88,998.198 792.188,909.431 794.496,997.803 796.804,936.619 799.112,912.992 801.42,911.095 803.728,860.979 806.035,1003.3 808.343,969.804 810.651,895.707 812.959,868.789 815.267,893.138 817.575,772.602 819.883,903.184 822.191,902.257 824.499,860.169 826.807,913.048 829.115,972.942 831.422,1010.08 833.73,1120.07 836.038,795.888 838.346,977.561 840.654,959.425 842.962,1005.57 845.27,923.679 847.578,869.14 849.886,976.376 852.194,961.654 854.502,1020.63 856.809,827.693 859.117,938.909 861.425,970.688 863.733,948.058 866.041,945.836 868.349,755.314 870.657,944.834 872.965,1054.49 875.273,1006.81 877.581,1074.26 879.889,988.437 882.197,961.356 884.504,837.084 886.812,984.314 889.12,1067.81 891.428,821.491 893.736,1011.23 896.044,1030.98 898.352,919.788 900.66,985.103 902.968,898.891 905.276,994.815 907.584,741.146 909.891,888.647 912.199,841.039 914.507,804.922 916.815,984.517 919.123,928.969 921.431,867.754 923.739,967.662 926.047,1035.54 928.355,848.306 930.663,1014.05 932.971,795.557 935.278,928.203 937.586,921.404 939.894,944.66 942.202,1007.76 944.51,1092.51 946.818,798.602 949.126,1046.92 951.434,817.017 953.742,878.593 956.05,976.063 958.358,893.484 960.665,962.011 962.973,896.273 965.281,942.833 967.589,937.874 969.897,1027.54 972.205,884.308 974.513,827.143 976.821,912.56 979.129,729.261 981.437,901.093 983.745,858.899 986.053,1028.75 988.36,905.559 990.668,877.602 992.976,932.776 995.284,838.646 997.592,947.492 999.9,848.947 1002.21,844.446 1004.52,832.095 1006.82,1026 1009.13,840.665 1011.44,842.819 1013.75,976.224 1016.06,1034.39 1018.36,1002.67 1020.67,958.014 1022.98,930.822 1025.29,1020.03 1027.59,1048.53 1029.9,1031.57 1032.21,896.616 1034.52,1051.6 1036.83,947.756 1039.13,909.078 1041.44,886.324 1043.75,836.96 1046.06,990.5 1048.37,889.679 1050.67,906.523 1052.98,1080.6 1055.29,871.904 1057.6,1045.54 1059.91,780.333 1062.21,1036.06 1064.52,860.266 1066.83,959.559 1069.14,1007.61 1071.45,887.053 1073.75,822.802 1076.06,1025.78 1078.37,1116.67 1080.68,734.495 1082.98,865.816 1085.29,802.724 1087.6,915.37 1089.91,812.709 1092.22,899.352 1094.52,1006.58 1096.83,891.559 1099.14,949.88 1101.45,909.216 1103.76,808.113 1106.06,1145.6 1108.37,879.834 1110.68,1093.15 1112.99,798.876 1115.3,920.205 1117.6,930.261 1119.91,901.611 1122.22,869.446 1124.53,972.135 1126.84,1029.44 1129.14,857.233 1131.45,839.684 1133.76,893.051 1136.07,830.388 1138.37,962.956 1140.68,1009.59 1142.99,920.194 1145.3,917.693 1147.61,809.513 1149.91,1045.3 1152.22,1010.72 1154.53,1036.84 1156.84,928.129 1159.15,919.432 1161.45,1032.76 1163.76,859.072 1166.07,998.226 1168.38,913.611 1170.69,990.311 1172.99,997.671 1175.3,908.736 1177.61,902.265 1179.92,957.418 1182.23,875.435 1184.53,915.429 1186.84,993.83 1189.15,958.512 1191.46,856.691 1193.76,1073.53 1196.07,855.641 1198.38,1000.08 1200.69,777.687 1203,904.042 1205.3,811.457 1207.61,915.633 1209.92,718.917 1212.23,874.061 1214.54,921.007 1216.84,977.135 1219.15,855.255 1221.46,832.72 1223.77,901.446 1226.08,958.628 1228.38,961.777 1230.69,962.94 1233,993.852 1235.31,893.423 1237.61,938.864 1239.92,978.469 1242.23,1035.54 1244.54,926.704 1246.85,829.186 1249.15,985.399 1251.46,1014.58 1253.77,981.793 1256.08,837.811 1258.39,796.051 1260.69,915.714 1263,870.337 1265.31,934.299 1267.62,1079.21 1269.93,910.033 1272.23,899.618 1274.54,1014.73 1276.85,961.217 1279.16,905.715 1281.47,855.123 1283.77,920.935 1286.08,925.605 1288.39,808.035 1290.7,841.82 1293,993.224 1295.31,996.376 1297.62,860.915 1299.93,827.458 1302.24,1042.27 1304.54,865.587 1306.85,890.95 1309.16,920.372 1311.47,845.877 1313.78,996.369 1316.08,859.857 1318.39,985.078 1320.7,849.992 1323.01,888.58 1325.32,746.164 1327.62,947.674 1329.93,989.42 1332.24,982.35 1334.55,1034.29 1336.86,936.449 1339.16,1074.9 1341.47,920.085 1343.78,963.929 1346.09,945.641 1348.39,890.015 1350.7,1100.25 1353.01,952.136 1355.32,869.434 1357.63,978.108 1359.93,1024.17 1362.24,915.287 1364.55,946.737 1366.86,1086.27 1369.17,925.638 1371.47,824.171 1373.78,999.553 1376.09,863.538 1378.4,881.205 1380.71,973.321 1383.01,807.341 1385.32,1000.09 1387.63,1063.71 1389.94,1008.54 1392.24,874.11 1394.55,956.277 1396.86,982.118 1399.17,836.385 1401.48,955.078 1403.78,794.747 1406.09,904.053 1408.4,811.306 1410.71,788.277 1413.02,908.808 1415.32,1023.69 1417.63,1009.3 1419.94,1060.88 1422.25,863.696 1424.56,963.38 1426.86,930.746 1429.17,926.851 1431.48,957.004 1433.79,870.447 1436.1,955.523 1438.4,971.312 1440.71,910.26 1443.02,905.49 1445.33,819.994 1447.63,987.118 1449.94,884.434 1452.25,1045.46 1454.56,800.11 1456.87,978.474 1459.17,1049.17 1461.48,1013.5 1463.79,922.108 1466.1,1097.09 1468.41,988.57 1470.71,811.91 1473.02,959.6 1475.33,946.225 1477.64,1012.99 1479.95,936.708 1482.25,814.159 1484.56,871.854 1486.87,966.36 1489.18,1032.21 1491.49,1000.18 1493.79,922.587 1496.1,978.166 1498.41,739.61 1500.72,957.497 1503.02,850.023 1505.33,958.114 1507.64,979.077 1509.95,928.377 1512.26,806.257 1514.56,944.808 1516.87,911.84 1519.18,840.075 1521.49,1023.56 1523.8,895.713 1526.1,881.482 1528.41,897.439 1530.72,938.815 1533.03,813.414 1535.34,825.599 1537.64,1166.96 1539.95,1039.46 1542.26,934.86 1544.57,876.572 1546.88,985.584 1549.18,845.767 1551.49,903.243 1553.8,942.753 1556.11,943.953 1558.41,1001.51 1560.72,1098.83 1563.03,909.271 1565.34,921.195 1567.65,942.443 1569.95,944.542 1572.26,841.916 1574.57,1028.13 1576.88,873.3 1579.19,969.411 1581.49,783.211 1583.8,726.548 1586.11,976.642 1588.42,940.049 1590.73,995.52 1593.03,900.933 1595.34,880.28 1597.65,1053.54 1599.96,879.492 1602.26,845.641 1604.57,858.187 1606.88,878.618 1609.19,992.294 1611.5,946.564 1613.8,988.83 1616.11,874.19 1618.42,621.902 1620.73,1068 1623.04,1002.8 1625.34,778.09 1627.65,1041.75 1629.96,768.603 1632.27,918.568 1634.58,801.078 1636.88,873.327 1639.19,875.225 1641.5,1049.48 1643.81,1113.52 1646.12,863.153 1648.42,904.669 1650.73,935.493 1653.04,839.463 1655.35,983.559 1657.65,979.335 1659.96,979.884 1662.27,926.875 1664.58,1099.99 1666.89,918.239 1669.19,951.778 1671.5,932.137 1673.81,893.601 1676.12,888.986 1678.43,849.537 1680.73,951.178 1683.04,893.486 1685.35,942.903 1687.66,958.107 1689.97,896.608 1692.27,882.839 1694.58,942.768 1696.89,860.235 1699.2,964.815 1701.51,985.029 1703.81,978.643 1706.12,1067.63 1708.43,1026.51 1710.74,790.629 1713.04,958.148 1715.35,772.881 1717.66,939.591 1719.97,833.694 1722.28,920.698 1724.58,749.515 1726.89,856.231 1729.2,1117.89 1731.51,981.773 1733.82,956.444 1736.12,998.39 1738.43,1011.03 1740.74,962.767 1743.05,1013.34 1745.36,855.739 1747.66,840.119 1749.97,1137.11 1752.28,925.69 1754.59,1038.53 1756.9,932.709 1759.2,880.722 1761.51,910.361 1763.82,1082.49 1766.13,890.714 1768.43,826.358 1770.74,888.461 1773.05,877.166 1775.36,992.385 1777.67,795.457 1779.97,1078.14 1782.28,971.639 1784.59,971.775 1786.9,787.127 1789.21,961.378 1791.51,962.638 1793.82,818.254 1796.13,992.75 1798.44,910.628 1800.75,954.778 1803.05,1017.68 1805.36,865.981 1807.67,898.484 1809.98,1059.21 1812.28,1010.5 1814.59,848.726 1816.9,997.163 1819.21,908.058 1821.52,898.764 1823.82,1019.88 1826.13,931.301 1828.44,914.856 1830.75,834.698 1833.06,1032.31 1835.36,1105.33 1837.67,1048.57 1839.98,952.752 1842.29,950.241 1844.6,979.151 1846.9,898.43 1849.21,950.902 1851.52,980.005 1853.83,962.758 1856.14,908.572 1858.44,913.658 1860.75,912.537 1863.06,895.214 1865.37,995.735 1867.67,856.604 1869.98,1104.09 1872.29,933.156 1874.6,1010.1 1876.91,903.44 1879.21,867.06 1881.52,886.305 1883.83,924.454 1886.14,860.373 1888.45,946.517 1890.75,1001.35 1893.06,971.404 1895.37,832.898 1897.68,936.161 1899.99,821.34 1902.29,759.628 1904.6,895.959 1906.91,921.992 1909.22,1080.41 1911.53,827.128 1913.83,1024.33 1916.14,1101.14 1918.45,900.506 1920.76,1053 1923.06,838.398 1925.37,870.26 1927.68,1043.57 1929.99,1088.43 1932.3,798.246 1934.6,917.304 1936.91,877.796 1939.22,969.337 1941.53,1162.93 1943.84,1001.35 1946.14,1013.97 1948.45,993.779 1950.76,968.254 1953.07,887.139 1955.38,833.665 1957.68,910.676 1959.99,894.035 1962.3,1052.27 1964.61,1055.8 1966.91,1009.58 1969.22,909.31 1971.53,982.938 1973.84,839.595 1976.15,998.035 1978.45,894.951 1980.76,881.892 1983.07,997.197 1985.38,1000 1987.69,954.856 1989.99,1041.54 1992.3,904.995 1994.61,1037.86 1996.92,817.645 1999.23,958.024 2001.53,980.155 2003.84,1095.39 2006.15,919.026 2008.46,971.3 2010.77,918.951 2013.07,761.832 2015.38,909.27 2017.69,997.506 2020,834.695 2022.3,856.242 2024.61,960.823 2026.92,877.6 2029.23,949.113 2031.54,805.293 2033.84,939.169 2036.15,939.129 2038.46,977.661 2040.77,990.765 2043.08,959.083 2045.38,858.249 2047.69,910.835 2050,1081.62 2052.31,1006.39 2054.62,968.495 2056.92,958.695 2059.23,977.611 2061.54,890.873 2063.85,838.221 2066.16,980.144 2068.46,1031.78 2070.77,1017.68 2073.08,984.737 2075.39,770.282 2077.69,934.078 2080,873.208 2082.31,898.184 2084.62,901.472 2086.93,926.868 2089.23,788.137 2091.54,1007.35 2093.85,906.292 2096.16,832.571 2098.47,805.893 2100.77,954.414 2103.08,1024.43 2105.39,1063.19 2107.7,964.975 2110.01,931.245 2112.31,1101.35 2114.62,942.896 2116.93,1046.65 2119.24,834.657 2121.55,1028.59 2123.85,915.94 2126.16,1040.83 2128.47,998.565 2130.78,1046.31 2133.08,946.632 2135.39,898.249 2137.7,1037.62 2140.01,1005.16 2142.32,865.461 2144.62,870.13 2146.93,894.165 2149.24,1001.68 2151.55,886.562 2153.86,975.576 2156.16,1040.86 2158.47,1114.68 2160.78,955.196 2163.09,972.896 2165.4,805.271 2167.7,868.043 2170.01,785.686 2172.32,1211.31 2174.63,886.038 2176.93,1120.27 2179.24,953.071 2181.55,894.362 2183.86,1052.02 2186.17,892.876 2188.47,852.596 2190.78,921.664 2193.09,1067.15 2195.4,821.151 2197.71,1012.7 2200.01,920.985 2202.32,1008.89 2204.63,880.207 2206.94,911.113 2209.25,1126.6 2211.55,949.733 2213.86,793.346 2216.17,985.622 2218.48,998.686 2220.79,948.627 2223.09,1037.6 2225.4,1033.04 2227.71,902.438 2230.02,1040.32 2232.32,998.08 2234.63,1199.28 2236.94,894.497 2239.25,962.545 2241.56,1018.16 2243.86,916.967 2246.17,941.365 2248.48,918.245 2250.79,1050.53 2253.1,1071.01 2255.4,938.597 2257.71,647.25 2260.02,857.699 2262.33,968.587 2264.64,960.74 2266.94,895.989 2269.25,1030.56 2271.56,1085.21 2273.87,1049.56 2276.18,819.897 2278.48,941.907 2280.79,857.612 2283.1,1039.82 2285.41,1085.29 2287.71,901.175 2290.02,588.518 2292.33,812.828 2294.64,812.015 2296.95,970.496 2299.25,894.566 2301.56,1130.99 2303.87,986.246 2306.18,929.479 2308.49,843.305 2310.79,875.265 2313.1,931.098 2315.41,948.878 2317.72,840.196 2320.03,869.953 2322.33,703.916 2324.64,856.351 2326.95,1016.99 2329.26,1072.84 2331.56,914.019 2333.87,959.356 2336.18,1033.34 2338.49,917.492 2340.8,863.639 2343.1,1123.49 2345.41,833.677 2347.72,912.942 2350.03,932.382 2352.34,901.547 2354.64,792.712 2356.95,793.672 2359.26,1153.37 2361.57,1028.93 2363.88,997.953 2366.18,928.783 2368.49,917.816 2370.8,934.749 2373.11,940.394 2375.42,847.08 2377.72,774.593 2380.03,1151.02 2382.34,947.538 2384.65,737.789 2386.95,782.8 2389.26,925.438 2391.57,859.978 2393.88,959.951 2396.19,894.735 2398.49,886.143 2400.8,852.605 2403.11,967.815 2405.42,899.91 2407.73,926.226 2410.03,949.439 2412.34,841.793 2414.65,1004.22 2416.96,893.647 2419.27,1013.34 2421.57,915.171 2423.88,894.132 2426.19,964.2 2428.5,1106.78 2430.81,872.657 2433.11,985.784 2435.42,1137.12 2437.73,993.069 2440.04,1070.55 2442.34,883.032 2444.65,990.002 2446.96,1060.89 2449.27,835.35 2451.58,1024.12 2453.88,881.763 2456.19,803.495 2458.5,984.913 2460.81,947.784 2463.12,854.13 2465.42,867.606 2467.73,942.076 2470.04,1051.71 2472.35,895.222 2474.66,970.305 2476.96,964.853 2479.27,904.539 2481.58,923.034 2483.89,796.579 2486.2,921.285 2488.5,963.037 2490.81,970.193 2493.12,950.552 2495.43,928.309 2497.73,954.217 2500.04,879.642 2502.35,999.519 2504.66,979.034 2506.97,892.796 2509.27,875.223 2511.58,907.505 2513.89,853.441 2516.2,1132.14 2518.51,892.726 2520.81,913.013 2523.12,825.031 2525.43,906.824 2527.74,1019.56 2530.05,939.831 2532.35,778.748 2534.66,1090.52 2536.97,920.947 2539.28,1034.1 2541.58,1016.92 2543.89,935.537 2546.2,954.519 2548.51,799.069 2550.82,1040.45 2553.12,1070.08 2555.43,874.505 2557.74,984.432 2560.05,800.499 2562.36,1013.56 2564.66,894.19 2566.97,1087.67 2569.28,685.461 2571.59,715.999 "></polyline>
<polyline clip-path="url(#clip342)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,772.948 268.292,424.532 270.6,494.748 272.908,504.63 275.216,358.891 277.524,419.883 279.832,442.502 282.139,538.537 284.447,457.062 286.755,292.712 289.063,428.494 291.371,361.763 293.679,237.332 295.987,535.309 298.295,494.941 300.603,498.351 302.911,359.869 305.219,446.883 307.527,444.593 309.834,250.727 312.142,687.952 314.45,389.554 316.758,316.794 319.066,219.183 321.374,328.466 323.682,528.707 325.99,501.082 328.298,446.819 330.606,291.74 332.914,339.796 335.221,533.012 337.529,414.678 339.837,393.077 342.145,511.386 344.453,442.344 346.761,161.598 349.069,189.553 351.377,500.5 353.685,541.289 355.993,535.305 358.301,416.716 360.608,331.485 362.916,443.066 365.224,531.852 367.532,580.919 369.84,487.446 372.148,194.465 374.456,549.992 376.764,597.206 379.072,373.77 381.38,273.283 383.688,550.162 385.996,651.45 388.303,433.501 390.611,536.492 392.919,434.196 395.227,603.44 397.535,436.838 399.843,383.994 402.151,529.621 404.459,483.599 406.767,234.334 409.075,398.44 411.383,419.172 413.69,279.095 415.998,440.256 418.306,395.754 420.614,510.724 422.922,471.044 425.23,479.495 427.538,523.919 429.846,377.303 432.154,354.998 434.462,688.954 436.77,610.788 439.077,320.633 441.385,345.377 443.693,693.445 446.001,606.44 448.309,359.361 450.617,342.732 452.925,310.68 455.233,429.345 457.541,573.918 459.849,513.058 462.157,541.089 464.465,369.462 466.772,438.511 469.08,293.965 471.388,532.937 473.696,388.197 476.004,337.963 478.312,357.132 480.62,507.113 482.928,260.479 485.236,407.16 487.544,471.574 489.852,406.943 492.159,356.78 494.467,617.154 496.775,336.235 499.083,385.009 501.391,372.016 503.699,376.663 506.007,451.239 508.315,520.519 510.623,421.131 512.931,589.63 515.239,428.134 517.546,446.735 519.854,511.516 522.162,445.775 524.47,388.671 526.778,729.899 529.086,491.364 531.394,477.62 533.702,636.155 536.01,507.726 538.318,437.552 540.626,461.2 542.933,417.289 545.241,348.833 547.549,465.012 549.857,492.271 552.165,563.92 554.473,369.338 556.781,605.551 559.089,604.253 561.397,296.484 563.705,524.961 566.013,417.665 568.321,440.442 570.628,649.217 572.936,593.815 575.244,368.741 577.552,419.474 579.86,410.397 582.168,599.44 584.476,390.192 586.784,615.117 589.092,413.497 591.4,350.881 593.708,218.009 596.015,419.17 598.323,537.147 600.631,375.316 602.939,583.223 605.247,411.494 607.555,593.885 609.863,373.187 612.171,372.996 614.479,478.19 616.787,444.124 619.095,472.307 621.402,469.916 623.71,450.43 626.018,309.442 628.326,535.509 630.634,416.49 632.942,395.77 635.25,453.725 637.558,519.707 639.866,323.748 642.174,467.591 644.482,499.59 646.79,229.484 649.097,554.652 651.405,550.097 653.713,368.442 656.021,323.429 658.329,487.603 660.637,96.8724 662.945,441.636 665.253,517.013 667.561,569.365 669.869,476.833 672.177,409.848 674.484,506.636 676.792,517.661 679.1,423.458 681.408,507.398 683.716,524.718 686.024,479.615 688.332,461.239 690.64,427.123 692.948,650.65 695.256,363.036 697.564,367.792 699.871,321.299 702.179,369.611 704.487,607.509 706.795,561.304 709.103,410.758 711.411,503.396 713.719,491.76 716.027,444.981 718.335,352.44 720.643,387.706 722.951,614.777 725.259,311.957 727.566,560.066 729.874,379.809 732.182,620.684 734.49,428.711 736.798,404.566 739.106,239.316 741.414,468.728 743.722,531.75 746.03,379.368 748.338,526.086 750.646,382.191 752.953,375.782 755.261,328.107 757.569,500.57 759.877,345.738 762.185,433.438 764.493,405.971 766.801,667.511 769.109,517.078 771.417,463.22 773.725,421.388 776.033,460.264 778.34,496.07 780.648,419.111 782.956,491.946 785.264,268.459 787.572,546.269 789.88,543.013 792.188,434.637 794.496,330.145 796.804,425.688 799.112,537.666 801.42,400.51 803.728,511.207 806.035,419.348 808.343,570.35 810.651,477.511 812.959,250.739 815.267,562.367 817.575,354.497 819.883,391.432 822.191,609.945 824.499,412.087 826.807,502.591 829.115,523.574 831.422,456.325 833.73,484.17 836.038,582.818 838.346,421.515 840.654,519.026 842.962,357.037 845.27,366.254 847.578,423.627 849.886,329.01 852.194,505.828 854.502,497.032 856.809,670.463 859.117,524.377 861.425,512.236 863.733,319.818 866.041,541.544 868.349,496.666 870.657,546.082 872.965,490.512 875.273,626.239 877.581,512.475 879.889,503.019 882.197,581.126 884.504,405.067 886.812,580.865 889.12,558.044 891.428,518.592 893.736,428.967 896.044,435.909 898.352,433.42 900.66,466.555 902.968,398.883 905.276,503.904 907.584,505.731 909.891,461.387 912.199,553.13 914.507,450.379 916.815,502.269 919.123,389.352 921.431,532.387 923.739,406.657 926.047,487.448 928.355,523.31 930.663,583.014 932.971,369.873 935.278,321.478 937.586,424.356 939.894,368.644 942.202,505.764 944.51,482.498 946.818,253.325 949.126,412.206 951.434,399.689 953.742,497.586 956.05,469.505 958.358,482.478 960.665,421.841 962.973,534.703 965.281,474.542 967.589,623.135 969.897,376.485 972.205,337.638 974.513,445.826 976.821,627.952 979.129,327.048 981.437,455.212 983.745,468.107 986.053,522.937 988.36,494.299 990.668,544.466 992.976,545.204 995.284,413.033 997.592,482.096 999.9,463.356 1002.21,537.281 1004.52,469.602 1006.82,510.837 1009.13,293.141 1011.44,603.715 1013.75,499.154 1016.06,370.223 1018.36,312.51 1020.67,514.002 1022.98,479.335 1025.29,529.485 1027.59,504.841 1029.9,473.363 1032.21,512.487 1034.52,326.911 1036.83,545.577 1039.13,523.42 1041.44,397.658 1043.75,597.697 1046.06,335.066 1048.37,452.116 1050.67,366.882 1052.98,500.775 1055.29,339.353 1057.6,487.066 1059.91,337.34 1062.21,417.688 1064.52,332.262 1066.83,556.636 1069.14,450.862 1071.45,687.689 1073.75,421.005 1076.06,461.494 1078.37,492.536 1080.68,521.933 1082.98,484.654 1085.29,392.99 1087.6,360.198 1089.91,358.623 1092.22,565.501 1094.52,324.214 1096.83,467.494 1099.14,507.488 1101.45,442.386 1103.76,331.275 1106.06,453.957 1108.37,241.06 1110.68,189.772 1112.99,536.236 1115.3,518.22 1117.6,377.108 1119.91,470.304 1122.22,364.601 1124.53,499.927 1126.84,420.572 1129.14,479.739 1131.45,472.857 1133.76,494.234 1136.07,510.024 1138.37,688.647 1140.68,286.524 1142.99,330.979 1145.3,575.605 1147.61,478.205 1149.91,207.024 1152.22,361.362 1154.53,438.194 1156.84,238.557 1159.15,561.156 1161.45,371.816 1163.76,602.351 1166.07,457.538 1168.38,545.061 1170.69,509.897 1172.99,622.291 1175.3,454.415 1177.61,428.317 1179.92,333.818 1182.23,461.032 1184.53,697.429 1186.84,448.046 1189.15,603.373 1191.46,411.646 1193.76,441.524 1196.07,420.541 1198.38,505.986 1200.69,469.842 1203,495.816 1205.3,569.745 1207.61,468.939 1209.92,283.235 1212.23,380.658 1214.54,350.271 1216.84,341.119 1219.15,546.252 1221.46,476.161 1223.77,447.355 1226.08,327.528 1228.38,394.352 1230.69,417.353 1233,522.995 1235.31,380.81 1237.61,416.324 1239.92,478.631 1242.23,412.899 1244.54,558.88 1246.85,407.534 1249.15,440.282 1251.46,434.545 1253.77,571.181 1256.08,566.681 1258.39,313.649 1260.69,500.906 1263,456.915 1265.31,455.521 1267.62,393.269 1269.93,321.077 1272.23,407.427 1274.54,391.833 1276.85,358.809 1279.16,522.368 1281.47,437.355 1283.77,267.591 1286.08,436.358 1288.39,527.443 1290.7,432.128 1293,473.721 1295.31,557.61 1297.62,545.871 1299.93,451.983 1302.24,468.198 1304.54,371.906 1306.85,431.937 1309.16,439.648 1311.47,404.157 1313.78,668.09 1316.08,592.189 1318.39,552.912 1320.7,417.447 1323.01,424.81 1325.32,435.726 1327.62,164.173 1329.93,443.124 1332.24,449.218 1334.55,540.627 1336.86,394.5 1339.16,427.661 1341.47,356.243 1343.78,400.773 1346.09,523.022 1348.39,519.425 1350.7,548.172 1353.01,392.996 1355.32,447.139 1357.63,337.789 1359.93,357.115 1362.24,532.783 1364.55,495.196 1366.86,397.243 1369.17,481.631 1371.47,338.706 1373.78,314.971 1376.09,384.596 1378.4,524.06 1380.71,460.958 1383.01,427.764 1385.32,403.317 1387.63,434.524 1389.94,528.638 1392.24,366.345 1394.55,533.909 1396.86,554.656 1399.17,462.172 1401.48,651.814 1403.78,326.425 1406.09,358.259 1408.4,520.845 1410.71,473.643 1413.02,555.619 1415.32,479.926 1417.63,528.807 1419.94,369.718 1422.25,468.973 1424.56,438.578 1426.86,396.688 1429.17,405.901 1431.48,573.416 1433.79,417.652 1436.1,519.449 1438.4,385.364 1440.71,480.142 1443.02,565.226 1445.33,468.401 1447.63,433.364 1449.94,589.607 1452.25,349.597 1454.56,559.424 1456.87,441.409 1459.17,559.927 1461.48,501.555 1463.79,291.189 1466.1,629.109 1468.41,400.527 1470.71,502.592 1473.02,566.1 1475.33,511.065 1477.64,513.318 1479.95,418.288 1482.25,642.398 1484.56,544.639 1486.87,457.251 1489.18,396.356 1491.49,416.572 1493.79,529.814 1496.1,475.559 1498.41,457.86 1500.72,406.953 1503.02,517.41 1505.33,369.569 1507.64,493.582 1509.95,552.834 1512.26,468.893 1514.56,340.884 1516.87,455.146 1519.18,387.175 1521.49,398.293 1523.8,456.636 1526.1,373.882 1528.41,421.886 1530.72,484.738 1533.03,609.894 1535.34,435.204 1537.64,406.684 1539.95,527.05 1542.26,408.386 1544.57,409.86 1546.88,597.937 1549.18,526.962 1551.49,454.193 1553.8,293.771 1556.11,478.788 1558.41,387.218 1560.72,441.42 1563.03,616.301 1565.34,509.294 1567.65,453.351 1569.95,494.645 1572.26,346.487 1574.57,424.11 1576.88,457.328 1579.19,470.11 1581.49,589.169 1583.8,353.4 1586.11,382.617 1588.42,576.003 1590.73,528.843 1593.03,568.916 1595.34,461.173 1597.65,530.205 1599.96,450.438 1602.26,494.085 1604.57,518.016 1606.88,568.023 1609.19,322.387 1611.5,437.949 1613.8,346.731 1616.11,254.014 1618.42,300.291 1620.73,319.368 1623.04,497.944 1625.34,420.608 1627.65,450.37 1629.96,610.357 1632.27,419.315 1634.58,316.074 1636.88,419.054 1639.19,625.947 1641.5,467.958 1643.81,470.569 1646.12,533.485 1648.42,430.652 1650.73,438.552 1653.04,296.892 1655.35,498.046 1657.65,340.646 1659.96,424.426 1662.27,443.16 1664.58,286.48 1666.89,594.785 1669.19,495.077 1671.5,387.146 1673.81,278.114 1676.12,380.073 1678.43,425.289 1680.73,528.854 1683.04,465.403 1685.35,331.155 1687.66,405.185 1689.97,437.791 1692.27,593.666 1694.58,517.702 1696.89,326.398 1699.2,541.823 1701.51,456.539 1703.81,433.648 1706.12,473.56 1708.43,320.542 1710.74,500.145 1713.04,454.236 1715.35,457.501 1717.66,308.189 1719.97,477.161 1722.28,525.573 1724.58,445.959 1726.89,394.819 1729.2,517.969 1731.51,459.171 1733.82,387.341 1736.12,448.459 1738.43,342.075 1740.74,584.851 1743.05,408.408 1745.36,569.988 1747.66,579.266 1749.97,526.933 1752.28,225.276 1754.59,477.845 1756.9,472.813 1759.2,425.358 1761.51,456.342 1763.82,375.709 1766.13,512.878 1768.43,468.302 1770.74,426.228 1773.05,356.534 1775.36,322.086 1777.67,639.053 1779.97,669.237 1782.28,564.451 1784.59,548.158 1786.9,130.295 1789.21,320.522 1791.51,569.023 1793.82,561.469 1796.13,351.158 1798.44,595.283 1800.75,388.187 1803.05,589.571 1805.36,477.737 1807.67,491.492 1809.98,608.665 1812.28,547.23 1814.59,381.22 1816.9,387.567 1819.21,506.922 1821.52,662.505 1823.82,387.243 1826.13,437.643 1828.44,483.077 1830.75,418.341 1833.06,433.624 1835.36,442.364 1837.67,475.653 1839.98,464.362 1842.29,428.073 1844.6,447.143 1846.9,596.933 1849.21,428.776 1851.52,392.136 1853.83,687.805 1856.14,384.034 1858.44,434.19 1860.75,392.767 1863.06,369.154 1865.37,268.403 1867.67,518.934 1869.98,426.396 1872.29,476.958 1874.6,494.019 1876.91,477.989 1879.21,387.053 1881.52,395.504 1883.83,530.927 1886.14,436.621 1888.45,719.735 1890.75,529.091 1893.06,427.595 1895.37,600.632 1897.68,444.09 1899.99,527.254 1902.29,585.561 1904.6,490.98 1906.91,535.986 1909.22,442.929 1911.53,505.848 1913.83,525.403 1916.14,519.185 1918.45,467.156 1920.76,503.182 1923.06,372.175 1925.37,467.633 1927.68,541.477 1929.99,538.26 1932.3,487.092 1934.6,569.943 1936.91,450.323 1939.22,373.743 1941.53,495.663 1943.84,292.472 1946.14,290.086 1948.45,396.735 1950.76,537.37 1953.07,362.85 1955.38,306.101 1957.68,411.71 1959.99,339.974 1962.3,540.171 1964.61,358.975 1966.91,471.995 1969.22,397.544 1971.53,452.545 1973.84,292.793 1976.15,443.977 1978.45,480.97 1980.76,510.016 1983.07,512.292 1985.38,655.858 1987.69,462.616 1989.99,498.329 1992.3,569.119 1994.61,451.081 1996.92,389.674 1999.23,328.947 2001.53,383.674 2003.84,268.107 2006.15,547.536 2008.46,547.034 2010.77,552.605 2013.07,570.011 2015.38,455.4 2017.69,416.969 2020,566.908 2022.3,405.216 2024.61,615.172 2026.92,366.351 2029.23,405.395 2031.54,513.177 2033.84,393.818 2036.15,434.323 2038.46,527.96 2040.77,441.074 2043.08,511.065 2045.38,426.808 2047.69,404.678 2050,416.482 2052.31,370.548 2054.62,382.341 2056.92,500.551 2059.23,378.177 2061.54,592.039 2063.85,721.898 2066.16,390.174 2068.46,466.185 2070.77,536.739 2073.08,364.319 2075.39,523.494 2077.69,426.147 2080,424.522 2082.31,475.72 2084.62,320.157 2086.93,347.778 2089.23,332.709 2091.54,478.77 2093.85,410.702 2096.16,335.705 2098.47,314.375 2100.77,304.935 2103.08,340.385 2105.39,437.347 2107.7,447.121 2110.01,351.987 2112.31,476.864 2114.62,540.054 2116.93,534.182 2119.24,374.191 2121.55,387.583 2123.85,648.493 2126.16,369.11 2128.47,517.63 2130.78,487.861 2133.08,469.124 2135.39,249.761 2137.7,461.495 2140.01,494.742 2142.32,494.904 2144.62,320.81 2146.93,544.861 2149.24,424.368 2151.55,508.89 2153.86,422.567 2156.16,482.928 2158.47,618.961 2160.78,488.646 2163.09,489.786 2165.4,593.619 2167.7,492.335 2170.01,370.374 2172.32,447.898 2174.63,486.369 2176.93,504.751 2179.24,534.35 2181.55,485.668 2183.86,418.95 2186.17,448.522 2188.47,564.882 2190.78,485.436 2193.09,398.775 2195.4,405.304 2197.71,531.32 2200.01,346.233 2202.32,475.043 2204.63,429.632 2206.94,312.061 2209.25,484.008 2211.55,445.465 2213.86,433.819 2216.17,310.627 2218.48,334.778 2220.79,517.119 2223.09,636.715 2225.4,537.912 2227.71,258.6 2230.02,457.361 2232.32,586.776 2234.63,371.482 2236.94,470.646 2239.25,500.146 2241.56,439.118 2243.86,548.074 2246.17,227.165 2248.48,401.506 2250.79,425.087 2253.1,414.698 2255.4,353.996 2257.71,652.234 2260.02,374.328 2262.33,394.8 2264.64,358.203 2266.94,550.409 2269.25,338.316 2271.56,407.482 2273.87,372.915 2276.18,475.093 2278.48,458.512 2280.79,303.388 2283.1,343.663 2285.41,496.553 2287.71,454.758 2290.02,436.419 2292.33,429.639 2294.64,545.9 2296.95,597.895 2299.25,336.371 2301.56,419.393 2303.87,285.459 2306.18,376.607 2308.49,478.859 2310.79,584.402 2313.1,394.952 2315.41,308.948 2317.72,363.441 2320.03,418.953 2322.33,321.308 2324.64,557.388 2326.95,440.28 2329.26,508.032 2331.56,465.562 2333.87,380.175 2336.18,436.407 2338.49,351.356 2340.8,426.971 2343.1,554.455 2345.41,617.614 2347.72,553.781 2350.03,372.144 2352.34,426.26 2354.64,552.809 2356.95,330.866 2359.26,568.454 2361.57,302.484 2363.88,491.974 2366.18,427.405 2368.49,307.502 2370.8,373.695 2373.11,486.912 2375.42,496.594 2377.72,382.068 2380.03,342.17 2382.34,466.307 2384.65,492.17 2386.95,393.967 2389.26,280.127 2391.57,552.167 2393.88,341.916 2396.19,406.977 2398.49,664.955 2400.8,607.859 2403.11,436.979 2405.42,536.047 2407.73,551.994 2410.03,322.496 2412.34,369.71 2414.65,611.148 2416.96,486.045 2419.27,340.67 2421.57,339.529 2423.88,474.813 2426.19,279.775 2428.5,542.446 2430.81,420.871 2433.11,466.357 2435.42,392.429 2437.73,431.624 2440.04,540.531 2442.34,371.939 2444.65,440.88 2446.96,535.003 2449.27,141.622 2451.58,424.426 2453.88,398.767 2456.19,433.338 2458.5,424.154 2460.81,412.161 2463.12,354.483 2465.42,424.898 2467.73,432.482 2470.04,246.898 2472.35,579.538 2474.66,383.719 2476.96,409.346 2479.27,346.78 2481.58,478.869 2483.89,364.85 2486.2,522.504 2488.5,404.698 2490.81,489.884 2493.12,393.658 2495.43,562.283 2497.73,528.182 2500.04,336.172 2502.35,494.5 2504.66,530.571 2506.97,203.128 2509.27,580.602 2511.58,691.246 2513.89,283.731 2516.2,336.505 2518.51,534.835 2520.81,544.191 2523.12,535.409 2525.43,509.237 2527.74,492.225 2530.05,451.362 2532.35,409.517 2534.66,457.212 2536.97,234.388 2539.28,614.353 2541.58,552.375 2543.89,518.435 2546.2,354.038 2548.51,459.591 2550.82,423.255 2553.12,375.97 2555.43,413.796 2557.74,460.11 2560.05,415.812 2562.36,367.812 2564.66,465.363 2566.97,274.433 2569.28,407.921 2571.59,504.337 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -2.53288   -3.68109   -4.4777    …  -6.0151    -6.0151    -4.17969
 -0.408008  -0.363839   0.565938     -0.664091  -0.664091   0.947821
  4.97127    5.14643    4.04948       5.55551    5.55551    4.99631

[:, :, 2] =
 -2.20096  -4.04702  -5.01198  -5.88423   …  -5.90105   -5.41471   -6.64873
 -1.71026  -1.43759   1.08573   0.670897     -0.192476  -0.589068  -2.41965
  1.17784   3.0722    4.2649    5.39211       4.08183    5.39557    4.24607

[:, :, 3] =
 -2.24277   -1.83744  -3.40001   -4.74432  …  -3.72489   -5.01951   -3.59634
 -0.326863   1.10793  -0.508575  -1.33956     -0.356033   0.153222  -1.06609
  2.36922    4.50567   3.79053    4.61704      4.44675    3.86076    4.37007

[:, :, 4] =
 -1.7589    -3.71547  -3.95182  -4.82802   …  -7.32082  -7.27035    -6.08395
 -0.201051  -1.40815  -1.27424  -0.508162      1.22462   0.0671639  -0.898503
  2.32122    3.35785   2.46457   3.49937       6.45574   5.91461     4.18158</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.96875    0.989617
  0.0158426  1.00242
  4.97613    0.98876</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.56 seconds
Compute duration  = 2.56 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -5.0284    1.0004    0.0177   3201.4573   5122.1398    1.0001   ⋯
        x[2]   -0.0093    1.0092    0.0174   3358.2604   4729.3718    1.0003   ⋯
        x[3]    5.0168    1.0224    0.0186   3003.6041   5113.7274    1.0003   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -6.9878   -5.7153   -5.0277   -4.3603   -3.0473
        x[2]   -1.9751   -0.6914   -0.0084    0.6695    1.9919
        x[3]    3.0596    4.3108    5.0286    5.7068    7.0246</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.44 seconds
Compute duration  = 1.44 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.5002    0.1884    0.0027   4827.5949   6515.9169    1.0000   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1489    0.3590    0.5033    0.6371    0.8576</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.23 seconds
Compute duration  = 0.23 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

           x    0.4857    0.1678    0.0171    71.6583    33.3780    1.0192     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.2311    0.3353    0.4859    0.6280    0.7699</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(-0.429009537332916, "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with -0.429009537332916:
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/Qeo2J/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/Qeo2J/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/Qeo2J/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/Qeo2J/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/Qeo2J/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/ooLj8/src/compiler.jl:579 [inlined]
  [7] demo
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:593 [inlined]
  [8] _evaluate!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.ThreadSafeVarInfo{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, Vector{Base.RefValue{Float64}}}, context::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/ooLj8/src/model.jl:975
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, context::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/ooLj8/src/model.jl:964
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/ooLj8/src/model.jl:894 [inlined]
 [11] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/ooLj8/src/values_as_in_model.jl:196 [inlined]
 [12] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/ooLj8/src/values_as_in_model.jl:195 [inlined]
 [13] getparams(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64})
    @ Turing.Inference ~/.julia/packages/Turing/bUZEC/src/mcmc/Inference.jl:383
 [14] Turing.Inference.Transition(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, t::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/bUZEC/src/mcmc/Inference.jl:258
 [15] transition_to_turing
    @ ~/.julia/packages/Turing/bUZEC/src/mcmc/abstractmcmc.jl:12 [inlined]
 [16] transition_to_turing(f::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, transition::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/bUZEC/src/mcmc/abstractmcmc.jl:17
 [17] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}; initial_state::Nothing, initial_params::Nothing, kwargs::@Kwargs{})
    @ Turing.Inference ~/.julia/packages/Turing/bUZEC/src/mcmc/abstractmcmc.jl:147
 [18] macro expansion
    @ ~/.julia/packages/AbstractMCMC/FSyVk/src/sample.jl:0 [inlined]
 [19] macro expansion
    @ ~/.julia/packages/AbstractMCMC/FSyVk/src/logging.jl:16 [inlined]
 [20] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, num_warmup::Int64, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/FSyVk/src/sample.jl:142
 [21] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/ooLj8/src/sampler.jl:93
 [22] sample
    @ ~/.julia/packages/DynamicPPL/ooLj8/src/sampler.jl:83 [inlined]
 [23] #sample#4
    @ ~/.julia/packages/Turing/bUZEC/src/mcmc/Inference.jl:305 [inlined]
 [24] sample
    @ ~/.julia/packages/Turing/bUZEC/src/mcmc/Inference.jl:296 [inlined]
 [25] #sample#3
    @ ~/.julia/packages/Turing/bUZEC/src/mcmc/Inference.jl:293 [inlined]
 [26] top-level scope
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:595</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.63 seconds
Compute duration  = 1.63 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.2217    0.0000    0.0000        NaN        NaN       NaN     ⋯
           x   -0.8729    0.0000    0.0000        NaN        NaN       NaN     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.2217    0.2217    0.2217    0.2217    0.2217
           x   -0.8729   -0.8729   -0.8729   -0.8729   -0.8729</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 3.06 seconds
Compute duration  = 3.06 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.9073    0.5727    0.0280   440.9125   382.3892    1.0040     ⋯
           x    0.1131    1.1149    0.0775   341.7212   139.4456    1.0065     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1356    0.4562    0.7805    1.2641    2.2644
           x   -2.2494   -0.3631    0.0411    0.5356    2.8971</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>