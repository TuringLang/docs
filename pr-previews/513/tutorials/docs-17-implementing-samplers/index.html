<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../tutorials/docs-07-for-developers-variational-inference/index.html" rel="prev">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/docs-00-getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/00-introduction/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.34" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.34</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.34">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Documentation</li><li class="breadcrumb-item"><a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html">Developers: Inference</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Documentation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Using Turing - Modelling Syntax and Interface</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-00-getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-14-using-turing-quick-start/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quick Start</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-12-using-turing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-09-using-turing-advanced/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced Usage</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-10-using-turing-autodiff/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-13-using-turing-performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-11-using-turing-dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-15-using-turing-sampler-viz/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-16-using-turing-external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Using Turing - Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/00-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Turing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/01-gaussian-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/02-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/03-bayesian-neural-network/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/04-hidden-markov-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/05-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/06-infinite-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/07-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/08-multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/09-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/10-bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/11-probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/13-seasonal-time-series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/15-gaussian-processes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Gaussian Processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/12-gplvm/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Developers: Contributing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-01-contributing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to Contribute</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Developers: PPL</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-05-for-developers-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/14-minituring/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/16-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-06-for-developers-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers: Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Documentation</li><li class="breadcrumb-item"><a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html">Developers: Inference</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-32.057501584026866</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-32.057501584026866</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([0.0, 0.0, 0.0]), MALAState{Vector{Float64}}([0.0, 0.0, 0.0]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -2.32306   -3.88484   -4.67413  -5.78673   …  -4.60356   -5.12451  -6.82323
  0.155099  -0.473695   2.25089   0.658928     -0.586374  -1.69939   0.238467
  3.34074    5.6399     5.26343   4.27292       5.18444    6.32706   5.8029</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -5.01711    0.989503
 -0.0108118  1.00461
  4.97901    1.02012</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip660">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip660)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip661">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip660)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip662">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip662)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip662)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip662)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip662)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip662)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip662)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1717.42 2640.76,1717.42 "></polyline>
<polyline clip-path="url(#clip662)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1467.41 2640.76,1467.41 "></polyline>
<polyline clip-path="url(#clip662)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1217.41 2640.76,1217.41 "></polyline>
<polyline clip-path="url(#clip662)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,967.409 2640.76,967.409 "></polyline>
<polyline clip-path="url(#clip662)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,717.406 2640.76,717.406 "></polyline>
<polyline clip-path="url(#clip662)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,467.403 2640.76,467.403 "></polyline>
<polyline clip-path="url(#clip662)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,217.4 2640.76,217.4 "></polyline>
<polyline clip-path="url(#clip660)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip660)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip660)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip660)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip660)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip660)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip660)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip660)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip660)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1717.42 215.714,1717.42 "></polyline>
<polyline clip-path="url(#clip660)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1467.41 215.714,1467.41 "></polyline>
<polyline clip-path="url(#clip660)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1217.41 215.714,1217.41 "></polyline>
<polyline clip-path="url(#clip660)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,967.409 215.714,967.409 "></polyline>
<polyline clip-path="url(#clip660)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,717.406 215.714,717.406 "></polyline>
<polyline clip-path="url(#clip660)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,467.403 215.714,467.403 "></polyline>
<polyline clip-path="url(#clip660)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,217.4 215.714,217.4 "></polyline>
<path clip-path="url(#clip660)" d="M50.5475 1717.87 L80.2233 1717.87 L80.2233 1721.8 L50.5475 1721.8 L50.5475 1717.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M89.1352 1700.14 L111.357 1700.14 L111.357 1702.13 L98.8111 1734.7 L93.9269 1734.7 L105.732 1704.07 L89.1352 1704.07 L89.1352 1700.14 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M120.478 1728.82 L125.362 1728.82 L125.362 1734.7 L120.478 1734.7 L120.478 1728.82 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M135.593 1700.14 L153.95 1700.14 L153.95 1704.07 L139.876 1704.07 L139.876 1712.54 Q140.894 1712.2 141.913 1712.04 Q142.931 1711.85 143.95 1711.85 Q149.737 1711.85 153.116 1715.02 Q156.496 1718.19 156.496 1723.61 Q156.496 1729.19 153.024 1732.29 Q149.552 1735.37 143.232 1735.37 Q141.056 1735.37 138.788 1735 Q136.542 1734.63 134.135 1733.89 L134.135 1729.19 Q136.218 1730.32 138.441 1730.88 Q140.663 1731.43 143.14 1731.43 Q147.144 1731.43 149.482 1729.33 Q151.82 1727.22 151.82 1723.61 Q151.82 1720 149.482 1717.89 Q147.144 1715.79 143.14 1715.79 Q141.265 1715.79 139.39 1716.2 Q137.538 1716.62 135.593 1717.5 L135.593 1700.14 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M49.5521 1467.87 L79.2279 1467.87 L79.2279 1471.8 L49.5521 1471.8 L49.5521 1467.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M89.3667 1450.13 L107.723 1450.13 L107.723 1454.07 L93.6491 1454.07 L93.6491 1462.54 Q94.6676 1462.19 95.6861 1462.03 Q96.7047 1461.85 97.7232 1461.85 Q103.51 1461.85 106.89 1465.02 Q110.269 1468.19 110.269 1473.61 Q110.269 1479.19 106.797 1482.29 Q103.325 1485.37 97.0056 1485.37 Q94.8297 1485.37 92.5612 1485 Q90.3158 1484.63 87.9084 1483.88 L87.9084 1479.19 Q89.9917 1480.32 92.2139 1480.88 Q94.4361 1481.43 96.913 1481.43 Q100.918 1481.43 103.256 1479.32 Q105.593 1477.22 105.593 1473.61 Q105.593 1470 103.256 1467.89 Q100.918 1465.78 96.913 1465.78 Q95.038 1465.78 93.163 1466.2 Q91.3112 1466.62 89.3667 1467.5 L89.3667 1450.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M119.482 1478.81 L124.367 1478.81 L124.367 1484.69 L119.482 1484.69 L119.482 1478.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M144.552 1453.21 Q140.941 1453.21 139.112 1456.78 Q137.306 1460.32 137.306 1467.45 Q137.306 1474.56 139.112 1478.12 Q140.941 1481.66 144.552 1481.66 Q148.186 1481.66 149.991 1478.12 Q151.82 1474.56 151.82 1467.45 Q151.82 1460.32 149.991 1456.78 Q148.186 1453.21 144.552 1453.21 M144.552 1449.51 Q150.362 1449.51 153.417 1454.12 Q156.496 1458.7 156.496 1467.45 Q156.496 1476.18 153.417 1480.78 Q150.362 1485.37 144.552 1485.37 Q138.741 1485.37 135.663 1480.78 Q132.607 1476.18 132.607 1467.45 Q132.607 1458.7 135.663 1454.12 Q138.741 1449.51 144.552 1449.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M50.5475 1217.86 L80.2233 1217.86 L80.2233 1221.8 L50.5475 1221.8 L50.5475 1217.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M94.3436 1230.76 L110.663 1230.76 L110.663 1234.69 L88.7186 1234.69 L88.7186 1230.76 Q91.3806 1228 95.9639 1223.37 Q100.57 1218.72 101.751 1217.38 Q103.996 1214.85 104.876 1213.12 Q105.779 1211.36 105.779 1209.67 Q105.779 1206.91 103.834 1205.18 Q101.913 1203.44 98.8111 1203.44 Q96.6121 1203.44 94.1584 1204.21 Q91.7278 1204.97 88.9501 1206.52 L88.9501 1201.8 Q91.7741 1200.66 94.2278 1200.09 Q96.6815 1199.51 98.7185 1199.51 Q104.089 1199.51 107.283 1202.19 Q110.478 1204.88 110.478 1209.37 Q110.478 1211.5 109.668 1213.42 Q108.881 1215.32 106.774 1217.91 Q106.195 1218.58 103.094 1221.8 Q99.9917 1224.99 94.3436 1230.76 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M120.478 1228.81 L125.362 1228.81 L125.362 1234.69 L120.478 1234.69 L120.478 1228.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M135.593 1200.13 L153.95 1200.13 L153.95 1204.07 L139.876 1204.07 L139.876 1212.54 Q140.894 1212.19 141.913 1212.03 Q142.931 1211.84 143.95 1211.84 Q149.737 1211.84 153.116 1215.02 Q156.496 1218.19 156.496 1223.6 Q156.496 1229.18 153.024 1232.28 Q149.552 1235.36 143.232 1235.36 Q141.056 1235.36 138.788 1234.99 Q136.542 1234.62 134.135 1233.88 L134.135 1229.18 Q136.218 1230.32 138.441 1230.87 Q140.663 1231.43 143.14 1231.43 Q147.144 1231.43 149.482 1229.32 Q151.82 1227.21 151.82 1223.6 Q151.82 1219.99 149.482 1217.89 Q147.144 1215.78 143.14 1215.78 Q141.265 1215.78 139.39 1216.2 Q137.538 1216.61 135.593 1217.49 L135.593 1200.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M99.3204 953.207 Q95.7093 953.207 93.8806 956.772 Q92.075 960.314 92.075 967.443 Q92.075 974.55 93.8806 978.115 Q95.7093 981.656 99.3204 981.656 Q102.955 981.656 104.76 978.115 Q106.589 974.55 106.589 967.443 Q106.589 960.314 104.76 956.772 Q102.955 953.207 99.3204 953.207 M99.3204 949.504 Q105.131 949.504 108.186 954.11 Q111.265 958.693 111.265 967.443 Q111.265 976.17 108.186 980.777 Q105.131 985.36 99.3204 985.36 Q93.5102 985.36 90.4315 980.777 Q87.376 976.17 87.376 967.443 Q87.376 958.693 90.4315 954.11 Q93.5102 949.504 99.3204 949.504 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M119.482 978.809 L124.367 978.809 L124.367 984.689 L119.482 984.689 L119.482 978.809 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M144.552 953.207 Q140.941 953.207 139.112 956.772 Q137.306 960.314 137.306 967.443 Q137.306 974.55 139.112 978.115 Q140.941 981.656 144.552 981.656 Q148.186 981.656 149.991 978.115 Q151.82 974.55 151.82 967.443 Q151.82 960.314 149.991 956.772 Q148.186 953.207 144.552 953.207 M144.552 949.504 Q150.362 949.504 153.417 954.11 Q156.496 958.693 156.496 967.443 Q156.496 976.17 153.417 980.777 Q150.362 985.36 144.552 985.36 Q138.741 985.36 135.663 980.777 Q132.607 976.17 132.607 967.443 Q132.607 958.693 135.663 954.11 Q138.741 949.504 144.552 949.504 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M94.3436 730.751 L110.663 730.751 L110.663 734.686 L88.7186 734.686 L88.7186 730.751 Q91.3806 727.996 95.9639 723.366 Q100.57 718.714 101.751 717.371 Q103.996 714.848 104.876 713.112 Q105.779 711.352 105.779 709.663 Q105.779 706.908 103.834 705.172 Q101.913 703.436 98.8111 703.436 Q96.6121 703.436 94.1584 704.2 Q91.7278 704.964 88.9501 706.515 L88.9501 701.792 Q91.7741 700.658 94.2278 700.079 Q96.6815 699.501 98.7185 699.501 Q104.089 699.501 107.283 702.186 Q110.478 704.871 110.478 709.362 Q110.478 711.491 109.668 713.413 Q108.881 715.311 106.774 717.903 Q106.195 718.575 103.094 721.792 Q99.9917 724.987 94.3436 730.751 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M120.478 728.806 L125.362 728.806 L125.362 734.686 L120.478 734.686 L120.478 728.806 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M135.593 700.126 L153.95 700.126 L153.95 704.061 L139.876 704.061 L139.876 712.533 Q140.894 712.186 141.913 712.024 Q142.931 711.839 143.95 711.839 Q149.737 711.839 153.116 715.01 Q156.496 718.181 156.496 723.598 Q156.496 729.176 153.024 732.278 Q149.552 735.357 143.232 735.357 Q141.056 735.357 138.788 734.987 Q136.542 734.616 134.135 733.876 L134.135 729.176 Q136.218 730.311 138.441 730.866 Q140.663 731.422 143.14 731.422 Q147.144 731.422 149.482 729.315 Q151.82 727.209 151.82 723.598 Q151.82 719.987 149.482 717.88 Q147.144 715.774 143.14 715.774 Q141.265 715.774 139.39 716.19 Q137.538 716.607 135.593 717.487 L135.593 700.126 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M89.3667 450.123 L107.723 450.123 L107.723 454.058 L93.6491 454.058 L93.6491 462.53 Q94.6676 462.183 95.6861 462.021 Q96.7047 461.836 97.7232 461.836 Q103.51 461.836 106.89 465.007 Q110.269 468.178 110.269 473.595 Q110.269 479.173 106.797 482.275 Q103.325 485.354 97.0056 485.354 Q94.8297 485.354 92.5612 484.984 Q90.3158 484.613 87.9084 483.873 L87.9084 479.173 Q89.9917 480.308 92.2139 480.863 Q94.4361 481.419 96.913 481.419 Q100.918 481.419 103.256 479.312 Q105.593 477.206 105.593 473.595 Q105.593 469.984 103.256 467.877 Q100.918 465.771 96.913 465.771 Q95.038 465.771 93.163 466.187 Q91.3112 466.604 89.3667 467.484 L89.3667 450.123 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M119.482 478.803 L124.367 478.803 L124.367 484.683 L119.482 484.683 L119.482 478.803 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M144.552 453.201 Q140.941 453.201 139.112 456.766 Q137.306 460.308 137.306 467.437 Q137.306 474.544 139.112 478.109 Q140.941 481.65 144.552 481.65 Q148.186 481.65 149.991 478.109 Q151.82 474.544 151.82 467.437 Q151.82 460.308 149.991 456.766 Q148.186 453.201 144.552 453.201 M144.552 449.498 Q150.362 449.498 153.417 454.104 Q156.496 458.687 156.496 467.437 Q156.496 476.164 153.417 480.771 Q150.362 485.354 144.552 485.354 Q138.741 485.354 135.663 480.771 Q132.607 476.164 132.607 467.437 Q132.607 458.687 135.663 454.104 Q138.741 449.498 144.552 449.498 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M89.1352 200.12 L111.357 200.12 L111.357 202.11 L98.8111 234.68 L93.9269 234.68 L105.732 204.055 L89.1352 204.055 L89.1352 200.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M120.478 228.8 L125.362 228.8 L125.362 234.68 L120.478 234.68 L120.478 228.8 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip660)" d="M135.593 200.12 L153.95 200.12 L153.95 204.055 L139.876 204.055 L139.876 212.527 Q140.894 212.18 141.913 212.018 Q142.931 211.833 143.95 211.833 Q149.737 211.833 153.116 215.004 Q156.496 218.175 156.496 223.592 Q156.496 229.171 153.024 232.272 Q149.552 235.351 143.232 235.351 Q141.056 235.351 138.788 234.981 Q136.542 234.61 134.135 233.87 L134.135 229.171 Q136.218 230.305 138.441 230.86 Q140.663 231.416 143.14 231.416 Q147.144 231.416 149.482 229.309 Q151.82 227.203 151.82 223.592 Q151.82 219.981 149.482 217.874 Q147.144 215.768 143.14 215.768 Q141.265 215.768 139.39 216.184 Q137.538 216.601 135.593 217.481 L135.593 200.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip662)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1199.72 268.292,1605.66 270.6,1536.76 272.908,1397.69 275.216,1357.33 277.524,1575.86 279.832,1573.49 282.139,1561.08 284.447,1526.95 286.755,1433.47 289.063,1449.16 291.371,1615.02 293.679,1621.53 295.987,1425.69 298.295,1609.09 300.603,1499.15 302.911,1341.74 305.219,1407.36 307.527,1514.8 309.834,1414.39 312.142,1657.58 314.45,1280.77 316.758,1532.57 319.066,1278.36 321.374,1506.96 323.682,1426.78 325.99,1522.42 328.298,1550.52 330.606,1662.01 332.914,1593.48 335.221,1351.15 337.529,1363.98 339.837,1481.97 342.145,1615.21 344.453,1344.72 346.761,1506.11 349.069,1564.03 351.377,1535.8 353.685,1485.49 355.993,1522.08 358.301,1203.99 360.608,1478.3 362.916,1455.71 365.224,1366.6 367.532,1409.93 369.84,1557 372.148,1467.3 374.456,1432.32 376.764,1355.05 379.072,1500.64 381.38,1494.14 383.688,1343.8 385.996,1361.41 388.303,1501.05 390.611,1562.25 392.919,1410.03 395.227,1518.05 397.535,1386.27 399.843,1370.77 402.151,1539.31 404.459,1420.65 406.767,1319.12 409.075,1508.19 411.383,1439.64 413.69,1474.53 415.998,1421.2 418.306,1489.55 420.614,1751.15 422.922,1670.48 425.23,1604.35 427.538,1558.35 429.846,1370.69 432.154,1444.54 434.462,1445.28 436.77,1435.19 439.077,1419.23 441.385,1536.08 443.693,1200.78 446.001,1493.11 448.309,1473.97 450.617,1306.96 452.925,1330.76 455.233,1564.9 457.541,1405.74 459.849,1433.18 462.157,1435.21 464.465,1559.16 466.772,1391.31 469.08,1228.82 471.388,1503.89 473.696,1451.09 476.004,1512.4 478.312,1613.24 480.62,1442.78 482.928,1529.11 485.236,1571.87 487.544,1448.24 489.852,1549.87 492.159,1523.07 494.467,1432.05 496.775,1472.42 499.083,1432.06 501.391,1543.61 503.699,1525.34 506.007,1436.13 508.315,1338.14 510.623,1507.34 512.931,1412.51 515.239,1619.96 517.546,1338.33 519.854,1494.47 522.162,1457.48 524.47,1513.43 526.778,1515.6 529.086,1409.69 531.394,1593.43 533.702,1322.99 536.01,1501.78 538.318,1536.98 540.626,1398 542.933,1512.75 545.241,1385.78 547.549,1543.75 549.857,1517.1 552.165,1431.27 554.473,1462.71 556.781,1465.28 559.089,1575.21 561.397,1360.62 563.705,1421.06 566.013,1563.42 568.321,1358.23 570.628,1459.12 572.936,1547.9 575.244,1267 577.552,1567 579.86,1356.84 582.168,1408.83 584.476,1432.13 586.784,1466.49 589.092,1475.61 591.4,1528.32 593.708,1460.48 596.015,1372.31 598.323,1547.54 600.631,1272.17 602.939,1632.08 605.247,1517.2 607.555,1382.89 609.863,1450.42 612.171,1578.82 614.479,1409.76 616.787,1505.1 619.095,1528.69 621.402,1386.2 623.71,1324.89 626.018,1462.78 628.326,1511.06 630.634,1387.1 632.942,1230.16 635.25,1536.07 637.558,1477.6 639.866,1423.16 642.174,1583.28 644.482,1448.42 646.79,1549.37 649.097,1438.05 651.405,1560.22 653.713,1271.4 656.021,1548.2 658.329,1484.43 660.637,1668.26 662.945,1387.83 665.253,1393.38 667.561,1523.18 669.869,1592.78 672.177,1456.31 674.484,1524.28 676.792,1521.9 679.1,1694.16 681.408,1587.08 683.716,1536.91 686.024,1574.52 688.332,1488.91 690.64,1537.7 692.948,1566.19 695.256,1628.76 697.564,1577.3 699.871,1410.89 702.179,1639.21 704.487,1438.55 706.795,1693.28 709.103,1409.13 711.411,1488.08 713.719,1408.19 716.027,1552.45 718.335,1640.47 720.643,1373.83 722.951,1412.93 725.259,1526.58 727.566,1410.22 729.874,1492.88 732.182,1455.52 734.49,1598.04 736.798,1457.36 739.106,1527.45 741.414,1491.88 743.722,1395.18 746.03,1421.45 748.338,1467.33 750.646,1395.46 752.953,1224.8 755.261,1445.89 757.569,1587.46 759.877,1384.17 762.185,1523.01 764.493,1272.14 766.801,1439.2 769.109,1634.1 771.417,1468.8 773.725,1504.74 776.033,1516.57 778.34,1481.17 780.648,1472.72 782.956,1542.65 785.264,1390.15 787.572,1519.58 789.88,1556.81 792.188,1483.12 794.496,1662.9 796.804,1474.73 799.112,1458.58 801.42,1556.9 803.728,1518.59 806.035,1507.65 808.343,1664.47 810.651,1502.01 812.959,1476.04 815.267,1513.88 817.575,1483.21 819.883,1532.38 822.191,1484.05 824.499,1589.7 826.807,1370.46 829.115,1448.88 831.422,1477.38 833.73,1463.93 836.038,1430.47 838.346,1460.92 840.654,1495.89 842.962,1408.28 845.27,1404.98 847.578,1481.29 849.886,1612.11 852.194,1528.98 854.502,1614.52 856.809,1402.37 859.117,1285.26 861.425,1545.7 863.733,1511.54 866.041,1388.61 868.349,1430.05 870.657,1308.11 872.965,1550.49 875.273,1536.06 877.581,1432.01 879.889,1490.46 882.197,1584.55 884.504,1492.15 886.812,1384.75 889.12,1442.63 891.428,1597.29 893.736,1445.13 896.044,1454.13 898.352,1534.47 900.66,1580.94 902.968,1479.44 905.276,1429.41 907.584,1418.25 909.891,1563.83 912.199,1393.08 914.507,1372.56 916.815,1262.65 919.123,1558.96 921.431,1258.05 923.739,1551.95 926.047,1426.51 928.355,1341.85 930.663,1411.51 932.971,1345.07 935.278,1346.51 937.586,1423.32 939.894,1467.06 942.202,1513.85 944.51,1565.81 946.818,1553.37 949.126,1449.38 951.434,1566.41 953.742,1542.99 956.05,1500.32 958.358,1449.33 960.665,1524.69 962.973,1324.9 965.281,1461.08 967.589,1498.14 969.897,1305.07 972.205,1520.63 974.513,1362.13 976.821,1400.2 979.129,1632.65 981.437,1503.63 983.745,1389.35 986.053,1318.5 988.36,1434.65 990.668,1530.7 992.976,1393.24 995.284,1637.29 997.592,1355.35 999.9,1557.4 1002.21,1508.55 1004.52,1489.82 1006.82,1460.66 1009.13,1390.61 1011.44,1347.8 1013.75,1477.63 1016.06,1328.87 1018.36,1303.71 1020.67,1515.52 1022.98,1568.44 1025.29,1480.35 1027.59,1454.44 1029.9,1540.56 1032.21,1559.51 1034.52,1429.34 1036.83,1431.74 1039.13,1453.5 1041.44,1379.76 1043.75,1313.94 1046.06,1479.77 1048.37,1582.49 1050.67,1566.73 1052.98,1502.07 1055.29,1508.72 1057.6,1461.64 1059.91,1143.23 1062.21,1526.54 1064.52,1373.39 1066.83,1385.77 1069.14,1569.09 1071.45,1417.38 1073.75,1396.78 1076.06,1540.47 1078.37,1523.95 1080.68,1496.33 1082.98,1383.88 1085.29,1691.48 1087.6,1409.99 1089.91,1597.85 1092.22,1391.85 1094.52,1423.31 1096.83,1457.91 1099.14,1562.39 1101.45,1483.52 1103.76,1281.32 1106.06,1321.3 1108.37,1548.4 1110.68,1528.45 1112.99,1344.68 1115.3,1482.66 1117.6,1482.29 1119.91,1343.47 1122.22,1579.8 1124.53,1341.84 1126.84,1369 1129.14,1285.06 1131.45,1534.07 1133.76,1324.37 1136.07,1574.27 1138.37,1516.59 1140.68,1403.5 1142.99,1408.91 1145.3,1387.74 1147.61,1356.21 1149.91,1478.29 1152.22,1350.11 1154.53,1435.77 1156.84,1555.89 1159.15,1455.34 1161.45,1454.52 1163.76,1433.83 1166.07,1677.74 1168.38,1563.14 1170.69,1510.26 1172.99,1474.57 1175.3,1478.28 1177.61,1384.87 1179.92,1323.8 1182.23,1473.19 1184.53,1592.78 1186.84,1749.4 1189.15,1402.67 1191.46,1562.77 1193.76,1257.59 1196.07,1503.56 1198.38,1550.29 1200.69,1501.66 1203,1597.71 1205.3,1489.95 1207.61,1470.91 1209.92,1408.58 1212.23,1412.35 1214.54,1547.29 1216.84,1510.31 1219.15,1437.38 1221.46,1482.73 1223.77,1439.74 1226.08,1536.2 1228.38,1460.08 1230.69,1477.91 1233,1479.38 1235.31,1508.38 1237.61,1534.47 1239.92,1415.86 1242.23,1579.43 1244.54,1435.29 1246.85,1558.69 1249.15,1476.73 1251.46,1479.89 1253.77,1319.35 1256.08,1528.8 1258.39,1374.85 1260.69,1577.74 1263,1585.19 1265.31,1408.17 1267.62,1536.92 1269.93,1457.85 1272.23,1482.01 1274.54,1601.93 1276.85,1575.87 1279.16,1453.05 1281.47,1577.51 1283.77,1624 1286.08,1408.01 1288.39,1502.86 1290.7,1617.89 1293,1509.96 1295.31,1441.75 1297.62,1430.34 1299.93,1605.06 1302.24,1481.8 1304.54,1575.74 1306.85,1541.87 1309.16,1493.18 1311.47,1531.28 1313.78,1276.57 1316.08,1425.31 1318.39,1609.11 1320.7,1406.62 1323.01,1560.4 1325.32,1396.01 1327.62,1547.98 1329.93,1362.43 1332.24,1447.66 1334.55,1370.04 1336.86,1446.07 1339.16,1599.8 1341.47,1514.28 1343.78,1450.32 1346.09,1373.1 1348.39,1678.09 1350.7,1700.5 1353.01,1337.94 1355.32,1336.62 1357.63,1464.49 1359.93,1499.66 1362.24,1330.29 1364.55,1494.75 1366.86,1490.83 1369.17,1478.79 1371.47,1532.61 1373.78,1508.91 1376.09,1210.08 1378.4,1555.67 1380.71,1367.53 1383.01,1438.73 1385.32,1461.59 1387.63,1551.07 1389.94,1454.16 1392.24,1429.84 1394.55,1386.02 1396.86,1597.26 1399.17,1441.71 1401.48,1557.64 1403.78,1473.02 1406.09,1432.18 1408.4,1508.04 1410.71,1419.43 1413.02,1503.79 1415.32,1652.34 1417.63,1484.04 1419.94,1280.6 1422.25,1308.4 1424.56,1593.43 1426.86,1424.81 1429.17,1244.86 1431.48,1628.17 1433.79,1613.89 1436.1,1395.52 1438.4,1400.41 1440.71,1546.48 1443.02,1528.93 1445.33,1412.03 1447.63,1370.96 1449.94,1455.32 1452.25,1464.07 1454.56,1435.22 1456.87,1448.65 1459.17,1475.47 1461.48,1402.17 1463.79,1323.41 1466.1,1551.73 1468.41,1421.13 1470.71,1294.23 1473.02,1507.28 1475.33,1499.18 1477.64,1330.13 1479.95,1390.2 1482.25,1444.88 1484.56,1516.01 1486.87,1581.93 1489.18,1301.73 1491.49,1509.02 1493.79,1460.59 1496.1,1598.3 1498.41,1473.62 1500.72,1403.11 1503.02,1358.1 1505.33,1431.98 1507.64,1492.27 1509.95,1404.23 1512.26,1390.73 1514.56,1460.74 1516.87,1408.06 1519.18,1549.73 1521.49,1434.2 1523.8,1423.01 1526.1,1407.79 1528.41,1619.97 1530.72,1602.56 1533.03,1389.75 1535.34,1567.08 1537.64,1647.77 1539.95,1256.83 1542.26,1471.63 1544.57,1566.37 1546.88,1611.42 1549.18,1688.08 1551.49,1647.41 1553.8,1588.33 1556.11,1504.06 1558.41,1383.84 1560.72,1461.68 1563.03,1418.6 1565.34,1488.05 1567.65,1437.41 1569.95,1411.4 1572.26,1365.13 1574.57,1408.58 1576.88,1541.35 1579.19,1379.22 1581.49,1380.35 1583.8,1456.27 1586.11,1561.87 1588.42,1388.34 1590.73,1363.5 1593.03,1546.29 1595.34,1370.77 1597.65,1381.72 1599.96,1395.12 1602.26,1545.87 1604.57,1488.17 1606.88,1527.06 1609.19,1450.09 1611.5,1589.74 1613.8,1384.64 1616.11,1454.04 1618.42,1408.34 1620.73,1489.7 1623.04,1434.96 1625.34,1460.15 1627.65,1357.42 1629.96,1573.7 1632.27,1470.78 1634.58,1500.1 1636.88,1485.46 1639.19,1485.46 1641.5,1555.68 1643.81,1223.15 1646.12,1520.17 1648.42,1390.52 1650.73,1391.79 1653.04,1409.4 1655.35,1415.51 1657.65,1554.62 1659.96,1625.15 1662.27,1386.5 1664.58,1468.2 1666.89,1553.02 1669.19,1235.8 1671.5,1471.98 1673.81,1516.26 1676.12,1560.05 1678.43,1355.72 1680.73,1441.07 1683.04,1369.28 1685.35,1485.34 1687.66,1393.61 1689.97,1427.09 1692.27,1493.8 1694.58,1266.48 1696.89,1493.83 1699.2,1353.52 1701.51,1575.22 1703.81,1420.94 1706.12,1482.7 1708.43,1407.92 1710.74,1453 1713.04,1522.22 1715.35,1526.33 1717.66,1405.79 1719.97,1596.66 1722.28,1402.88 1724.58,1242.02 1726.89,1422.67 1729.2,1391.33 1731.51,1649.47 1733.82,1597.59 1736.12,1463.92 1738.43,1540.72 1740.74,1443.76 1743.05,1452.37 1745.36,1463.31 1747.66,1330.59 1749.97,1664.18 1752.28,1446.84 1754.59,1435.4 1756.9,1429.21 1759.2,1572.63 1761.51,1504.82 1763.82,1290.28 1766.13,1446.9 1768.43,1508.72 1770.74,1337.52 1773.05,1526.65 1775.36,1602.56 1777.67,1341.63 1779.97,1462.75 1782.28,1353.3 1784.59,1399.03 1786.9,1523.69 1789.21,1444.11 1791.51,1496.68 1793.82,1580.14 1796.13,1257.77 1798.44,1461.57 1800.75,1464.78 1803.05,1487.61 1805.36,1417.68 1807.67,1585.59 1809.98,1616.71 1812.28,1428.1 1814.59,1470.26 1816.9,1549.97 1819.21,1383.76 1821.52,1445.94 1823.82,1324.11 1826.13,1402.1 1828.44,1482.2 1830.75,1348.69 1833.06,1365.52 1835.36,1324.61 1837.67,1651.89 1839.98,1445.72 1842.29,1447.56 1844.6,1329.48 1846.9,1363.39 1849.21,1362.87 1851.52,1493.86 1853.83,1307.95 1856.14,1406.15 1858.44,1160.41 1860.75,1744.98 1863.06,1439.25 1865.37,1642.83 1867.67,1557.44 1869.98,1600.6 1872.29,1638.41 1874.6,1406.57 1876.91,1564.06 1879.21,1383.25 1881.52,1423.81 1883.83,1512.15 1886.14,1605.24 1888.45,1367.71 1890.75,1637.85 1893.06,1297.03 1895.37,1556.27 1897.68,1371.86 1899.99,1449.9 1902.29,1696.19 1904.6,1522.21 1906.91,1358.44 1909.22,1443.6 1911.53,1219.73 1913.83,1674.15 1916.14,1426.73 1918.45,1353.15 1920.76,1306.49 1923.06,1412.02 1925.37,1400.34 1927.68,1319.58 1929.99,1320.47 1932.3,1407.14 1934.6,1344.26 1936.91,1504 1939.22,1700.55 1941.53,1514.63 1943.84,1535.82 1946.14,1522.35 1948.45,1466.4 1950.76,1499.36 1953.07,1360.94 1955.38,1506.29 1957.68,1469.57 1959.99,1582.53 1962.3,1523.33 1964.61,1441.81 1966.91,1591.71 1969.22,1534.53 1971.53,1418.52 1973.84,1663 1976.15,1599.75 1978.45,1585.22 1980.76,1540.85 1983.07,1374.57 1985.38,1404.49 1987.69,1463.72 1989.99,1263.96 1992.3,1511.96 1994.61,1450.85 1996.92,1449.22 1999.23,1430.07 2001.53,1522.24 2003.84,1535.49 2006.15,1455.29 2008.46,1336.34 2010.77,1460.84 2013.07,1428.72 2015.38,1502.33 2017.69,1510.91 2020,1460.61 2022.3,1374.08 2024.61,1411.02 2026.92,1558.93 2029.23,1442.5 2031.54,1585.08 2033.84,1618.73 2036.15,1410.87 2038.46,1382.04 2040.77,1545.95 2043.08,1258.54 2045.38,1350.6 2047.69,1448.37 2050,1462.19 2052.31,1423.91 2054.62,1429.98 2056.92,1467.7 2059.23,1608.9 2061.54,1455.31 2063.85,1368.23 2066.16,1454.75 2068.46,1380.03 2070.77,1402.54 2073.08,1421.34 2075.39,1419.66 2077.69,1465.74 2080,1502.76 2082.31,1527.14 2084.62,1560.11 2086.93,1470.85 2089.23,1332.65 2091.54,1627.75 2093.85,1417.3 2096.16,1446.79 2098.47,1628.59 2100.77,1460.52 2103.08,1335.88 2105.39,1460.67 2107.7,1603.82 2110.01,1524.36 2112.31,1529.91 2114.62,1433.09 2116.93,1546.27 2119.24,1544.82 2121.55,1429.34 2123.85,1743.66 2126.16,1416.22 2128.47,1499.68 2130.78,1398.21 2133.08,1477.68 2135.39,1455.91 2137.7,1236 2140.01,1573.5 2142.32,1572.7 2144.62,1364.88 2146.93,1444.82 2149.24,1466.21 2151.55,1388.4 2153.86,1416.35 2156.16,1347.35 2158.47,1425.35 2160.78,1534.58 2163.09,1430.22 2165.4,1696.48 2167.7,1421.15 2170.01,1658.4 2172.32,1584.3 2174.63,1352.51 2176.93,1435.77 2179.24,1619.11 2181.55,1504.09 2183.86,1679.72 2186.17,1630.62 2188.47,1395.99 2190.78,1256.92 2193.09,1468.25 2195.4,1314.97 2197.71,1483.32 2200.01,1313.78 2202.32,1511.31 2204.63,1396.42 2206.94,1321.69 2209.25,1403.38 2211.55,1296.12 2213.86,1411.21 2216.17,1489.49 2218.48,1401.04 2220.79,1500.37 2223.09,1516.29 2225.4,1631.61 2227.71,1612.63 2230.02,1550.08 2232.32,1641.2 2234.63,1413.02 2236.94,1610.45 2239.25,1566.55 2241.56,1502.2 2243.86,1372.23 2246.17,1320.87 2248.48,1313.85 2250.79,1712.65 2253.1,1663.08 2255.4,1513.01 2257.71,1237.56 2260.02,1584.07 2262.33,1462.25 2264.64,1320.52 2266.94,1398.29 2269.25,1297.96 2271.56,1513.65 2273.87,1596.37 2276.18,1528.56 2278.48,1412.72 2280.79,1283.08 2283.1,1543.53 2285.41,1297.98 2287.71,1384.13 2290.02,1407.87 2292.33,1565.06 2294.64,1474.02 2296.95,1593.03 2299.25,1575.66 2301.56,1472.49 2303.87,1389.81 2306.18,1432.12 2308.49,1394.85 2310.79,1553.31 2313.1,1320.15 2315.41,1621.77 2317.72,1457.05 2320.03,1533.98 2322.33,1386.91 2324.64,1492.51 2326.95,1455.74 2329.26,1623.64 2331.56,1567.94 2333.87,1548.86 2336.18,1368.87 2338.49,1431.53 2340.8,1385.3 2343.1,1362.37 2345.41,1410.93 2347.72,1275.15 2350.03,1506.24 2352.34,1271.26 2354.64,1561.93 2356.95,1461.66 2359.26,1401.07 2361.57,1307.04 2363.88,1462.43 2366.18,1477.01 2368.49,1598.44 2370.8,1640.77 2373.11,1464.69 2375.42,1375.02 2377.72,1453.75 2380.03,1437.32 2382.34,1399.18 2384.65,1299.35 2386.95,1640.87 2389.26,1466.33 2391.57,1440.63 2393.88,1385.44 2396.19,1559.75 2398.49,1430.42 2400.8,1415.45 2403.11,1392.44 2405.42,1512.78 2407.73,1468.99 2410.03,1518.18 2412.34,1477.67 2414.65,1533.27 2416.96,1548.87 2419.27,1467.81 2421.57,1404.86 2423.88,1473.38 2426.19,1545.69 2428.5,1504.53 2430.81,1463.57 2433.11,1389.68 2435.42,1489.68 2437.73,1587.66 2440.04,1418.7 2442.34,1671.8 2444.65,1288.19 2446.96,1293.56 2449.27,1445.42 2451.58,1638.75 2453.88,1458.66 2456.19,1482.21 2458.5,1353.03 2460.81,1374.97 2463.12,1324.9 2465.42,1436.62 2467.73,1242.76 2470.04,1357.11 2472.35,1374.26 2474.66,1531.92 2476.96,1638.88 2479.27,1370.1 2481.58,1610.27 2483.89,1500.2 2486.2,1469.7 2488.5,1525.68 2490.81,1424.22 2493.12,1587.39 2495.43,1316.67 2497.73,1558.88 2500.04,1534.63 2502.35,1450.68 2504.66,1279.19 2506.97,1506.36 2509.27,1516.05 2511.58,1505.44 2513.89,1558.83 2516.2,1480.46 2518.51,1475.71 2520.81,1563.15 2523.12,1518.41 2525.43,1326.41 2527.74,1509.26 2530.05,1519.81 2532.35,1585.37 2534.66,1417.62 2536.97,1494.73 2539.28,1442.48 2541.58,1663.91 2543.89,1456.71 2546.2,1324.2 2548.51,1351.1 2550.82,1615.23 2553.12,1479.61 2555.43,1258.25 2557.74,1458.79 2560.05,1315.33 2562.36,1440.08 2564.66,1390.99 2566.97,1588.31 2569.28,1466.84 2571.59,1442.59 "></polyline>
<polyline clip-path="url(#clip662)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,951.899 268.292,869.02 270.6,874.895 272.908,959.327 275.216,1068.23 277.524,855.868 279.832,1072.29 282.139,929.635 284.447,1032.73 286.755,887.941 289.063,913.906 291.371,915.133 293.679,890.177 295.987,949.655 298.295,830.689 300.603,1175.95 302.911,835.866 305.219,1119.96 307.527,763.099 309.834,1063.6 312.142,1042.43 314.45,1290.53 316.758,948.612 319.066,1049.53 321.374,949.197 323.682,937.664 325.99,912.384 328.298,1010.2 330.606,1077.02 332.914,923.831 335.221,1279.6 337.529,961.322 339.837,844.197 342.145,854.144 344.453,1012.93 346.761,998.29 349.069,929.748 351.377,956.901 353.685,767.019 355.993,1036.32 358.301,765.5 360.608,1165.1 362.916,1105.14 365.224,796.759 367.532,1064.91 369.84,955.033 372.148,982.039 374.456,796.381 376.764,925.57 379.072,899.834 381.38,1153.91 383.688,922.046 385.996,883.387 388.303,1124.72 390.611,841.241 392.919,835.49 395.227,1076.11 397.535,783.758 399.843,1020.19 402.151,881.321 404.459,994.98 406.767,857.425 409.075,1073.55 411.383,963.039 413.69,975.438 415.998,1003.35 418.306,1014.98 420.614,964.117 422.922,1006.89 425.23,864.884 427.538,932.629 429.846,1011.09 432.154,797.516 434.462,923.812 436.77,1027.11 439.077,992.851 441.385,800.35 443.693,672.88 446.001,1085.56 448.309,1068.22 450.617,1065.28 452.925,917.272 455.233,871.47 457.541,944.616 459.849,986.791 462.157,1062.67 464.465,932.032 466.772,1014.23 469.08,920.683 471.388,981.933 473.696,1018.43 476.004,863.314 478.312,1102.54 480.62,856.599 482.928,917.679 485.236,845.944 487.544,834.55 489.852,972.935 492.159,1047.25 494.467,958.543 496.775,972.299 499.083,948.454 501.391,939.43 503.699,1110.97 506.007,865.241 508.315,874.786 510.623,1071.42 512.931,938.576 515.239,1043.04 517.546,798.318 519.854,920.873 522.162,858.187 524.47,1038.52 526.778,1035.22 529.086,1094.43 531.394,1106.68 533.702,990.935 536.01,1103.46 538.318,1200.19 540.626,1125.91 542.933,840.343 545.241,981.566 547.549,1140.59 549.857,883.406 552.165,1018.33 554.473,954.796 556.781,989.238 559.089,867.926 561.397,970.811 563.705,855.329 566.013,810.236 568.321,885.076 570.628,995.011 572.936,988.264 575.244,932.482 577.552,886.062 579.86,1066.03 582.168,927.699 584.476,1060.67 586.784,1011.76 589.092,1036 591.4,1035.27 593.708,872.321 596.015,1026.93 598.323,948.042 600.631,923.187 602.939,846.7 605.247,897.431 607.555,737.726 609.863,850.001 612.171,960.831 614.479,971.384 616.787,1089.08 619.095,934.793 621.402,1045.06 623.71,993.83 626.018,863.078 628.326,1066.21 630.634,1078.84 632.942,917.087 635.25,1049.14 637.558,1191.41 639.866,964.143 642.174,924.297 644.482,941.259 646.79,916.958 649.097,1066.78 651.405,958.734 653.713,923.646 656.021,1015.09 658.329,1029.09 660.637,949.795 662.945,903.594 665.253,957.209 667.561,858.217 669.869,830.052 672.177,1035.25 674.484,945.427 676.792,1027.94 679.1,798.9 681.408,730.152 683.716,975.129 686.024,949.845 688.332,955.434 690.64,801.307 692.948,875.439 695.256,1059.63 697.564,1190.47 699.871,1255.95 702.179,1014.72 704.487,974.8 706.795,1106.09 709.103,899.72 711.411,1112.96 713.719,1068.14 716.027,1017.47 718.335,944.47 720.643,853.776 722.951,935.26 725.259,1000.3 727.566,1066.6 729.874,1011.47 732.182,974.499 734.49,1197.45 736.798,1055.83 739.106,1005.92 741.414,977.787 743.722,1051.03 746.03,1104.25 748.338,984.594 750.646,1079.65 752.953,1129.35 755.261,908.814 757.569,1128.3 759.877,1033.53 762.185,880.19 764.493,911.432 766.801,760.497 769.109,985.382 771.417,967.2 773.725,1113.94 776.033,932.392 778.34,854.777 780.648,1010.76 782.956,916.475 785.264,1017.39 787.572,1139.23 789.88,893.44 792.188,1177.14 794.496,1010.99 796.804,1175.61 799.112,854.721 801.42,996.865 803.728,883.677 806.035,884.722 808.343,917.472 810.651,829.479 812.959,807.061 815.267,754.377 817.575,855.905 819.883,1045.96 822.191,795.258 824.499,871.645 826.807,819.679 829.115,1035.79 831.422,1131.56 833.73,986.947 836.038,1013.06 838.346,1015.73 840.654,962.478 842.962,1040.09 845.27,930.926 847.578,1073.37 849.886,1135.59 852.194,1050.04 854.502,1144.48 856.809,734.737 859.117,1080.86 861.425,933.618 863.733,1035.81 866.041,960.898 868.349,1145.46 870.657,917.287 872.965,1112.61 875.273,875.49 877.581,800.57 879.889,985.668 882.197,962.767 884.504,969.822 886.812,948.132 889.12,1071.06 891.428,826.117 893.736,805.452 896.044,1018.91 898.352,919.039 900.66,1046.51 902.968,940.581 905.276,809.248 907.584,857.279 909.891,861.696 912.199,1004.59 914.507,812.19 916.815,1052.14 919.123,1043.15 921.431,804.872 923.739,822.329 926.047,992.578 928.355,841.441 930.663,868.353 932.971,980.775 935.278,927.673 937.586,954.496 939.894,922.627 942.202,944.318 944.51,910.058 946.818,1123.25 949.126,919.415 951.434,1032.33 953.742,860.151 956.05,1062.36 958.358,974.611 960.665,906.563 962.973,983.163 965.281,770.341 967.589,1230.51 969.897,1065.72 972.205,790.158 974.513,836.595 976.821,880.546 979.129,1156.9 981.437,1124.29 983.745,924.933 986.053,886.063 988.36,1008.92 990.668,905.31 992.976,1001.16 995.284,1062.63 997.592,1037.29 999.9,1111.79 1002.21,1092.47 1004.52,864.815 1006.82,979.689 1009.13,1064.77 1011.44,1001.08 1013.75,930.395 1016.06,1117.34 1018.36,890.099 1020.67,938.57 1022.98,1127.75 1025.29,908.219 1027.59,784.816 1029.9,1074.68 1032.21,1163.39 1034.52,850.569 1036.83,926.716 1039.13,1030.23 1041.44,883.659 1043.75,1029.97 1046.06,982.978 1048.37,683.806 1050.67,972.972 1052.98,1039.06 1055.29,798.237 1057.6,957.087 1059.91,1081.91 1062.21,919.264 1064.52,1164.08 1066.83,801.543 1069.14,873.619 1071.45,1034.53 1073.75,1195.77 1076.06,858.144 1078.37,925.473 1080.68,910.735 1082.98,1064.57 1085.29,897.956 1087.6,935.468 1089.91,578.508 1092.22,1064.12 1094.52,813.694 1096.83,1105.3 1099.14,1027.1 1101.45,1069.29 1103.76,1049.5 1106.06,1055.61 1108.37,891.07 1110.68,873.974 1112.99,937.242 1115.3,962.488 1117.6,879.44 1119.91,862.419 1122.22,918.491 1124.53,979.934 1126.84,863.395 1129.14,1076 1131.45,1080.8 1133.76,1009.5 1136.07,970.733 1138.37,1035.77 1140.68,961.322 1142.99,871.888 1145.3,950.759 1147.61,916.609 1149.91,974.431 1152.22,997.958 1154.53,939.061 1156.84,913.683 1159.15,940.754 1161.45,881.987 1163.76,780.947 1166.07,874.563 1168.38,942.077 1170.69,942.077 1172.99,886.747 1175.3,823.567 1177.61,1167.67 1179.92,1006.71 1182.23,1042.52 1184.53,924.022 1186.84,1065.15 1189.15,1016.88 1191.46,1056.97 1193.76,914.397 1196.07,818.802 1198.38,980.338 1200.69,1043.66 1203,1096.88 1205.3,992.829 1207.61,672.115 1209.92,928.528 1212.23,831.637 1214.54,895.808 1216.84,1047.06 1219.15,954.401 1221.46,1053.17 1223.77,925.937 1226.08,1046.56 1228.38,1087.67 1230.69,729.332 1233,997.374 1235.31,896.901 1237.61,919.793 1239.92,1073.4 1242.23,849.677 1244.54,776.797 1246.85,1002.33 1249.15,998.576 1251.46,887.678 1253.77,942.651 1256.08,1020.96 1258.39,999.656 1260.69,1094.54 1263,902.804 1265.31,1009.21 1267.62,869.074 1269.93,1022.19 1272.23,947.222 1274.54,989.161 1276.85,1015.69 1279.16,845.506 1281.47,944.731 1283.77,986.506 1286.08,949.29 1288.39,1102.63 1290.7,859.847 1293,978.642 1295.31,991.493 1297.62,1026.73 1299.93,846.297 1302.24,864.261 1304.54,905.264 1306.85,881.93 1309.16,994.812 1311.47,979.921 1313.78,953.779 1316.08,1005.32 1318.39,990.08 1320.7,921.849 1323.01,1124.24 1325.32,955.27 1327.62,1106.94 1329.93,1003.71 1332.24,932.201 1334.55,797.198 1336.86,879.595 1339.16,817.586 1341.47,889.205 1343.78,946.153 1346.09,1085.49 1348.39,1093.8 1350.7,824.255 1353.01,1008.6 1355.32,868.988 1357.63,862.249 1359.93,1012.02 1362.24,897.114 1364.55,1039.45 1366.86,851.98 1369.17,946.77 1371.47,917.289 1373.78,1009.04 1376.09,1114.68 1378.4,766.693 1380.71,1007.08 1383.01,944.8 1385.32,848.95 1387.63,873.326 1389.94,870.947 1392.24,1164.02 1394.55,860.738 1396.86,954.183 1399.17,816.732 1401.48,830.331 1403.78,892.452 1406.09,1093.33 1408.4,1118.75 1410.71,836.069 1413.02,1019.03 1415.32,940.384 1417.63,823.438 1419.94,1119.46 1422.25,915.577 1424.56,1004 1426.86,874.121 1429.17,961.441 1431.48,1063.9 1433.79,915.721 1436.1,917.096 1438.4,1051.31 1440.71,1041.46 1443.02,1028.46 1445.33,1011.76 1447.63,914.906 1449.94,968.349 1452.25,1126.71 1454.56,990.717 1456.87,943.92 1459.17,949.276 1461.48,840.751 1463.79,1064.71 1466.1,868.23 1468.41,968.392 1470.71,1027.82 1473.02,910.222 1475.33,948.597 1477.64,1039.3 1479.95,773.487 1482.25,1271.8 1484.56,991.898 1486.87,859.217 1489.18,1077.77 1491.49,853.365 1493.79,973.26 1496.1,1094.67 1498.41,853.206 1500.72,1004.8 1503.02,928.108 1505.33,893.104 1507.64,932.718 1509.95,899.974 1512.26,1124.97 1514.56,932.865 1516.87,1030.39 1519.18,920.203 1521.49,841.636 1523.8,832.691 1526.1,680.988 1528.41,1091.97 1530.72,1100.78 1533.03,1017.92 1535.34,954.306 1537.64,785.45 1539.95,980.925 1542.26,1011.05 1544.57,1055.53 1546.88,925.561 1549.18,862.575 1551.49,943.376 1553.8,923.318 1556.11,1136.99 1558.41,878.775 1560.72,960.317 1563.03,985.163 1565.34,928.9 1567.65,1013.07 1569.95,758.608 1572.26,1036.4 1574.57,1121.25 1576.88,957.494 1579.19,1078.73 1581.49,878.485 1583.8,880.092 1586.11,1099.2 1588.42,1063.83 1590.73,921.348 1593.03,945.837 1595.34,809.556 1597.65,822.407 1599.96,928.846 1602.26,961.938 1604.57,881.284 1606.88,934.101 1609.19,919.37 1611.5,884.048 1613.8,872.606 1616.11,826.105 1618.42,1040.96 1620.73,941.781 1623.04,1200.4 1625.34,982.452 1627.65,927.824 1629.96,918.359 1632.27,808.564 1634.58,984.53 1636.88,1080.02 1639.19,683.092 1641.5,965.446 1643.81,1033.3 1646.12,1233.91 1648.42,741.362 1650.73,923.606 1653.04,1087.48 1655.35,1011.72 1657.65,901.119 1659.96,879.95 1662.27,827.946 1664.58,903.406 1666.89,1193.39 1669.19,1126.72 1671.5,794.514 1673.81,839.455 1676.12,994.346 1678.43,937.742 1680.73,914.587 1683.04,1182.97 1685.35,836.684 1687.66,976.917 1689.97,1009.12 1692.27,913.326 1694.58,1026.83 1696.89,1111.31 1699.2,1043.75 1701.51,1061.26 1703.81,909.146 1706.12,872.239 1708.43,907.547 1710.74,991.05 1713.04,998.118 1715.35,990.771 1717.66,760.512 1719.97,1175.08 1722.28,855.277 1724.58,1027.32 1726.89,892.442 1729.2,969.122 1731.51,1103.22 1733.82,948.562 1736.12,999.559 1738.43,882.984 1740.74,1024.45 1743.05,1049.97 1745.36,908.42 1747.66,906.029 1749.97,1002.55 1752.28,879.407 1754.59,1072.24 1756.9,1048.14 1759.2,940.45 1761.51,903.145 1763.82,1115.78 1766.13,943.599 1768.43,978.167 1770.74,982.676 1773.05,1130.9 1775.36,971.656 1777.67,908.212 1779.97,1037.96 1782.28,1092.29 1784.59,927.251 1786.9,902.346 1789.21,986.134 1791.51,980.314 1793.82,810.972 1796.13,1036.63 1798.44,953.3 1800.75,1040.61 1803.05,945.795 1805.36,1068.75 1807.67,923.104 1809.98,917.708 1812.28,1069.01 1814.59,965.427 1816.9,1146.6 1819.21,1162.47 1821.52,940.94 1823.82,910.177 1826.13,1033.66 1828.44,1176.82 1830.75,966.158 1833.06,897.899 1835.36,982.918 1837.67,1039.47 1839.98,947.132 1842.29,1078.83 1844.6,887.899 1846.9,933.6 1849.21,978.116 1851.52,1027.87 1853.83,985.373 1856.14,1157.09 1858.44,1077.31 1860.75,892.008 1863.06,948.35 1865.37,983.809 1867.67,780.695 1869.98,897.966 1872.29,918.497 1874.6,908.532 1876.91,1047.36 1879.21,1043.33 1881.52,908.753 1883.83,874.762 1886.14,852.047 1888.45,1245.13 1890.75,949.309 1893.06,1144.9 1895.37,1083.04 1897.68,924.79 1899.99,876.018 1902.29,1052.44 1904.6,1015.25 1906.91,1053.22 1909.22,879.324 1911.53,801.233 1913.83,901.543 1916.14,962.488 1918.45,968.865 1920.76,945.877 1923.06,1115.25 1925.37,890.437 1927.68,872.61 1929.99,1026.02 1932.3,973.708 1934.6,972.366 1936.91,915.998 1939.22,920.501 1941.53,898.951 1943.84,1048.32 1946.14,889.515 1948.45,975.797 1950.76,993.499 1953.07,804.974 1955.38,940.694 1957.68,1022.81 1959.99,906.282 1962.3,934.695 1964.61,994.296 1966.91,779.124 1969.22,1000.38 1971.53,1072.69 1973.84,986.225 1976.15,800.16 1978.45,857.885 1980.76,732.548 1983.07,829.316 1985.38,1083.1 1987.69,890.613 1989.99,1027.94 1992.3,915.277 1994.61,981.456 1996.92,1147.9 1999.23,1203.08 2001.53,1046.24 2003.84,1129.29 2006.15,844.905 2008.46,968.123 2010.77,1085.91 2013.07,1019.94 2015.38,952.612 2017.69,777.342 2020,902.272 2022.3,769.329 2024.61,1028.78 2026.92,843.768 2029.23,1151.37 2031.54,987.364 2033.84,895.184 2036.15,1039.96 2038.46,950.408 2040.77,796.607 2043.08,942.381 2045.38,923.9 2047.69,1133.73 2050,1002.74 2052.31,1158.88 2054.62,1044.74 2056.92,864.894 2059.23,941.856 2061.54,1042.87 2063.85,773.741 2066.16,1034.42 2068.46,949.399 2070.77,951.621 2073.08,911.631 2075.39,1060.36 2077.69,1096.49 2080,737.341 2082.31,868.856 2084.62,1004.45 2086.93,903.558 2089.23,966.72 2091.54,994.322 2093.85,862.122 2096.16,897.667 2098.47,790.931 2100.77,1148.95 2103.08,1045.64 2105.39,906.322 2107.7,1039.53 2110.01,892.029 2112.31,852.62 2114.62,971.388 2116.93,768.785 2119.24,1075.12 2121.55,731.14 2123.85,924.784 2126.16,945.781 2128.47,1066.98 2130.78,1009.6 2133.08,1077.19 2135.39,838.915 2137.7,894.867 2140.01,979.285 2142.32,921.724 2144.62,895.267 2146.93,1142.33 2149.24,870.017 2151.55,857.174 2153.86,1095.71 2156.16,1002.81 2158.47,849.803 2160.78,1005.58 2163.09,1020.15 2165.4,1021.6 2167.7,952.858 2170.01,975.125 2172.32,949.433 2174.63,1157.99 2176.93,863.207 2179.24,1097.35 2181.55,928.156 2183.86,1135.2 2186.17,889.33 2188.47,914.964 2190.78,1107.88 2193.09,982.202 2195.4,1147.13 2197.71,1053.42 2200.01,965.834 2202.32,1132.87 2204.63,987.898 2206.94,959.825 2209.25,840.405 2211.55,999.287 2213.86,926.778 2216.17,931.384 2218.48,902.476 2220.79,889.562 2223.09,1004.87 2225.4,1137.61 2227.71,958.762 2230.02,1055.28 2232.32,956.077 2234.63,971.927 2236.94,1080.45 2239.25,951.769 2241.56,881.668 2243.86,850.055 2246.17,910.169 2248.48,1105.22 2250.79,831.046 2253.1,912.833 2255.4,1086.04 2257.71,984.765 2260.02,893.662 2262.33,1081.89 2264.64,1176.61 2266.94,1013.21 2269.25,1129.62 2271.56,1007.61 2273.87,1015.03 2276.18,965.985 2278.48,934.379 2280.79,966.747 2283.1,895.857 2285.41,1005.19 2287.71,1027.74 2290.02,1079.15 2292.33,1083.57 2294.64,824.149 2296.95,877.68 2299.25,987.582 2301.56,903.917 2303.87,854.538 2306.18,982.512 2308.49,1033.5 2310.79,1010.33 2313.1,1028.98 2315.41,840.442 2317.72,890.639 2320.03,908.142 2322.33,1038.96 2324.64,1054.89 2326.95,1053.89 2329.26,892.417 2331.56,836.595 2333.87,841.983 2336.18,837.67 2338.49,948.238 2340.8,818.97 2343.1,999.424 2345.41,844.583 2347.72,1051.62 2350.03,984.81 2352.34,1079.16 2354.64,874.11 2356.95,1059.02 2359.26,948.517 2361.57,982.876 2363.88,1112.69 2366.18,1055.56 2368.49,879.602 2370.8,966.884 2373.11,846.408 2375.42,912.667 2377.72,892.224 2380.03,900.352 2382.34,903.744 2384.65,925.944 2386.95,1079.85 2389.26,836.406 2391.57,843.634 2393.88,1137.37 2396.19,1028.96 2398.49,916.979 2400.8,815.925 2403.11,979.354 2405.42,1082.7 2407.73,1061.74 2410.03,846.859 2412.34,880.88 2414.65,1188.55 2416.96,983.915 2419.27,963.667 2421.57,997.332 2423.88,976.244 2426.19,1022.81 2428.5,1039.27 2430.81,902.635 2433.11,1069.83 2435.42,1082.11 2437.73,989.33 2440.04,757.805 2442.34,1110.07 2444.65,1163.78 2446.96,988.662 2449.27,1022.74 2451.58,898.152 2453.88,854.125 2456.19,1068.18 2458.5,800.904 2460.81,920.552 2463.12,932.671 2465.42,940.992 2467.73,1023.41 2470.04,917.108 2472.35,1131.98 2474.66,984.637 2476.96,967.438 2479.27,957.456 2481.58,1034.57 2483.89,1135.45 2486.2,966.835 2488.5,989.408 2490.81,1222.49 2493.12,1106.07 2495.43,1093.36 2497.73,795.358 2500.04,1226.15 2502.35,833.584 2504.66,990.722 2506.97,945.666 2509.27,986.242 2511.58,879.09 2513.89,964.694 2516.2,986.834 2518.51,848.676 2520.81,1048.58 2523.12,989.15 2525.43,951.861 2527.74,991.281 2530.05,929.483 2532.35,959.773 2534.66,1084.75 2536.97,1205.31 2539.28,981.992 2541.58,870.014 2543.89,858.268 2546.2,968.386 2548.51,928.217 2550.82,873.145 2553.12,915.09 2555.43,900.76 2557.74,926.681 2560.05,887.123 2562.36,947.03 2564.66,986.054 2566.97,907.39 2569.28,906.687 2571.59,1059.01 "></polyline>
<polyline clip-path="url(#clip662)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,633.331 268.292,392.944 270.6,431.466 272.908,562.057 275.216,675.016 277.524,458.126 279.832,554.755 282.139,394.848 284.447,357.071 286.755,384.546 289.063,485.706 291.371,392.752 293.679,585.55 295.987,645.782 298.295,430.353 300.603,425.178 302.911,533.497 305.219,406.845 307.527,462.423 309.834,392.91 312.142,303.527 314.45,446.937 316.758,436.461 319.066,438.28 321.374,417.861 323.682,481.214 325.99,489.888 328.298,423.374 330.606,492.664 332.914,454.099 335.221,453.074 337.529,484.056 339.837,322.614 342.145,396.687 344.453,527.683 346.761,513.23 349.069,425.279 351.377,485.429 353.685,533.119 355.993,682.576 358.301,520.712 360.608,710.912 362.916,422.711 365.224,348.544 367.532,492.118 369.84,617.085 372.148,538.526 374.456,544.853 376.764,469.127 379.072,426.075 381.38,513.847 383.688,482.687 385.996,463.511 388.303,418.235 390.611,583.679 392.919,687.559 395.227,360.916 397.535,370.07 399.843,467.307 402.151,416.724 404.459,442.543 406.767,313.085 409.075,400.408 411.383,459.515 413.69,466.195 415.998,428.045 418.306,364.035 420.614,481.629 422.922,637.072 425.23,444.247 427.538,445.561 429.846,372.698 432.154,501.264 434.462,411.925 436.77,577.3 439.077,410.217 441.385,519.786 443.693,251.369 446.001,465.089 448.309,394.061 450.617,565.615 452.925,453.568 455.233,539.695 457.541,405.118 459.849,385.013 462.157,316.081 464.465,471.038 466.772,463.85 469.08,444.958 471.388,671.285 473.696,565.67 476.004,457.765 478.312,614.286 480.62,506.971 482.928,536.138 485.236,429.784 487.544,383.646 489.852,456.363 492.159,426.345 494.467,446.45 496.775,268.274 499.083,527.098 501.391,375.744 503.699,340.543 506.007,495.168 508.315,340.666 510.623,310.925 512.931,551.489 515.239,397.692 517.546,520.243 519.854,465.311 522.162,454.395 524.47,449.52 526.778,515.792 529.086,421.472 531.394,450.482 533.702,443.232 536.01,409.024 538.318,232.971 540.626,511.982 542.933,491.032 545.241,411.289 547.549,438.671 549.857,410.262 552.165,319.368 554.473,453.592 556.781,521.88 559.089,391.732 561.397,544.741 563.705,568.632 566.013,535.376 568.321,563.332 570.628,560.359 572.936,451.872 575.244,451.714 577.552,330.905 579.86,654.776 582.168,501.824 584.476,408.308 586.784,487.141 589.092,542.141 591.4,491.662 593.708,412.844 596.015,380.679 598.323,383.661 600.631,442.717 602.939,536.747 605.247,447.917 607.555,416.219 609.863,406.975 612.171,340.782 614.479,410.351 616.787,606.94 619.095,392.989 621.402,400.692 623.71,666.503 626.018,478.58 628.326,438.406 630.634,333.847 632.942,574.89 635.25,449.859 637.558,461.412 639.866,467.638 642.174,286.048 644.482,267.48 646.79,449.399 649.097,414.554 651.405,529.757 653.713,453.119 656.021,446.712 658.329,382.207 660.637,550.27 662.945,437.807 665.253,453.953 667.561,360.448 669.869,328.06 672.177,497.875 674.484,299.883 676.792,461.765 679.1,375.644 681.408,697.511 683.716,571.109 686.024,591.708 688.332,350.096 690.64,565.801 692.948,533.322 695.256,581.217 697.564,520.706 699.871,449.286 702.179,579.608 704.487,570.245 706.795,400.354 709.103,501.969 711.411,449.578 713.719,499.293 716.027,558.664 718.335,488.216 720.643,256.975 722.951,540.109 725.259,377.151 727.566,401.4 729.874,460.129 732.182,523.286 734.49,536.511 736.798,476.436 739.106,489.899 741.414,525.734 743.722,621.995 746.03,365.614 748.338,594.142 750.646,547.733 752.953,614.055 755.261,434.18 757.569,399.408 759.877,394.044 762.185,277.761 764.493,510.569 766.801,422.57 769.109,409.699 771.417,488.495 773.725,637.373 776.033,508.625 778.34,513.509 780.648,629.207 782.956,429.056 785.264,495.851 787.572,551.632 789.88,496.684 792.188,434.368 794.496,551.615 796.804,675.773 799.112,564.62 801.42,405.467 803.728,423.407 806.035,390.08 808.343,527.415 810.651,621.703 812.959,418.607 815.267,570.804 817.575,406.152 819.883,380.681 822.191,664.776 824.499,458.02 826.807,365.963 829.115,360.085 831.422,482.985 833.73,448.301 836.038,509.39 838.346,438.424 840.654,537.085 842.962,421.788 845.27,522.008 847.578,341.311 849.886,442.969 852.194,416.065 854.502,318.158 856.809,421.064 859.117,348.606 861.425,454.223 863.733,656.196 866.041,392.906 868.349,341.93 870.657,502.347 872.965,449.077 875.273,379.787 877.581,526.284 879.889,527.751 882.197,385.117 884.504,572.099 886.812,447.024 889.12,314.065 891.428,376.267 893.736,293.609 896.044,517.22 898.352,460.832 900.66,481.012 902.968,392.642 905.276,383.524 907.584,370.427 909.891,561.553 912.199,500.354 914.507,417.503 916.815,494.258 919.123,275.324 921.431,477.92 923.739,467.021 926.047,272.57 928.355,468.374 930.663,635.562 932.971,567.501 935.278,580.301 937.586,608.005 939.894,531.732 942.202,470.297 944.51,481.99 946.818,619.793 949.126,381.881 951.434,468.518 953.742,522.198 956.05,312.051 958.358,616.855 960.665,553.513 962.973,396.103 965.281,399.405 967.589,425.425 969.897,318.634 972.205,588.954 974.513,427.271 976.821,622.637 979.129,600.064 981.437,538.048 983.745,506.681 986.053,243.991 988.36,553.174 990.668,361.948 992.976,567.043 995.284,351.924 997.592,504.907 999.9,581.925 1002.21,392.457 1004.52,341.949 1006.82,539.836 1009.13,517.724 1011.44,367.884 1013.75,637.757 1016.06,400.512 1018.36,265.788 1020.67,364.763 1022.98,505.885 1025.29,655.146 1027.59,525.353 1029.9,443.604 1032.21,496.188 1034.52,629.281 1036.83,484.951 1039.13,346.357 1041.44,370.629 1043.75,503.31 1046.06,475.018 1048.37,527.568 1050.67,424.285 1052.98,494.182 1055.29,516.761 1057.6,535.551 1059.91,391.996 1062.21,528.101 1064.52,281.493 1066.83,308.332 1069.14,331.823 1071.45,620.488 1073.75,637.634 1076.06,359.817 1078.37,619.207 1080.68,412.179 1082.98,450.282 1085.29,559.692 1087.6,430.029 1089.91,487.529 1092.22,452.807 1094.52,412.961 1096.83,630.291 1099.14,573.235 1101.45,724.382 1103.76,431.936 1106.06,575.464 1108.37,277.754 1110.68,524.877 1112.99,478.707 1115.3,342.048 1117.6,485.485 1119.91,426.287 1122.22,411.178 1124.53,487.125 1126.84,405.355 1129.14,476.843 1131.45,523.24 1133.76,380.977 1136.07,442.992 1138.37,589.618 1140.68,221.503 1142.99,442.433 1145.3,392.005 1147.61,397.035 1149.91,358.547 1152.22,599.747 1154.53,574.124 1156.84,461.286 1159.15,394.689 1161.45,514.864 1163.76,578.941 1166.07,529.238 1168.38,522.462 1170.69,410.391 1172.99,414.068 1175.3,615.833 1177.61,588.854 1179.92,530.464 1182.23,474.559 1184.53,510.365 1186.84,454.866 1189.15,538.585 1191.46,375.136 1193.76,488.454 1196.07,401.292 1198.38,408.124 1200.69,534.083 1203,515.147 1205.3,419.761 1207.61,584.816 1209.92,666.658 1212.23,616.86 1214.54,623.577 1216.84,657.591 1219.15,438.973 1221.46,360.512 1223.77,479.033 1226.08,414.723 1228.38,540.742 1230.69,551.328 1233,562.662 1235.31,646.522 1237.61,759.269 1239.92,607.043 1242.23,422.608 1244.54,519.495 1246.85,594.773 1249.15,717.631 1251.46,540.459 1253.77,479.796 1256.08,469.506 1258.39,410.356 1260.69,284.055 1263,400.952 1265.31,564.557 1267.62,441.289 1269.93,406.751 1272.23,365.756 1274.54,272.309 1276.85,294.449 1279.16,550.82 1281.47,695.12 1283.77,493.263 1286.08,478.769 1288.39,479.893 1290.7,515.958 1293,503.499 1295.31,652.344 1297.62,379.317 1299.93,445.423 1302.24,458.423 1304.54,349.735 1306.85,443.793 1309.16,227.533 1311.47,494.127 1313.78,461.673 1316.08,626.101 1318.39,433.102 1320.7,351.246 1323.01,423.305 1325.32,434.26 1327.62,367.968 1329.93,441.274 1332.24,234.283 1334.55,558.109 1336.86,557.237 1339.16,653.391 1341.47,454.07 1343.78,513.53 1346.09,450.516 1348.39,529.414 1350.7,380.951 1353.01,512.903 1355.32,560.185 1357.63,529.694 1359.93,525.213 1362.24,682.629 1364.55,317.021 1366.86,426.37 1369.17,500.642 1371.47,453.782 1373.78,474.42 1376.09,570.139 1378.4,583.99 1380.71,495.181 1383.01,640.412 1385.32,187.824 1387.63,373.254 1389.94,224.017 1392.24,430.916 1394.55,451.242 1396.86,346.501 1399.17,531.899 1401.48,424.392 1403.78,459.132 1406.09,457.94 1408.4,575.462 1410.71,558.359 1413.02,448.753 1415.32,338.171 1417.63,195.251 1419.94,517.252 1422.25,602.427 1424.56,359.447 1426.86,304.145 1429.17,379.322 1431.48,445.415 1433.79,622.81 1436.1,479.898 1438.4,578.777 1440.71,412.357 1443.02,404.553 1445.33,460.111 1447.63,535.658 1449.94,664.141 1452.25,591.234 1454.56,344.535 1456.87,386.083 1459.17,366.581 1461.48,562.22 1463.79,467.423 1466.1,453.525 1468.41,232.974 1470.71,474.875 1473.02,536.904 1475.33,457.526 1477.64,462.773 1479.95,364.728 1482.25,569.689 1484.56,617.596 1486.87,531.826 1489.18,594.186 1491.49,362.066 1493.79,443.178 1496.1,491.212 1498.41,358.082 1500.72,408.675 1503.02,429.383 1505.33,515.74 1507.64,409.654 1509.95,406.527 1512.26,353.055 1514.56,488.269 1516.87,390.808 1519.18,529.56 1521.49,414.053 1523.8,582.105 1526.1,447.437 1528.41,417.53 1530.72,563.529 1533.03,458.891 1535.34,460.301 1537.64,568.009 1539.95,445.529 1542.26,476.314 1544.57,394.093 1546.88,609.258 1549.18,470.992 1551.49,458.966 1553.8,771.553 1556.11,489.582 1558.41,634.278 1560.72,680.388 1563.03,497.311 1565.34,548.358 1567.65,410.896 1569.95,468.094 1572.26,96.8724 1574.57,451.833 1576.88,464.438 1579.19,433.389 1581.49,544.086 1583.8,410.217 1586.11,423.434 1588.42,534.338 1590.73,630.176 1593.03,496.623 1595.34,194.776 1597.65,459.514 1599.96,468.735 1602.26,469.465 1604.57,563.887 1606.88,557.704 1609.19,348.236 1611.5,551.269 1613.8,587.572 1616.11,607.151 1618.42,476.131 1620.73,432.868 1623.04,435.199 1625.34,343.745 1627.65,378.955 1629.96,311.005 1632.27,630.287 1634.58,653.447 1636.88,434.636 1639.19,339.405 1641.5,475.755 1643.81,431.746 1646.12,452.267 1648.42,368.423 1650.73,574.06 1653.04,482.877 1655.35,475.213 1657.65,464.255 1659.96,628.045 1662.27,435.304 1664.58,593.969 1666.89,411.839 1669.19,441.172 1671.5,530.237 1673.81,506.074 1676.12,611.237 1678.43,475.7 1680.73,545.024 1683.04,545.26 1685.35,456.296 1687.66,431.481 1689.97,473.505 1692.27,476.387 1694.58,395.201 1696.89,358.419 1699.2,483.584 1701.51,404.298 1703.81,587.91 1706.12,426.522 1708.43,468.648 1710.74,374.114 1713.04,491.127 1715.35,369.975 1717.66,483.044 1719.97,404.408 1722.28,427.185 1724.58,543.505 1726.89,549.696 1729.2,555.088 1731.51,532.506 1733.82,298.178 1736.12,409.838 1738.43,517.106 1740.74,327.069 1743.05,424.092 1745.36,561.23 1747.66,598.672 1749.97,510.328 1752.28,577.406 1754.59,490.609 1756.9,519.842 1759.2,436.578 1761.51,436.022 1763.82,531.514 1766.13,272.923 1768.43,316.965 1770.74,557.293 1773.05,585.136 1775.36,534.931 1777.67,467.528 1779.97,459.982 1782.28,562.316 1784.59,534.91 1786.9,457.406 1789.21,392.177 1791.51,430.077 1793.82,421.848 1796.13,687.141 1798.44,404.152 1800.75,493.461 1803.05,503.904 1805.36,564.773 1807.67,648.712 1809.98,440.557 1812.28,553.19 1814.59,461.581 1816.9,519.914 1819.21,432.519 1821.52,381.635 1823.82,410.639 1826.13,591.114 1828.44,514.008 1830.75,588.126 1833.06,477.055 1835.36,530.673 1837.67,459.394 1839.98,422.851 1842.29,487.739 1844.6,556.501 1846.9,536.08 1849.21,549.364 1851.52,307.943 1853.83,459.38 1856.14,368.056 1858.44,463.114 1860.75,555.851 1863.06,135.525 1865.37,245.677 1867.67,616.383 1869.98,360.909 1872.29,328.042 1874.6,526.776 1876.91,485.417 1879.21,543.008 1881.52,494.261 1883.83,382.62 1886.14,481.394 1888.45,299.073 1890.75,568.571 1893.06,424.214 1895.37,386.195 1897.68,614.674 1899.99,466.079 1902.29,374.858 1904.6,451.715 1906.91,525.383 1909.22,576.367 1911.53,466.892 1913.83,326.469 1916.14,536.518 1918.45,424.275 1920.76,446.05 1923.06,404.48 1925.37,288.379 1927.68,521.872 1929.99,352.602 1932.3,280.578 1934.6,425.989 1936.91,469.05 1939.22,215.766 1941.53,363.584 1943.84,425.624 1946.14,309.29 1948.45,369.134 1950.76,458.619 1953.07,474.091 1955.38,370.25 1957.68,398.977 1959.99,316.087 1962.3,419.64 1964.61,444.087 1966.91,528.218 1969.22,462.257 1971.53,492.569 1973.84,476.75 1976.15,507.399 1978.45,365.626 1980.76,552.623 1983.07,432.748 1985.38,283.359 1987.69,260.217 1989.99,415.436 1992.3,536.061 1994.61,483.965 1996.92,622.711 1999.23,434.859 2001.53,512.736 2003.84,427.049 2006.15,320.997 2008.46,240.966 2010.77,438.482 2013.07,463.607 2015.38,680.286 2017.69,335.223 2020,516.122 2022.3,454.503 2024.61,460.901 2026.92,500.413 2029.23,526.654 2031.54,598.664 2033.84,518.693 2036.15,302.814 2038.46,463.392 2040.77,477.228 2043.08,416.759 2045.38,429.553 2047.69,506.938 2050,453.091 2052.31,545.425 2054.62,433.954 2056.92,439.934 2059.23,488.639 2061.54,457.033 2063.85,237.97 2066.16,347.689 2068.46,499.955 2070.77,611.58 2073.08,555.883 2075.39,453.603 2077.69,609.683 2080,413.824 2082.31,486.643 2084.62,245.528 2086.93,430.095 2089.23,395.937 2091.54,500.184 2093.85,459.578 2096.16,419.177 2098.47,416.779 2100.77,613.687 2103.08,458.708 2105.39,511.544 2107.7,656.06 2110.01,556.057 2112.31,336.551 2114.62,451.548 2116.93,446.086 2119.24,436.574 2121.55,302.461 2123.85,566.053 2126.16,442.932 2128.47,414.765 2130.78,484.129 2133.08,477.304 2135.39,505.956 2137.7,538.221 2140.01,396.335 2142.32,576.201 2144.62,456.29 2146.93,463.944 2149.24,447.899 2151.55,470.868 2153.86,404.371 2156.16,398.759 2158.47,399.313 2160.78,385.242 2163.09,618.676 2165.4,661.894 2167.7,487.181 2170.01,481.248 2172.32,490.313 2174.63,368.727 2176.93,536.013 2179.24,664.377 2181.55,643.539 2183.86,655.446 2186.17,414.533 2188.47,458.908 2190.78,477.375 2193.09,522.456 2195.4,410.32 2197.71,560.965 2200.01,520.535 2202.32,598.963 2204.63,547.81 2206.94,671.403 2209.25,460.002 2211.55,362.706 2213.86,545.08 2216.17,475.836 2218.48,361.971 2220.79,445.936 2223.09,709.587 2225.4,513.117 2227.71,411.065 2230.02,670.452 2232.32,368.316 2234.63,664.527 2236.94,137.667 2239.25,415.238 2241.56,431.169 2243.86,504.039 2246.17,604.801 2248.48,420.736 2250.79,424.008 2253.1,441.222 2255.4,650.959 2257.71,489.124 2260.02,460.032 2262.33,526.129 2264.64,506.288 2266.94,533.042 2269.25,344.661 2271.56,458.681 2273.87,447.035 2276.18,323.535 2278.48,626.909 2280.79,426.374 2283.1,367.174 2285.41,413.164 2287.71,421.676 2290.02,486.972 2292.33,487.513 2294.64,682.951 2296.95,572.539 2299.25,406.104 2301.56,577.009 2303.87,501.827 2306.18,448.164 2308.49,412.399 2310.79,498.486 2313.1,280.7 2315.41,663.934 2317.72,414.563 2320.03,420.41 2322.33,606.417 2324.64,357.186 2326.95,577.411 2329.26,493.603 2331.56,540.77 2333.87,438.959 2336.18,492.804 2338.49,491.195 2340.8,386.288 2343.1,487.417 2345.41,641.655 2347.72,576.533 2350.03,493.424 2352.34,425.821 2354.64,777.844 2356.95,419.856 2359.26,605.899 2361.57,514.148 2363.88,269.233 2366.18,418.569 2368.49,576.886 2370.8,469.369 2373.11,520.894 2375.42,428.468 2377.72,426.321 2380.03,452.352 2382.34,422.583 2384.65,390.962 2386.95,435.044 2389.26,512.134 2391.57,560.65 2393.88,575.312 2396.19,326.794 2398.49,665.355 2400.8,456.465 2403.11,700.003 2405.42,344.934 2407.73,312.454 2410.03,366.006 2412.34,452.421 2414.65,442.68 2416.96,377.152 2419.27,572.41 2421.57,534.861 2423.88,359.534 2426.19,332.872 2428.5,335.332 2430.81,302.432 2433.11,282.055 2435.42,424.223 2437.73,481.724 2440.04,360.193 2442.34,412.918 2444.65,595.78 2446.96,481.273 2449.27,230.209 2451.58,564.334 2453.88,235.174 2456.19,427.157 2458.5,444.16 2460.81,506.333 2463.12,647.839 2465.42,388.375 2467.73,391.675 2470.04,557.482 2472.35,514.507 2474.66,363.822 2476.96,493.054 2479.27,533.222 2481.58,552.168 2483.89,663.157 2486.2,368.014 2488.5,485.539 2490.81,580.303 2493.12,626.145 2495.43,464.828 2497.73,406.547 2500.04,569.323 2502.35,586.888 2504.66,380.882 2506.97,460.876 2509.27,579.498 2511.58,382.787 2513.89,515.012 2516.2,510.6 2518.51,681.645 2520.81,287.353 2523.12,400.886 2525.43,462.786 2527.74,458.156 2530.05,460.933 2532.35,483.101 2534.66,463.168 2536.97,394.947 2539.28,603.404 2541.58,403.02 2543.89,616.814 2546.2,500.26 2548.51,477.902 2550.82,482.153 2553.12,481.105 2555.43,437.591 2557.74,403.372 2560.05,402.326 2562.36,487.654 2564.66,508.816 2566.97,468.16 2569.28,513.178 2571.59,601.172 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -1.13795   -3.61624  -3.54236   -4.36089  …  -6.64225  -5.00206   -5.00206
  0.144541  -1.38079   0.332663  -1.19827      1.37064  -0.263165  -0.263165
  1.76636    3.7076    5.19959    5.13142      3.5557    5.18119    5.18119

[:, :, 2] =
 -2.24302   -4.71483   -3.21674  -6.46223  …  -4.31786    -3.84522  -4.36846
  0.248888   0.798163   1.20875   1.07994     -0.0634955   1.99973  -0.251539
  0.517159   3.07257    4.54199   4.40871      3.89131     4.98888   5.38284

[:, :, 3] =
 -2.91611   -5.18296  -7.00501   -4.66127   …  -4.58239  -6.46987   -4.86591
 -0.637069  -2.23859  -0.124732  -0.572147      1.73135   0.869722   1.79085
  2.80061    4.51519   3.68146    5.21612       4.93614   4.2729     4.00456

[:, :, 4] =
 -2.43419    -3.97032   -6.29082  -5.84659  …  -4.79639  -4.89967   -4.43686
 -0.0715232  -0.237092   1.57929   2.14446     -1.33067  -0.970253  -1.22105
  1.51651     5.60973    5.57493   5.69922      5.92403   4.40388    4.23477</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -5.02983     0.995024
  0.00344519  0.998961
  4.98863     1.00554</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.48 seconds
Compute duration  = 2.48 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -5.0148    1.0087    0.0181   3107.3216   5201.1173    1.0000   ⋯
        x[2]   -0.0171    1.0201    0.0179   3237.2757   5560.9940    1.0015   ⋯
        x[3]    4.9749    1.0055    0.0177   3253.3915   5053.3579    1.0006   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -6.9923   -5.6939   -5.0057   -4.3351   -3.0435
        x[2]   -2.0121   -0.7126   -0.0214    0.6877    1.9687
        x[3]    2.9895    4.3036    4.9860    5.6621    6.8759</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.48 seconds
Compute duration  = 1.48 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.5001    0.1861    0.0028   4436.8330   5750.6584    0.9999   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1553    0.3598    0.5003    0.6382    0.8493</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.23 seconds
Compute duration  = 0.23 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

           x    0.5018    0.1331    0.0081   222.8069    89.3024    1.0033     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.2621    0.3965    0.5088    0.6118    0.7368</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(-1.980753387896891, "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with -1.980753387896891:
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/nmUhn/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/compiler.jl:579 [inlined]
  [7] demo(__model__::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, __varinfo__::DynamicPPL.ThreadSafeVarInfo{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, Vector{Base.RefValue{Float64}}}, __context__::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:592
  [8] _evaluate!!
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:973 [inlined]
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, context::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:962
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:892 [inlined]
 [11] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/values_as_in_model.jl:196 [inlined]
 [12] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/values_as_in_model.jl:195 [inlined]
 [13] getparams(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:343
 [14] Turing.Inference.Transition(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, t::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:226
 [15] transition_to_turing
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:12 [inlined]
 [16] transition_to_turing(f::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, transition::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:17
 [17] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}; initial_state::Nothing, initial_params::Nothing, kwargs::@Kwargs{})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:141
 [18] step
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:96 [inlined]
 [19] macro expansion
    @ ~/.julia/packages/AbstractMCMC/YrmkI/src/sample.jl:130 [inlined]
 [20] macro expansion
    @ ~/.julia/packages/AbstractMCMC/YrmkI/src/logging.jl:16 [inlined]
 [21] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/YrmkI/src/sample.jl:120
 [22] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/MjWTB/src/sampler.jl:93
 [23] sample
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/sampler.jl:83 [inlined]
 [24] #sample#4
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:276 [inlined]
 [25] sample
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:267 [inlined]
 [26] #sample#3
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:264 [inlined]
 [27] top-level scope
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:594</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.63 seconds
Compute duration  = 1.63 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8450    0.5449    0.0229   428.6170   183.7916    1.0008     ⋯
           x   -0.0459    0.8927    0.0373   702.6600   601.5633    1.0028     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1524    0.4110    0.7221    1.1670    2.1641
           x   -2.3550   -0.4285   -0.0063    0.4131    1.6918</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 3.01 seconds
Compute duration  = 3.01 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.7865    0.5484    0.0306   226.1385   148.3668    1.0017     ⋯
           x   -0.0026    0.9100    0.0471   507.9942   493.9295    1.0009     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.0885    0.3521    0.6580    1.0997    2.1287
           x   -1.9445   -0.3457    0.0015    0.3577    1.9939</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>