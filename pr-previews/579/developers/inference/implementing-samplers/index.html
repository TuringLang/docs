<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing Samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../developers/inference/variational-inference/index.html" rel="prev">
<link href="../../../assets/favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-6cd699286831e1a51092dd37a8f143c8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark-0fe6c82f0128f372cccc6e05b9c0dd0b.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../tutorials/coin-flipping/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.36" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.36</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.36">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../developers/contributing/index.html">Developers</a></li><li class="breadcrumb-item"><a href="../../../developers/inference/abstractmcmc-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../../developers/inference/implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../core-functionality/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Core Functionality</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">User Guide</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/automatic-differentiation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/custom-distribution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Custom Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/probability-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Querying Model Probabilities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/modifying-logprob/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modifying the Log Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/generated-quantities/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generated Quantities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/sampler-visualisation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/coin-flipping/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction: Coin Flipping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/gaussian-mixture-models/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/bayesian-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/bayesian-neural-networks/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/hidden-markov-models/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/bayesian-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/infinite-mixture-models/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/bayesian-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/bayesian-time-series-analysis/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/gaussian-processes-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Processes: Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/gaussian-process-latent-variable-models/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/contributing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contributing</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">DynamicPPL’s Compiler</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/compiler/model-manual/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manually Defining a Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/compiler/minituring-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/compiler/minituring-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/compiler/design-overview/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design (Outdated)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Inference (note: outdated)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/inference/abstractmcmc-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/inference/abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing Implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/inference/variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/inference/implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/developers/inference/implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../developers/contributing/index.html">Developers</a></li><li class="breadcrumb-item"><a href="../../../developers/inference/abstractmcmc-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../../developers/inference/implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing Samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-29.280382658733217</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-29.280382658733217</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([0.0, 0.0, 0.0]), MALAState{Vector{Float64}}([0.0, 0.0, 0.0]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -2.7346    -3.7316    -5.48824   …  -4.30447   -4.11315   -3.99509
 -0.259649   0.514945  -0.296254     -0.485601  -0.664343   0.523979
  1.136      3.43436    3.03582       6.60111    7.29458    7.11117</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.98096      0.991769
 -0.000512686  0.990755
  4.99637      1.01118</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip000">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip000)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip001">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip000)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip002">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1614.84 2640.76,1614.84 "></polyline>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1376.71 2640.76,1376.71 "></polyline>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1138.58 2640.76,1138.58 "></polyline>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,900.452 2640.76,900.452 "></polyline>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,662.323 2640.76,662.323 "></polyline>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,424.193 2640.76,424.193 "></polyline>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,186.063 2640.76,186.063 "></polyline>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip000)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1614.84 215.714,1614.84 "></polyline>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1376.71 215.714,1376.71 "></polyline>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1138.58 215.714,1138.58 "></polyline>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,900.452 215.714,900.452 "></polyline>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,662.323 215.714,662.323 "></polyline>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,424.193 215.714,424.193 "></polyline>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,186.063 215.714,186.063 "></polyline>
<path clip-path="url(#clip000)" d="M50.5475 1615.29 L80.2233 1615.29 L80.2233 1619.23 L50.5475 1619.23 L50.5475 1615.29 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M89.1352 1597.56 L111.357 1597.56 L111.357 1599.55 L98.8111 1632.12 L93.9269 1632.12 L105.732 1601.5 L89.1352 1601.5 L89.1352 1597.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M120.478 1626.24 L125.362 1626.24 L125.362 1632.12 L120.478 1632.12 L120.478 1626.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M135.593 1597.56 L153.95 1597.56 L153.95 1601.5 L139.876 1601.5 L139.876 1609.97 Q140.894 1609.62 141.913 1609.46 Q142.931 1609.28 143.95 1609.28 Q149.737 1609.28 153.116 1612.45 Q156.496 1615.62 156.496 1621.03 Q156.496 1626.61 153.024 1629.71 Q149.552 1632.79 143.232 1632.79 Q141.056 1632.79 138.788 1632.42 Q136.542 1632.05 134.135 1631.31 L134.135 1626.61 Q136.218 1627.75 138.441 1628.3 Q140.663 1628.86 143.14 1628.86 Q147.144 1628.86 149.482 1626.75 Q151.82 1624.65 151.82 1621.03 Q151.82 1617.42 149.482 1615.32 Q147.144 1613.21 143.14 1613.21 Q141.265 1613.21 139.39 1613.63 Q137.538 1614.04 135.593 1614.92 L135.593 1597.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M49.5521 1377.16 L79.2279 1377.16 L79.2279 1381.1 L49.5521 1381.1 L49.5521 1377.16 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M89.3667 1359.43 L107.723 1359.43 L107.723 1363.37 L93.6491 1363.37 L93.6491 1371.84 Q94.6676 1371.49 95.6861 1371.33 Q96.7047 1371.15 97.7232 1371.15 Q103.51 1371.15 106.89 1374.32 Q110.269 1377.49 110.269 1382.9 Q110.269 1388.48 106.797 1391.58 Q103.325 1394.66 97.0056 1394.66 Q94.8297 1394.66 92.5612 1394.29 Q90.3158 1393.92 87.9084 1393.18 L87.9084 1388.48 Q89.9917 1389.62 92.2139 1390.17 Q94.4361 1390.73 96.913 1390.73 Q100.918 1390.73 103.256 1388.62 Q105.593 1386.52 105.593 1382.9 Q105.593 1379.29 103.256 1377.19 Q100.918 1375.08 96.913 1375.08 Q95.038 1375.08 93.163 1375.5 Q91.3112 1375.91 89.3667 1376.79 L89.3667 1359.43 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M119.482 1388.11 L124.367 1388.11 L124.367 1393.99 L119.482 1393.99 L119.482 1388.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M144.552 1362.51 Q140.941 1362.51 139.112 1366.08 Q137.306 1369.62 137.306 1376.75 Q137.306 1383.85 139.112 1387.42 Q140.941 1390.96 144.552 1390.96 Q148.186 1390.96 149.991 1387.42 Q151.82 1383.85 151.82 1376.75 Q151.82 1369.62 149.991 1366.08 Q148.186 1362.51 144.552 1362.51 M144.552 1358.81 Q150.362 1358.81 153.417 1363.41 Q156.496 1368 156.496 1376.75 Q156.496 1385.47 153.417 1390.08 Q150.362 1394.66 144.552 1394.66 Q138.741 1394.66 135.663 1390.08 Q132.607 1385.47 132.607 1376.75 Q132.607 1368 135.663 1363.41 Q138.741 1358.81 144.552 1358.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M50.5475 1139.03 L80.2233 1139.03 L80.2233 1142.97 L50.5475 1142.97 L50.5475 1139.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M94.3436 1151.93 L110.663 1151.93 L110.663 1155.86 L88.7186 1155.86 L88.7186 1151.93 Q91.3806 1149.17 95.9639 1144.54 Q100.57 1139.89 101.751 1138.55 Q103.996 1136.02 104.876 1134.29 Q105.779 1132.53 105.779 1130.84 Q105.779 1128.08 103.834 1126.35 Q101.913 1124.61 98.8111 1124.61 Q96.6121 1124.61 94.1584 1125.38 Q91.7278 1126.14 88.9501 1127.69 L88.9501 1122.97 Q91.7741 1121.83 94.2278 1121.26 Q96.6815 1120.68 98.7185 1120.68 Q104.089 1120.68 107.283 1123.36 Q110.478 1126.05 110.478 1130.54 Q110.478 1132.67 109.668 1134.59 Q108.881 1136.49 106.774 1139.08 Q106.195 1139.75 103.094 1142.97 Q99.9917 1146.16 94.3436 1151.93 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M120.478 1149.98 L125.362 1149.98 L125.362 1155.86 L120.478 1155.86 L120.478 1149.98 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M135.593 1121.3 L153.95 1121.3 L153.95 1125.24 L139.876 1125.24 L139.876 1133.71 Q140.894 1133.36 141.913 1133.2 Q142.931 1133.02 143.95 1133.02 Q149.737 1133.02 153.116 1136.19 Q156.496 1139.36 156.496 1144.77 Q156.496 1150.35 153.024 1153.45 Q149.552 1156.53 143.232 1156.53 Q141.056 1156.53 138.788 1156.16 Q136.542 1155.79 134.135 1155.05 L134.135 1150.35 Q136.218 1151.49 138.441 1152.04 Q140.663 1152.6 143.14 1152.6 Q147.144 1152.6 149.482 1150.49 Q151.82 1148.39 151.82 1144.77 Q151.82 1141.16 149.482 1139.06 Q147.144 1136.95 143.14 1136.95 Q141.265 1136.95 139.39 1137.37 Q137.538 1137.78 135.593 1138.66 L135.593 1121.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M99.3204 886.251 Q95.7093 886.251 93.8806 889.816 Q92.075 893.358 92.075 900.487 Q92.075 907.594 93.8806 911.158 Q95.7093 914.7 99.3204 914.7 Q102.955 914.7 104.76 911.158 Q106.589 907.594 106.589 900.487 Q106.589 893.358 104.76 889.816 Q102.955 886.251 99.3204 886.251 M99.3204 882.547 Q105.131 882.547 108.186 887.154 Q111.265 891.737 111.265 900.487 Q111.265 909.214 108.186 913.82 Q105.131 918.404 99.3204 918.404 Q93.5102 918.404 90.4315 913.82 Q87.376 909.214 87.376 900.487 Q87.376 891.737 90.4315 887.154 Q93.5102 882.547 99.3204 882.547 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M119.482 911.853 L124.367 911.853 L124.367 917.732 L119.482 917.732 L119.482 911.853 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M144.552 886.251 Q140.941 886.251 139.112 889.816 Q137.306 893.358 137.306 900.487 Q137.306 907.594 139.112 911.158 Q140.941 914.7 144.552 914.7 Q148.186 914.7 149.991 911.158 Q151.82 907.594 151.82 900.487 Q151.82 893.358 149.991 889.816 Q148.186 886.251 144.552 886.251 M144.552 882.547 Q150.362 882.547 153.417 887.154 Q156.496 891.737 156.496 900.487 Q156.496 909.214 153.417 913.82 Q150.362 918.404 144.552 918.404 Q138.741 918.404 135.663 913.82 Q132.607 909.214 132.607 900.487 Q132.607 891.737 135.663 887.154 Q138.741 882.547 144.552 882.547 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M94.3436 675.667 L110.663 675.667 L110.663 679.603 L88.7186 679.603 L88.7186 675.667 Q91.3806 672.913 95.9639 668.283 Q100.57 663.63 101.751 662.288 Q103.996 659.765 104.876 658.029 Q105.779 656.269 105.779 654.58 Q105.779 651.825 103.834 650.089 Q101.913 648.353 98.8111 648.353 Q96.6121 648.353 94.1584 649.117 Q91.7278 649.881 88.9501 651.431 L88.9501 646.709 Q91.7741 645.575 94.2278 644.996 Q96.6815 644.418 98.7185 644.418 Q104.089 644.418 107.283 647.103 Q110.478 649.788 110.478 654.279 Q110.478 656.408 109.668 658.33 Q108.881 660.228 106.774 662.82 Q106.195 663.492 103.094 666.709 Q99.9917 669.904 94.3436 675.667 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M120.478 673.723 L125.362 673.723 L125.362 679.603 L120.478 679.603 L120.478 673.723 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M135.593 645.043 L153.95 645.043 L153.95 648.978 L139.876 648.978 L139.876 657.45 Q140.894 657.103 141.913 656.941 Q142.931 656.755 143.95 656.755 Q149.737 656.755 153.116 659.927 Q156.496 663.098 156.496 668.515 Q156.496 674.093 153.024 677.195 Q149.552 680.274 143.232 680.274 Q141.056 680.274 138.788 679.904 Q136.542 679.533 134.135 678.792 L134.135 674.093 Q136.218 675.228 138.441 675.783 Q140.663 676.339 143.14 676.339 Q147.144 676.339 149.482 674.232 Q151.82 672.126 151.82 668.515 Q151.82 664.904 149.482 662.797 Q147.144 660.691 143.14 660.691 Q141.265 660.691 139.39 661.107 Q137.538 661.524 135.593 662.404 L135.593 645.043 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M89.3667 406.913 L107.723 406.913 L107.723 410.848 L93.6491 410.848 L93.6491 419.32 Q94.6676 418.973 95.6861 418.811 Q96.7047 418.626 97.7232 418.626 Q103.51 418.626 106.89 421.797 Q110.269 424.968 110.269 430.385 Q110.269 435.963 106.797 439.065 Q103.325 442.144 97.0056 442.144 Q94.8297 442.144 92.5612 441.774 Q90.3158 441.403 87.9084 440.662 L87.9084 435.963 Q89.9917 437.098 92.2139 437.653 Q94.4361 438.209 96.913 438.209 Q100.918 438.209 103.256 436.102 Q105.593 433.996 105.593 430.385 Q105.593 426.774 103.256 424.667 Q100.918 422.561 96.913 422.561 Q95.038 422.561 93.163 422.977 Q91.3112 423.394 89.3667 424.274 L89.3667 406.913 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M119.482 435.593 L124.367 435.593 L124.367 441.473 L119.482 441.473 L119.482 435.593 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M144.552 409.991 Q140.941 409.991 139.112 413.556 Q137.306 417.098 137.306 424.227 Q137.306 431.334 139.112 434.899 Q140.941 438.44 144.552 438.44 Q148.186 438.44 149.991 434.899 Q151.82 431.334 151.82 424.227 Q151.82 417.098 149.991 413.556 Q148.186 409.991 144.552 409.991 M144.552 406.288 Q150.362 406.288 153.417 410.894 Q156.496 415.477 156.496 424.227 Q156.496 432.954 153.417 437.561 Q150.362 442.144 144.552 442.144 Q138.741 442.144 135.663 437.561 Q132.607 432.954 132.607 424.227 Q132.607 415.477 135.663 410.894 Q138.741 406.288 144.552 406.288 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M89.1352 168.783 L111.357 168.783 L111.357 170.774 L98.8111 203.343 L93.9269 203.343 L105.732 172.718 L89.1352 172.718 L89.1352 168.783 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M120.478 197.463 L125.362 197.463 L125.362 203.343 L120.478 203.343 L120.478 197.463 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip000)" d="M135.593 168.783 L153.95 168.783 L153.95 172.718 L139.876 172.718 L139.876 181.19 Q140.894 180.843 141.913 180.681 Q142.931 180.496 143.95 180.496 Q149.737 180.496 153.116 183.667 Q156.496 186.838 156.496 192.255 Q156.496 197.834 153.024 200.935 Q149.552 204.014 143.232 204.014 Q141.056 204.014 138.788 203.644 Q136.542 203.273 134.135 202.533 L134.135 197.834 Q136.218 198.968 138.441 199.523 Q140.663 200.079 143.14 200.079 Q147.144 200.079 149.482 197.972 Q151.82 195.866 151.82 192.255 Q151.82 188.644 149.482 186.537 Q147.144 184.431 143.14 184.431 Q141.265 184.431 139.39 184.848 Q137.538 185.264 135.593 186.144 L135.593 168.783 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip002)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1160.93 268.292,1354.34 270.6,1285.11 272.908,1113.36 275.216,1521.61 277.524,1328.87 279.832,1534.29 282.139,1516.81 284.447,1302.25 286.755,1322.65 289.063,1406.48 291.371,1446.76 293.679,1250.98 295.987,1470.45 298.295,1456.26 300.603,1243.39 302.911,1458.08 305.219,1543.24 307.527,1292.87 309.834,1484 312.142,1369.3 314.45,1472.95 316.758,1504.16 319.066,1417.92 321.374,1419.05 323.682,1353.48 325.99,1431.95 328.298,1420.49 330.606,1322.44 332.914,1328.93 335.221,1524.17 337.529,1390.24 339.837,1225.05 342.145,1327.14 344.453,1355.68 346.761,1365.46 349.069,1451.75 351.377,1346.62 353.685,1512.7 355.993,1360.89 358.301,1507.3 360.608,1361.94 362.916,1425.76 365.224,1380.05 367.532,1460.32 369.84,1394.67 372.148,1364.17 374.456,1474.36 376.764,1535.12 379.072,1431.24 381.38,1380.97 383.688,1409.18 385.996,1202.56 388.303,1364.41 390.611,1246.66 392.919,1373.49 395.227,1241.61 397.535,1305.05 399.843,1299.03 402.151,1379.63 404.459,1516.84 406.767,1395.33 409.075,1276.95 411.383,1304.94 413.69,1386.46 415.998,1401.78 418.306,1331.81 420.614,1585.63 422.922,1211.54 425.23,1406.23 427.538,1457.13 429.846,1276.05 432.154,1377.75 434.462,1274.24 436.77,1439.32 439.077,1441.22 441.385,1291.6 443.693,1214.32 446.001,1433.47 448.309,1309.78 450.617,1494.14 452.925,1276.75 455.233,1490.38 457.541,1325.46 459.849,1389.59 462.157,1240.11 464.465,1369.63 466.772,1288.74 469.08,1213.18 471.388,1523.78 473.696,1307.08 476.004,1409.86 478.312,1454.67 480.62,1474.29 482.928,1338.79 485.236,1329.46 487.544,1323 489.852,1536.18 492.159,1440.29 494.467,1307.62 496.775,1294.52 499.083,1297.36 501.391,1431.38 503.699,1235.45 506.007,1289.49 508.315,1392.79 510.623,1642.94 512.931,1317.95 515.239,1336.49 517.546,1284.1 519.854,1412.2 522.162,1297.51 524.47,1338.53 526.778,1402.48 529.086,1312.73 531.394,1308.45 533.702,1438.36 536.01,1517.67 538.318,1234.48 540.626,1528.81 542.933,1475.4 545.241,1322.15 547.549,1579.5 549.857,1371.93 552.165,1239.31 554.473,1468.18 556.781,1337.02 559.089,1465.25 561.397,1236.51 563.705,1471.02 566.013,1165.09 568.321,1402.26 570.628,1657.47 572.936,1471.36 575.244,1549.22 577.552,1401.24 579.86,1450.95 582.168,1451.55 584.476,1395.26 586.784,1440.53 589.092,1178.43 591.4,1310.8 593.708,1208.04 596.015,1384.2 598.323,1364.68 600.631,1264.07 602.939,1459.93 605.247,1404.14 607.555,1342.17 609.863,1400.4 612.171,1412.96 614.479,1195.68 616.787,1367.09 619.095,1264.4 621.402,1274.25 623.71,1350.05 626.018,1171.49 628.326,1546.68 630.634,1322.38 632.942,1206.78 635.25,1380.72 637.558,1298.49 639.866,1206.8 642.174,1370.42 644.482,1469.39 646.79,1315.56 649.097,1441.82 651.405,1374.34 653.713,1430.32 656.021,1428.2 658.329,1434.13 660.637,1390.91 662.945,1443.36 665.253,1482.73 667.561,1332.58 669.869,1417.85 672.177,1305.53 674.484,1488.31 676.792,1263.48 679.1,1365.77 681.408,1335.84 683.716,1401.56 686.024,1307.53 688.332,1336.44 690.64,1276.42 692.948,1546.85 695.256,1290.26 697.564,1334.52 699.871,1325.28 702.179,1418.74 704.487,1484.28 706.795,1357.66 709.103,1401.99 711.411,1344.44 713.719,1489.2 716.027,1456.53 718.335,1366.12 720.643,1213.63 722.951,1264.35 725.259,1328.64 727.566,1173.19 729.874,1172.7 732.182,1302.61 734.49,1321.28 736.798,1379.23 739.106,1408.09 741.414,1329.25 743.722,1448.86 746.03,1353.24 748.338,1339.65 750.646,1407.47 752.953,1256.18 755.261,1393.03 757.569,1377.13 759.877,1397.9 762.185,1255.11 764.493,1426.71 766.801,1204.52 769.109,1262.12 771.417,1368.68 773.725,1490.19 776.033,1315.78 778.34,1440.43 780.648,1370.29 782.956,1271.19 785.264,1368.49 787.572,1278.76 789.88,1450.99 792.188,1366.31 794.496,1490.4 796.804,1304.95 799.112,1320.99 801.42,1357.88 803.728,1299.7 806.035,1228.27 808.343,1208.87 810.651,1402.49 812.959,1414.69 815.267,1453.16 817.575,1322.03 819.883,1377.43 822.191,1330.87 824.499,1316.54 826.807,1212.99 829.115,1421.09 831.422,1197.91 833.73,1481.49 836.038,1331.82 838.346,1286.49 840.654,1408.47 842.962,1312.03 845.27,1349.92 847.578,1397.06 849.886,1576.75 852.194,1489.11 854.502,1409.07 856.809,1374.03 859.117,1329.68 861.425,1400.09 863.733,1486.12 866.041,1331.44 868.349,1579.03 870.657,1430.54 872.965,1493.49 875.273,1433.29 877.581,1445.83 879.889,1413.72 882.197,1362.78 884.504,1285.68 886.812,1431.38 889.12,1407.15 891.428,1410.76 893.736,1230.68 896.044,1395.42 898.352,1483.35 900.66,1363.25 902.968,1272.63 905.276,1387.3 907.584,1307.92 909.891,1510.02 912.199,1585.06 914.507,1221.09 916.815,1137.96 919.123,1379.09 921.431,1454.59 923.739,1340.12 926.047,1461.86 928.355,1377.57 930.663,1356.43 932.971,1373.48 935.278,1411.66 937.586,1382.12 939.894,1355.18 942.202,1397.88 944.51,1504.47 946.818,1356.72 949.126,1503.83 951.434,1408.79 953.742,1417.51 956.05,1305.68 958.358,1354.88 960.665,1408.56 962.973,1214.44 965.281,1307.09 967.589,1311.41 969.897,1475.98 972.205,1354.92 974.513,1289.31 976.821,1233.55 979.129,1388.9 981.437,1330.34 983.745,1401.14 986.053,1374.3 988.36,1395.41 990.668,1300.9 992.976,1433.21 995.284,1313.6 997.592,1555.27 999.9,1282.5 1002.21,1532.89 1004.52,1528.11 1006.82,1277.05 1009.13,1183.66 1011.44,1424.72 1013.75,1340.95 1016.06,1390.44 1018.36,1427.23 1020.67,1246.7 1022.98,1438.46 1025.29,1378.37 1027.59,1220.51 1029.9,1207.8 1032.21,1356.21 1034.52,1304.49 1036.83,1393.23 1039.13,1311.21 1041.44,1396.28 1043.75,1345.3 1046.06,1263.14 1048.37,1381.16 1050.67,1477.71 1052.98,1432.99 1055.29,1476.28 1057.6,1335.88 1059.91,1226.77 1062.21,1516.17 1064.52,1292.83 1066.83,1560.35 1069.14,1367.63 1071.45,1410.22 1073.75,1340.01 1076.06,1317.63 1078.37,1382.14 1080.68,1195.31 1082.98,1607.4 1085.29,1264.57 1087.6,1333.85 1089.91,1139.53 1092.22,1390.43 1094.52,1578.53 1096.83,1191.91 1099.14,1366.74 1101.45,1316.21 1103.76,1471.19 1106.06,1477.01 1108.37,1388.79 1110.68,1323.37 1112.99,1355.42 1115.3,1424.96 1117.6,1464.95 1119.91,1396.3 1122.22,1420.57 1124.53,1228.76 1126.84,1362.9 1129.14,1284.48 1131.45,1221.39 1133.76,1386.02 1136.07,1456.82 1138.37,1333.2 1140.68,1461.16 1142.99,1276.17 1145.3,1391.26 1147.61,1150.3 1149.91,1274.38 1152.22,1459.83 1154.53,1385.06 1156.84,1559.14 1159.15,1529.71 1161.45,1480.29 1163.76,1494.62 1166.07,1436.44 1168.38,1316.3 1170.69,1437.13 1172.99,1334.11 1175.3,1414.35 1177.61,1189.5 1179.92,1415.25 1182.23,1146.43 1184.53,1339.56 1186.84,1234.59 1189.15,1398.52 1191.46,1324.94 1193.76,1338.96 1196.07,1437.7 1198.38,1609.1 1200.69,1321.18 1203,1403.25 1205.3,1392.02 1207.61,1439.51 1209.92,1235.18 1212.23,1532.18 1214.54,1458.86 1216.84,1276.84 1219.15,1404.36 1221.46,1352.58 1223.77,1452.44 1226.08,1440.67 1228.38,1304.23 1230.69,1517.3 1233,1335.91 1235.31,1462.1 1237.61,1551.03 1239.92,1338.69 1242.23,1253.24 1244.54,1266.8 1246.85,1386.53 1249.15,1369.77 1251.46,1328.87 1253.77,1412.8 1256.08,1300.43 1258.39,1315.83 1260.69,1476.8 1263,1385.99 1265.31,1347.59 1267.62,1514.67 1269.93,1534.11 1272.23,1318.32 1274.54,1491.75 1276.85,1346.11 1279.16,1193.82 1281.47,1333.96 1283.77,1383.79 1286.08,1383.04 1288.39,1359.78 1290.7,1305.9 1293,1351.35 1295.31,1316.81 1297.62,1373.64 1299.93,1306.54 1302.24,1319.65 1304.54,1209.8 1306.85,1298.95 1309.16,1411.43 1311.47,1410.65 1313.78,1153.38 1316.08,1237.71 1318.39,1485.07 1320.7,1206.47 1323.01,1400.53 1325.32,1416.88 1327.62,1191.7 1329.93,1458.45 1332.24,1509.52 1334.55,1296.48 1336.86,1341.64 1339.16,1257.53 1341.47,1397.24 1343.78,1205.43 1346.09,1514.66 1348.39,1414.3 1350.7,1352.51 1353.01,1333.36 1355.32,1434.72 1357.63,1214.33 1359.93,1291.68 1362.24,1392.45 1364.55,1338 1366.86,1391.15 1369.17,1338.4 1371.47,1436.16 1373.78,1332.73 1376.09,1326.4 1378.4,1489.32 1380.71,1350.13 1383.01,1320.61 1385.32,1360.11 1387.63,1329.54 1389.94,1300.88 1392.24,1260.87 1394.55,1289.33 1396.86,1273.67 1399.17,1422.17 1401.48,1453.96 1403.78,1301.83 1406.09,1445.82 1408.4,1467.4 1410.71,1523.94 1413.02,1151.62 1415.32,1365.85 1417.63,1434.44 1419.94,1429.07 1422.25,1304.18 1424.56,1400.21 1426.86,1283.85 1429.17,1214.71 1431.48,1291.93 1433.79,1297.45 1436.1,1396.52 1438.4,1520.19 1440.71,1400.45 1443.02,1215.55 1445.33,1453.45 1447.63,1300.89 1449.94,1293.59 1452.25,1310.41 1454.56,1301.88 1456.87,1391.84 1459.17,1302.17 1461.48,1382.37 1463.79,1370.11 1466.1,1328.86 1468.41,1212.24 1470.71,1234.03 1473.02,1372.71 1475.33,1314.38 1477.64,1274.9 1479.95,1287.01 1482.25,1246.02 1484.56,1431.39 1486.87,1369.84 1489.18,1402.71 1491.49,1491.19 1493.79,1320.1 1496.1,1443.3 1498.41,1594.51 1500.72,1336.17 1503.02,1435.8 1505.33,1406.83 1507.64,1356.23 1509.95,1332.02 1512.26,1524.38 1514.56,1167.13 1516.87,1244.92 1519.18,1448.96 1521.49,1396.62 1523.8,1309.5 1526.1,1408.69 1528.41,1389.4 1530.72,1244.23 1533.03,1387.64 1535.34,1647.94 1537.64,1374.12 1539.95,1278.17 1542.26,1206.62 1544.57,1411.41 1546.88,1419.17 1549.18,1558.89 1551.49,1425.71 1553.8,1357.81 1556.11,1407.76 1558.41,1191.64 1560.72,1409.84 1563.03,1422.83 1565.34,1255.83 1567.65,1309.08 1569.95,1548.21 1572.26,1402.18 1574.57,1455.09 1576.88,1516.27 1579.19,1545.25 1581.49,1403.96 1583.8,1256.06 1586.11,1325.14 1588.42,1259.4 1590.73,1206.07 1593.03,1371.19 1595.34,1333.79 1597.65,1328.1 1599.96,1407.4 1602.26,1469.18 1604.57,1438.94 1606.88,1280.2 1609.19,1349.08 1611.5,1485.61 1613.8,1459.91 1616.11,1494.19 1618.42,1328.51 1620.73,1279.03 1623.04,1366.4 1625.34,1382.35 1627.65,1330.93 1629.96,1353.78 1632.27,1392.48 1634.58,1365.49 1636.88,1194.2 1639.19,1330.23 1641.5,1300.81 1643.81,1375.28 1646.12,1298.83 1648.42,1306.21 1650.73,1291.2 1653.04,1466.46 1655.35,1376.83 1657.65,1503.72 1659.96,1409.63 1662.27,1356.96 1664.58,1478.51 1666.89,1364.9 1669.19,1358.39 1671.5,1356.68 1673.81,1491.82 1676.12,1364.29 1678.43,1337.66 1680.73,1315.75 1683.04,1477.67 1685.35,1494.35 1687.66,1319.62 1689.97,1356.93 1692.27,1332.6 1694.58,1533.68 1696.89,1509.6 1699.2,1268.77 1701.51,1454.5 1703.81,1329.48 1706.12,1451.91 1708.43,1411.24 1710.74,1437.2 1713.04,1391.79 1715.35,1366.72 1717.66,1348.69 1719.97,1194.5 1722.28,1257.71 1724.58,1751.15 1726.89,1324.08 1729.2,1574.96 1731.51,1562.59 1733.82,1367.51 1736.12,1370.14 1738.43,1480.54 1740.74,1255.7 1743.05,1291.51 1745.36,1322.29 1747.66,1471.86 1749.97,1497.7 1752.28,1333.31 1754.59,1184.98 1756.9,1418.63 1759.2,1438.47 1761.51,1290.97 1763.82,1335.47 1766.13,1280.56 1768.43,1362.08 1770.74,1326.2 1773.05,1492.16 1775.36,1381.39 1777.67,1476.37 1779.97,1285.87 1782.28,1349.58 1784.59,1209.93 1786.9,1142.3 1789.21,1341.34 1791.51,1309.86 1793.82,1260.32 1796.13,1389.94 1798.44,1244.42 1800.75,1301.68 1803.05,1332.82 1805.36,1419.32 1807.67,1496.1 1809.98,1426.23 1812.28,1369.92 1814.59,1402.42 1816.9,1433.41 1819.21,1298.59 1821.52,1415.24 1823.82,1432.21 1826.13,1261.84 1828.44,1413.22 1830.75,1383.41 1833.06,1508.61 1835.36,1354.3 1837.67,1417.3 1839.98,1357.48 1842.29,1232.52 1844.6,1252.53 1846.9,1342.34 1849.21,1299.74 1851.52,1294.15 1853.83,1276.42 1856.14,1394.46 1858.44,1331.54 1860.75,1678.31 1863.06,1284.36 1865.37,1223.02 1867.67,1441.67 1869.98,1507.09 1872.29,1340.62 1874.6,1400.35 1876.91,1399.56 1879.21,1547.15 1881.52,1433.45 1883.83,1268.61 1886.14,1450.49 1888.45,1443.63 1890.75,1389.42 1893.06,1440.68 1895.37,1387.86 1897.68,1216.91 1899.99,1338.76 1902.29,1303.32 1904.6,1344.39 1906.91,1351.4 1909.22,1394.25 1911.53,1434.12 1913.83,1258.52 1916.14,1341.77 1918.45,1591.84 1920.76,1339.37 1923.06,1495.63 1925.37,1430.58 1927.68,1345.73 1929.99,1285.12 1932.3,1466.06 1934.6,1448.17 1936.91,1517.61 1939.22,1349.37 1941.53,1445.43 1943.84,1483.47 1946.14,1496.58 1948.45,1306.17 1950.76,1350.97 1953.07,1187.36 1955.38,1362.83 1957.68,1321.3 1959.99,1430.33 1962.3,1437.59 1964.61,1409.23 1966.91,1318.62 1969.22,1383.01 1971.53,1360.77 1973.84,1531.17 1976.15,1603.47 1978.45,1451.52 1980.76,1482.24 1983.07,1321.77 1985.38,1437.56 1987.69,1325.53 1989.99,1454.54 1992.3,1394.11 1994.61,1372.56 1996.92,1280.39 1999.23,1349.76 2001.53,1355.67 2003.84,1463.37 2006.15,1517.09 2008.46,1424.89 2010.77,1215.49 2013.07,1447.94 2015.38,1287.29 2017.69,1439.98 2020,1323.04 2022.3,1298.99 2024.61,1260.49 2026.92,1367 2029.23,1338.25 2031.54,1405.92 2033.84,1440.56 2036.15,1393.72 2038.46,1426.08 2040.77,1215.78 2043.08,1543.97 2045.38,1360.62 2047.69,1431.03 2050,1316.36 2052.31,1408.89 2054.62,1448.7 2056.92,1456.1 2059.23,1365.04 2061.54,1444.17 2063.85,1458.06 2066.16,1377.36 2068.46,1419.31 2070.77,1439.83 2073.08,1385.71 2075.39,1462.11 2077.69,1296.29 2080,1372.34 2082.31,1385.48 2084.62,1337.26 2086.93,1430.07 2089.23,1267.62 2091.54,1526.53 2093.85,1421.9 2096.16,1345.49 2098.47,1433.69 2100.77,1324.37 2103.08,1301.52 2105.39,1278.16 2107.7,1375.04 2110.01,1231.76 2112.31,1252.39 2114.62,1416.95 2116.93,1229.74 2119.24,1372.31 2121.55,1343.44 2123.85,1227.81 2126.16,1437.23 2128.47,1350.15 2130.78,1415.25 2133.08,1439.46 2135.39,1254.82 2137.7,1349.38 2140.01,1326.67 2142.32,1271.68 2144.62,1375.75 2146.93,1381.98 2149.24,1432.03 2151.55,1355.08 2153.86,1489.25 2156.16,1309.5 2158.47,1566.36 2160.78,1378.85 2163.09,1416.46 2165.4,1427.29 2167.7,1433.99 2170.01,1452.47 2172.32,1257.03 2174.63,1349.38 2176.93,1395.74 2179.24,1233.09 2181.55,1294.5 2183.86,1553.73 2186.17,1482.41 2188.47,1408.61 2190.78,1506.28 2193.09,1324.04 2195.4,1252.28 2197.71,1565.11 2200.01,1354.3 2202.32,1568.82 2204.63,1188.13 2206.94,1497.24 2209.25,1392.61 2211.55,1335.93 2213.86,1330.07 2216.17,1405.94 2218.48,1379.14 2220.79,1205.91 2223.09,1347.4 2225.4,1399.04 2227.71,1361.68 2230.02,1302.92 2232.32,1306.48 2234.63,1443.35 2236.94,1262.04 2239.25,1378.43 2241.56,1404.08 2243.86,1432.49 2246.17,1396.4 2248.48,1384.1 2250.79,1191.29 2253.1,1340.48 2255.4,1154.27 2257.71,1337.71 2260.02,1469.28 2262.33,1370.33 2264.64,1436.39 2266.94,1482.08 2269.25,1322.91 2271.56,1445.59 2273.87,1414.55 2276.18,1120.3 2278.48,1352.87 2280.79,1404.91 2283.1,1303.17 2285.41,1475.83 2287.71,1365.92 2290.02,1466.65 2292.33,1299.1 2294.64,1506.01 2296.95,1364.46 2299.25,1416.57 2301.56,1410.86 2303.87,1355.72 2306.18,1498.32 2308.49,1459.29 2310.79,1273.99 2313.1,1380.44 2315.41,1481.65 2317.72,1302.72 2320.03,1326.59 2322.33,1524.98 2324.64,1461.15 2326.95,1401.71 2329.26,1340.76 2331.56,1218.92 2333.87,1331.03 2336.18,1324.1 2338.49,1410.75 2340.8,1394.37 2343.1,1391.4 2345.41,1598.23 2347.72,1336.82 2350.03,1262.51 2352.34,1192.67 2354.64,1456.77 2356.95,1297.08 2359.26,1355.77 2361.57,1400.58 2363.88,1434.72 2366.18,1435.65 2368.49,1370.27 2370.8,1458.04 2373.11,1417.58 2375.42,1380.04 2377.72,1308.56 2380.03,1304.94 2382.34,1386.97 2384.65,1428.1 2386.95,1306.84 2389.26,1534.02 2391.57,1315.87 2393.88,1435 2396.19,1343.2 2398.49,1502.04 2400.8,1238.76 2403.11,1269.87 2405.42,1161.01 2407.73,1291.72 2410.03,1219.39 2412.34,1260.72 2414.65,1388.26 2416.96,1389.21 2419.27,1484.14 2421.57,1453.48 2423.88,1359.72 2426.19,1455.95 2428.5,1528.6 2430.81,1399.34 2433.11,1509.16 2435.42,1286.1 2437.73,1356.96 2440.04,1551.11 2442.34,1371.14 2444.65,1396.57 2446.96,1306.83 2449.27,1469.49 2451.58,1476.83 2453.88,1348.05 2456.19,1292.29 2458.5,1335.59 2460.81,1297.67 2463.12,1421.93 2465.42,1246.79 2467.73,1403.88 2470.04,1400.31 2472.35,1495.36 2474.66,1337.21 2476.96,1387.95 2479.27,1165.95 2481.58,1336.64 2483.89,1332.62 2486.2,1461.6 2488.5,1416.35 2490.81,1306.2 2493.12,1337.03 2495.43,1406.57 2497.73,1282.62 2500.04,1294.56 2502.35,1342.03 2504.66,1347.62 2506.97,1297.17 2509.27,1458.56 2511.58,1369.59 2513.89,1264.44 2516.2,1345.75 2518.51,1275.05 2520.81,1265.81 2523.12,1398.31 2525.43,1283.31 2527.74,1473.41 2530.05,1256.03 2532.35,1276.6 2534.66,1267.26 2536.97,1315.52 2539.28,1476.05 2541.58,1303.65 2543.89,1344.34 2546.2,1521.4 2548.51,1250.89 2550.82,1366.76 2553.12,1386.97 2555.43,1361.34 2557.74,1470.87 2560.05,1267.14 2562.36,1491.94 2564.66,1184.9 2566.97,1500.26 2569.28,1376.29 2571.59,1418.97 "></polyline>
<polyline clip-path="url(#clip002)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,925.185 268.292,871.499 270.6,1136.24 272.908,903.498 275.216,863.616 277.524,884.175 279.832,893.625 282.139,771.23 284.447,883.871 286.755,882.384 289.063,906.645 291.371,762.882 293.679,721.884 295.987,877.474 298.295,858.045 300.603,846.569 302.911,865.96 305.219,1017.93 307.527,875.522 309.834,921.952 312.142,951.131 314.45,868.793 316.758,826.634 319.066,925.133 321.374,875.61 323.682,874.848 325.99,974.416 328.298,847.269 330.606,833.72 332.914,857.331 335.221,879.167 337.529,719.125 339.837,1002.29 342.145,989.008 344.453,948.422 346.761,957.291 349.069,867.675 351.377,745.524 353.685,907.432 355.993,1002.48 358.301,925.53 360.608,853.971 362.916,872.85 365.224,1036.79 367.532,895.064 369.84,888.141 372.148,860.668 374.456,954.347 376.764,937.13 379.072,1019.07 381.38,939.171 383.688,907.606 385.996,809.485 388.303,1068.59 390.611,1014.56 392.919,1025.33 395.227,773.462 397.535,806.873 399.843,895.779 402.151,917.192 404.459,881.045 406.767,728.018 409.075,881.536 411.383,874.834 413.69,864.467 415.998,893.455 418.306,952.367 420.614,939.405 422.922,926.355 425.23,743.84 427.538,915.197 429.846,992.026 432.154,860.8 434.462,929.853 436.77,935.881 439.077,842.938 441.385,808.445 443.693,885.831 446.001,921.948 448.309,845.431 450.617,926.778 452.925,746.608 455.233,827.414 457.541,940.451 459.849,1043.07 462.157,881.738 464.465,813.94 466.772,888.092 469.08,759.681 471.388,792.133 473.696,908.989 476.004,984.434 478.312,984.98 480.62,871.135 482.928,812.673 485.236,1062.71 487.544,940.929 489.852,1003.96 492.159,984.264 494.467,951.672 496.775,752.941 499.083,948.629 501.391,980.725 503.699,774.66 506.007,904.466 508.315,897.438 510.623,992.346 512.931,825.736 515.239,964.218 517.546,877.796 519.854,706.501 522.162,851.127 524.47,832.424 526.778,1004.71 529.086,842.654 531.394,854.65 533.702,933.279 536.01,778.858 538.318,1102.73 540.626,851.793 542.933,998.414 545.241,1034.7 547.549,936.512 549.857,727.285 552.165,886.256 554.473,1198.38 556.781,970.39 559.089,1028.64 561.397,923.388 563.705,897.565 566.013,911.712 568.321,867.532 570.628,948.215 572.936,963.155 575.244,783.465 577.552,828.967 579.86,1035.3 582.168,1017.61 584.476,1072.34 586.784,966.804 589.092,829.443 591.4,808.894 593.708,864.762 596.015,1022.97 598.323,821.299 600.631,826.483 602.939,1016.09 605.247,798.027 607.555,932.401 609.863,842.727 612.171,959.9 614.479,990.946 616.787,963.044 619.095,875.596 621.402,1043.78 623.71,1080.49 626.018,821.216 628.326,752.664 630.634,942.358 632.942,763.038 635.25,836.455 637.558,993.48 639.866,1020.15 642.174,1042.61 644.482,793.72 646.79,804.095 649.097,1025.82 651.405,860.741 653.713,904.779 656.021,914.391 658.329,899.036 660.637,1127.72 662.945,932.46 665.253,758.521 667.561,1166.18 669.869,748.656 672.177,990.271 674.484,1016.94 676.792,884.407 679.1,977.235 681.408,917.37 683.716,855.368 686.024,903.182 688.332,838.878 690.64,888.093 692.948,897.886 695.256,858.498 697.564,808.495 699.871,990.288 702.179,849.808 704.487,833.177 706.795,860.258 709.103,962.118 711.411,873.583 713.719,994.139 716.027,891.96 718.335,998.278 720.643,781.66 722.951,999.892 725.259,844.858 727.566,842.732 729.874,1004.99 732.182,848.085 734.49,923.419 736.798,864.336 739.106,823.737 741.414,1029.31 743.722,798.648 746.03,1030.06 748.338,908.943 750.646,847.961 752.953,926.761 755.261,905.582 757.569,900.418 759.877,885.71 762.185,1014.6 764.493,1108.97 766.801,771.506 769.109,703.207 771.417,993.493 773.725,881.045 776.033,1009.49 778.34,737.883 780.648,902.582 782.956,766.899 785.264,751.199 787.572,922.345 789.88,1008.39 792.188,835.98 794.496,787.231 796.804,891.31 799.112,913.281 801.42,927.396 803.728,1006.43 806.035,950.49 808.343,913.073 810.651,740.313 812.959,893.189 815.267,990.213 817.575,950.223 819.883,1048.13 822.191,950 824.499,881.442 826.807,959.093 829.115,855.188 831.422,956.194 833.73,789.371 836.038,868.929 838.346,942.542 840.654,897.641 842.962,1008.25 845.27,1029.8 847.578,986.184 849.886,955.299 852.194,942.504 854.502,908.942 856.809,665.462 859.117,989.265 861.425,916.626 863.733,900.4 866.041,1020.47 868.349,932.988 870.657,978.62 872.965,907.558 875.273,984.525 877.581,990.619 879.889,848.594 882.197,952.855 884.504,966.235 886.812,895.025 889.12,799.286 891.428,1030.82 893.736,984.746 896.044,949.238 898.352,1062.43 900.66,772.901 902.968,976.5 905.276,938.32 907.584,920.926 909.891,965.544 912.199,904.922 914.507,961.03 916.815,763.152 919.123,795.805 921.431,911.945 923.739,931.581 926.047,867.626 928.355,865.147 930.663,937.921 932.971,845.129 935.278,940.549 937.586,832.746 939.894,998.803 942.202,940.978 944.51,877.001 946.818,846.169 949.126,1012.23 951.434,893.64 953.742,925.325 956.05,1007.46 958.358,831.167 960.665,1020.68 962.973,778.123 965.281,885.78 967.589,1048 969.897,999.006 972.205,742.848 974.513,944.613 976.821,1010.22 979.129,1062.38 981.437,861.914 983.745,1010.62 986.053,786.49 988.36,940.53 990.668,916.464 992.976,825.624 995.284,841.74 997.592,914.24 999.9,958.374 1002.21,852.019 1004.52,866.999 1006.82,898.729 1009.13,912.107 1011.44,979.982 1013.75,796.268 1016.06,1030.34 1018.36,811.993 1020.67,916.283 1022.98,935.842 1025.29,901.696 1027.59,983.706 1029.9,931.581 1032.21,880.656 1034.52,975.31 1036.83,1021.27 1039.13,796.502 1041.44,742.32 1043.75,643.534 1046.06,817.976 1048.37,1033.38 1050.67,821.155 1052.98,881.196 1055.29,653.143 1057.6,803.363 1059.91,942.514 1062.21,905.895 1064.52,1003.58 1066.83,799.114 1069.14,1088.86 1071.45,861.648 1073.75,780.363 1076.06,864.257 1078.37,693.661 1080.68,740.767 1082.98,990.6 1085.29,901.763 1087.6,803.074 1089.91,803.633 1092.22,916.034 1094.52,871.456 1096.83,768.532 1099.14,984.104 1101.45,852.082 1103.76,938.215 1106.06,996.081 1108.37,876.971 1110.68,1154.57 1112.99,880.378 1115.3,937.542 1117.6,833.312 1119.91,1054.68 1122.22,689.834 1124.53,745.945 1126.84,975.995 1129.14,981.768 1131.45,934.876 1133.76,866.04 1136.07,877.1 1138.37,831.137 1140.68,880.62 1142.99,821.357 1145.3,789.41 1147.61,870.904 1149.91,998.159 1152.22,813.272 1154.53,955.398 1156.84,866.333 1159.15,910.945 1161.45,849.717 1163.76,759.803 1166.07,952.72 1168.38,834.384 1170.69,946.161 1172.99,849.045 1175.3,863.257 1177.61,925.326 1179.92,997.205 1182.23,723.893 1184.53,1060.55 1186.84,962.316 1189.15,819.012 1191.46,635.832 1193.76,902.593 1196.07,1033.78 1198.38,875.139 1200.69,1071.28 1203,960.044 1205.3,943.194 1207.61,851.819 1209.92,870.185 1212.23,945.031 1214.54,903.418 1216.84,978.071 1219.15,998.184 1221.46,775.346 1223.77,967.444 1226.08,953.077 1228.38,932.156 1230.69,809.786 1233,977.115 1235.31,894.226 1237.61,971.883 1239.92,1023.05 1242.23,884.356 1244.54,707.171 1246.85,863.934 1249.15,929.794 1251.46,952.278 1253.77,905.573 1256.08,824.66 1258.39,899.623 1260.69,1002.49 1263,911.959 1265.31,837.592 1267.62,894.995 1269.93,787.91 1272.23,852.051 1274.54,908.273 1276.85,950.249 1279.16,831.883 1281.47,760.249 1283.77,906.756 1286.08,1002.56 1288.39,691.31 1290.7,915.408 1293,775.62 1295.31,777.981 1297.62,877.595 1299.93,751.125 1302.24,800.616 1304.54,996.838 1306.85,896.593 1309.16,878.988 1311.47,917.494 1313.78,954.323 1316.08,897.133 1318.39,835.095 1320.7,829.784 1323.01,909.565 1325.32,1029.76 1327.62,877.243 1329.93,907.452 1332.24,1069.93 1334.55,853.403 1336.86,814.422 1339.16,1023.81 1341.47,893.436 1343.78,845.112 1346.09,1047.06 1348.39,1114.24 1350.7,848.763 1353.01,1012.53 1355.32,770.08 1357.63,956.191 1359.93,766.511 1362.24,824.36 1364.55,979.28 1366.86,1027.36 1369.17,904.174 1371.47,954.833 1373.78,970.515 1376.09,879.342 1378.4,805.901 1380.71,1013.17 1383.01,967.459 1385.32,986.375 1387.63,806.078 1389.94,861.785 1392.24,845.399 1394.55,848.513 1396.86,878.421 1399.17,843.979 1401.48,762.03 1403.78,975.986 1406.09,912.721 1408.4,878.952 1410.71,961.312 1413.02,952.041 1415.32,903.86 1417.63,870.676 1419.94,774.086 1422.25,761.491 1424.56,926.72 1426.86,1002.51 1429.17,966.486 1431.48,809.439 1433.79,1094.16 1436.1,806.095 1438.4,888.779 1440.71,1074.22 1443.02,911.325 1445.33,918.407 1447.63,878.653 1449.94,839.49 1452.25,1033.55 1454.56,903.223 1456.87,869.395 1459.17,863.406 1461.48,730.735 1463.79,943.847 1466.1,925.48 1468.41,1054.53 1470.71,764.909 1473.02,885.223 1475.33,1057.8 1477.64,875.113 1479.95,928.609 1482.25,893.263 1484.56,817.006 1486.87,784.432 1489.18,892.54 1491.49,840.811 1493.79,838.424 1496.1,916.314 1498.41,1037.07 1500.72,904.074 1503.02,723.485 1505.33,930.728 1507.64,848.653 1509.95,819.222 1512.26,1019.35 1514.56,917.641 1516.87,946.779 1519.18,1049.79 1521.49,839.402 1523.8,1014.34 1526.1,873.527 1528.41,933.313 1530.72,907.273 1533.03,1082.5 1535.34,784.827 1537.64,824.185 1539.95,843.998 1542.26,817.554 1544.57,784.712 1546.88,812.108 1549.18,952.578 1551.49,978.581 1553.8,838.963 1556.11,828.532 1558.41,969.604 1560.72,959.009 1563.03,825.811 1565.34,938.623 1567.65,796.305 1569.95,1099.88 1572.26,972.448 1574.57,946.656 1576.88,1058.17 1579.19,896.911 1581.49,860.37 1583.8,1013.92 1586.11,848.74 1588.42,919.713 1590.73,879.424 1593.03,948.087 1595.34,837.602 1597.65,817.783 1599.96,925.718 1602.26,799.041 1604.57,887.272 1606.88,794.972 1609.19,789.243 1611.5,822.561 1613.8,874.261 1616.11,970.131 1618.42,745.323 1620.73,1095.43 1623.04,979.516 1625.34,757.419 1627.65,755.161 1629.96,908.974 1632.27,908.716 1634.58,845.356 1636.88,1015.33 1639.19,860.233 1641.5,921.502 1643.81,848.765 1646.12,950.503 1648.42,959.696 1650.73,901.502 1653.04,876.535 1655.35,644.275 1657.65,991.546 1659.96,1048.97 1662.27,825.886 1664.58,837.6 1666.89,860.438 1669.19,756.571 1671.5,843.959 1673.81,858.179 1676.12,870.589 1678.43,833.679 1680.73,883.722 1683.04,852.229 1685.35,1055.57 1687.66,1022.42 1689.97,905.431 1692.27,846.124 1694.58,762.424 1696.89,945.98 1699.2,867.467 1701.51,1072.79 1703.81,751.932 1706.12,930.055 1708.43,835.675 1710.74,857.218 1713.04,795.487 1715.35,864.908 1717.66,813.249 1719.97,849.955 1722.28,962.89 1724.58,976.774 1726.89,964.124 1729.2,783.284 1731.51,859.245 1733.82,730.632 1736.12,912.868 1738.43,984.346 1740.74,804.173 1743.05,931.103 1745.36,932.671 1747.66,855.51 1749.97,819.135 1752.28,722.994 1754.59,921.572 1756.9,957.201 1759.2,934.874 1761.51,707.365 1763.82,982.382 1766.13,852.572 1768.43,1017.93 1770.74,895.863 1773.05,802.276 1775.36,913.418 1777.67,907.038 1779.97,826.815 1782.28,1053.48 1784.59,782.111 1786.9,890.753 1789.21,857.537 1791.51,924.793 1793.82,915.358 1796.13,936.647 1798.44,1027.75 1800.75,916.646 1803.05,786.101 1805.36,972.77 1807.67,796.03 1809.98,803.174 1812.28,957.608 1814.59,1034.12 1816.9,965.484 1819.21,957.444 1821.52,833.115 1823.82,969.338 1826.13,971.741 1828.44,990.393 1830.75,947.999 1833.06,1081.17 1835.36,953.689 1837.67,1035.69 1839.98,971.698 1842.29,832.421 1844.6,884.845 1846.9,984.27 1849.21,968.583 1851.52,838.461 1853.83,772.856 1856.14,905.013 1858.44,940.82 1860.75,658.835 1863.06,1124.71 1865.37,899.875 1867.67,936.362 1869.98,1018.64 1872.29,834.827 1874.6,866.986 1876.91,874.132 1879.21,796.035 1881.52,830.117 1883.83,1020.93 1886.14,1061.15 1888.45,844.763 1890.75,841.682 1893.06,794.542 1895.37,898.111 1897.68,852.902 1899.99,880.223 1902.29,802.539 1904.6,1009.51 1906.91,841.829 1909.22,783.482 1911.53,844.244 1913.83,1001.83 1916.14,887.868 1918.45,817.372 1920.76,814.811 1923.06,975.929 1925.37,950.893 1927.68,952.943 1929.99,866.589 1932.3,869.399 1934.6,1080.02 1936.91,789.328 1939.22,986.903 1941.53,1115.23 1943.84,914.232 1946.14,1057.36 1948.45,849.751 1950.76,734.946 1953.07,765.833 1955.38,934.75 1957.68,959.291 1959.99,904.918 1962.3,909.153 1964.61,908.175 1966.91,916.929 1969.22,961.603 1971.53,931.9 1973.84,891.322 1976.15,812.952 1978.45,904.665 1980.76,922.201 1983.07,1027.94 1985.38,878.132 1987.69,859.566 1989.99,885.875 1992.3,896.477 1994.61,976.409 1996.92,831.606 1999.23,843.417 2001.53,994.392 2003.84,875.808 2006.15,891.68 2008.46,946.958 2010.77,1056.53 2013.07,848.62 2015.38,728.487 2017.69,929.086 2020,956.035 2022.3,1123.21 2024.61,824.158 2026.92,944.468 2029.23,1014.03 2031.54,854.901 2033.84,847.462 2036.15,876.538 2038.46,1020.31 2040.77,789.271 2043.08,907.301 2045.38,775.475 2047.69,880.724 2050,962.216 2052.31,866.397 2054.62,797.332 2056.92,955.394 2059.23,873.751 2061.54,908.976 2063.85,951.025 2066.16,1077.21 2068.46,1027.36 2070.77,767.023 2073.08,954.472 2075.39,876.516 2077.69,770.475 2080,912.221 2082.31,937.687 2084.62,967.287 2086.93,884.06 2089.23,1061.83 2091.54,891.725 2093.85,735.814 2096.16,894.128 2098.47,921.261 2100.77,1035.75 2103.08,848.35 2105.39,983.629 2107.7,717.136 2110.01,923.984 2112.31,922.114 2114.62,879.157 2116.93,805.933 2119.24,980.361 2121.55,820.107 2123.85,932.695 2126.16,968.58 2128.47,922.52 2130.78,977.402 2133.08,1008.83 2135.39,882.01 2137.7,810.808 2140.01,840.607 2142.32,891.226 2144.62,869.655 2146.93,722.49 2149.24,920.151 2151.55,908.845 2153.86,787.956 2156.16,886.752 2158.47,974.614 2160.78,858.319 2163.09,850.722 2165.4,831.103 2167.7,877.407 2170.01,879.791 2172.32,901.614 2174.63,1028.11 2176.93,763.367 2179.24,933.733 2181.55,976.809 2183.86,874.939 2186.17,905.473 2188.47,927.758 2190.78,844.803 2193.09,918.481 2195.4,925.74 2197.71,857.579 2200.01,872.753 2202.32,745.579 2204.63,923.836 2206.94,935.42 2209.25,812.868 2211.55,988.358 2213.86,956.312 2216.17,889.698 2218.48,759.071 2220.79,897.586 2223.09,970.754 2225.4,806.151 2227.71,871.051 2230.02,817.848 2232.32,867.48 2234.63,838.472 2236.94,915.863 2239.25,895.598 2241.56,824.939 2243.86,1129.01 2246.17,876.458 2248.48,899.51 2250.79,896.411 2253.1,885.848 2255.4,845.873 2257.71,922.591 2260.02,1027.29 2262.33,928.134 2264.64,944.794 2266.94,900.971 2269.25,890.963 2271.56,780.205 2273.87,965.315 2276.18,760.597 2278.48,905.632 2280.79,869.601 2283.1,946.374 2285.41,780.874 2287.71,962.229 2290.02,878.479 2292.33,936.786 2294.64,887.405 2296.95,890.252 2299.25,966.087 2301.56,924.773 2303.87,925.223 2306.18,943.028 2308.49,924.069 2310.79,997.001 2313.1,864.176 2315.41,916.848 2317.72,900.322 2320.03,803.972 2322.33,1114.05 2324.64,925.875 2326.95,864.934 2329.26,829.969 2331.56,894.288 2333.87,830.286 2336.18,840.907 2338.49,874.89 2340.8,1064.89 2343.1,891.09 2345.41,906.743 2347.72,884.152 2350.03,881.232 2352.34,895.258 2354.64,804.057 2356.95,748.23 2359.26,939.225 2361.57,1029.63 2363.88,895.997 2366.18,805.437 2368.49,777.503 2370.8,884.651 2373.11,775.737 2375.42,760.052 2377.72,813.688 2380.03,953.792 2382.34,749.023 2384.65,986.345 2386.95,860.567 2389.26,922.722 2391.57,1050.53 2393.88,941.709 2396.19,882.026 2398.49,952.565 2400.8,909.203 2403.11,997.261 2405.42,871.632 2407.73,802.491 2410.03,936.625 2412.34,866.362 2414.65,888.244 2416.96,891.972 2419.27,900.952 2421.57,898.032 2423.88,899.106 2426.19,999.846 2428.5,887.913 2430.81,1202.38 2433.11,1017.91 2435.42,861.133 2437.73,936.259 2440.04,797.523 2442.34,1192.83 2444.65,911.34 2446.96,1096.96 2449.27,774.281 2451.58,709.309 2453.88,967.708 2456.19,783.01 2458.5,949.492 2460.81,877.577 2463.12,1063.24 2465.42,1002 2467.73,906.639 2470.04,912.646 2472.35,929.577 2474.66,855.726 2476.96,692.899 2479.27,848.631 2481.58,889.877 2483.89,973.01 2486.2,1015.35 2488.5,880.851 2490.81,875.916 2493.12,970.458 2495.43,942.742 2497.73,915.609 2500.04,924.857 2502.35,861.05 2504.66,938.936 2506.97,915.198 2509.27,902.486 2511.58,974.389 2513.89,935.931 2516.2,887.733 2518.51,954.687 2520.81,893.177 2523.12,890.585 2525.43,778.251 2527.74,932.873 2530.05,830.368 2532.35,874.92 2534.66,785.302 2536.97,996.62 2539.28,1092.4 2541.58,820.663 2543.89,926.249 2546.2,1046.65 2548.51,931.464 2550.82,881.904 2553.12,996.159 2555.43,905.793 2557.74,923.945 2560.05,863.107 2562.36,866.115 2564.66,871.522 2566.97,827.863 2569.28,985.572 2571.59,840.384 "></polyline>
<polyline clip-path="url(#clip002)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,792.246 268.292,448.686 270.6,439.379 272.908,510.462 275.216,386.803 277.524,541.687 279.832,435.183 282.139,331.937 284.447,461.887 286.755,330.419 289.063,385.963 291.371,516.161 293.679,425.775 295.987,414.726 298.295,210.694 300.603,477.303 302.911,364.243 305.219,596.232 307.527,434.828 309.834,315.023 312.142,411.69 314.45,528.981 316.758,246.99 319.066,540.571 321.374,490.063 323.682,592.781 325.99,517.649 328.298,586.079 330.606,367.042 332.914,322.929 335.221,477.828 337.529,308.75 339.837,452.766 342.145,273.707 344.453,294.326 346.761,260.925 349.069,540.409 351.377,348.834 353.685,413.057 355.993,385.016 358.301,598.281 360.608,471.721 362.916,400.844 365.224,381.802 367.532,430.673 369.84,303.69 372.148,449.27 374.456,454.713 376.764,332.577 379.072,381.631 381.38,329.757 383.688,482.705 385.996,300.335 388.303,347.584 390.611,448.243 392.919,468.234 395.227,270.193 397.535,225.436 399.843,437.017 402.151,568.865 404.459,384.077 406.767,488.197 409.075,425.25 411.383,585.961 413.69,381.842 415.998,363.127 418.306,398.688 420.614,405.932 422.922,358.685 425.23,446.473 427.538,416.01 429.846,260.084 432.154,369.555 434.462,457.734 436.77,434.38 439.077,499.861 441.385,246.156 443.693,331.613 446.001,304.705 448.309,282.731 450.617,376.24 452.925,469.153 455.233,437.556 457.541,500.112 459.849,532.443 462.157,439.537 464.465,517.293 466.772,705.155 469.08,327.981 471.388,361.317 473.696,420.602 476.004,194.207 478.312,442.552 480.62,491.359 482.928,152.792 485.236,354.06 487.544,625.572 489.852,423.299 492.159,393.454 494.467,381.005 496.775,439.115 499.083,290.796 501.391,446.727 503.699,438.076 506.007,506.705 508.315,509.934 510.623,555.555 512.931,380.513 515.239,401.431 517.546,469.394 519.854,439.554 522.162,490.938 524.47,313.793 526.778,441.246 529.086,553.383 531.394,251.361 533.702,300.378 536.01,334.28 538.318,582.838 540.626,460.023 542.933,504.686 545.241,380.719 547.549,407.391 549.857,374.526 552.165,387.175 554.473,316.371 556.781,501.853 559.089,302.569 561.397,376.251 563.705,585.322 566.013,432.286 568.321,595.372 570.628,600.8 572.936,460.97 575.244,432.565 577.552,499.652 579.86,583.043 582.168,440.298 584.476,312.887 586.784,395.318 589.092,505.092 591.4,341.407 593.708,438.78 596.015,366.783 598.323,323.611 600.631,540.922 602.939,536.575 605.247,624.15 607.555,390.095 609.863,654.76 612.171,371.75 614.479,477.454 616.787,377.704 619.095,295.871 621.402,376.361 623.71,459.512 626.018,271.724 628.326,507.511 630.634,371.267 632.942,370.617 635.25,491.709 637.558,228.276 639.866,370.076 642.174,415.746 644.482,502.689 646.79,405.773 649.097,446.965 651.405,444.228 653.713,429.175 656.021,422.885 658.329,500.483 660.637,347.495 662.945,494.245 665.253,230.851 667.561,284.86 669.869,422.934 672.177,431.537 674.484,371 676.792,291.53 679.1,338.822 681.408,473.012 683.716,522.753 686.024,426.557 688.332,523.57 690.64,532.21 692.948,347.03 695.256,453.525 697.564,469.511 699.871,516.467 702.179,412.9 704.487,379.544 706.795,638.574 709.103,272.658 711.411,409.595 713.719,351.354 716.027,466.894 718.335,356.121 720.643,473.266 722.951,300.898 725.259,277.263 727.566,476.917 729.874,394.196 732.182,408.561 734.49,488.818 736.798,405.144 739.106,430.023 741.414,484.89 743.722,434.931 746.03,401.617 748.338,436.476 750.646,579.841 752.953,535.529 755.261,406.723 757.569,375.476 759.877,513.411 762.185,382.972 764.493,333.683 766.801,354.767 769.109,543.077 771.417,416.202 773.725,534.452 776.033,373.803 778.34,412.066 780.648,418.439 782.956,395.216 785.264,315.786 787.572,317.771 789.88,308.323 792.188,351.859 794.496,378.174 796.804,432.978 799.112,324.033 801.42,274.231 803.728,469.904 806.035,472.086 808.343,386.754 810.651,502.329 812.959,528.471 815.267,394.207 817.575,627.929 819.883,290.988 822.191,545.445 824.499,387.16 826.807,458.327 829.115,415.645 831.422,415.457 833.73,250.359 836.038,543.263 838.346,485.578 840.654,311.493 842.962,432.631 845.27,478.57 847.578,428.021 849.886,329.214 852.194,337.027 854.502,544.09 856.809,388.468 859.117,481.002 861.425,438.19 863.733,438.269 866.041,480.351 868.349,476.42 870.657,470.649 872.965,375.237 875.273,189.029 877.581,466.327 879.889,414.965 882.197,502.504 884.504,242.893 886.812,530.453 889.12,562.771 891.428,462.903 893.736,397.337 896.044,525.638 898.352,484.63 900.66,346.269 902.968,534.21 905.276,228.952 907.584,506.195 909.891,665.452 912.199,272.499 914.507,509.863 916.815,438.501 919.123,322.543 921.431,436.857 923.739,414.215 926.047,442.265 928.355,398.394 930.663,607.455 932.971,476.31 935.278,371.212 937.586,533.183 939.894,398.283 942.202,531.859 944.51,448.841 946.818,438.977 949.126,355.973 951.434,408.869 953.742,470.946 956.05,552.139 958.358,475.639 960.665,324.283 962.973,484.525 965.281,408.293 967.589,298.756 969.897,638.236 972.205,397.954 974.513,437.582 976.821,382.447 979.129,456.912 981.437,293.523 983.745,254.836 986.053,604.514 988.36,450.083 990.668,175.261 992.976,288.326 995.284,306.181 997.592,419.972 999.9,511.837 1002.21,392.698 1004.52,433.27 1006.82,329.83 1009.13,539.334 1011.44,421.89 1013.75,516.026 1016.06,482.878 1018.36,369.291 1020.67,481.957 1022.98,543.418 1025.29,454.642 1027.59,543.648 1029.9,359.359 1032.21,442.44 1034.52,407.18 1036.83,302.832 1039.13,451.247 1041.44,440.542 1043.75,473.15 1046.06,310.848 1048.37,352.988 1050.67,327.937 1052.98,267.477 1055.29,387.35 1057.6,360.337 1059.91,562.437 1062.21,458.423 1064.52,473.148 1066.83,408.615 1069.14,467.808 1071.45,448.929 1073.75,427.762 1076.06,415.016 1078.37,311.096 1080.68,523.465 1082.98,398.798 1085.29,451.715 1087.6,358.526 1089.91,369.332 1092.22,376.044 1094.52,678.104 1096.83,434.627 1099.14,483.945 1101.45,490.395 1103.76,518 1106.06,349.033 1108.37,326.88 1110.68,442.705 1112.99,395.717 1115.3,423.268 1117.6,429.547 1119.91,465.566 1122.22,510.268 1124.53,460.694 1126.84,323.854 1129.14,327.786 1131.45,668.001 1133.76,386.122 1136.07,420.67 1138.37,351.389 1140.68,509.671 1142.99,409.999 1145.3,372.796 1147.61,336.851 1149.91,427.09 1152.22,363.405 1154.53,661.931 1156.84,483.975 1159.15,403.439 1161.45,286.825 1163.76,351.541 1166.07,403.374 1168.38,433.08 1170.69,342.927 1172.99,467.837 1175.3,503.968 1177.61,353.855 1179.92,349.165 1182.23,445.771 1184.53,400.588 1186.84,452.94 1189.15,416.099 1191.46,465.981 1193.76,299.793 1196.07,325.738 1198.38,481.068 1200.69,481.643 1203,439.189 1205.3,401.57 1207.61,372.549 1209.92,478.19 1212.23,535.849 1214.54,389.426 1216.84,252.344 1219.15,449.596 1221.46,414.51 1223.77,360.346 1226.08,385.168 1228.38,476.561 1230.69,361.299 1233,466.423 1235.31,366.993 1237.61,574.251 1239.92,343.323 1242.23,291.727 1244.54,365.948 1246.85,471.835 1249.15,490.346 1251.46,96.8724 1253.77,408.179 1256.08,400.993 1258.39,417.783 1260.69,367.159 1263,345.64 1265.31,594.588 1267.62,454.918 1269.93,383.963 1272.23,336.316 1274.54,395.712 1276.85,427.431 1279.16,313.165 1281.47,392.518 1283.77,353.036 1286.08,283.482 1288.39,423.1 1290.7,359.9 1293,572.193 1295.31,460.354 1297.62,368.85 1299.93,289.594 1302.24,409.327 1304.54,280.835 1306.85,478.427 1309.16,470.689 1311.47,333.446 1313.78,400.734 1316.08,603.396 1318.39,512.221 1320.7,259.573 1323.01,461.798 1325.32,505.703 1327.62,346.241 1329.93,479.407 1332.24,445.138 1334.55,397.556 1336.86,366.584 1339.16,350.685 1341.47,315.248 1343.78,448.465 1346.09,494.677 1348.39,326.193 1350.7,361.972 1353.01,410.354 1355.32,399.017 1357.63,474.583 1359.93,541.965 1362.24,547.045 1364.55,519.806 1366.86,255.889 1369.17,439.909 1371.47,378.658 1373.78,299.523 1376.09,495.671 1378.4,472.5 1380.71,440.579 1383.01,415.806 1385.32,382.713 1387.63,452.704 1389.94,275.526 1392.24,465.877 1394.55,292.877 1396.86,365.585 1399.17,604.569 1401.48,351.882 1403.78,447.169 1406.09,474.097 1408.4,468.446 1410.71,338.271 1413.02,528.996 1415.32,359.215 1417.63,446.923 1419.94,338.295 1422.25,441.598 1424.56,200.883 1426.86,247.154 1429.17,362.212 1431.48,478.878 1433.79,413.867 1436.1,358.14 1438.4,446.672 1440.71,418.887 1443.02,396.393 1445.33,436.552 1447.63,553.658 1449.94,274.147 1452.25,510.852 1454.56,432.361 1456.87,486.395 1459.17,488.54 1461.48,367.903 1463.79,424.899 1466.1,455.566 1468.41,391.032 1470.71,358.169 1473.02,508.536 1475.33,433.039 1477.64,510.406 1479.95,400.562 1482.25,503.943 1484.56,352.804 1486.87,609.768 1489.18,441.041 1491.49,213.558 1493.79,591.691 1496.1,516.789 1498.41,454.634 1500.72,316.054 1503.02,513.119 1505.33,205.276 1507.64,505.97 1509.95,511.538 1512.26,509.075 1514.56,432.81 1516.87,396.232 1519.18,436.91 1521.49,414.018 1523.8,515.994 1526.1,516.631 1528.41,294.503 1530.72,407.616 1533.03,434.461 1535.34,412.171 1537.64,191.482 1539.95,280.591 1542.26,328.412 1544.57,525.961 1546.88,442.632 1549.18,408.961 1551.49,385.098 1553.8,544.95 1556.11,487.599 1558.41,518.978 1560.72,523.953 1563.03,380.819 1565.34,413.056 1567.65,354.622 1569.95,358.562 1572.26,435.448 1574.57,346.209 1576.88,457.317 1579.19,433.431 1581.49,485.409 1583.8,421.592 1586.11,512.154 1588.42,474.963 1590.73,400.93 1593.03,451.449 1595.34,466.902 1597.65,532.166 1599.96,461.626 1602.26,249.005 1604.57,565.892 1606.88,295.233 1609.19,516.335 1611.5,359.414 1613.8,419.388 1616.11,394.924 1618.42,377.708 1620.73,518.627 1623.04,353.426 1625.34,393.963 1627.65,425.077 1629.96,426.873 1632.27,408.474 1634.58,517.403 1636.88,262.934 1639.19,467.264 1641.5,539.651 1643.81,242.796 1646.12,423.621 1648.42,381.105 1650.73,437.755 1653.04,471.306 1655.35,453.035 1657.65,458.98 1659.96,424.922 1662.27,305.277 1664.58,441.955 1666.89,502.351 1669.19,474.281 1671.5,298.978 1673.81,491.441 1676.12,251.293 1678.43,451.498 1680.73,506.08 1683.04,293.585 1685.35,485.99 1687.66,490.943 1689.97,480.706 1692.27,382.592 1694.58,395.106 1696.89,476.838 1699.2,388.804 1701.51,397.11 1703.81,457.225 1706.12,436.676 1708.43,384.355 1710.74,378.673 1713.04,505.593 1715.35,366.979 1717.66,369.251 1719.97,459.2 1722.28,568.66 1724.58,488.816 1726.89,378.952 1729.2,307.711 1731.51,495.861 1733.82,429.589 1736.12,616.159 1738.43,389.656 1740.74,512.389 1743.05,300.275 1745.36,442.222 1747.66,327.611 1749.97,452.057 1752.28,437.908 1754.59,584.188 1756.9,566.738 1759.2,573.058 1761.51,365.796 1763.82,450.6 1766.13,450.11 1768.43,423.192 1770.74,174.705 1773.05,413.637 1775.36,315.066 1777.67,432.809 1779.97,296.144 1782.28,375.219 1784.59,478.636 1786.9,331.465 1789.21,469.524 1791.51,287.955 1793.82,406.506 1796.13,393.601 1798.44,447.145 1800.75,323.299 1803.05,349.667 1805.36,408.693 1807.67,417.533 1809.98,470.284 1812.28,415.033 1814.59,238.56 1816.9,244.836 1819.21,447.24 1821.52,402.401 1823.82,415.815 1826.13,326.119 1828.44,366.224 1830.75,478.125 1833.06,375.515 1835.36,448.741 1837.67,533.529 1839.98,483.204 1842.29,378.313 1844.6,375.271 1846.9,590.626 1849.21,254.69 1851.52,448.404 1853.83,391.671 1856.14,302.82 1858.44,288.517 1860.75,377.155 1863.06,538.027 1865.37,490.641 1867.67,297.573 1869.98,405.529 1872.29,492.51 1874.6,396.009 1876.91,416.219 1879.21,478.428 1881.52,381.702 1883.83,364.111 1886.14,261.366 1888.45,422.91 1890.75,534.695 1893.06,221.298 1895.37,379.732 1897.68,652.285 1899.99,575.672 1902.29,365.461 1904.6,245.369 1906.91,564.906 1909.22,441.415 1911.53,553.698 1913.83,306.856 1916.14,459.722 1918.45,497.865 1920.76,457.203 1923.06,430.604 1925.37,416.347 1927.68,433.408 1929.99,352.78 1932.3,329.537 1934.6,349.287 1936.91,273.247 1939.22,659.591 1941.53,427.015 1943.84,349.391 1946.14,610.261 1948.45,408.586 1950.76,243.842 1953.07,305.899 1955.38,380.358 1957.68,408.189 1959.99,545.582 1962.3,309.638 1964.61,414.513 1966.91,610.737 1969.22,462.666 1971.53,424.838 1973.84,416.919 1976.15,741.392 1978.45,273.856 1980.76,516.022 1983.07,555.148 1985.38,553.086 1987.69,440.453 1989.99,433.012 1992.3,351.722 1994.61,233.782 1996.92,415.855 1999.23,394.894 2001.53,357.192 2003.84,358.096 2006.15,435.947 2008.46,368.78 2010.77,284.956 2013.07,340.122 2015.38,367.771 2017.69,394.923 2020,565.08 2022.3,468.487 2024.61,520.836 2026.92,400.585 2029.23,536.019 2031.54,331.006 2033.84,580.453 2036.15,437.476 2038.46,479.724 2040.77,316.334 2043.08,398.558 2045.38,454.269 2047.69,518.408 2050,386.571 2052.31,614.316 2054.62,399.35 2056.92,199.449 2059.23,381.183 2061.54,466.64 2063.85,660.844 2066.16,397.607 2068.46,490.347 2070.77,381.388 2073.08,375.57 2075.39,492.452 2077.69,307.294 2080,416.753 2082.31,512.386 2084.62,394.941 2086.93,407.963 2089.23,394.8 2091.54,519.506 2093.85,399.555 2096.16,444.407 2098.47,344.092 2100.77,344.323 2103.08,524.589 2105.39,445.604 2107.7,465.789 2110.01,351.751 2112.31,437.892 2114.62,407.622 2116.93,480.49 2119.24,459.793 2121.55,434.872 2123.85,512.663 2126.16,468.076 2128.47,336.008 2130.78,381.213 2133.08,567.997 2135.39,405.379 2137.7,436.489 2140.01,421.014 2142.32,594.095 2144.62,550.214 2146.93,325.814 2149.24,294.242 2151.55,389.165 2153.86,388.667 2156.16,409.198 2158.47,578.909 2160.78,551.302 2163.09,412.332 2165.4,481.25 2167.7,224.649 2170.01,561.059 2172.32,472.137 2174.63,470.944 2176.93,605.013 2179.24,478.556 2181.55,505.912 2183.86,409.099 2186.17,546.11 2188.47,493.877 2190.78,637.702 2193.09,465.692 2195.4,454.762 2197.71,411.817 2200.01,392.971 2202.32,350.437 2204.63,508.688 2206.94,318.217 2209.25,540.113 2211.55,506.713 2213.86,243.194 2216.17,514.739 2218.48,446.596 2220.79,409.475 2223.09,398.494 2225.4,400.872 2227.71,570.32 2230.02,467.986 2232.32,286.32 2234.63,364.721 2236.94,571.337 2239.25,365.859 2241.56,458.941 2243.86,540.863 2246.17,442.107 2248.48,384.94 2250.79,498.465 2253.1,293.572 2255.4,446.903 2257.71,302.576 2260.02,389.859 2262.33,390.34 2264.64,572.816 2266.94,466.938 2269.25,404.562 2271.56,481.213 2273.87,485.715 2276.18,481.839 2278.48,497.228 2280.79,373.305 2283.1,464.21 2285.41,487.264 2287.71,330.641 2290.02,483.948 2292.33,466.457 2294.64,392.199 2296.95,526.322 2299.25,605.179 2301.56,348.269 2303.87,456.45 2306.18,514.902 2308.49,459.549 2310.79,296.557 2313.1,472.134 2315.41,333.291 2317.72,464.98 2320.03,253.924 2322.33,566.75 2324.64,308.047 2326.95,481.306 2329.26,553.531 2331.56,418.089 2333.87,516.093 2336.18,375.567 2338.49,342.361 2340.8,484.687 2343.1,514.749 2345.41,450.12 2347.72,416.062 2350.03,301.805 2352.34,518.177 2354.64,532.358 2356.95,375.692 2359.26,432.101 2361.57,545.055 2363.88,227.914 2366.18,540.393 2368.49,434.087 2370.8,467.768 2373.11,358.843 2375.42,338.759 2377.72,441.836 2380.03,322.642 2382.34,401.243 2384.65,378.528 2386.95,362.158 2389.26,370.947 2391.57,607.154 2393.88,469.704 2396.19,234.461 2398.49,388.474 2400.8,495.558 2403.11,452.094 2405.42,488.782 2407.73,451.725 2410.03,482.399 2412.34,410.442 2414.65,387.103 2416.96,416.643 2419.27,457.566 2421.57,275.16 2423.88,366.271 2426.19,347.14 2428.5,465.877 2430.81,293.604 2433.11,389.2 2435.42,478.337 2437.73,634.325 2440.04,463.822 2442.34,431.52 2444.65,470.015 2446.96,493.341 2449.27,228.257 2451.58,315.926 2453.88,438.684 2456.19,478.515 2458.5,470.397 2460.81,332.59 2463.12,466.938 2465.42,581.955 2467.73,393.594 2470.04,563.821 2472.35,555.789 2474.66,355.357 2476.96,549.6 2479.27,148.933 2481.58,479.998 2483.89,341.229 2486.2,470.666 2488.5,550.929 2490.81,300.537 2493.12,268.023 2495.43,437.26 2497.73,502.418 2500.04,487.802 2502.35,296.143 2504.66,469.378 2506.97,501.259 2509.27,508.895 2511.58,399.461 2513.89,556.493 2516.2,194.595 2518.51,469.626 2520.81,431.924 2523.12,527.115 2525.43,492.331 2527.74,517.343 2530.05,562.404 2532.35,475.282 2534.66,241.08 2536.97,442.443 2539.28,527.003 2541.58,571.596 2543.89,417.312 2546.2,447.801 2548.51,454.321 2550.82,443.345 2553.12,405.533 2555.43,517.642 2557.74,529.675 2560.05,469.56 2562.36,346.19 2564.66,317.024 2566.97,418.719 2569.28,386.826 2571.59,485.635 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -2.04804  -4.74827   -6.04929   -6.80328  …  -3.87785   -4.9202   -3.16371
  1.24725   0.670535   0.841694   1.54313     -0.623484   1.50345   0.289232
  3.74095   3.29002    4.80319    5.6128       6.43762    4.56376   4.45779

[:, :, 2] =
 -2.7155   -4.23118   -6.02515   -5.60051  …  -3.44349   -4.19081   -4.19081
 -0.27454  -0.403454  -0.213727  -1.44987     -0.536202  -0.100065  -0.100065
  3.89101   1.90322    3.41755    5.85748      6.63948    5.7424     5.7424

[:, :, 3] =
 -4.40953  -4.44776    -4.9694   -6.24864  …  -4.83487   -5.33742   -5.33742
  1.38151  -0.0495736  -1.95782  -2.58474      0.455983  -0.746202  -0.746202
  4.14644   5.72118     5.44978   6.39307      3.36154    4.56528    4.56528

[:, :, 4] =
 -2.84101    -6.17459    -4.82054  …  -5.80636   -4.34264  -3.92764
  0.0907526  -0.0799502  -2.04788      0.469791  -1.27658  -0.704473
  2.1975      3.85215     3.86447      4.61756    4.23011   6.89231</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.97551     0.998126
 -0.00637074  1.00736
  5.01351     1.0161</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 3.02 seconds
Compute duration  = 3.02 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -5.0204    0.9819    0.0169   3394.9187   6113.4305    1.0002   ⋯
        x[2]    0.0110    0.9919    0.0174   3231.0514   5444.6988    1.0000   ⋯
        x[3]    4.9900    0.9963    0.0171   3375.6325   5612.8766    0.9999   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -6.9440   -5.6802   -5.0148   -4.3401   -3.1585
        x[2]   -1.9281   -0.6623    0.0172    0.6754    1.9224
        x[3]    3.0295    4.3267    4.9941    5.6492    6.9268</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.02 seconds
Compute duration  = 2.02 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.5050    0.1907    0.0028   4706.4012   6239.1383    1.0008   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1506    0.3625    0.5066    0.6472    0.8596</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.15 seconds
Compute duration  = 0.15 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

           x    0.5355    0.1617    0.0205    56.3368        NaN    1.0301     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.2515    0.4009    0.5378    0.6668    0.7900</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}(-0.5024019288366302,1.0,0.0), "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}(-0.5024019288366302,1.0,0.0):
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/tQhJE/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/tQhJE/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/tQhJE/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/tQhJE/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/tQhJE/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/senfM/src/compiler.jl:584 [inlined]
  [7] demo(__model__::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, __varinfo__::DynamicPPL.ThreadSafeVarInfo{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}}, ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Base.RefValue{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, __context__::DynamicPPL.DefaultContext)
    @ Main.Notebook ~/work/docs/docs/developers/inference/implementing-samplers/index.qmd:595
  [8] _evaluate!!
    @ ~/.julia/packages/DynamicPPL/senfM/src/model.jl:936 [inlined]
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}}, ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, context::DynamicPPL.DefaultContext)
    @ DynamicPPL ~/.julia/packages/DynamicPPL/senfM/src/model.jl:925
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/senfM/src/model.jl:855 [inlined]
 [11] logdensity
    @ ~/.julia/packages/DynamicPPL/senfM/src/logdensityfunction.jl:140 [inlined]
 [12] Fix1
    @ ./operators.jl:1127 [inlined]
 [13] vector_mode_dual_eval!(f::Base.Fix1{typeof(LogDensityProblems.logdensity), LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}}, cfg::ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}, x::Vector{Float64})
    @ ForwardDiff ~/.julia/packages/ForwardDiff/UBbGT/src/apiutils.jl:24
 [14] vector_mode_gradient!
    @ ~/.julia/packages/ForwardDiff/UBbGT/src/gradient.jl:98 [inlined]
 [15] gradient!(result::DiffResults.MutableDiffResult{1, Float64, Tuple{Vector{Float64}}}, f::Base.Fix1{typeof(LogDensityProblems.logdensity), LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}}, x::Vector{Float64}, cfg::ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}, ::Val{true})
    @ ForwardDiff ~/.julia/packages/ForwardDiff/UBbGT/src/gradient.jl:39
 [16] gradient!
    @ ~/.julia/packages/ForwardDiff/UBbGT/src/gradient.jl:36 [inlined]
 [17] logdensity_and_gradient
    @ ~/.julia/packages/LogDensityProblemsAD/9uEsH/ext/LogDensityProblemsADForwardDiffExt.jl:116 [inlined]
 [18] leapfrog_step(model::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, x::Vector{Float64}, p::Vector{Float64}, ϵ::Int64, M::UniformScaling{Bool})
    @ Main.Notebook ~/work/docs/docs/developers/inference/implementing-samplers/index.qmd:371
 [19] step(rng::TaskLocalRNG, model_wrapper::AbstractMCMC.LogDensityModel{LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}}, sampler::MALA{Int64, UniformScaling{Bool}}, state::MALAState{Vector{Float64}}; kwargs::@Kwargs{})
    @ Main.Notebook ~/work/docs/docs/developers/inference/implementing-samplers/index.qmd:336
 [20] step
    @ ~/work/docs/docs/developers/inference/implementing-samplers/index.qmd:318 [inlined]
 [21] #step#27
    @ ~/.julia/packages/Turing/oFGEb/src/mcmc/abstractmcmc.jl:117 [inlined]
 [22] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, state::Turing.Inference.TuringState{MALAState{Vector{Float64}}, LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}})
    @ Turing.Inference ~/.julia/packages/Turing/oFGEb/src/mcmc/abstractmcmc.jl:106
 [23] macro expansion
    @ ~/.julia/packages/AbstractMCMC/FSyVk/src/sample.jl:217 [inlined]
 [24] macro expansion
    @ ~/.julia/packages/AbstractMCMC/FSyVk/src/logging.jl:16 [inlined]
 [25] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, num_warmup::Int64, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/FSyVk/src/sample.jl:142
 [26] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/senfM/src/sampler.jl:107
 [27] sample
    @ ~/.julia/packages/DynamicPPL/senfM/src/sampler.jl:97 [inlined]
 [28] #sample#6
    @ ~/.julia/packages/Turing/oFGEb/src/mcmc/Inference.jl:321 [inlined]
 [29] sample
    @ ~/.julia/packages/Turing/oFGEb/src/mcmc/Inference.jl:312 [inlined]
 [30] #sample#5
    @ ~/.julia/packages/Turing/oFGEb/src/mcmc/Inference.jl:309 [inlined]
 [31] top-level scope
    @ ~/work/docs/docs/developers/inference/implementing-samplers/index.qmd:597</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.6 seconds
Compute duration  = 0.6 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8599    0.5473    0.0270   323.2304   190.7553    1.0019     ⋯
           x   -0.0206    1.0667    0.0672   380.5884   268.8942    1.0039     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1251    0.4193    0.7528    1.1925    2.1208
           x   -2.3859   -0.3991   -0.0120    0.4501    2.1663</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 3.92 seconds
Compute duration  = 3.92 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8569    0.5676    0.0262   334.5962    87.3203    1.0098     ⋯
           x   -0.0049    0.9572    0.0479   513.4286   459.2629    1.0089     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1671    0.4139    0.7218    1.1748    2.2681
           x   -2.0433   -0.4242    0.0175    0.4029    1.9737</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/docs\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../../developers/inference/variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/developers/inference/implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>