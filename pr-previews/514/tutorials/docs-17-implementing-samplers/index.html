<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../tutorials/docs-07-for-developers-variational-inference/index.html" rel="prev">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/docs-00-getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/00-introduction/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.34" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.34</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.34">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Documentation</li><li class="breadcrumb-item"><a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html">Developers: Inference</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Documentation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Using Turing - Modelling Syntax and Interface</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-00-getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-14-using-turing-quick-start/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quick Start</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-12-using-turing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-09-using-turing-advanced/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced Usage</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-10-using-turing-autodiff/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-13-using-turing-performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-11-using-turing-dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-15-using-turing-sampler-viz/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-16-using-turing-external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Using Turing - Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/00-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Turing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/01-gaussian-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/02-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/03-bayesian-neural-network/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/04-hidden-markov-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/05-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/06-infinite-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/07-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/08-multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/09-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/10-bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/11-probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/13-seasonal-time-series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/15-gaussian-processes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Gaussian Processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/12-gplvm/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Developers: Contributing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-01-contributing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to Contribute</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Developers: PPL</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-05-for-developers-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/14-minituring/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/16-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-06-for-developers-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers: Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Documentation</li><li class="breadcrumb-item"><a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html">Developers: Inference</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-18.35640976482088</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-18.35640976482088</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([0.0, 0.0, 0.0]), MALAState{Vector{Float64}}([0.0, 0.0, 0.0]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -2.8393   -3.13262   -3.49815   …  -3.90473  -4.80825  -6.37248
  1.26562   0.725135   0.101481      1.82151   1.21947   0.00838206
  3.07917   3.171      4.82748       4.7766    4.96973   4.4329</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.99687     0.989305
 -0.00538647  0.992261
  5.03081     1.00138</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip130">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip130)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip131">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip130)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip132">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip132)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip132)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip132)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip132)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip132)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip132)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1659.79 2640.76,1659.79 "></polyline>
<polyline clip-path="url(#clip132)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1421.51 2640.76,1421.51 "></polyline>
<polyline clip-path="url(#clip132)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1183.23 2640.76,1183.23 "></polyline>
<polyline clip-path="url(#clip132)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,944.959 2640.76,944.959 "></polyline>
<polyline clip-path="url(#clip132)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,706.683 2640.76,706.683 "></polyline>
<polyline clip-path="url(#clip132)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,468.407 2640.76,468.407 "></polyline>
<polyline clip-path="url(#clip132)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,230.131 2640.76,230.131 "></polyline>
<polyline clip-path="url(#clip130)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip130)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip130)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip130)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip130)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip130)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip130)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip130)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip130)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1659.79 215.714,1659.79 "></polyline>
<polyline clip-path="url(#clip130)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1421.51 215.714,1421.51 "></polyline>
<polyline clip-path="url(#clip130)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1183.23 215.714,1183.23 "></polyline>
<polyline clip-path="url(#clip130)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,944.959 215.714,944.959 "></polyline>
<polyline clip-path="url(#clip130)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,706.683 215.714,706.683 "></polyline>
<polyline clip-path="url(#clip130)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,468.407 215.714,468.407 "></polyline>
<polyline clip-path="url(#clip130)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,230.131 215.714,230.131 "></polyline>
<path clip-path="url(#clip130)" d="M50.5475 1660.24 L80.2233 1660.24 L80.2233 1664.17 L50.5475 1664.17 L50.5475 1660.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M89.1352 1642.51 L111.357 1642.51 L111.357 1644.5 L98.8111 1677.07 L93.9269 1677.07 L105.732 1646.44 L89.1352 1646.44 L89.1352 1642.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M120.478 1671.19 L125.362 1671.19 L125.362 1677.07 L120.478 1677.07 L120.478 1671.19 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M135.593 1642.51 L153.95 1642.51 L153.95 1646.44 L139.876 1646.44 L139.876 1654.91 Q140.894 1654.57 141.913 1654.4 Q142.931 1654.22 143.95 1654.22 Q149.737 1654.22 153.116 1657.39 Q156.496 1660.56 156.496 1665.98 Q156.496 1671.56 153.024 1674.66 Q149.552 1677.74 143.232 1677.74 Q141.056 1677.74 138.788 1677.37 Q136.542 1677 134.135 1676.26 L134.135 1671.56 Q136.218 1672.69 138.441 1673.25 Q140.663 1673.8 143.14 1673.8 Q147.144 1673.8 149.482 1671.7 Q151.82 1669.59 151.82 1665.98 Q151.82 1662.37 149.482 1660.26 Q147.144 1658.15 143.14 1658.15 Q141.265 1658.15 139.39 1658.57 Q137.538 1658.99 135.593 1659.87 L135.593 1642.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M49.5521 1421.96 L79.2279 1421.96 L79.2279 1425.9 L49.5521 1425.9 L49.5521 1421.96 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M89.3667 1404.23 L107.723 1404.23 L107.723 1408.17 L93.6491 1408.17 L93.6491 1416.64 Q94.6676 1416.29 95.6861 1416.13 Q96.7047 1415.94 97.7232 1415.94 Q103.51 1415.94 106.89 1419.12 Q110.269 1422.29 110.269 1427.7 Q110.269 1433.28 106.797 1436.38 Q103.325 1439.46 97.0056 1439.46 Q94.8297 1439.46 92.5612 1439.09 Q90.3158 1438.72 87.9084 1437.98 L87.9084 1433.28 Q89.9917 1434.42 92.2139 1434.97 Q94.4361 1435.53 96.913 1435.53 Q100.918 1435.53 103.256 1433.42 Q105.593 1431.31 105.593 1427.7 Q105.593 1424.09 103.256 1421.99 Q100.918 1419.88 96.913 1419.88 Q95.038 1419.88 93.163 1420.3 Q91.3112 1420.71 89.3667 1421.59 L89.3667 1404.23 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M119.482 1432.91 L124.367 1432.91 L124.367 1438.79 L119.482 1438.79 L119.482 1432.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M144.552 1407.31 Q140.941 1407.31 139.112 1410.87 Q137.306 1414.42 137.306 1421.55 Q137.306 1428.65 139.112 1432.22 Q140.941 1435.76 144.552 1435.76 Q148.186 1435.76 149.991 1432.22 Q151.82 1428.65 151.82 1421.55 Q151.82 1414.42 149.991 1410.87 Q148.186 1407.31 144.552 1407.31 M144.552 1403.61 Q150.362 1403.61 153.417 1408.21 Q156.496 1412.8 156.496 1421.55 Q156.496 1430.27 153.417 1434.88 Q150.362 1439.46 144.552 1439.46 Q138.741 1439.46 135.663 1434.88 Q132.607 1430.27 132.607 1421.55 Q132.607 1412.8 135.663 1408.21 Q138.741 1403.61 144.552 1403.61 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M50.5475 1183.69 L80.2233 1183.69 L80.2233 1187.62 L50.5475 1187.62 L50.5475 1183.69 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M94.3436 1196.58 L110.663 1196.58 L110.663 1200.51 L88.7186 1200.51 L88.7186 1196.58 Q91.3806 1193.83 95.9639 1189.2 Q100.57 1184.54 101.751 1183.2 Q103.996 1180.68 104.876 1178.94 Q105.779 1177.18 105.779 1175.49 Q105.779 1172.74 103.834 1171 Q101.913 1169.27 98.8111 1169.27 Q96.6121 1169.27 94.1584 1170.03 Q91.7278 1170.79 88.9501 1172.34 L88.9501 1167.62 Q91.7741 1166.49 94.2278 1165.91 Q96.6815 1165.33 98.7185 1165.33 Q104.089 1165.33 107.283 1168.02 Q110.478 1170.7 110.478 1175.19 Q110.478 1177.32 109.668 1179.24 Q108.881 1181.14 106.774 1183.73 Q106.195 1184.4 103.094 1187.62 Q99.9917 1190.82 94.3436 1196.58 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M120.478 1194.64 L125.362 1194.64 L125.362 1200.51 L120.478 1200.51 L120.478 1194.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M135.593 1165.95 L153.95 1165.95 L153.95 1169.89 L139.876 1169.89 L139.876 1178.36 Q140.894 1178.01 141.913 1177.85 Q142.931 1177.67 143.95 1177.67 Q149.737 1177.67 153.116 1180.84 Q156.496 1184.01 156.496 1189.43 Q156.496 1195.01 153.024 1198.11 Q149.552 1201.19 143.232 1201.19 Q141.056 1201.19 138.788 1200.82 Q136.542 1200.45 134.135 1199.7 L134.135 1195.01 Q136.218 1196.14 138.441 1196.7 Q140.663 1197.25 143.14 1197.25 Q147.144 1197.25 149.482 1195.14 Q151.82 1193.04 151.82 1189.43 Q151.82 1185.82 149.482 1183.71 Q147.144 1181.6 143.14 1181.6 Q141.265 1181.6 139.39 1182.02 Q137.538 1182.44 135.593 1183.32 L135.593 1165.95 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M99.3204 930.758 Q95.7093 930.758 93.8806 934.322 Q92.075 937.864 92.075 944.994 Q92.075 952.1 93.8806 955.665 Q95.7093 959.206 99.3204 959.206 Q102.955 959.206 104.76 955.665 Q106.589 952.1 106.589 944.994 Q106.589 937.864 104.76 934.322 Q102.955 930.758 99.3204 930.758 M99.3204 927.054 Q105.131 927.054 108.186 931.66 Q111.265 936.244 111.265 944.994 Q111.265 953.72 108.186 958.327 Q105.131 962.91 99.3204 962.91 Q93.5102 962.91 90.4315 958.327 Q87.376 953.72 87.376 944.994 Q87.376 936.244 90.4315 931.66 Q93.5102 927.054 99.3204 927.054 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M119.482 956.359 L124.367 956.359 L124.367 962.239 L119.482 962.239 L119.482 956.359 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M144.552 930.758 Q140.941 930.758 139.112 934.322 Q137.306 937.864 137.306 944.994 Q137.306 952.1 139.112 955.665 Q140.941 959.206 144.552 959.206 Q148.186 959.206 149.991 955.665 Q151.82 952.1 151.82 944.994 Q151.82 937.864 149.991 934.322 Q148.186 930.758 144.552 930.758 M144.552 927.054 Q150.362 927.054 153.417 931.66 Q156.496 936.244 156.496 944.994 Q156.496 953.72 153.417 958.327 Q150.362 962.91 144.552 962.91 Q138.741 962.91 135.663 958.327 Q132.607 953.72 132.607 944.994 Q132.607 936.244 135.663 931.66 Q138.741 927.054 144.552 927.054 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M94.3436 720.028 L110.663 720.028 L110.663 723.963 L88.7186 723.963 L88.7186 720.028 Q91.3806 717.273 95.9639 712.643 Q100.57 707.991 101.751 706.648 Q103.996 704.125 104.876 702.389 Q105.779 700.63 105.779 698.94 Q105.779 696.185 103.834 694.449 Q101.913 692.713 98.8111 692.713 Q96.6121 692.713 94.1584 693.477 Q91.7278 694.241 88.9501 695.792 L88.9501 691.07 Q91.7741 689.935 94.2278 689.357 Q96.6815 688.778 98.7185 688.778 Q104.089 688.778 107.283 691.463 Q110.478 694.148 110.478 698.639 Q110.478 700.769 109.668 702.69 Q108.881 704.588 106.774 707.181 Q106.195 707.852 103.094 711.069 Q99.9917 714.264 94.3436 720.028 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M120.478 718.083 L125.362 718.083 L125.362 723.963 L120.478 723.963 L120.478 718.083 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M135.593 689.403 L153.95 689.403 L153.95 693.338 L139.876 693.338 L139.876 701.81 Q140.894 701.463 141.913 701.301 Q142.931 701.116 143.95 701.116 Q149.737 701.116 153.116 704.287 Q156.496 707.458 156.496 712.875 Q156.496 718.454 153.024 721.555 Q149.552 724.634 143.232 724.634 Q141.056 724.634 138.788 724.264 Q136.542 723.893 134.135 723.153 L134.135 718.454 Q136.218 719.588 138.441 720.143 Q140.663 720.699 143.14 720.699 Q147.144 720.699 149.482 718.593 Q151.82 716.486 151.82 712.875 Q151.82 709.264 149.482 707.157 Q147.144 705.051 143.14 705.051 Q141.265 705.051 139.39 705.468 Q137.538 705.884 135.593 706.764 L135.593 689.403 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M89.3667 451.127 L107.723 451.127 L107.723 455.062 L93.6491 455.062 L93.6491 463.534 Q94.6676 463.187 95.6861 463.025 Q96.7047 462.84 97.7232 462.84 Q103.51 462.84 106.89 466.011 Q110.269 469.182 110.269 474.599 Q110.269 480.178 106.797 483.279 Q103.325 486.358 97.0056 486.358 Q94.8297 486.358 92.5612 485.988 Q90.3158 485.617 87.9084 484.877 L87.9084 480.178 Q89.9917 481.312 92.2139 481.867 Q94.4361 482.423 96.913 482.423 Q100.918 482.423 103.256 480.317 Q105.593 478.21 105.593 474.599 Q105.593 470.988 103.256 468.881 Q100.918 466.775 96.913 466.775 Q95.038 466.775 93.163 467.192 Q91.3112 467.608 89.3667 468.488 L89.3667 451.127 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M119.482 479.807 L124.367 479.807 L124.367 485.687 L119.482 485.687 L119.482 479.807 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M144.552 454.206 Q140.941 454.206 139.112 457.77 Q137.306 461.312 137.306 468.442 Q137.306 475.548 139.112 479.113 Q140.941 482.654 144.552 482.654 Q148.186 482.654 149.991 479.113 Q151.82 475.548 151.82 468.442 Q151.82 461.312 149.991 457.77 Q148.186 454.206 144.552 454.206 M144.552 450.502 Q150.362 450.502 153.417 455.108 Q156.496 459.692 156.496 468.442 Q156.496 477.168 153.417 481.775 Q150.362 486.358 144.552 486.358 Q138.741 486.358 135.663 481.775 Q132.607 477.168 132.607 468.442 Q132.607 459.692 135.663 455.108 Q138.741 450.502 144.552 450.502 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M89.1352 212.851 L111.357 212.851 L111.357 214.842 L98.8111 247.411 L93.9269 247.411 L105.732 216.786 L89.1352 216.786 L89.1352 212.851 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M120.478 241.531 L125.362 241.531 L125.362 247.411 L120.478 247.411 L120.478 241.531 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip130)" d="M135.593 212.851 L153.95 212.851 L153.95 216.786 L139.876 216.786 L139.876 225.258 Q140.894 224.911 141.913 224.749 Q142.931 224.564 143.95 224.564 Q149.737 224.564 153.116 227.735 Q156.496 230.906 156.496 236.323 Q156.496 241.902 153.024 245.003 Q149.552 248.082 143.232 248.082 Q141.056 248.082 138.788 247.712 Q136.542 247.341 134.135 246.601 L134.135 241.902 Q136.218 243.036 138.441 243.591 Q140.663 244.147 143.14 244.147 Q147.144 244.147 149.482 242.041 Q151.82 239.934 151.82 236.323 Q151.82 232.712 149.482 230.605 Q147.144 228.499 143.14 228.499 Q141.265 228.499 139.39 228.916 Q137.538 229.332 135.593 230.212 L135.593 212.851 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip132)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1215.57 268.292,1531.19 270.6,1312.1 272.908,1390.37 275.216,1352.56 277.524,1561.01 279.832,1442.48 282.139,1526.16 284.447,1335.29 286.755,1245.96 289.063,1325.41 291.371,1256.31 293.679,1231.96 295.987,1541.21 298.295,1426.67 300.603,1411.42 302.911,1423.02 305.219,1477.89 307.527,1371.2 309.834,1436.43 312.142,1347.02 314.45,1415.85 316.758,1340.51 319.066,1548.45 321.374,1515.02 323.682,1333.91 325.99,1391.94 328.298,1459.02 330.606,1421 332.914,1290.77 335.221,1519.65 337.529,1292.81 339.837,1323.49 342.145,1384.94 344.453,1286.6 346.761,1457.22 349.069,1535.37 351.377,1554.1 353.685,1261.89 355.993,1407.08 358.301,1590.36 360.608,1418.91 362.916,1391.46 365.224,1408.1 367.532,1431.73 369.84,1298.43 372.148,1421.65 374.456,1452.29 376.764,1551.66 379.072,1400.72 381.38,1472.67 383.688,1429.34 385.996,1599.41 388.303,1284.9 390.611,1492.3 392.919,1453.2 395.227,1435.83 397.535,1276.62 399.843,1456.58 402.151,1239.84 404.459,1272.21 406.767,1273.97 409.075,1549.2 411.383,1621.96 413.69,1430.18 415.998,1348.36 418.306,1422.17 420.614,1419.05 422.922,1404.59 425.23,1382.35 427.538,1411.06 429.846,1410.3 432.154,1492.11 434.462,1392.6 436.77,1568.29 439.077,1461.82 441.385,1416.79 443.693,1438.63 446.001,1612.22 448.309,1533.41 450.617,1462.02 452.925,1393.72 455.233,1384.21 457.541,1381.84 459.849,1440.52 462.157,1356.76 464.465,1599.27 466.772,1282.47 469.08,1403.74 471.388,1568.29 473.696,1528.09 476.004,1340.15 478.312,1377.78 480.62,1275.25 482.928,1371.74 485.236,1393.35 487.544,1559 489.852,1335.4 492.159,1439.63 494.467,1422.27 496.775,1057.57 499.083,1340.59 501.391,1535.79 503.699,1407.71 506.007,1382.44 508.315,1302.56 510.623,1529.99 512.931,1312.29 515.239,1384.03 517.546,1641.15 519.854,1341.89 522.162,1515.49 524.47,1466.99 526.778,1430.12 529.086,1272.16 531.394,1540.34 533.702,1481.69 536.01,1612.03 538.318,1424.46 540.626,1385.63 542.933,1406.97 545.241,1411.22 547.549,1566.88 549.857,1483.21 552.165,1542.91 554.473,1469.25 556.781,1378.09 559.089,1458.78 561.397,1431.43 563.705,1282.67 566.013,1499.16 568.321,1470.3 570.628,1476.91 572.936,1355.89 575.244,1346.2 577.552,1419.01 579.86,1414.03 582.168,1446.35 584.476,1409.21 586.784,1335.42 589.092,1322.86 591.4,1370.86 593.708,1443.87 596.015,1474.13 598.323,1498.99 600.631,1437.26 602.939,1634.53 605.247,1612.96 607.555,1324.55 609.863,1415.6 612.171,1416.9 614.479,1372.12 616.787,1386.2 619.095,1413.26 621.402,1347.46 623.71,1348.83 626.018,1412.4 628.326,1359.51 630.634,1348.04 632.942,1326.13 635.25,1490 637.558,1465.81 639.866,1347.45 642.174,1172.5 644.482,1203.36 646.79,1448.02 649.097,1646.75 651.405,1291.59 653.713,1586.42 656.021,1355.35 658.329,1494.85 660.637,1264.41 662.945,1305.1 665.253,1291.83 667.561,1471.14 669.869,1524.01 672.177,1449.83 674.484,1446.24 676.792,1527.28 679.1,1430.72 681.408,1254.12 683.716,1240.89 686.024,1394.5 688.332,1485.4 690.64,1357.93 692.948,1391.68 695.256,1432.36 697.564,1422.34 699.871,1289.36 702.179,1253.74 704.487,1295.24 706.795,1485.79 709.103,1436.37 711.411,1394.61 713.719,1596.1 716.027,1503.69 718.335,1375.68 720.643,1393.42 722.951,1341.21 725.259,1505.56 727.566,1564.51 729.874,1539.47 732.182,1367.23 734.49,1327.36 736.798,1300.7 739.106,1468.29 741.414,1285.53 743.722,1499.39 746.03,1537.1 748.338,1636.19 750.646,1527.51 752.953,1477.55 755.261,1291.61 757.569,1556.08 759.877,1476.47 762.185,1424.09 764.493,1437.07 766.801,1631.63 769.109,1458.06 771.417,1532.42 773.725,1475.66 776.033,1371.01 778.34,1545.98 780.648,1286.55 782.956,1539.1 785.264,1448.61 787.572,1472.56 789.88,1469.84 792.188,1564.59 794.496,1505.59 796.804,1551.88 799.112,1420.61 801.42,1419.04 803.728,1524.39 806.035,1258.64 808.343,1401.43 810.651,1256.97 812.959,1517.53 815.267,1430.3 817.575,1384.67 819.883,1396.05 822.191,1420.77 824.499,1421.96 826.807,1479.39 829.115,1477.69 831.422,1468.8 833.73,1661.94 836.038,1558.95 838.346,1292.54 840.654,1580.94 842.962,1409.45 845.27,1309.17 847.578,1484.68 849.886,1457.34 852.194,1592.62 854.502,1474.55 856.809,1428.27 859.117,1419.02 861.425,1336.89 863.733,1347.35 866.041,1434.32 868.349,1498.95 870.657,1437.72 872.965,1370.62 875.273,1332.38 877.581,1444.56 879.889,1316.58 882.197,1479.19 884.504,1370.11 886.812,1471.38 889.12,1498.91 891.428,1442.98 893.736,1394.61 896.044,1465.54 898.352,1250.59 900.66,1501.51 902.968,1461.5 905.276,1469.87 907.584,1364.23 909.891,1292.52 912.199,1429.69 914.507,1442.16 916.815,1409.35 919.123,1438.7 921.431,1401.04 923.739,1374.96 926.047,1369.65 928.355,1394.64 930.663,1421.07 932.971,1562.79 935.278,1397.61 937.586,1311.34 939.894,1390.68 942.202,1495.52 944.51,1429.58 946.818,1329.92 949.126,1615.15 951.434,1433.19 953.742,1423.61 956.05,1409.01 958.358,1495.15 960.665,1403.56 962.973,1372.37 965.281,1457.42 967.589,1265.61 969.897,1404.98 972.205,1416.43 974.513,1433 976.821,1294.13 979.129,1306.43 981.437,1417.41 983.745,1306.59 986.053,1472.49 988.36,1347.02 990.668,1505.89 992.976,1320.15 995.284,1523.25 997.592,1427.93 999.9,1295.64 1002.21,1347.26 1004.52,1577.18 1006.82,1422.61 1009.13,1505.43 1011.44,1546.45 1013.75,1495.24 1016.06,1323 1018.36,1389.63 1020.67,1490.98 1022.98,1508.81 1025.29,1437.14 1027.59,1425.24 1029.9,1302.82 1032.21,1485.74 1034.52,1327.81 1036.83,1307.65 1039.13,1565.62 1041.44,1224.88 1043.75,1458.58 1046.06,1534.33 1048.37,1261.54 1050.67,1469.61 1052.98,1200.51 1055.29,1296.29 1057.6,1299.37 1059.91,1428.39 1062.21,1244.26 1064.52,1499.74 1066.83,1510.53 1069.14,1487.63 1071.45,1583.77 1073.75,1485.02 1076.06,1299.65 1078.37,1454.79 1080.68,1492.35 1082.98,1410.21 1085.29,1392.98 1087.6,1370.04 1089.91,1297.97 1092.22,1499.18 1094.52,1378.96 1096.83,1380.26 1099.14,1357.11 1101.45,1267.93 1103.76,1504 1106.06,1665.62 1108.37,1340.42 1110.68,1580.34 1112.99,1391.62 1115.3,1407.71 1117.6,1500.38 1119.91,1581.68 1122.22,1517.42 1124.53,1307.32 1126.84,1397.23 1129.14,1347.74 1131.45,1349.57 1133.76,1272.9 1136.07,1344.94 1138.37,1482.16 1140.68,1497.85 1142.99,1450.7 1145.3,1392.04 1147.61,1477.17 1149.91,1437.32 1152.22,1530.55 1154.53,1509.79 1156.84,1193.13 1159.15,1556.9 1161.45,1579.26 1163.76,1423.02 1166.07,1462.71 1168.38,1332.59 1170.69,1345.08 1172.99,1346.19 1175.3,1532.67 1177.61,1383.84 1179.92,1540.53 1182.23,1366.37 1184.53,1608.63 1186.84,1271.14 1189.15,1367.8 1191.46,1450.87 1193.76,1523 1196.07,1453.76 1198.38,1513.66 1200.69,1484.51 1203,1305.38 1205.3,1396.85 1207.61,1325.32 1209.92,1459.02 1212.23,1435.19 1214.54,1469.04 1216.84,1590.13 1219.15,1421.42 1221.46,1319.47 1223.77,1533.71 1226.08,1495.27 1228.38,1208.16 1230.69,1381.04 1233,1652.24 1235.31,1440.94 1237.61,1429.38 1239.92,1486.86 1242.23,1378.91 1244.54,1197.21 1246.85,1345.28 1249.15,1415.5 1251.46,1441.09 1253.77,1281.68 1256.08,1393.53 1258.39,1473.61 1260.69,1433.4 1263,1364.72 1265.31,1596.51 1267.62,1604.3 1269.93,1398.85 1272.23,1334.05 1274.54,1471.86 1276.85,1512.36 1279.16,1311.92 1281.47,1407.65 1283.77,1448.95 1286.08,1435.88 1288.39,1497.3 1290.7,1558.86 1293,1265.88 1295.31,1352.92 1297.62,1439.92 1299.93,1317.78 1302.24,1509.45 1304.54,1397.72 1306.85,1435.24 1309.16,1237.43 1311.47,1366.21 1313.78,1477.42 1316.08,1403.59 1318.39,1217.13 1320.7,1431.96 1323.01,1371.89 1325.32,1402.36 1327.62,1428.84 1329.93,1507.32 1332.24,1458.23 1334.55,1473.34 1336.86,1309.31 1339.16,1514.6 1341.47,1489.42 1343.78,1539.89 1346.09,1306.53 1348.39,1325.76 1350.7,1498.69 1353.01,1484.98 1355.32,1315.03 1357.63,1603.19 1359.93,1329.7 1362.24,1307.88 1364.55,1275.82 1366.86,1751.15 1369.17,1559.2 1371.47,1514.47 1373.78,1494.7 1376.09,1395.93 1378.4,1195.92 1380.71,1451.26 1383.01,1299.95 1385.32,1443.33 1387.63,1541.35 1389.94,1278.98 1392.24,1422.44 1394.55,1384.57 1396.86,1463.75 1399.17,1385.3 1401.48,1573.56 1403.78,1429.69 1406.09,1507.9 1408.4,1508.09 1410.71,1456.64 1413.02,1402.82 1415.32,1363.8 1417.63,1398.35 1419.94,1382.71 1422.25,1330.29 1424.56,1400.51 1426.86,1460.99 1429.17,1415.05 1431.48,1378.7 1433.79,1429.88 1436.1,1180.17 1438.4,1499.05 1440.71,1199.58 1443.02,1421.87 1445.33,1490.37 1447.63,1495.41 1449.94,1397.77 1452.25,1320.07 1454.56,1414.46 1456.87,1382.56 1459.17,1383.91 1461.48,1552.62 1463.79,1286.22 1466.1,1402.81 1468.41,1534.35 1470.71,1107.54 1473.02,1619.71 1475.33,1390.56 1477.64,1440.87 1479.95,1565.48 1482.25,1491.34 1484.56,1487.67 1486.87,1423.2 1489.18,1286.98 1491.49,1392.24 1493.79,1297.44 1496.1,1522.68 1498.41,1309.34 1500.72,1401.33 1503.02,1362.16 1505.33,1439.07 1507.64,1539.63 1509.95,1498.09 1512.26,1454.3 1514.56,1551.59 1516.87,1481.8 1519.18,1420.98 1521.49,1442.42 1523.8,1469.7 1526.1,1382.94 1528.41,1630.43 1530.72,1318.98 1533.03,1455.62 1535.34,1502.65 1537.64,1414.28 1539.95,1457.8 1542.26,1403.59 1544.57,1437.43 1546.88,1394.68 1549.18,1313.14 1551.49,1446.58 1553.8,1443.16 1556.11,1516.39 1558.41,1468.28 1560.72,1461.77 1563.03,1558.67 1565.34,1469.67 1567.65,1497.85 1569.95,1391.81 1572.26,1504.21 1574.57,1393.75 1576.88,1292.43 1579.19,1527.38 1581.49,1496.93 1583.8,1497.1 1586.11,1354.72 1588.42,1540.15 1590.73,1438.18 1593.03,1472.57 1595.34,1382.43 1597.65,1311.44 1599.96,1236.44 1602.26,1381.14 1604.57,1333.94 1606.88,1481.69 1609.19,1479.12 1611.5,1340.63 1613.8,1398.71 1616.11,1581.35 1618.42,1421.35 1620.73,1407.37 1623.04,1456.34 1625.34,1220.25 1627.65,1462.19 1629.96,1406.04 1632.27,1383.15 1634.58,1372.11 1636.88,1445.52 1639.19,1462.18 1641.5,1483.94 1643.81,1309.6 1646.12,1476.26 1648.42,1319.99 1650.73,1435.37 1653.04,1412.42 1655.35,1259.09 1657.65,1397.02 1659.96,1325.08 1662.27,1257.27 1664.58,1508.43 1666.89,1431.87 1669.19,1459.54 1671.5,1327.1 1673.81,1354.75 1676.12,1337.27 1678.43,1331.93 1680.73,1463.67 1683.04,1558.83 1685.35,1357.8 1687.66,1427.24 1689.97,1429.72 1692.27,1474.6 1694.58,1429.82 1696.89,1358.59 1699.2,1287.52 1701.51,1349.79 1703.81,1399.95 1706.12,1557.24 1708.43,1410.57 1710.74,1462.35 1713.04,1400.67 1715.35,1466.03 1717.66,1351.52 1719.97,1345.39 1722.28,1428.08 1724.58,1526.5 1726.89,1363.21 1729.2,1442.58 1731.51,1508.52 1733.82,1358.94 1736.12,1603 1738.43,1416.83 1740.74,1499.53 1743.05,1374.46 1745.36,1281.59 1747.66,1450.2 1749.97,1449.98 1752.28,1394.42 1754.59,1573.58 1756.9,1490.59 1759.2,1506.65 1761.51,1240.66 1763.82,1320.32 1766.13,1384.63 1768.43,1582.2 1770.74,1546.66 1773.05,1352.55 1775.36,1399.22 1777.67,1357.84 1779.97,1425.98 1782.28,1411.96 1784.59,1435.39 1786.9,1351.99 1789.21,1348.87 1791.51,1472.84 1793.82,1393.56 1796.13,1461.49 1798.44,1305.08 1800.75,1305.37 1803.05,1513.03 1805.36,1500.48 1807.67,1228.85 1809.98,1390.68 1812.28,1390.54 1814.59,1483.02 1816.9,1363.51 1819.21,1365.21 1821.52,1405.7 1823.82,1363.67 1826.13,1609.05 1828.44,1422.95 1830.75,1413.32 1833.06,1246.83 1835.36,1372.95 1837.67,1455.9 1839.98,1481.78 1842.29,1366.47 1844.6,1498.39 1846.9,1392.9 1849.21,1307.74 1851.52,1289.93 1853.83,1570.15 1856.14,1407.29 1858.44,1445.41 1860.75,1498.05 1863.06,1453.61 1865.37,1479 1867.67,1295.69 1869.98,1258.49 1872.29,1566.43 1874.6,1556.31 1876.91,1438.17 1879.21,1387.4 1881.52,1465.92 1883.83,1386.73 1886.14,1239.35 1888.45,1533.09 1890.75,1433.42 1893.06,1379.33 1895.37,1373.87 1897.68,1454.02 1899.99,1409.45 1902.29,1541.47 1904.6,1382.19 1906.91,1442.35 1909.22,1234.18 1911.53,1412.42 1913.83,1394.53 1916.14,1514.41 1918.45,1424.2 1920.76,1400.87 1923.06,1458.02 1925.37,1523.64 1927.68,1535.56 1929.99,1335.09 1932.3,1509.22 1934.6,1452 1936.91,1536.56 1939.22,1239.75 1941.53,1259.3 1943.84,1457.08 1946.14,1379.94 1948.45,1626.69 1950.76,1458.87 1953.07,1316.93 1955.38,1397.27 1957.68,1390.17 1959.99,1548.19 1962.3,1433.8 1964.61,1391.83 1966.91,1423 1969.22,1507.31 1971.53,1378.37 1973.84,1538.87 1976.15,1473.31 1978.45,1270.28 1980.76,1441.82 1983.07,1577.72 1985.38,1434.62 1987.69,1253.75 1989.99,1595.05 1992.3,1452.76 1994.61,1569.58 1996.92,1346.65 1999.23,1370.72 2001.53,1399.36 2003.84,1461.6 2006.15,1418.11 2008.46,1345.9 2010.77,1369.7 2013.07,1517.9 2015.38,1383.44 2017.69,1554.3 2020,1269.58 2022.3,1366.94 2024.61,1371.34 2026.92,1547.76 2029.23,1324.96 2031.54,1309.76 2033.84,1609.73 2036.15,1310.31 2038.46,1419.2 2040.77,1498.14 2043.08,1513.23 2045.38,1515.91 2047.69,1481.79 2050,1338.75 2052.31,1347.59 2054.62,1481.46 2056.92,1431.73 2059.23,1442.79 2061.54,1490.88 2063.85,1595.94 2066.16,1384.31 2068.46,1438.76 2070.77,1470.82 2073.08,1503.44 2075.39,1470.6 2077.69,1317.01 2080,1497.77 2082.31,1366.15 2084.62,1501.38 2086.93,1408.85 2089.23,1260.04 2091.54,1346.42 2093.85,1368.52 2096.16,1429.86 2098.47,1534.99 2100.77,1580.41 2103.08,1438.23 2105.39,1497.17 2107.7,1535.66 2110.01,1247.59 2112.31,1503.81 2114.62,1248.45 2116.93,1441.65 2119.24,1510.93 2121.55,1560.16 2123.85,1208.09 2126.16,1475.41 2128.47,1574.85 2130.78,1435.21 2133.08,1441.31 2135.39,1279.07 2137.7,1062.97 2140.01,1649.23 2142.32,1342.09 2144.62,1528.42 2146.93,1427.52 2149.24,1452.29 2151.55,1517.92 2153.86,1601.89 2156.16,1437.4 2158.47,1502.32 2160.78,1573.86 2163.09,1522.84 2165.4,1505.19 2167.7,1496.54 2170.01,1323.44 2172.32,1455.84 2174.63,1274.24 2176.93,1517.36 2179.24,1365.83 2181.55,1450.34 2183.86,1445.22 2186.17,1312.34 2188.47,1331.41 2190.78,1415.49 2193.09,1524.75 2195.4,1582.81 2197.71,1419.9 2200.01,1518.48 2202.32,1423.5 2204.63,1421.4 2206.94,1345.25 2209.25,1298.81 2211.55,1353.04 2213.86,1312.83 2216.17,1450.89 2218.48,1497.84 2220.79,1339.75 2223.09,1484.99 2225.4,1465.31 2227.71,1476.81 2230.02,1450.56 2232.32,1199.52 2234.63,1371.48 2236.94,1470.87 2239.25,1339.18 2241.56,1454.46 2243.86,1458.57 2246.17,1495.61 2248.48,1418.77 2250.79,1400.26 2253.1,1455.21 2255.4,1475.18 2257.71,1394.99 2260.02,1474.79 2262.33,1523.88 2264.64,1454.14 2266.94,1453.63 2269.25,1507.12 2271.56,1352.52 2273.87,1349.56 2276.18,1350.29 2278.48,1315.15 2280.79,1531.96 2283.1,1515.88 2285.41,1332.68 2287.71,1536.55 2290.02,1525.63 2292.33,1418.39 2294.64,1280.16 2296.95,1531.41 2299.25,1351.78 2301.56,1320.16 2303.87,1299.16 2306.18,1404.18 2308.49,1513.16 2310.79,1386.76 2313.1,1335.27 2315.41,1426.48 2317.72,1376.64 2320.03,1489.28 2322.33,1350.84 2324.64,1195.52 2326.95,1317.56 2329.26,1431.69 2331.56,1300.51 2333.87,1322.84 2336.18,1429.92 2338.49,1416.98 2340.8,1281.55 2343.1,1339.65 2345.41,1208.36 2347.72,1281.4 2350.03,1371.91 2352.34,1404.12 2354.64,1523.56 2356.95,1429.45 2359.26,1431.94 2361.57,1365.74 2363.88,1446.69 2366.18,1433.07 2368.49,1478.16 2370.8,1400.93 2373.11,1335.11 2375.42,1489.31 2377.72,1619.04 2380.03,1365.65 2382.34,1510.65 2384.65,1207.51 2386.95,1479.56 2389.26,1397.4 2391.57,1414.03 2393.88,1508.02 2396.19,1398.25 2398.49,1437.5 2400.8,1373.63 2403.11,1352.11 2405.42,1482.3 2407.73,1489.7 2410.03,1318.78 2412.34,1558.85 2414.65,1525.2 2416.96,1624.58 2419.27,1469.91 2421.57,1271.29 2423.88,1398.5 2426.19,1450.11 2428.5,1445.21 2430.81,1253.41 2433.11,1248.65 2435.42,1331.31 2437.73,1491.52 2440.04,1371.22 2442.34,1379.57 2444.65,1464.95 2446.96,1502.24 2449.27,1361.23 2451.58,1245.23 2453.88,1296.9 2456.19,1355.91 2458.5,1572.95 2460.81,1310.57 2463.12,1362.21 2465.42,1364.76 2467.73,1312.41 2470.04,1571.14 2472.35,1253.92 2474.66,1548.55 2476.96,1348.73 2479.27,1485.7 2481.58,1363.4 2483.89,1242.27 2486.2,1520.52 2488.5,1382.66 2490.81,1415.79 2493.12,1160.28 2495.43,1354.9 2497.73,1245.57 2500.04,1439.76 2502.35,1405.53 2504.66,1405.55 2506.97,1334.29 2509.27,1384.75 2511.58,1421.56 2513.89,1218.5 2516.2,1534.06 2518.51,1484.72 2520.81,1372.7 2523.12,1439.03 2525.43,1423.28 2527.74,1418.81 2530.05,1283.23 2532.35,1238.3 2534.66,1428.05 2536.97,1423.13 2539.28,1628.76 2541.58,1433.96 2543.89,1505.84 2546.2,1274.21 2548.51,1436.58 2550.82,1584.7 2553.12,1371.42 2555.43,1360.57 2557.74,1449.52 2560.05,1340.09 2562.36,1457.2 2564.66,1488.26 2566.97,1452.8 2569.28,1356.2 2571.59,1272.99 "></polyline>
<polyline clip-path="url(#clip132)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,824.332 268.292,1008.34 270.6,972.109 272.908,986.147 275.216,1114.06 277.524,930.951 279.832,858.394 282.139,926.41 284.447,804.611 286.755,886.363 289.063,962.451 291.371,1026.99 293.679,1009.81 295.987,983.084 298.295,995.793 300.603,842.827 302.911,942.327 305.219,894.996 307.527,953.191 309.834,858.62 312.142,900.211 314.45,1038.8 316.758,923.564 319.066,971.877 321.374,1086.3 323.682,938.623 325.99,970.485 328.298,801.513 330.606,968.891 332.914,830.635 335.221,922.879 337.529,1004.28 339.837,993.392 342.145,838.293 344.453,862.553 346.761,930.399 349.069,923.606 351.377,1010.34 353.685,934.355 355.993,1083.88 358.301,839.924 360.608,1107.83 362.916,632.586 365.224,913.629 367.532,772.248 369.84,1082.6 372.148,968.344 374.456,1059.23 376.764,930.268 379.072,977.095 381.38,832.233 383.688,956.287 385.996,973.734 388.303,1027.84 390.611,928.142 392.919,1006.21 395.227,987.968 397.535,972.073 399.843,1034.68 402.151,1076.8 404.459,996.224 406.767,919.65 409.075,828.843 411.383,867.543 413.69,941.674 415.998,1019.09 418.306,900.317 420.614,1136 422.922,997.118 425.23,1092.46 427.538,943.899 429.846,942.666 432.154,981.824 434.462,1188.91 436.77,1025.61 439.077,1113.16 441.385,864.521 443.693,958.366 446.001,920.567 448.309,1001.03 450.617,875.702 452.925,961.892 455.233,849.786 457.541,1019.06 459.849,963.289 462.157,904.131 464.465,1105.1 466.772,1048.44 469.08,946.165 471.388,964.795 473.696,947.111 476.004,957.275 478.312,893.255 480.62,979.905 482.928,1004.82 485.236,1024.35 487.544,930.647 489.852,928.813 492.159,889.666 494.467,1073.14 496.775,1047.05 499.083,1163.21 501.391,944.016 503.699,937.917 506.007,937.521 508.315,1042.84 510.623,1052.76 512.931,997.811 515.239,856.161 517.546,900.02 519.854,855.556 522.162,1145.36 524.47,802.69 526.778,873.698 529.086,795.669 531.394,856.048 533.702,1018.35 536.01,945.831 538.318,1020.91 540.626,723.556 542.933,1058.6 545.241,933.295 547.549,990.874 549.857,888.766 552.165,876.392 554.473,931.113 556.781,976.113 559.089,811.618 561.397,982.556 563.705,937.279 566.013,976.02 568.321,1010.36 570.628,994.447 572.936,979.959 575.244,1006.8 577.552,921.22 579.86,958.688 582.168,965.647 584.476,868.208 586.784,689.178 589.092,1066.56 591.4,1081.09 593.708,999.856 596.015,1096.41 598.323,949.515 600.631,916.461 602.939,990.747 605.247,778.628 607.555,966.387 609.863,911.201 612.171,943.721 614.479,943.83 616.787,821.13 619.095,734.45 621.402,1128.23 623.71,851.197 626.018,827.817 628.326,972.78 630.634,889.131 632.942,1122.43 635.25,794.453 637.558,1215.54 639.866,930.012 642.174,907.528 644.482,1053.47 646.79,1072.95 649.097,1029.46 651.405,697.78 653.713,1057.84 656.021,915.424 658.329,933.017 660.637,1027.56 662.945,726.239 665.253,946.579 667.561,968.701 669.869,994.572 672.177,832.44 674.484,1038.42 676.792,971.233 679.1,971.107 681.408,959.152 683.716,922.634 686.024,1030.19 688.332,937.771 690.64,1119.87 692.948,1056.27 695.256,1091.67 697.564,973.441 699.871,1164.29 702.179,1045.23 704.487,986.477 706.795,892.519 709.103,851.317 711.411,1056.89 713.719,919.55 716.027,908.161 718.335,877.393 720.643,1002.38 722.951,930.238 725.259,925.296 727.566,835.589 729.874,870.005 732.182,847.484 734.49,860.764 736.798,903.606 739.106,963.275 741.414,959.173 743.722,952.734 746.03,926.18 748.338,939.468 750.646,931.57 752.953,945.126 755.261,1023.25 757.569,887.723 759.877,853.708 762.185,781.22 764.493,859.643 766.801,875.838 769.109,932.226 771.417,1008.58 773.725,949.556 776.033,980.323 778.34,1112.37 780.648,1130.8 782.956,1156.77 785.264,829.404 787.572,1097.18 789.88,1081.27 792.188,1071.19 794.496,997.488 796.804,1018.57 799.112,906.844 801.42,1122.99 803.728,947.701 806.035,972.499 808.343,1030.63 810.651,837.278 812.959,872.817 815.267,816.104 817.575,888.812 819.883,931.647 822.191,976.41 824.499,969.347 826.807,849.792 829.115,1039.34 831.422,919.362 833.73,876.211 836.038,781.326 838.346,1134.59 840.654,974.565 842.962,1118.98 845.27,973.071 847.578,1104.86 849.886,908.267 852.194,835.252 854.502,945.226 856.809,821.57 859.117,797.376 861.425,966.539 863.733,1099.72 866.041,836.667 868.349,870.609 870.657,878.692 872.965,942.999 875.273,921.344 877.581,966.453 879.889,766.093 882.197,953.551 884.504,932.462 886.812,934.736 889.12,936.262 891.428,1000.21 893.736,1004.9 896.044,872.291 898.352,892.058 900.66,832.352 902.968,899.677 905.276,1083.55 907.584,1007.71 909.891,779.791 912.199,1010.36 914.507,926.749 916.815,936.451 919.123,746.163 921.431,937.024 923.739,954.238 926.047,730.463 928.355,946.646 930.663,1042.48 932.971,824.312 935.278,957.414 937.586,980.645 939.894,826.428 942.202,1024.15 944.51,1019.98 946.818,1030.23 949.126,836.276 951.434,971.382 953.742,850.086 956.05,880.512 958.358,849.16 960.665,843.944 962.973,975.768 965.281,936.886 967.589,1038.82 969.897,949.536 972.205,972.877 974.513,866.514 976.821,968.737 979.129,910.882 981.437,984.679 983.745,1025.79 986.053,966.999 988.36,1065.38 990.668,890.156 992.976,953.452 995.284,889.449 997.592,1031.97 999.9,901.315 1002.21,927.644 1004.52,862.526 1006.82,1099.96 1009.13,951.495 1011.44,890.164 1013.75,918.047 1016.06,890.083 1018.36,830.397 1020.67,1045.37 1022.98,877.813 1025.29,964.457 1027.59,1134.14 1029.9,994.323 1032.21,838.993 1034.52,971.547 1036.83,989.674 1039.13,925.253 1041.44,1070.52 1043.75,1010.6 1046.06,1215.71 1048.37,1133.23 1050.67,939.686 1052.98,949.177 1055.29,913.316 1057.6,986.963 1059.91,977.446 1062.21,1038.74 1064.52,954.024 1066.83,1026.14 1069.14,1023.39 1071.45,892.649 1073.75,924.571 1076.06,931.594 1078.37,1091.69 1080.68,1108.84 1082.98,763.303 1085.29,800.927 1087.6,933.543 1089.91,1058.54 1092.22,939.399 1094.52,936.909 1096.83,923.899 1099.14,1054.23 1101.45,980.921 1103.76,1030.8 1106.06,956.446 1108.37,959.953 1110.68,1121.58 1112.99,933.435 1115.3,984.043 1117.6,925.435 1119.91,929.241 1122.22,911.614 1124.53,1004.02 1126.84,1103 1129.14,890.167 1131.45,1051.44 1133.76,846.811 1136.07,1033.58 1138.37,904.939 1140.68,1009.5 1142.99,939.001 1145.3,854.876 1147.61,779.964 1149.91,855.605 1152.22,888.834 1154.53,850.999 1156.84,923.341 1159.15,883.996 1161.45,885.859 1163.76,1002.89 1166.07,897.82 1168.38,1083.92 1170.69,858.203 1172.99,947.838 1175.3,1034.14 1177.61,1047.38 1179.92,1047.56 1182.23,1103.7 1184.53,933.19 1186.84,939.656 1189.15,888.87 1191.46,857.129 1193.76,1115.91 1196.07,874.694 1198.38,901.609 1200.69,838.024 1203,1017.7 1205.3,794.592 1207.61,880.642 1209.92,1133.1 1212.23,1017.66 1214.54,1112.27 1216.84,1031.04 1219.15,975.499 1221.46,994.856 1223.77,974.006 1226.08,1032.09 1228.38,1012.93 1230.69,941.133 1233,1086.73 1235.31,914.191 1237.61,996.235 1239.92,894.086 1242.23,980.839 1244.54,864.845 1246.85,1000.45 1249.15,827.919 1251.46,940.404 1253.77,875.463 1256.08,1015.44 1258.39,1131.55 1260.69,948.348 1263,1099.9 1265.31,910.09 1267.62,1096.43 1269.93,768.319 1272.23,1018.76 1274.54,862.021 1276.85,993.136 1279.16,935.782 1281.47,903.387 1283.77,1033.06 1286.08,858.803 1288.39,1065.39 1290.7,972.406 1293,937.067 1295.31,1027.21 1297.62,911.569 1299.93,959.88 1302.24,845.736 1304.54,1010.6 1306.85,690.638 1309.16,823.186 1311.47,996.314 1313.78,1065 1316.08,938.312 1318.39,805.283 1320.7,1010.42 1323.01,934.443 1325.32,982.261 1327.62,968.993 1329.93,1003.09 1332.24,914.204 1334.55,749.548 1336.86,916.467 1339.16,834.489 1341.47,930.39 1343.78,924.124 1346.09,981.478 1348.39,966.687 1350.7,815.673 1353.01,919.097 1355.32,1029.78 1357.63,1013.57 1359.93,760.154 1362.24,883.951 1364.55,930.495 1366.86,1056.07 1369.17,934.12 1371.47,893.724 1373.78,936.773 1376.09,791.509 1378.4,820.33 1380.71,1007.17 1383.01,989.405 1385.32,940.107 1387.63,1090.23 1389.94,880.227 1392.24,869.316 1394.55,980.171 1396.86,1171.49 1399.17,1102.79 1401.48,814.43 1403.78,1108.97 1406.09,867.259 1408.4,858.387 1410.71,1004.57 1413.02,938.166 1415.32,861.619 1417.63,923.677 1419.94,867.813 1422.25,942.647 1424.56,863.957 1426.86,1013.83 1429.17,917.951 1431.48,786.028 1433.79,992.583 1436.1,952.585 1438.4,926.903 1440.71,997.22 1443.02,909.943 1445.33,1109.5 1447.63,932.124 1449.94,1030.53 1452.25,941.8 1454.56,1055.29 1456.87,941.493 1459.17,992.27 1461.48,1009.39 1463.79,1068.86 1466.1,937.776 1468.41,905.946 1470.71,990.143 1473.02,810.033 1475.33,850.631 1477.64,1125.35 1479.95,1072.41 1482.25,993.766 1484.56,973.55 1486.87,870.305 1489.18,1089.66 1491.49,942.144 1493.79,906.998 1496.1,987.646 1498.41,1039.98 1500.72,983.053 1503.02,769.402 1505.33,963.66 1507.64,828.125 1509.95,892.007 1512.26,1114.7 1514.56,894.382 1516.87,908.908 1519.18,1011.12 1521.49,843.937 1523.8,896.36 1526.1,881.205 1528.41,963.943 1530.72,815.479 1533.03,836.238 1535.34,768.875 1537.64,931.518 1539.95,920.674 1542.26,836.523 1544.57,821.209 1546.88,938.337 1549.18,904.106 1551.49,940.228 1553.8,843.916 1556.11,1106.83 1558.41,878.048 1560.72,976.401 1563.03,1092.6 1565.34,951.618 1567.65,1031.18 1569.95,1008.14 1572.26,988.156 1574.57,1017.41 1576.88,967.011 1579.19,890.131 1581.49,1053.6 1583.8,861.838 1586.11,882.98 1588.42,1197.14 1590.73,940.772 1593.03,909.047 1595.34,1017.29 1597.65,1031.36 1599.96,971.604 1602.26,1017.89 1604.57,1039.32 1606.88,844.204 1609.19,854.257 1611.5,957.3 1613.8,748.844 1616.11,919.9 1618.42,972.938 1620.73,955.659 1623.04,1023.03 1625.34,1007.89 1627.65,912.03 1629.96,903.877 1632.27,1041.11 1634.58,891.54 1636.88,909.618 1639.19,697.736 1641.5,920.204 1643.81,977.639 1646.12,885.861 1648.42,950.696 1650.73,907.585 1653.04,869.9 1655.35,839.364 1657.65,956.214 1659.96,960.83 1662.27,985.837 1664.58,940.308 1666.89,943.738 1669.19,982.376 1671.5,1026.39 1673.81,885.516 1676.12,1000.69 1678.43,964.544 1680.73,914.573 1683.04,958.549 1685.35,949.982 1687.66,889.927 1689.97,938.929 1692.27,1132.05 1694.58,832.298 1696.89,919.651 1699.2,979.149 1701.51,806.877 1703.81,968.07 1706.12,898.409 1708.43,1065.02 1710.74,903.572 1713.04,996.776 1715.35,866.878 1717.66,865.968 1719.97,958.774 1722.28,989.066 1724.58,1078.66 1726.89,902.249 1729.2,982.563 1731.51,892.781 1733.82,795.707 1736.12,1145.66 1738.43,1054.98 1740.74,1047.88 1743.05,961.324 1745.36,910.079 1747.66,966.056 1749.97,947.305 1752.28,1115.88 1754.59,814.058 1756.9,906.809 1759.2,761.178 1761.51,1048.81 1763.82,699.762 1766.13,921.957 1768.43,878.424 1770.74,991.18 1773.05,877.096 1775.36,863.868 1777.67,920.85 1779.97,867.222 1782.28,1044.49 1784.59,1046.96 1786.9,791.939 1789.21,1128.72 1791.51,823.484 1793.82,1058.05 1796.13,911.272 1798.44,974.71 1800.75,860.518 1803.05,868.38 1805.36,884.939 1807.67,844.647 1809.98,985.717 1812.28,894.794 1814.59,1146.92 1816.9,815.129 1819.21,861.031 1821.52,974.458 1823.82,875.492 1826.13,856.748 1828.44,907.237 1830.75,887.151 1833.06,796.326 1835.36,794.647 1837.67,1092.88 1839.98,1123.44 1842.29,1057.27 1844.6,1089.86 1846.9,843.984 1849.21,834.02 1851.52,931.246 1853.83,988.648 1856.14,891.636 1858.44,1004.63 1860.75,937.287 1863.06,1123.79 1865.37,799.606 1867.67,1038.02 1869.98,860.264 1872.29,891.045 1874.6,983.389 1876.91,1155.26 1879.21,953.368 1881.52,889.59 1883.83,913.508 1886.14,1011.06 1888.45,763.983 1890.75,984.284 1893.06,972.75 1895.37,938.281 1897.68,945.186 1899.99,888.207 1902.29,935.441 1904.6,1011.19 1906.91,1109.29 1909.22,1074.43 1911.53,875.873 1913.83,1066.43 1916.14,826.589 1918.45,734.349 1920.76,1045.47 1923.06,951.58 1925.37,956.742 1927.68,1110.79 1929.99,944.783 1932.3,997.603 1934.6,1000.19 1936.91,937.632 1939.22,957.583 1941.53,842.767 1943.84,1034.69 1946.14,880.562 1948.45,996.337 1950.76,904.11 1953.07,1117.95 1955.38,952.56 1957.68,814.63 1959.99,1019.14 1962.3,944.381 1964.61,1041.46 1966.91,781.348 1969.22,1045.45 1971.53,996.384 1973.84,907.283 1976.15,918.843 1978.45,974.408 1980.76,917.712 1983.07,946.354 1985.38,934.577 1987.69,1086.07 1989.99,913.479 1992.3,1054.93 1994.61,966.251 1996.92,875.022 1999.23,1073.74 2001.53,910.999 2003.84,961.411 2006.15,959.663 2008.46,908.226 2010.77,858.282 2013.07,737.334 2015.38,962.228 2017.69,901.267 2020,1077.95 2022.3,1053.93 2024.61,1000.18 2026.92,793.596 2029.23,1051.57 2031.54,1030.62 2033.84,889.66 2036.15,905.477 2038.46,904.302 2040.77,942.04 2043.08,854.86 2045.38,824.24 2047.69,925.441 2050,1120.02 2052.31,821.575 2054.62,776.61 2056.92,843.873 2059.23,772.024 2061.54,805.83 2063.85,1007.32 2066.16,1030.46 2068.46,937.956 2070.77,977.529 2073.08,940.083 2075.39,964.066 2077.69,1023.51 2080,1142.03 2082.31,914.601 2084.62,882.177 2086.93,836.504 2089.23,813.42 2091.54,972.722 2093.85,867.445 2096.16,970.123 2098.47,1115.6 2100.77,1078.35 2103.08,940.982 2105.39,741.732 2107.7,942.704 2110.01,979.94 2112.31,983.919 2114.62,940.66 2116.93,1073.96 2119.24,939.786 2121.55,1008.2 2123.85,945.539 2126.16,1008.86 2128.47,975.886 2130.78,922.373 2133.08,902.337 2135.39,1057.27 2137.7,1093.16 2140.01,854.736 2142.32,792.207 2144.62,1021.9 2146.93,857.336 2149.24,863.289 2151.55,1030.86 2153.86,877.181 2156.16,983.759 2158.47,801.495 2160.78,959.809 2163.09,834.971 2165.4,1016.82 2167.7,870.473 2170.01,971.362 2172.32,932.484 2174.63,889.457 2176.93,1016.5 2179.24,1026.38 2181.55,953.795 2183.86,1002.91 2186.17,1032.93 2188.47,903.922 2190.78,986.911 2193.09,810.635 2195.4,928.014 2197.71,961.141 2200.01,807.983 2202.32,975.164 2204.63,1045.66 2206.94,827.546 2209.25,963.85 2211.55,919.405 2213.86,655.467 2216.17,1047.75 2218.48,1045.21 2220.79,959.303 2223.09,894.14 2225.4,895.723 2227.71,1016.89 2230.02,926.781 2232.32,1072.36 2234.63,926.903 2236.94,851.808 2239.25,914.923 2241.56,960.293 2243.86,1102.54 2246.17,752.103 2248.48,930.234 2250.79,1109.03 2253.1,982.649 2255.4,894.535 2257.71,999.587 2260.02,896.667 2262.33,928.099 2264.64,895.617 2266.94,953.511 2269.25,715.711 2271.56,1015.6 2273.87,926.329 2276.18,972.261 2278.48,920.29 2280.79,982.101 2283.1,968.428 2285.41,947.915 2287.71,767.404 2290.02,769.803 2292.33,1054.28 2294.64,915.974 2296.95,824.518 2299.25,962.424 2301.56,1067.12 2303.87,1039.66 2306.18,898.799 2308.49,943.057 2310.79,914.665 2313.1,747.24 2315.41,1016.64 2317.72,941.54 2320.03,995.633 2322.33,954.504 2324.64,1061.87 2326.95,965.595 2329.26,1137.26 2331.56,804.79 2333.87,1195.12 2336.18,889.466 2338.49,1123.11 2340.8,880.897 2343.1,861.636 2345.41,873.538 2347.72,1087.45 2350.03,844.023 2352.34,857.933 2354.64,1183.91 2356.95,1035.51 2359.26,833.955 2361.57,997.96 2363.88,923.682 2366.18,1012.24 2368.49,1055.41 2370.8,918.613 2373.11,874.574 2375.42,908.845 2377.72,1003.58 2380.03,814.466 2382.34,1030.98 2384.65,1016.77 2386.95,935.15 2389.26,1065.36 2391.57,841.174 2393.88,887.449 2396.19,999.779 2398.49,957.641 2400.8,1108.46 2403.11,906.907 2405.42,967.734 2407.73,1048.95 2410.03,869 2412.34,928.585 2414.65,794.917 2416.96,970.619 2419.27,782.562 2421.57,1009.46 2423.88,762.686 2426.19,1007.56 2428.5,1069.26 2430.81,1134.3 2433.11,780.656 2435.42,1025.82 2437.73,963.811 2440.04,973.137 2442.34,940.23 2444.65,1003.65 2446.96,821.942 2449.27,1047.54 2451.58,944.277 2453.88,1070.56 2456.19,1001.39 2458.5,888.673 2460.81,930.429 2463.12,888.074 2465.42,1008.1 2467.73,911.977 2470.04,1014.81 2472.35,1100.77 2474.66,955.614 2476.96,1005.3 2479.27,802.283 2481.58,850.198 2483.89,969.755 2486.2,988.673 2488.5,1029.94 2490.81,951.748 2493.12,913.247 2495.43,847.048 2497.73,725.565 2500.04,927.931 2502.35,912.979 2504.66,911.071 2506.97,761.678 2509.27,926.623 2511.58,851.806 2513.89,896.76 2516.2,660.925 2518.51,1078.17 2520.81,798.864 2523.12,913.163 2525.43,891.493 2527.74,958.89 2530.05,821.667 2532.35,1003.57 2534.66,972.47 2536.97,996.023 2539.28,911.626 2541.58,940.768 2543.89,981.157 2546.2,871.029 2548.51,774.86 2550.82,1064.77 2553.12,731.658 2555.43,929.689 2557.74,861.483 2560.05,815.48 2562.36,863.514 2564.66,988.661 2566.97,977.944 2569.28,990.667 2571.59,818.618 "></polyline>
<polyline clip-path="url(#clip132)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,651.482 268.292,412.379 270.6,341.761 272.908,308.848 275.216,602.485 277.524,431.721 279.832,568.658 282.139,474.874 284.447,494.947 286.755,543.922 289.063,538.479 291.371,544.123 293.679,498.082 295.987,409.947 298.295,586.577 300.603,413.004 302.911,557.331 305.219,646.285 307.527,437.273 309.834,457.466 312.142,409.967 314.45,371.832 316.758,390.222 319.066,573.195 321.374,436.825 323.682,529.112 325.99,390.24 328.298,273.309 330.606,446.989 332.914,513.971 335.221,656.962 337.529,438.337 339.837,458.253 342.145,477.53 344.453,445.238 346.761,710.536 349.069,518.251 351.377,403.737 353.685,548.574 355.993,393.275 358.301,542.916 360.608,505.569 362.916,409.919 365.224,446.695 367.532,588.273 369.84,558.797 372.148,327.829 374.456,609.901 376.764,430.058 379.072,518.847 381.38,345.687 383.688,392.52 385.996,266.387 388.303,516.1 390.611,485.525 392.919,492.165 395.227,363.094 397.535,425.835 399.843,462.77 402.151,455.35 404.459,386.075 406.767,295.294 409.075,523.254 411.383,577.059 413.69,393.963 415.998,372.145 418.306,310.786 420.614,379.724 422.922,389.185 425.23,373.774 427.538,488.846 429.846,478.156 432.154,467.541 434.462,593.898 436.77,478.723 439.077,259.988 441.385,401.84 443.693,347.354 446.001,445.781 448.309,475.033 450.617,506.197 452.925,398.901 455.233,629.86 457.541,353.985 459.849,371.992 462.157,381.356 464.465,391.61 466.772,625.2 469.08,481.671 471.388,554.907 473.696,474.953 476.004,443.513 478.312,630.356 480.62,459.363 482.928,498.628 485.236,303.355 487.544,277.185 489.852,398.162 492.159,364.561 494.467,493.017 496.775,402.694 499.083,463.456 501.391,460.94 503.699,336.249 506.007,605.654 508.315,481.959 510.623,666.801 512.931,486.015 515.239,515.016 517.546,454.435 519.854,449.409 522.162,315.831 524.47,248.025 526.778,332.326 529.086,580.547 531.394,365.381 533.702,513.056 536.01,380.136 538.318,406.533 540.626,554.099 542.933,397.045 545.241,468.656 547.549,251.413 549.857,515.419 552.165,401.778 554.473,475.83 556.781,395.545 559.089,438.165 561.397,515.078 563.705,355.518 566.013,329.827 568.321,505.204 570.628,458.302 572.936,547.763 575.244,484.264 577.552,296.239 579.86,387.119 582.168,294.308 584.476,589.804 586.784,451.278 589.092,361.684 591.4,521.283 593.708,411.024 596.015,513.75 598.323,458.12 600.631,490.159 602.939,374.086 605.247,420.94 607.555,320.914 609.863,525.125 612.171,572.742 614.479,440.842 616.787,336.782 619.095,411.556 621.402,530.609 623.71,547.836 626.018,588.345 628.326,510.032 630.634,541.82 632.942,606.339 635.25,644.616 637.558,601.016 639.866,440.178 642.174,343.072 644.482,418.914 646.79,409.525 649.097,718.353 651.405,383.215 653.713,451.811 656.021,522.951 658.329,632.558 660.637,541.022 662.945,385.611 665.253,456.755 667.561,555.527 669.869,486.909 672.177,506.068 674.484,539.272 676.792,469.378 679.1,556.301 681.408,488.164 683.716,220.11 686.024,462.619 688.332,267.198 690.64,305.615 692.948,542.222 695.256,548.444 697.564,675.909 699.871,335.889 702.179,401.769 704.487,390.155 706.795,449.308 709.103,570.898 711.411,443.612 713.719,558.286 716.027,415.818 718.335,287.307 720.643,416.4 722.951,404.126 725.259,458.741 727.566,187.626 729.874,527.943 732.182,544.651 734.49,498.254 736.798,331.152 739.106,315.87 741.414,473.288 743.722,467.219 746.03,349.01 748.338,475.578 750.646,490.985 752.953,469.317 755.261,442.58 757.569,361.778 759.877,502.918 762.185,512.276 764.493,432.021 766.801,422.356 769.109,360.816 771.417,387.446 773.725,483.439 776.033,421.634 778.34,443.003 780.648,518.597 782.956,496.512 785.264,537.93 787.572,457.775 789.88,292.349 792.188,322.997 794.496,397.278 796.804,556.973 799.112,354.878 801.42,535.558 803.728,494.77 806.035,560.196 808.343,594.829 810.651,552.225 812.959,400.973 815.267,375.953 817.575,321.676 819.883,519.008 822.191,481.579 824.499,278.935 826.807,450.184 829.115,537.137 831.422,438.602 833.73,410.184 836.038,408.67 838.346,531.166 840.654,549.65 842.962,444.18 845.27,448.077 847.578,394.678 849.886,310.094 852.194,536.656 854.502,550.404 856.809,428.014 859.117,444.516 861.425,585.983 863.733,371.981 866.041,248.102 868.349,403.657 870.657,717.102 872.965,525.424 875.273,539.182 877.581,713.844 879.889,635.397 882.197,472.471 884.504,511.677 886.812,536.495 889.12,328.17 891.428,516.721 893.736,559.191 896.044,673.421 898.352,531.715 900.66,642.672 902.968,489.417 905.276,501.139 907.584,444.826 909.891,549.835 912.199,484.806 914.507,522.105 916.815,538.434 919.123,504.605 921.431,552.75 923.739,324.856 926.047,420.757 928.355,492.792 930.663,409.922 932.971,486.683 935.278,417.396 937.586,501.221 939.894,543.954 942.202,604.881 944.51,371.839 946.818,483.523 949.126,462.902 951.434,335.179 953.742,438.833 956.05,581.362 958.358,483.552 960.665,591.714 962.973,469.259 965.281,314.906 967.589,532.684 969.897,494.33 972.205,403.317 974.513,354.761 976.821,527.741 979.129,503.258 981.437,301.76 983.745,403.477 986.053,426.774 988.36,650.418 990.668,318.562 992.976,479.642 995.284,599.744 997.592,366.485 999.9,475.026 1002.21,410.251 1004.52,550.341 1006.82,319.564 1009.13,468.33 1011.44,474.498 1013.75,652.349 1016.06,465.243 1018.36,461.703 1020.67,319.687 1022.98,595.093 1025.29,648.409 1027.59,501.446 1029.9,598.185 1032.21,531.148 1034.52,289.126 1036.83,405.357 1039.13,617.63 1041.44,540.585 1043.75,456.323 1046.06,452.694 1048.37,564.21 1050.67,453.549 1052.98,424.53 1055.29,337.706 1057.6,297.5 1059.91,442.775 1062.21,624.272 1064.52,499.423 1066.83,386.043 1069.14,402.26 1071.45,472.748 1073.75,317.295 1076.06,471.226 1078.37,390.187 1080.68,371.695 1082.98,371.479 1085.29,656.389 1087.6,677.432 1089.91,461.029 1092.22,551.698 1094.52,455.076 1096.83,419.51 1099.14,563.109 1101.45,475.143 1103.76,356.075 1106.06,552.542 1108.37,436.591 1110.68,576.744 1112.99,463.436 1115.3,548.897 1117.6,432.156 1119.91,528.217 1122.22,531.463 1124.53,523.796 1126.84,308.022 1129.14,603.453 1131.45,433.005 1133.76,437.205 1136.07,563.48 1138.37,408.185 1140.68,382.949 1142.99,412.921 1145.3,424.994 1147.61,344.462 1149.91,463.136 1152.22,433.02 1154.53,539.476 1156.84,431.509 1159.15,425.399 1161.45,377.642 1163.76,600.474 1166.07,270.9 1168.38,524.376 1170.69,339.119 1172.99,415.318 1175.3,598.256 1177.61,396.249 1179.92,534.941 1182.23,296.993 1184.53,539.013 1186.84,438.748 1189.15,462.846 1191.46,465.223 1193.76,348.597 1196.07,620.45 1198.38,415.913 1200.69,381.196 1203,409.942 1205.3,408.669 1207.61,375.263 1209.92,357.761 1212.23,377.647 1214.54,468.169 1216.84,366.043 1219.15,590.747 1221.46,431.963 1223.77,712.294 1226.08,513.624 1228.38,355.671 1230.69,465.544 1233,461.284 1235.31,551.562 1237.61,598.945 1239.92,329.977 1242.23,438.272 1244.54,460.707 1246.85,352.244 1249.15,567.358 1251.46,411.327 1253.77,422.479 1256.08,634.037 1258.39,515.79 1260.69,452.021 1263,424.26 1265.31,594.036 1267.62,496.974 1269.93,615.516 1272.23,503.227 1274.54,573.958 1276.85,577.384 1279.16,501.176 1281.47,549.887 1283.77,523.088 1286.08,571.432 1288.39,465.387 1290.7,248.126 1293,348.601 1295.31,334.974 1297.62,394.936 1299.93,579.138 1302.24,342.272 1304.54,357.616 1306.85,552.079 1309.16,376.264 1311.47,690.368 1313.78,472.287 1316.08,398.413 1318.39,577.046 1320.7,547.532 1323.01,500.447 1325.32,492.245 1327.62,485.392 1329.93,577.659 1332.24,424.404 1334.55,491.565 1336.86,261.18 1339.16,359.42 1341.47,366.479 1343.78,491.985 1346.09,398.372 1348.39,368.667 1350.7,562.191 1353.01,527.351 1355.32,547.252 1357.63,364.054 1359.93,581.32 1362.24,443.623 1364.55,438.299 1366.86,412.793 1369.17,376.013 1371.47,234.446 1373.78,401.102 1376.09,415.359 1378.4,514.204 1380.71,455.36 1383.01,471.071 1385.32,402.257 1387.63,552.204 1389.94,552.752 1392.24,503.502 1394.55,399.171 1396.86,524.529 1399.17,524.904 1401.48,544.986 1403.78,433.63 1406.09,490.151 1408.4,569.447 1410.71,526.862 1413.02,516.206 1415.32,532.752 1417.63,443.564 1419.94,418.556 1422.25,578.321 1424.56,514.405 1426.86,304.208 1429.17,329.468 1431.48,453.909 1433.79,635.881 1436.1,481.451 1438.4,537.326 1440.71,516.293 1443.02,537.638 1445.33,480.23 1447.63,453.11 1449.94,640.116 1452.25,415.87 1454.56,346.823 1456.87,373.232 1459.17,523.68 1461.48,398.443 1463.79,561.281 1466.1,437.999 1468.41,433.649 1470.71,572.536 1473.02,452.355 1475.33,310.261 1477.64,626.566 1479.95,522.902 1482.25,458.151 1484.56,364.597 1486.87,453.313 1489.18,502.982 1491.49,514.184 1493.79,515.048 1496.1,391.695 1498.41,454.827 1500.72,416.839 1503.02,476.459 1505.33,597.751 1507.64,440.688 1509.95,490.1 1512.26,399.423 1514.56,358.302 1516.87,590.356 1519.18,276.719 1521.49,578.429 1523.8,466.329 1526.1,425.452 1528.41,427.351 1530.72,407.033 1533.03,386.332 1535.34,509.117 1537.64,462.021 1539.95,314.301 1542.26,148.903 1544.57,412.572 1546.88,353.75 1549.18,491.77 1551.49,507.401 1553.8,415.763 1556.11,480.789 1558.41,690.432 1560.72,434.294 1563.03,467.024 1565.34,506.382 1567.65,282.619 1569.95,547.875 1572.26,385.877 1574.57,443.716 1576.88,472.696 1579.19,389.209 1581.49,340.023 1583.8,475.298 1586.11,529.426 1588.42,238.687 1590.73,580.714 1593.03,439.29 1595.34,475.295 1597.65,525.644 1599.96,366.44 1602.26,504.427 1604.57,438.019 1606.88,514.954 1609.19,392.349 1611.5,507.56 1613.8,298.704 1616.11,489.961 1618.42,468.764 1620.73,556.615 1623.04,424.717 1625.34,393.461 1627.65,370.794 1629.96,519.73 1632.27,442.635 1634.58,434.293 1636.88,624.936 1639.19,365.513 1641.5,575.201 1643.81,463.091 1646.12,478.586 1648.42,391.794 1650.73,412.542 1653.04,523.968 1655.35,423.208 1657.65,484.58 1659.96,492.435 1662.27,638.356 1664.58,702.367 1666.89,591.807 1669.19,465.747 1671.5,447.024 1673.81,572.55 1676.12,347.843 1678.43,362.253 1680.73,516.223 1683.04,473.09 1685.35,365.524 1687.66,448.084 1689.97,691.146 1692.27,437.22 1694.58,408.631 1696.89,761.016 1699.2,425.47 1701.51,431.227 1703.81,532.277 1706.12,499.115 1708.43,583.364 1710.74,373.215 1713.04,296.033 1715.35,509.688 1717.66,630.908 1719.97,418.43 1722.28,464.243 1724.58,593.162 1726.89,463.75 1729.2,362.711 1731.51,574.379 1733.82,409.743 1736.12,462.089 1738.43,682.16 1740.74,448.133 1743.05,643.791 1745.36,368.205 1747.66,529.129 1749.97,574.345 1752.28,527.685 1754.59,379.328 1756.9,363.664 1759.2,318.171 1761.51,376.938 1763.82,513.227 1766.13,511.949 1768.43,479.237 1770.74,540.876 1773.05,523.618 1775.36,760.989 1777.67,496.055 1779.97,611.872 1782.28,483.001 1784.59,594.307 1786.9,417.535 1789.21,351.959 1791.51,445.294 1793.82,525.038 1796.13,529.499 1798.44,447.56 1800.75,367.54 1803.05,422.209 1805.36,494.486 1807.67,335.195 1809.98,499.897 1812.28,574.727 1814.59,432.743 1816.9,529.271 1819.21,643.166 1821.52,608.399 1823.82,516.08 1826.13,424.464 1828.44,309.805 1830.75,369.261 1833.06,472.315 1835.36,563.183 1837.67,412.403 1839.98,412.67 1842.29,336.499 1844.6,461.957 1846.9,481.795 1849.21,485.19 1851.52,398.692 1853.83,514.482 1856.14,504.305 1858.44,473.749 1860.75,404.826 1863.06,531.745 1865.37,473.632 1867.67,398.43 1869.98,360.169 1872.29,430.683 1874.6,509.83 1876.91,589.859 1879.21,683.5 1881.52,426.413 1883.83,493.611 1886.14,522.666 1888.45,376.696 1890.75,469.585 1893.06,442.698 1895.37,377.854 1897.68,519.361 1899.99,489.748 1902.29,431.837 1904.6,435.797 1906.91,575.499 1909.22,381.896 1911.53,589.047 1913.83,534.167 1916.14,580.936 1918.45,591.041 1920.76,534.865 1923.06,606.849 1925.37,607.255 1927.68,469.476 1929.99,462.846 1932.3,332.491 1934.6,413.41 1936.91,513.194 1939.22,581.588 1941.53,428.525 1943.84,513.459 1946.14,417.619 1948.45,550.346 1950.76,531.387 1953.07,96.8724 1955.38,589.609 1957.68,479.547 1959.99,529.515 1962.3,362.152 1964.61,336.767 1966.91,481.519 1969.22,626.018 1971.53,326.923 1973.84,468.12 1976.15,554.845 1978.45,323.722 1980.76,514.766 1983.07,491.604 1985.38,632.869 1987.69,361.963 1989.99,349.881 1992.3,598.698 1994.61,527.854 1996.92,601.759 1999.23,493.23 2001.53,425.338 2003.84,420.367 2006.15,439.384 2008.46,365.797 2010.77,559.054 2013.07,642.661 2015.38,422.384 2017.69,365.895 2020,565.572 2022.3,391.312 2024.61,531.464 2026.92,431.151 2029.23,478.862 2031.54,315.084 2033.84,482.187 2036.15,635.318 2038.46,500.812 2040.77,501.258 2043.08,452.927 2045.38,499.546 2047.69,312.53 2050,634.097 2052.31,451.014 2054.62,705.788 2056.92,570.177 2059.23,483.678 2061.54,373.043 2063.85,597.519 2066.16,385.003 2068.46,401.109 2070.77,436.365 2073.08,510.3 2075.39,395.558 2077.69,325.865 2080,546.216 2082.31,420.842 2084.62,617.446 2086.93,479.389 2089.23,415.395 2091.54,619.392 2093.85,529.838 2096.16,376.479 2098.47,314.465 2100.77,430.356 2103.08,576.694 2105.39,458.907 2107.7,664.285 2110.01,332.604 2112.31,415.229 2114.62,342.389 2116.93,398.592 2119.24,488.306 2121.55,548.915 2123.85,480.989 2126.16,524.416 2128.47,452.196 2130.78,553.162 2133.08,411.294 2135.39,427.772 2137.7,500.451 2140.01,483.89 2142.32,466.535 2144.62,401.974 2146.93,485.915 2149.24,495.863 2151.55,592.495 2153.86,471.215 2156.16,553.434 2158.47,398.248 2160.78,360.268 2163.09,438.693 2165.4,420.908 2167.7,312.956 2170.01,387.281 2172.32,358.354 2174.63,324.516 2176.93,640.008 2179.24,466.246 2181.55,468.437 2183.86,477.855 2186.17,541.871 2188.47,553.533 2190.78,372.132 2193.09,498.476 2195.4,323.034 2197.71,518.4 2200.01,371.707 2202.32,487.431 2204.63,496.648 2206.94,624.458 2209.25,572.308 2211.55,366.04 2213.86,410.858 2216.17,360.467 2218.48,400.448 2220.79,401.761 2223.09,578.495 2225.4,516.876 2227.71,493.495 2230.02,448.963 2232.32,620.946 2234.63,366.671 2236.94,509.209 2239.25,434.803 2241.56,282.562 2243.86,539.338 2246.17,444.776 2248.48,607.475 2250.79,471.395 2253.1,433.559 2255.4,410.227 2257.71,409.156 2260.02,564.029 2262.33,474.648 2264.64,489.315 2266.94,553.182 2269.25,426.057 2271.56,383.008 2273.87,569.432 2276.18,439.483 2278.48,809.447 2280.79,360.239 2283.1,365.674 2285.41,584.069 2287.71,467.643 2290.02,525.467 2292.33,414.811 2294.64,262.163 2296.95,460.974 2299.25,517.934 2301.56,426.18 2303.87,551.264 2306.18,459.301 2308.49,458.573 2310.79,487.063 2313.1,514.544 2315.41,452.167 2317.72,509.609 2320.03,476.788 2322.33,502.244 2324.64,553.492 2326.95,446.185 2329.26,462.059 2331.56,486.272 2333.87,405.072 2336.18,621.321 2338.49,447.407 2340.8,437.032 2343.1,385.877 2345.41,326.535 2347.72,768.07 2350.03,422.056 2352.34,544.39 2354.64,579.487 2356.95,466.944 2359.26,418.27 2361.57,494.423 2363.88,364.86 2366.18,409.168 2368.49,360.657 2370.8,454.072 2373.11,587.7 2375.42,460.862 2377.72,505.121 2380.03,387.772 2382.34,591.629 2384.65,360.801 2386.95,344.207 2389.26,406.476 2391.57,466.996 2393.88,253.094 2396.19,363.628 2398.49,544.877 2400.8,556.484 2403.11,385.4 2405.42,517.472 2407.73,445.616 2410.03,298.365 2412.34,457.736 2414.65,438.078 2416.96,367.508 2419.27,330.993 2421.57,535.909 2423.88,506.385 2426.19,557.049 2428.5,482.79 2430.81,463.032 2433.11,279.691 2435.42,569.394 2437.73,502.077 2440.04,356.169 2442.34,319.372 2444.65,460.342 2446.96,552.622 2449.27,467.595 2451.58,543.756 2453.88,494.578 2456.19,498.279 2458.5,495.548 2460.81,523.328 2463.12,527.972 2465.42,405.458 2467.73,524.854 2470.04,340.076 2472.35,653.736 2474.66,438.663 2476.96,433.815 2479.27,312.919 2481.58,440.389 2483.89,458.728 2486.2,477.472 2488.5,382.949 2490.81,455.351 2493.12,432.782 2495.43,502.497 2497.73,528.822 2500.04,575.082 2502.35,622.095 2504.66,460.535 2506.97,321.039 2509.27,539.235 2511.58,402.111 2513.89,430.748 2516.2,421.903 2518.51,454.378 2520.81,538.058 2523.12,632.906 2525.43,343.319 2527.74,302.337 2530.05,495.721 2532.35,457.751 2534.66,572.065 2536.97,564.522 2539.28,447.574 2541.58,487.07 2543.89,356.535 2546.2,474.231 2548.51,371.398 2550.82,344.007 2553.12,587.617 2555.43,436.869 2557.74,469.242 2560.05,289.867 2562.36,437.705 2564.66,307.313 2566.97,454.57 2569.28,569.155 2571.59,482.038 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -2.82901   -3.65413   -5.15324    …  -6.70633   -5.0344   -5.0344
 -0.342877  -0.377143  -0.0676111      0.235447   0.61723   0.61723
  2.898      3.02869    3.95972        5.12918    5.718     5.718

[:, :, 2] =
 -3.18749   -3.10895  -4.70569   -5.36963  …  -4.40633   -4.82255  -5.46825
 -0.565424  -0.70948   0.306344   1.60967      0.852016  -0.35271  -0.875743
  2.05158    3.24467   5.56406    5.69653      6.13536    6.12936   6.5751

[:, :, 3] =
 -2.75545   -3.36386   -6.01647   -6.90643   …  -4.4284   -4.1774    -4.97992
 -0.701164   0.536064   0.611369   0.139728     -1.73964   0.839353   1.61304
  2.89558    4.31441    5.00554    2.66307       3.97956   2.88158    4.96346

[:, :, 4] =
 -2.00494   -3.01138  -3.01138  …  -3.43622   -5.77087    -5.77087
  0.882241   1.88842   1.88842      0.580926   0.0790193   0.0790193
  3.27219    2.67769   2.67769      6.07001    5.65732     5.65732</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.97949     1.00078
 -0.00775848  0.994735
  5.00998     0.99183</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.45 seconds
Compute duration  = 2.45 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -5.0068    1.0039    0.0172   3409.9140   5038.1263    1.0001   ⋯
        x[2]   -0.0096    1.0038    0.0181   3059.0908   4536.8828    1.0000   ⋯
        x[3]    4.9967    0.9946    0.0170   3406.3175   5041.9680    1.0000   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -6.9550   -5.6919   -5.0017   -4.3221   -3.0227
        x[2]   -1.9546   -0.6854   -0.0088    0.6718    1.9608
        x[3]    3.0566    4.3249    4.9937    5.6743    6.9614</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.44 seconds
Compute duration  = 1.44 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.5020    0.1868    0.0026   4893.1341   5803.9277    1.0006   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1528    0.3616    0.5006    0.6431    0.8551</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.23 seconds
Compute duration  = 0.23 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

           x    0.5487    0.1811    0.0298    33.0557        NaN    1.1481     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.2127    0.4000    0.5465    0.7098    0.7936</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}(-1.0976616369363104,1.0,0.0), "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}(-1.0976616369363104,1.0,0.0):
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/nmUhn/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/compiler.jl:579 [inlined]
  [7] demo(__model__::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, __varinfo__::DynamicPPL.ThreadSafeVarInfo{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}}, ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Base.RefValue{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, __context__::DynamicPPL.DefaultContext)
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:592
  [8] _evaluate!!
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:973 [inlined]
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}}, ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, context::DynamicPPL.DefaultContext)
    @ DynamicPPL ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:962
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:892 [inlined]
 [11] logdensity
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/logdensityfunction.jl:140 [inlined]
 [12] Fix1
    @ ./operators.jl:1118 [inlined]
 [13] vector_mode_dual_eval!(f::Base.Fix1{typeof(LogDensityProblems.logdensity), LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}}, cfg::ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}, x::Vector{Float64})
    @ ForwardDiff ~/.julia/packages/ForwardDiff/PcZ48/src/apiutils.jl:24
 [14] vector_mode_gradient!(result::DiffResults.MutableDiffResult{1, Float64, Tuple{Vector{Float64}}}, f::Base.Fix1{typeof(LogDensityProblems.logdensity), LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}}, x::Vector{Float64}, cfg::ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}})
    @ ForwardDiff ~/.julia/packages/ForwardDiff/PcZ48/src/gradient.jl:96
 [15] gradient!
    @ ~/.julia/packages/ForwardDiff/PcZ48/src/gradient.jl:37 [inlined]
 [16] gradient!
    @ ~/.julia/packages/ForwardDiff/PcZ48/src/gradient.jl:35 [inlined]
 [17] logdensity_and_gradient
    @ ~/.julia/packages/LogDensityProblemsAD/rBlLq/ext/LogDensityProblemsADForwardDiffExt.jl:118 [inlined]
 [18] leapfrog_step(model::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, x::Vector{Float64}, p::Vector{Float64}, ϵ::Int64, M::UniformScaling{Bool})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:369
 [19] step(rng::TaskLocalRNG, model_wrapper::AbstractMCMC.LogDensityModel{LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}}, sampler::MALA{Int64, UniformScaling{Bool}}, state::MALAState{Vector{Float64}}; kwargs::@Kwargs{})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:334
 [20] step
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:316 [inlined]
 [21] #step#107
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:155 [inlined]
 [22] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, state::Turing.Inference.TuringState{MALAState{Vector{Float64}}, LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:144
 [23] macro expansion
    @ ~/.julia/packages/AbstractMCMC/YrmkI/src/sample.jl:176 [inlined]
 [24] macro expansion
    @ ~/.julia/packages/AbstractMCMC/YrmkI/src/logging.jl:16 [inlined]
 [25] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/YrmkI/src/sample.jl:120
 [26] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/MjWTB/src/sampler.jl:93
 [27] sample
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/sampler.jl:83 [inlined]
 [28] #sample#4
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:276 [inlined]
 [29] sample
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:267 [inlined]
 [30] #sample#3
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:264 [inlined]
 [31] top-level scope
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:594</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.53 seconds
Compute duration  = 0.53 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8422    0.5740    0.0324   240.7532    98.7761    1.0001     ⋯
           x    0.0413    0.8659    0.0313   799.5678   817.3306    1.0001     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1681    0.3781    0.7271    1.1495    2.1986
           x   -1.7194   -0.3827   -0.0065    0.4612    1.9903</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.81 seconds
Compute duration  = 2.81 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8649    0.5388    0.0219   497.7722   322.7667    1.0016     ⋯
           x   -0.0016    0.9614    0.0422   586.1740   503.2066    1.0039     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1565    0.4204    0.7633    1.2075    2.0927
           x   -2.1594   -0.4515    0.0120    0.4527    2.1665</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>