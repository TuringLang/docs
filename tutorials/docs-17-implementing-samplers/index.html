<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../tutorials/docs-07-for-developers-variational-inference/index.html" rel="prev">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/docs-00-getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/00-introduction/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.34" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.34</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.34">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Documentation</li><li class="breadcrumb-item"><a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html">Developers: Inference</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Documentation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Using Turing - Modelling Syntax and Interface</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-00-getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-14-using-turing-quick-start/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quick Start</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-12-using-turing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-09-using-turing-advanced/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced Usage</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-10-using-turing-autodiff/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-13-using-turing-performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-11-using-turing-dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-15-using-turing-sampler-viz/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-16-using-turing-external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Using Turing - Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/00-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Turing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/01-gaussian-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/02-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/03-bayesian-neural-network/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/04-hidden-markov-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/05-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/06-infinite-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/07-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/08-multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/09-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/10-bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/11-probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/13-seasonal-time-series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/15-gaussian-processes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Gaussian Processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/12-gplvm/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Developers: Contributing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-01-contributing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to Contribute</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Developers: PPL</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-05-for-developers-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/14-minituring/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/16-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-06-for-developers-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers: Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Documentation</li><li class="breadcrumb-item"><a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html">Developers: Inference</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-20.89103476081242</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-20.89103476081242</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([0.0, 0.0, 0.0]), MALAState{Vector{Float64}}([0.0, 0.0, 0.0]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -1.5634   -5.43012  -3.92388  -4.51175  …  -3.25695   -4.08376   -5.57737
 -1.03963  -1.20417   1.34992  -1.52746     -0.217958   0.705936   2.1639
  2.29461   3.67251   3.41699   5.70312      6.50885    6.99602    5.51492</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -5.00654    0.984681
  0.0107405  1.00095
  5.0016     0.999725</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip700">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip700)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip701">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip700)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip702">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1724.79 2640.76,1724.79 "></polyline>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1471.68 2640.76,1471.68 "></polyline>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1218.57 2640.76,1218.57 "></polyline>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,965.46 2640.76,965.46 "></polyline>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,712.35 2640.76,712.35 "></polyline>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,459.239 2640.76,459.239 "></polyline>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,206.128 2640.76,206.128 "></polyline>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip700)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1724.79 215.714,1724.79 "></polyline>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1471.68 215.714,1471.68 "></polyline>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1218.57 215.714,1218.57 "></polyline>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,965.46 215.714,965.46 "></polyline>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,712.35 215.714,712.35 "></polyline>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,459.239 215.714,459.239 "></polyline>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,206.128 215.714,206.128 "></polyline>
<path clip-path="url(#clip700)" d="M50.5475 1725.24 L80.2233 1725.24 L80.2233 1729.18 L50.5475 1729.18 L50.5475 1725.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M89.1352 1707.51 L111.357 1707.51 L111.357 1709.5 L98.8111 1742.07 L93.9269 1742.07 L105.732 1711.45 L89.1352 1711.45 L89.1352 1707.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M120.478 1736.19 L125.362 1736.19 L125.362 1742.07 L120.478 1742.07 L120.478 1736.19 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M135.593 1707.51 L153.95 1707.51 L153.95 1711.45 L139.876 1711.45 L139.876 1719.92 Q140.894 1719.57 141.913 1719.41 Q142.931 1719.23 143.95 1719.23 Q149.737 1719.23 153.116 1722.4 Q156.496 1725.57 156.496 1730.99 Q156.496 1736.56 153.024 1739.67 Q149.552 1742.74 143.232 1742.74 Q141.056 1742.74 138.788 1742.37 Q136.542 1742 134.135 1741.26 L134.135 1736.56 Q136.218 1737.7 138.441 1738.25 Q140.663 1738.81 143.14 1738.81 Q147.144 1738.81 149.482 1736.7 Q151.82 1734.6 151.82 1730.99 Q151.82 1727.37 149.482 1725.27 Q147.144 1723.16 143.14 1723.16 Q141.265 1723.16 139.39 1723.58 Q137.538 1723.99 135.593 1724.87 L135.593 1707.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M49.5521 1472.13 L79.2279 1472.13 L79.2279 1476.07 L49.5521 1476.07 L49.5521 1472.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M89.3667 1454.4 L107.723 1454.4 L107.723 1458.34 L93.6491 1458.34 L93.6491 1466.81 Q94.6676 1466.46 95.6861 1466.3 Q96.7047 1466.12 97.7232 1466.12 Q103.51 1466.12 106.89 1469.29 Q110.269 1472.46 110.269 1477.87 Q110.269 1483.45 106.797 1486.55 Q103.325 1489.63 97.0056 1489.63 Q94.8297 1489.63 92.5612 1489.26 Q90.3158 1488.89 87.9084 1488.15 L87.9084 1483.45 Q89.9917 1484.59 92.2139 1485.14 Q94.4361 1485.7 96.913 1485.7 Q100.918 1485.7 103.256 1483.59 Q105.593 1481.49 105.593 1477.87 Q105.593 1474.26 103.256 1472.16 Q100.918 1470.05 96.913 1470.05 Q95.038 1470.05 93.163 1470.47 Q91.3112 1470.88 89.3667 1471.76 L89.3667 1454.4 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M119.482 1483.08 L124.367 1483.08 L124.367 1488.96 L119.482 1488.96 L119.482 1483.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M144.552 1457.48 Q140.941 1457.48 139.112 1461.05 Q137.306 1464.59 137.306 1471.72 Q137.306 1478.82 139.112 1482.39 Q140.941 1485.93 144.552 1485.93 Q148.186 1485.93 149.991 1482.39 Q151.82 1478.82 151.82 1471.72 Q151.82 1464.59 149.991 1461.05 Q148.186 1457.48 144.552 1457.48 M144.552 1453.78 Q150.362 1453.78 153.417 1458.38 Q156.496 1462.97 156.496 1471.72 Q156.496 1480.44 153.417 1485.05 Q150.362 1489.63 144.552 1489.63 Q138.741 1489.63 135.663 1485.05 Q132.607 1480.44 132.607 1471.72 Q132.607 1462.97 135.663 1458.38 Q138.741 1453.78 144.552 1453.78 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M50.5475 1219.02 L80.2233 1219.02 L80.2233 1222.96 L50.5475 1222.96 L50.5475 1219.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M94.3436 1231.92 L110.663 1231.92 L110.663 1235.85 L88.7186 1235.85 L88.7186 1231.92 Q91.3806 1229.16 95.9639 1224.53 Q100.57 1219.88 101.751 1218.54 Q103.996 1216.01 104.876 1214.28 Q105.779 1212.52 105.779 1210.83 Q105.779 1208.07 103.834 1206.34 Q101.913 1204.6 98.8111 1204.6 Q96.6121 1204.6 94.1584 1205.37 Q91.7278 1206.13 88.9501 1207.68 L88.9501 1202.96 Q91.7741 1201.82 94.2278 1201.25 Q96.6815 1200.67 98.7185 1200.67 Q104.089 1200.67 107.283 1203.35 Q110.478 1206.04 110.478 1210.53 Q110.478 1212.66 109.668 1214.58 Q108.881 1216.48 106.774 1219.07 Q106.195 1219.74 103.094 1222.96 Q99.9917 1226.15 94.3436 1231.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M120.478 1229.97 L125.362 1229.97 L125.362 1235.85 L120.478 1235.85 L120.478 1229.97 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M135.593 1201.29 L153.95 1201.29 L153.95 1205.23 L139.876 1205.23 L139.876 1213.7 Q140.894 1213.35 141.913 1213.19 Q142.931 1213 143.95 1213 Q149.737 1213 153.116 1216.18 Q156.496 1219.35 156.496 1224.76 Q156.496 1230.34 153.024 1233.44 Q149.552 1236.52 143.232 1236.52 Q141.056 1236.52 138.788 1236.15 Q136.542 1235.78 134.135 1235.04 L134.135 1230.34 Q136.218 1231.48 138.441 1232.03 Q140.663 1232.59 143.14 1232.59 Q147.144 1232.59 149.482 1230.48 Q151.82 1228.37 151.82 1224.76 Q151.82 1221.15 149.482 1219.05 Q147.144 1216.94 143.14 1216.94 Q141.265 1216.94 139.39 1217.36 Q137.538 1217.77 135.593 1218.65 L135.593 1201.29 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M99.3204 951.259 Q95.7093 951.259 93.8806 954.824 Q92.075 958.366 92.075 965.495 Q92.075 972.602 93.8806 976.166 Q95.7093 979.708 99.3204 979.708 Q102.955 979.708 104.76 976.166 Q106.589 972.602 106.589 965.495 Q106.589 958.366 104.76 954.824 Q102.955 951.259 99.3204 951.259 M99.3204 947.555 Q105.131 947.555 108.186 952.162 Q111.265 956.745 111.265 965.495 Q111.265 974.222 108.186 978.828 Q105.131 983.412 99.3204 983.412 Q93.5102 983.412 90.4315 978.828 Q87.376 974.222 87.376 965.495 Q87.376 956.745 90.4315 952.162 Q93.5102 947.555 99.3204 947.555 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M119.482 976.861 L124.367 976.861 L124.367 982.74 L119.482 982.74 L119.482 976.861 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M144.552 951.259 Q140.941 951.259 139.112 954.824 Q137.306 958.366 137.306 965.495 Q137.306 972.602 139.112 976.166 Q140.941 979.708 144.552 979.708 Q148.186 979.708 149.991 976.166 Q151.82 972.602 151.82 965.495 Q151.82 958.366 149.991 954.824 Q148.186 951.259 144.552 951.259 M144.552 947.555 Q150.362 947.555 153.417 952.162 Q156.496 956.745 156.496 965.495 Q156.496 974.222 153.417 978.828 Q150.362 983.412 144.552 983.412 Q138.741 983.412 135.663 978.828 Q132.607 974.222 132.607 965.495 Q132.607 956.745 135.663 952.162 Q138.741 947.555 144.552 947.555 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M94.3436 725.694 L110.663 725.694 L110.663 729.63 L88.7186 729.63 L88.7186 725.694 Q91.3806 722.94 95.9639 718.31 Q100.57 713.657 101.751 712.315 Q103.996 709.792 104.876 708.056 Q105.779 706.296 105.779 704.607 Q105.779 701.852 103.834 700.116 Q101.913 698.38 98.8111 698.38 Q96.6121 698.38 94.1584 699.144 Q91.7278 699.907 88.9501 701.458 L88.9501 696.736 Q91.7741 695.602 94.2278 695.023 Q96.6815 694.445 98.7185 694.445 Q104.089 694.445 107.283 697.13 Q110.478 699.815 110.478 704.306 Q110.478 706.435 109.668 708.357 Q108.881 710.255 106.774 712.847 Q106.195 713.519 103.094 716.736 Q99.9917 719.931 94.3436 725.694 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M120.478 723.75 L125.362 723.75 L125.362 729.63 L120.478 729.63 L120.478 723.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M135.593 695.07 L153.95 695.07 L153.95 699.005 L139.876 699.005 L139.876 707.477 Q140.894 707.13 141.913 706.968 Q142.931 706.782 143.95 706.782 Q149.737 706.782 153.116 709.954 Q156.496 713.125 156.496 718.542 Q156.496 724.12 153.024 727.222 Q149.552 730.301 143.232 730.301 Q141.056 730.301 138.788 729.93 Q136.542 729.56 134.135 728.819 L134.135 724.12 Q136.218 725.255 138.441 725.81 Q140.663 726.366 143.14 726.366 Q147.144 726.366 149.482 724.259 Q151.82 722.153 151.82 718.542 Q151.82 714.931 149.482 712.824 Q147.144 710.718 143.14 710.718 Q141.265 710.718 139.39 711.134 Q137.538 711.551 135.593 712.431 L135.593 695.07 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M89.3667 441.959 L107.723 441.959 L107.723 445.894 L93.6491 445.894 L93.6491 454.366 Q94.6676 454.019 95.6861 453.857 Q96.7047 453.672 97.7232 453.672 Q103.51 453.672 106.89 456.843 Q110.269 460.014 110.269 465.431 Q110.269 471.009 106.797 474.111 Q103.325 477.19 97.0056 477.19 Q94.8297 477.19 92.5612 476.82 Q90.3158 476.449 87.9084 475.708 L87.9084 471.009 Q89.9917 472.144 92.2139 472.699 Q94.4361 473.255 96.913 473.255 Q100.918 473.255 103.256 471.148 Q105.593 469.042 105.593 465.431 Q105.593 461.82 103.256 459.713 Q100.918 457.607 96.913 457.607 Q95.038 457.607 93.163 458.023 Q91.3112 458.44 89.3667 459.32 L89.3667 441.959 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M119.482 470.639 L124.367 470.639 L124.367 476.519 L119.482 476.519 L119.482 470.639 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M144.552 445.037 Q140.941 445.037 139.112 448.602 Q137.306 452.144 137.306 459.273 Q137.306 466.38 139.112 469.945 Q140.941 473.486 144.552 473.486 Q148.186 473.486 149.991 469.945 Q151.82 466.38 151.82 459.273 Q151.82 452.144 149.991 448.602 Q148.186 445.037 144.552 445.037 M144.552 441.334 Q150.362 441.334 153.417 445.94 Q156.496 450.523 156.496 459.273 Q156.496 468 153.417 472.607 Q150.362 477.19 144.552 477.19 Q138.741 477.19 135.663 472.607 Q132.607 468 132.607 459.273 Q132.607 450.523 135.663 445.94 Q138.741 441.334 144.552 441.334 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M89.1352 188.848 L111.357 188.848 L111.357 190.838 L98.8111 223.408 L93.9269 223.408 L105.732 192.783 L89.1352 192.783 L89.1352 188.848 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M120.478 217.528 L125.362 217.528 L125.362 223.408 L120.478 223.408 L120.478 217.528 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip700)" d="M135.593 188.848 L153.95 188.848 L153.95 192.783 L139.876 192.783 L139.876 201.255 Q140.894 200.908 141.913 200.746 Q142.931 200.561 143.95 200.561 Q149.737 200.561 153.116 203.732 Q156.496 206.903 156.496 212.32 Q156.496 217.898 153.024 221 Q149.552 224.079 143.232 224.079 Q141.056 224.079 138.788 223.709 Q136.542 223.338 134.135 222.597 L134.135 217.898 Q136.218 219.033 138.441 219.588 Q140.663 220.144 143.14 220.144 Q147.144 220.144 149.482 218.037 Q151.82 215.931 151.82 212.32 Q151.82 208.709 149.482 206.602 Q147.144 204.496 143.14 204.496 Q141.265 204.496 139.39 204.912 Q137.538 205.329 135.593 206.209 L135.593 188.848 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip702)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1123.75 268.292,1364.44 270.6,1404.21 272.908,1502.82 275.216,1489.31 277.524,1436.14 279.832,1458.56 282.139,1533.37 284.447,1448.97 286.755,1501.77 289.063,1376.63 291.371,1588.45 293.679,1319.26 295.987,1559.84 298.295,1463.47 300.603,1597.06 302.911,1618.06 305.219,1576.25 307.527,1522.32 309.834,1368.41 312.142,1220.9 314.45,1537.65 316.758,1523.22 319.066,1437.88 321.374,1432.67 323.682,1619.89 325.99,1713.86 328.298,1460.18 330.606,1395.94 332.914,1417.09 335.221,1504.87 337.529,1593.84 339.837,1416.06 342.145,1547.77 344.453,1263.14 346.761,1338.85 349.069,1494.77 351.377,1439.14 353.685,1690.02 355.993,1590.32 358.301,1400.26 360.608,1402.8 362.916,1532.89 365.224,1588.14 367.532,1422.32 369.84,1437.51 372.148,1466.08 374.456,1496.7 376.764,1441.76 379.072,1520.65 381.38,1479.02 383.688,1337.11 385.996,1542.91 388.303,1586.9 390.611,1521.95 392.919,1355.28 395.227,1535.12 397.535,1652.08 399.843,1425.54 402.151,1397.44 404.459,1550.28 406.767,1581.97 409.075,1564.64 411.383,1592.79 413.69,1492.79 415.998,1549.02 418.306,1397.52 420.614,1329.71 422.922,1492.86 425.23,1427.13 427.538,1535.76 429.846,1410.17 432.154,1405.87 434.462,1563.84 436.77,1617.25 439.077,1478.08 441.385,1408.99 443.693,1488.62 446.001,1502.66 448.309,1462.59 450.617,1296.89 452.925,1581.88 455.233,1516.1 457.541,1527.57 459.849,1592.4 462.157,1352.78 464.465,1449.69 466.772,1527.68 469.08,1537.53 471.388,1432.45 473.696,1388.19 476.004,1309.37 478.312,1532.4 480.62,1445.6 482.928,1587.22 485.236,1731.73 487.544,1445.2 489.852,1389.94 492.159,1468.55 494.467,1309.48 496.775,1423.99 499.083,1641.49 501.391,1395.65 503.699,1526.73 506.007,1622.59 508.315,1436.09 510.623,1313.57 512.931,1441.84 515.239,1606.01 517.546,1430.45 519.854,1496.87 522.162,1566.61 524.47,1606.27 526.778,1571.3 529.086,1303.11 531.394,1440.06 533.702,1356.35 536.01,1296.93 538.318,1680.39 540.626,1493.79 542.933,1544.54 545.241,1414.78 547.549,1349.03 549.857,1571.16 552.165,1485.97 554.473,1580.77 556.781,1590.84 559.089,1474.84 561.397,1502.73 563.705,1491.7 566.013,1446.61 568.321,1394.53 570.628,1410.73 572.936,1419.4 575.244,1466.22 577.552,1535.22 579.86,1593.52 582.168,1513.2 584.476,1509.29 586.784,1479 589.092,1583.41 591.4,1394.97 593.708,1529.93 596.015,1558.72 598.323,1507.35 600.631,1486.65 602.939,1316.11 605.247,1413.15 607.555,1468.52 609.863,1511.01 612.171,1510.98 614.479,1396.43 616.787,1495.55 619.095,1528.98 621.402,1344.89 623.71,1260.75 626.018,1432.23 628.326,1437.36 630.634,1691.42 632.942,1363.16 635.25,1321.76 637.558,1514.28 639.866,1478.15 642.174,1415.33 644.482,1529.98 646.79,1530.62 649.097,1360.46 651.405,1439.39 653.713,1601 656.021,1387.22 658.329,1394.93 660.637,1535.63 662.945,1416.76 665.253,1306.69 667.561,1375.19 669.869,1304.48 672.177,1723.82 674.484,1394.75 676.792,1450.97 679.1,1459.35 681.408,1506.45 683.716,1251.82 686.024,1565.5 688.332,1444.89 690.64,1526.02 692.948,1428.35 695.256,1574.7 697.564,1637.25 699.871,1537.58 702.179,1568.76 704.487,1672.8 706.795,1548.07 709.103,1533.37 711.411,1448.75 713.719,1461.08 716.027,1531.38 718.335,1501.31 720.643,1403.29 722.951,1252.9 725.259,1323.85 727.566,1557.96 729.874,1371.72 732.182,1481.27 734.49,1467.04 736.798,1466.98 739.106,1601.51 741.414,1376.17 743.722,1560.9 746.03,1715.12 748.338,1371.28 750.646,1428.13 752.953,1460.92 755.261,1344.57 757.569,1474.17 759.877,1319.49 762.185,1527.84 764.493,1393.15 766.801,1429.06 769.109,1461.82 771.417,1500.55 773.725,1332.4 776.033,1400.29 778.34,1364.88 780.648,1290.75 782.956,1373.25 785.264,1401.34 787.572,1416.4 789.88,1620.33 792.188,1503.87 794.496,1558.04 796.804,1522.74 799.112,1391.1 801.42,1628.53 803.728,1422.13 806.035,1432.91 808.343,1227.53 810.651,1469.47 812.959,1646.14 815.267,1454.12 817.575,1480.32 819.883,1428.37 822.191,1378.35 824.499,1574.61 826.807,1517.26 829.115,1310.29 831.422,1600.18 833.73,1241.52 836.038,1494.43 838.346,1661.89 840.654,1416.32 842.962,1517.95 845.27,1463.49 847.578,1407.76 849.886,1457.84 852.194,1487.07 854.502,1541.74 856.809,1415.2 859.117,1572.18 861.425,1433.45 863.733,1478.07 866.041,1304.88 868.349,1522.95 870.657,1400.9 872.965,1517.34 875.273,1553.71 877.581,1509.9 879.889,1503.91 882.197,1586.65 884.504,1526.01 886.812,1387.17 889.12,1588.05 891.428,1424.6 893.736,1495.38 896.044,1592.81 898.352,1500.59 900.66,1687.21 902.968,1499.28 905.276,1399.73 907.584,1410.51 909.891,1480.68 912.199,1490.19 914.507,1410.6 916.815,1349.18 919.123,1502.36 921.431,1318 923.739,1290.91 926.047,1503.75 928.355,1275.19 930.663,1408.76 932.971,1523.48 935.278,1496.27 937.586,1345.52 939.894,1716.57 942.202,1621.75 944.51,1462.62 946.818,1503.3 949.126,1599.83 951.434,1432.49 953.742,1559.88 956.05,1671.11 958.358,1436.46 960.665,1509.1 962.973,1520.78 965.281,1407.13 967.589,1521.1 969.897,1412.46 972.205,1475.34 974.513,1372.49 976.821,1636.39 979.129,1630.17 981.437,1668.09 983.745,1349.29 986.053,1499.31 988.36,1482.98 990.668,1449.18 992.976,1344.66 995.284,1454.69 997.592,1427.76 999.9,1339.91 1002.21,1444.56 1004.52,1575.47 1006.82,1462.14 1009.13,1513.35 1011.44,1475.4 1013.75,1485.18 1016.06,1643.38 1018.36,1534.48 1020.67,1622.75 1022.98,1554.07 1025.29,1441.64 1027.59,1360.91 1029.9,1638.22 1032.21,1663.08 1034.52,1417.24 1036.83,1291.8 1039.13,1515.77 1041.44,1277.1 1043.75,1561.89 1046.06,1593.25 1048.37,1441.36 1050.67,1332.59 1052.98,1436.4 1055.29,1596.93 1057.6,1599.78 1059.91,1368.55 1062.21,1527.95 1064.52,1539.71 1066.83,1544.46 1069.14,1514.06 1071.45,1446.5 1073.75,1513.97 1076.06,1605.92 1078.37,1456.3 1080.68,1401.9 1082.98,1525.64 1085.29,1649.19 1087.6,1438.15 1089.91,1426.31 1092.22,1478.66 1094.52,1671.4 1096.83,1547.22 1099.14,1483.43 1101.45,1438.03 1103.76,1336.13 1106.06,1421.77 1108.37,1502.55 1110.68,1537.45 1112.99,1416.04 1115.3,1636.11 1117.6,1496.97 1119.91,1471.92 1122.22,1290.13 1124.53,1379.13 1126.84,1626.93 1129.14,1614 1131.45,1614.69 1133.76,1214.82 1136.07,1610.47 1138.37,1510.99 1140.68,1469.18 1142.99,1338.21 1145.3,1475.02 1147.61,1479.82 1149.91,1510.61 1152.22,1548.71 1154.53,1455.03 1156.84,1424.11 1159.15,1410.66 1161.45,1265.78 1163.76,1542.23 1166.07,1374.43 1168.38,1581.12 1170.69,1279.5 1172.99,1349.65 1175.3,1577.06 1177.61,1616.58 1179.92,1296.63 1182.23,1383.78 1184.53,1273.6 1186.84,1472.07 1189.15,1525.24 1191.46,1583.72 1193.76,1445.87 1196.07,1523.28 1198.38,1427.74 1200.69,1512.25 1203,1656.14 1205.3,1371 1207.61,1416.55 1209.92,1631.76 1212.23,1233.03 1214.54,1552.1 1216.84,1453.51 1219.15,1423.85 1221.46,1435.07 1223.77,1425.77 1226.08,1487.56 1228.38,1530.22 1230.69,1414.54 1233,1524.49 1235.31,1363.63 1237.61,1517.49 1239.92,1444.58 1242.23,1474.77 1244.54,1284.33 1246.85,1588.27 1249.15,1522.88 1251.46,1573.86 1253.77,1541.63 1256.08,1397.38 1258.39,1430.84 1260.69,1600.47 1263,1402.51 1265.31,1403.71 1267.62,1488.42 1269.93,1538.75 1272.23,1323.82 1274.54,1475.87 1276.85,1635.85 1279.16,1623.28 1281.47,1372.73 1283.77,1490.15 1286.08,1520.65 1288.39,1374.47 1290.7,1521.22 1293,1357.36 1295.31,1314.75 1297.62,1462.08 1299.93,1364.82 1302.24,1565.97 1304.54,1591.62 1306.85,1570.1 1309.16,1384.24 1311.47,1533.15 1313.78,1509.88 1316.08,1387.46 1318.39,1572.89 1320.7,1503.82 1323.01,1434.31 1325.32,1478.55 1327.62,1368.47 1329.93,1401.38 1332.24,1471.36 1334.55,1375.19 1336.86,1366.82 1339.16,1582.91 1341.47,1466.26 1343.78,1546.15 1346.09,1591.81 1348.39,1406.44 1350.7,1381.05 1353.01,1531.78 1355.32,1304.55 1357.63,1311.82 1359.93,1455.03 1362.24,1341 1364.55,1348.39 1366.86,1480.08 1369.17,1534 1371.47,1328.03 1373.78,1374.68 1376.09,1469.6 1378.4,1488.31 1380.71,1448.1 1383.01,1387.64 1385.32,1411.12 1387.63,1498.8 1389.94,1683.13 1392.24,1457.78 1394.55,1386.85 1396.86,1471.65 1399.17,1391.76 1401.48,1403.81 1403.78,1414.26 1406.09,1422.25 1408.4,1285.51 1410.71,1551.1 1413.02,1692.71 1415.32,1430.5 1417.63,1456.34 1419.94,1384.39 1422.25,1625.9 1424.56,1511.14 1426.86,1453.7 1429.17,1430.96 1431.48,1569.18 1433.79,1423.93 1436.1,1559.56 1438.4,1488.11 1440.71,1492.36 1443.02,1549.24 1445.33,1484.23 1447.63,1589.09 1449.94,1587.1 1452.25,1533.17 1454.56,1409.33 1456.87,1388.03 1459.17,1504.11 1461.48,1603.75 1463.79,1376.48 1466.1,1411.42 1468.41,1467.53 1470.71,1478.18 1473.02,1468.18 1475.33,1590.73 1477.64,1352 1479.95,1639.36 1482.25,1475.09 1484.56,1415.28 1486.87,1496.78 1489.18,1511.64 1491.49,1502.53 1493.79,1348.7 1496.1,1323.77 1498.41,1730.22 1500.72,1601.09 1503.02,1362.36 1505.33,1554.88 1507.64,1419.37 1509.95,1400.6 1512.26,1376.11 1514.56,1559.76 1516.87,1478.8 1519.18,1364.03 1521.49,1637.13 1523.8,1604.26 1526.1,1426.39 1528.41,1287.38 1530.72,1519.46 1533.03,1438.54 1535.34,1452.13 1537.64,1308.81 1539.95,1596.71 1542.26,1525.55 1544.57,1694.32 1546.88,1629.42 1549.18,1400.44 1551.49,1309.93 1553.8,1467.72 1556.11,1356.04 1558.41,1589.42 1560.72,1404.05 1563.03,1524.9 1565.34,1433.12 1567.65,1589.33 1569.95,1539.2 1572.26,1475.71 1574.57,1484.62 1576.88,1668.55 1579.19,1398.02 1581.49,1352.06 1583.8,1395.06 1586.11,1648.32 1588.42,1566.16 1590.73,1447.95 1593.03,1512.81 1595.34,1751.15 1597.65,1435.77 1599.96,1567.52 1602.26,1578.23 1604.57,1433.07 1606.88,1356.11 1609.19,1523.07 1611.5,1541.52 1613.8,1440.43 1616.11,1511.52 1618.42,1191.72 1620.73,1411.65 1623.04,1557.98 1625.34,1451.5 1627.65,1377.45 1629.96,1519.98 1632.27,1555.91 1634.58,1536.63 1636.88,1586.84 1639.19,1528.44 1641.5,1469.04 1643.81,1431.45 1646.12,1424.08 1648.42,1442.34 1650.73,1438.9 1653.04,1286.48 1655.35,1419.68 1657.65,1366.76 1659.96,1550.79 1662.27,1377.32 1664.58,1435.83 1666.89,1488.86 1669.19,1639.15 1671.5,1308.97 1673.81,1514.59 1676.12,1558.95 1678.43,1467.53 1680.73,1599.04 1683.04,1428.24 1685.35,1587.23 1687.66,1430.51 1689.97,1586.01 1692.27,1440.15 1694.58,1672.41 1696.89,1292.58 1699.2,1505.66 1701.51,1527.56 1703.81,1315.12 1706.12,1461.09 1708.43,1392.09 1710.74,1480.83 1713.04,1450.99 1715.35,1607.94 1717.66,1531.34 1719.97,1468.15 1722.28,1464.08 1724.58,1580.9 1726.89,1528.58 1729.2,1454.15 1731.51,1498.73 1733.82,1426.06 1736.12,1556.37 1738.43,1552.79 1740.74,1432.2 1743.05,1471.57 1745.36,1420.22 1747.66,1360.16 1749.97,1501.53 1752.28,1541.17 1754.59,1426.27 1756.9,1659.04 1759.2,1505.76 1761.51,1528.55 1763.82,1401.27 1766.13,1489.95 1768.43,1562.31 1770.74,1419.31 1773.05,1345.85 1775.36,1606.44 1777.67,1476.62 1779.97,1519.97 1782.28,1582.94 1784.59,1613.87 1786.9,1552.72 1789.21,1370.76 1791.51,1343.47 1793.82,1348 1796.13,1594.44 1798.44,1562.45 1800.75,1574.81 1803.05,1234.47 1805.36,1320.9 1807.67,1498.68 1809.98,1317.55 1812.28,1215.11 1814.59,1618.59 1816.9,1374.73 1819.21,1539.38 1821.52,1485.36 1823.82,1335.49 1826.13,1393.49 1828.44,1338.72 1830.75,1525.9 1833.06,1325.46 1835.36,1459.95 1837.67,1348.77 1839.98,1328.66 1842.29,1552.17 1844.6,1499.06 1846.9,1471.3 1849.21,1487.5 1851.52,1426.37 1853.83,1475.74 1856.14,1389.37 1858.44,1303.18 1860.75,1427.75 1863.06,1435.55 1865.37,1532.08 1867.67,1408.24 1869.98,1565.59 1872.29,1597.66 1874.6,1500.37 1876.91,1508.79 1879.21,1467.88 1881.52,1550.8 1883.83,1692.05 1886.14,1373.16 1888.45,1395.24 1890.75,1283.85 1893.06,1621.86 1895.37,1449.29 1897.68,1434.03 1899.99,1573.74 1902.29,1431.86 1904.6,1420.33 1906.91,1364.58 1909.22,1614.11 1911.53,1418.05 1913.83,1422.67 1916.14,1430.56 1918.45,1540.36 1920.76,1248.97 1923.06,1415.49 1925.37,1327.1 1927.68,1539.39 1929.99,1553.35 1932.3,1506.67 1934.6,1415.89 1936.91,1456.8 1939.22,1532.66 1941.53,1505.26 1943.84,1710.94 1946.14,1661.72 1948.45,1374.43 1950.76,1481.24 1953.07,1476.96 1955.38,1296.86 1957.68,1435.72 1959.99,1503.88 1962.3,1556.43 1964.61,1427.7 1966.91,1587.13 1969.22,1472.43 1971.53,1552.39 1973.84,1555.93 1976.15,1311.2 1978.45,1542.28 1980.76,1524.82 1983.07,1389.38 1985.38,1533.17 1987.69,1437.52 1989.99,1531.29 1992.3,1656.52 1994.61,1319.03 1996.92,1411.02 1999.23,1567.71 2001.53,1612.86 2003.84,1572.82 2006.15,1505.87 2008.46,1432.34 2010.77,1678 2013.07,1331.68 2015.38,1481.88 2017.69,1328.68 2020,1350.95 2022.3,1302.71 2024.61,1487.82 2026.92,1516.91 2029.23,1503.19 2031.54,1561.36 2033.84,1312.42 2036.15,1626.18 2038.46,1350.77 2040.77,1497.32 2043.08,1474.42 2045.38,1620 2047.69,1696.22 2050,1270.31 2052.31,1223.57 2054.62,1487.38 2056.92,1536.83 2059.23,1551.04 2061.54,1313.23 2063.85,1338.23 2066.16,1514.75 2068.46,1469.14 2070.77,1522.5 2073.08,1496.27 2075.39,1343.49 2077.69,1554.49 2080,1584.53 2082.31,1587.48 2084.62,1700.35 2086.93,1466.87 2089.23,1406.38 2091.54,1516.87 2093.85,1553.19 2096.16,1616.88 2098.47,1543.01 2100.77,1505.46 2103.08,1625.08 2105.39,1237.72 2107.7,1504.68 2110.01,1624.88 2112.31,1551.82 2114.62,1378.27 2116.93,1327.49 2119.24,1406.85 2121.55,1546.38 2123.85,1609.86 2126.16,1527.32 2128.47,1649.5 2130.78,1541.96 2133.08,1465.43 2135.39,1532.21 2137.7,1480.72 2140.01,1448.72 2142.32,1403.57 2144.62,1372.62 2146.93,1455.35 2149.24,1347.88 2151.55,1369.96 2153.86,1588.18 2156.16,1447.11 2158.47,1406.04 2160.78,1588.17 2163.09,1631.72 2165.4,1552.69 2167.7,1478.6 2170.01,1392.15 2172.32,1486.7 2174.63,1593.8 2176.93,1455.65 2179.24,1576.35 2181.55,1518.83 2183.86,1467.54 2186.17,1393.48 2188.47,1390.23 2190.78,1291.71 2193.09,1534.42 2195.4,1376.8 2197.71,1338.05 2200.01,1535.75 2202.32,1459.77 2204.63,1746.54 2206.94,1427.33 2209.25,1388.68 2211.55,1334.48 2213.86,1493.65 2216.17,1366.07 2218.48,1474.6 2220.79,1514.46 2223.09,1380.68 2225.4,1695.75 2227.71,1403.66 2230.02,1561.78 2232.32,1455.68 2234.63,1478.47 2236.94,1360.38 2239.25,1378.77 2241.56,1712.04 2243.86,1353.77 2246.17,1525.25 2248.48,1502.95 2250.79,1477.61 2253.1,1654.4 2255.4,1337.45 2257.71,1531.6 2260.02,1558.3 2262.33,1645.99 2264.64,1638.36 2266.94,1310.94 2269.25,1432.87 2271.56,1422.07 2273.87,1455.88 2276.18,1557.08 2278.48,1458.06 2280.79,1509.47 2283.1,1462.38 2285.41,1474.45 2287.71,1685.76 2290.02,1464.88 2292.33,1561.66 2294.64,1625.69 2296.95,1520 2299.25,1258.01 2301.56,1702.78 2303.87,1409.1 2306.18,1481.76 2308.49,1568.51 2310.79,1532.56 2313.1,1403.76 2315.41,1645.17 2317.72,1533.04 2320.03,1416.22 2322.33,1297.82 2324.64,1385.36 2326.95,1394.25 2329.26,1487.34 2331.56,1450.99 2333.87,1374.77 2336.18,1602.4 2338.49,1302.01 2340.8,1479.44 2343.1,1420.21 2345.41,1610.74 2347.72,1515.3 2350.03,1359.09 2352.34,1382.09 2354.64,1363.69 2356.95,1429.89 2359.26,1507.37 2361.57,1563.98 2363.88,1377.53 2366.18,1238.16 2368.49,1455.34 2370.8,1395.29 2373.11,1450.9 2375.42,1522.43 2377.72,1102.43 2380.03,1523.55 2382.34,1335.63 2384.65,1338.27 2386.95,1414.71 2389.26,1524.93 2391.57,1445.58 2393.88,1450.8 2396.19,1593.66 2398.49,1375.65 2400.8,1461.23 2403.11,1516.66 2405.42,1594.81 2407.73,1653.97 2410.03,1442.83 2412.34,1314.02 2414.65,1399.9 2416.96,1381.93 2419.27,1397.26 2421.57,1442.05 2423.88,1589.59 2426.19,1547.85 2428.5,1337.25 2430.81,1512.01 2433.11,1570.14 2435.42,1403.03 2437.73,1664.7 2440.04,1321.26 2442.34,1462.19 2444.65,1447.17 2446.96,1526.83 2449.27,1355.62 2451.58,1462.31 2453.88,1560.59 2456.19,1402.39 2458.5,1436.14 2460.81,1526.49 2463.12,1431.73 2465.42,1626.02 2467.73,1451.41 2470.04,1461.95 2472.35,1690.89 2474.66,1594.88 2476.96,1468.48 2479.27,1374 2481.58,1577.35 2483.89,1342.52 2486.2,1423.27 2488.5,1587.92 2490.81,1504.42 2493.12,1404.92 2495.43,1365.08 2497.73,1357.25 2500.04,1414.4 2502.35,1464.12 2504.66,1369.59 2506.97,1325.16 2509.27,1570.77 2511.58,1325.83 2513.89,1281.36 2516.2,1383.96 2518.51,1437.85 2520.81,1478.91 2523.12,1616.19 2525.43,1233.23 2527.74,1277.05 2530.05,1602.19 2532.35,1297.1 2534.66,1469.79 2536.97,1506.05 2539.28,1522.09 2541.58,1444.09 2543.89,1591.64 2546.2,1547.77 2548.51,1481.12 2550.82,1537.22 2553.12,1329.19 2555.43,1514.7 2557.74,1447.3 2560.05,1391.87 2562.36,1589.75 2564.66,1517.28 2566.97,1556.23 2569.28,1437.3 2571.59,1517.71 "></polyline>
<polyline clip-path="url(#clip702)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1070.72 268.292,983.637 270.6,902.023 272.908,832.393 275.216,1075.32 277.524,780.288 279.832,992.378 282.139,1093.11 284.447,958.295 286.755,1121.13 289.063,827.559 291.371,1080.98 293.679,930.461 295.987,868.212 298.295,1155.12 300.603,965.229 302.911,883.694 305.219,866.931 307.527,1118.7 309.834,904.566 312.142,1037.38 314.45,669.838 316.758,988.739 319.066,925.229 321.374,710.738 323.682,990.612 325.99,1052.4 328.298,959.646 330.606,834.637 332.914,1035.65 335.221,949.797 337.529,926.504 339.837,1006.1 342.145,706.905 344.453,1090.67 346.761,1074.9 349.069,899.727 351.377,1070.61 353.685,1008.19 355.993,1050.96 358.301,792.42 360.608,733.98 362.916,880.987 365.224,739.454 367.532,876.947 369.84,1001.94 372.148,1007.09 374.456,861.655 376.764,854.06 379.072,945.5 381.38,1002.44 383.688,936.454 385.996,952.574 388.303,978.081 390.611,831.951 392.919,1051.93 395.227,913.86 397.535,992.69 399.843,1012.23 402.151,893.465 404.459,939.98 406.767,960.816 409.075,870.906 411.383,1046.8 413.69,892.503 415.998,776.553 418.306,954.363 420.614,904.252 422.922,950.534 425.23,919.723 427.538,1016.32 429.846,1099.78 432.154,1017.06 434.462,1022.92 436.77,896.28 439.077,1225.93 441.385,810.229 443.693,946.885 446.001,905.251 448.309,967.899 450.617,868.092 452.925,926.892 455.233,991.617 457.541,1017.02 459.849,1164.58 462.157,846.957 464.465,1108.77 466.772,907.639 469.08,958.127 471.388,973.394 473.696,1071.02 476.004,1007.52 478.312,939.952 480.62,1071.98 482.928,972.649 485.236,1119.16 487.544,879.764 489.852,1005.89 492.159,971.07 494.467,955.707 496.775,1060.33 499.083,1169.83 501.391,1017.79 503.699,1023.19 506.007,961.861 508.315,883.656 510.623,874.739 512.931,900.932 515.239,649.279 517.546,1020.91 519.854,969.157 522.162,1112 524.47,1000.7 526.778,862.109 529.086,982.127 531.394,1030.38 533.702,771.412 536.01,1081.43 538.318,1023.34 540.626,1044.89 542.933,771.497 545.241,1154.22 547.549,959.626 549.857,972.305 552.165,993.627 554.473,1073.65 556.781,1039.42 559.089,821.271 561.397,1019.51 563.705,962.944 566.013,1006.72 568.321,1034.86 570.628,839.244 572.936,1114.16 575.244,1019.76 577.552,941.931 579.86,969.638 582.168,843.306 584.476,874.098 586.784,1000.75 589.092,896.983 591.4,1039.84 593.708,973.436 596.015,1101.13 598.323,1006.81 600.631,1040.17 602.939,862.23 605.247,900.782 607.555,1138.17 609.863,1105.1 612.171,882.785 614.479,985.124 616.787,811.463 619.095,976.611 621.402,862.848 623.71,912.758 626.018,1076.16 628.326,1015.43 630.634,787.877 632.942,802.073 635.25,844.479 637.558,949.763 639.866,888.88 642.174,1014.96 644.482,1150.29 646.79,912.892 649.097,1027.38 651.405,901.547 653.713,763.405 656.021,1072.93 658.329,878.233 660.637,1106.34 662.945,1004.45 665.253,962.489 667.561,1004.68 669.869,1115.69 672.177,768.034 674.484,1002.91 676.792,916.979 679.1,1064.87 681.408,906.249 683.716,1026.76 686.024,909.078 688.332,1004.17 690.64,849.354 692.948,1127.86 695.256,901.131 697.564,980.6 699.871,1010.53 702.179,755.281 704.487,1068.73 706.795,850.961 709.103,894.572 711.411,979.731 713.719,998.183 716.027,943.643 718.335,1044.24 720.643,1034.66 722.951,901.834 725.259,980.436 727.566,968.264 729.874,787.336 732.182,825.294 734.49,1103.81 736.798,1086.44 739.106,917.983 741.414,787.176 743.722,1168.29 746.03,1011.78 748.338,1106.96 750.646,1019.51 752.953,885.172 755.261,849.699 757.569,1094.56 759.877,972.541 762.185,1095.59 764.493,851.02 766.801,962.8 769.109,811.262 771.417,900.596 773.725,982.084 776.033,1084.99 778.34,1117.02 780.648,987.231 782.956,984.008 785.264,991.826 787.572,906.917 789.88,912.262 792.188,970.738 794.496,846.841 796.804,1044.93 799.112,869.311 801.42,1072.85 803.728,909.821 806.035,972.575 808.343,1059.64 810.651,897.09 812.959,1049.29 815.267,1001.99 817.575,963.007 819.883,1023.39 822.191,1143.94 824.499,1042.87 826.807,923.943 829.115,971.428 831.422,1018.91 833.73,990.747 836.038,815.056 838.346,758.809 840.654,918.605 842.962,859.26 845.27,679.84 847.578,1103.75 849.886,852.46 852.194,1079.48 854.502,974.595 856.809,932.639 859.117,879.48 861.425,838.318 863.733,975.317 866.041,1031.01 868.349,906.535 870.657,1035.12 872.965,1054.76 875.273,826.55 877.581,1003.2 879.889,887.811 882.197,936.325 884.504,1062.56 886.812,857.399 889.12,936.312 891.428,1085.25 893.736,859.91 896.044,912.192 898.352,1063.43 900.66,1029.84 902.968,1015.62 905.276,999.84 907.584,858.287 909.891,904.524 912.199,967.006 914.507,1279.67 916.815,1017.17 919.123,841.048 921.431,637.598 923.739,1018.09 926.047,945.3 928.355,1048.02 930.663,1227.83 932.971,836.484 935.278,1020.64 937.586,923.187 939.894,1129.22 942.202,705.326 944.51,1044.13 946.818,1098.36 949.126,999.093 951.434,1019.9 953.742,919.34 956.05,944.98 958.358,736.473 960.665,1036.56 962.973,973.781 965.281,758.382 967.589,1116.05 969.897,959.804 972.205,1090.78 974.513,923.419 976.821,1114.25 979.129,966.058 981.437,1016.2 983.745,708.248 986.053,961.11 988.36,990.954 990.668,920.047 992.976,812.906 995.284,921.916 997.592,1072.75 999.9,948.053 1002.21,927.737 1004.52,975.453 1006.82,1027.44 1009.13,894.023 1011.44,841.878 1013.75,902.119 1016.06,916.762 1018.36,1060.17 1020.67,1139.72 1022.98,1021.18 1025.29,914.422 1027.59,905.016 1029.9,870.562 1032.21,991.662 1034.52,866.65 1036.83,953.784 1039.13,944.545 1041.44,1096.29 1043.75,1235.73 1046.06,815.226 1048.37,904.008 1050.67,876.442 1052.98,1080.01 1055.29,975.452 1057.6,1113.21 1059.91,938.267 1062.21,1017.69 1064.52,1015.65 1066.83,923.983 1069.14,949.78 1071.45,952.355 1073.75,1085.52 1076.06,901.529 1078.37,871.785 1080.68,865.444 1082.98,910.824 1085.29,1009.73 1087.6,910.112 1089.91,1195.22 1092.22,1059.8 1094.52,965.494 1096.83,851.111 1099.14,899.226 1101.45,670.245 1103.76,1105.21 1106.06,875.068 1108.37,1155.95 1110.68,1004.97 1112.99,1065.63 1115.3,1014.03 1117.6,750.983 1119.91,926.561 1122.22,824.572 1124.53,921.658 1126.84,969.995 1129.14,1173.51 1131.45,1117.59 1133.76,940.007 1136.07,981.951 1138.37,963.503 1140.68,1042.68 1142.99,894.712 1145.3,954.109 1147.61,1044.33 1149.91,998.934 1152.22,961.53 1154.53,988.99 1156.84,1014.9 1159.15,1005.02 1161.45,1063.69 1163.76,813.207 1166.07,799.378 1168.38,1011.57 1170.69,1017.77 1172.99,906.454 1175.3,1194.11 1177.61,1022.29 1179.92,1168.45 1182.23,947.078 1184.53,949.596 1186.84,1012.25 1189.15,909.471 1191.46,689.107 1193.76,798.625 1196.07,941.866 1198.38,1080.86 1200.69,992.165 1203,990.756 1205.3,938.473 1207.61,751.55 1209.92,932.136 1212.23,948.673 1214.54,804.635 1216.84,1028.81 1219.15,965.072 1221.46,986.739 1223.77,945.228 1226.08,786.269 1228.38,996.005 1230.69,1022.22 1233,1086.65 1235.31,942.212 1237.61,913.91 1239.92,984.297 1242.23,1067.28 1244.54,1029.32 1246.85,926.634 1249.15,947.217 1251.46,985.006 1253.77,928.456 1256.08,936.465 1258.39,725.677 1260.69,1020.92 1263,968.127 1265.31,1088.89 1267.62,1024.62 1269.93,856.749 1272.23,963.222 1274.54,821.102 1276.85,915.491 1279.16,931.967 1281.47,961.002 1283.77,1081.34 1286.08,848.799 1288.39,1014.55 1290.7,1039.55 1293,1118.95 1295.31,1047.36 1297.62,1060.4 1299.93,1081.09 1302.24,1024.46 1304.54,980.281 1306.85,1038.66 1309.16,837.536 1311.47,757.015 1313.78,938.431 1316.08,974.387 1318.39,900.9 1320.7,956.786 1323.01,1041.8 1325.32,977.69 1327.62,927.614 1329.93,716.686 1332.24,1100.85 1334.55,1065.32 1336.86,938.523 1339.16,909.322 1341.47,900.361 1343.78,949.613 1346.09,1101.05 1348.39,862.795 1350.7,977.432 1353.01,1092.57 1355.32,954.554 1357.63,866.04 1359.93,1029.57 1362.24,1082.86 1364.55,1086.23 1366.86,834.054 1369.17,690.546 1371.47,1037.51 1373.78,955.85 1376.09,1207.42 1378.4,913.881 1380.71,770.803 1383.01,853.613 1385.32,1059.38 1387.63,1013.71 1389.94,966.158 1392.24,874.997 1394.55,948.256 1396.86,1017.81 1399.17,1138.89 1401.48,1133.78 1403.78,833.143 1406.09,957.657 1408.4,1025.45 1410.71,868.653 1413.02,906.855 1415.32,765.289 1417.63,1229.22 1419.94,787.565 1422.25,1183.01 1424.56,905.268 1426.86,848.031 1429.17,858.121 1431.48,1008.83 1433.79,1049.59 1436.1,940.481 1438.4,959.556 1440.71,961.913 1443.02,822.302 1445.33,856.288 1447.63,925.469 1449.94,1072.86 1452.25,1082.46 1454.56,719.63 1456.87,1065.75 1459.17,1166.26 1461.48,1093.07 1463.79,1132.9 1466.1,1099.27 1468.41,825.478 1470.71,913.598 1473.02,959.299 1475.33,791.147 1477.64,794.523 1479.95,974.81 1482.25,940.826 1484.56,1035.03 1486.87,941.689 1489.18,957.628 1491.49,976.199 1493.79,1074.64 1496.1,859.639 1498.41,1013.59 1500.72,915.127 1503.02,1216.39 1505.33,969.515 1507.64,1086.86 1509.95,985.409 1512.26,1063.95 1514.56,980.969 1516.87,914.445 1519.18,919.704 1521.49,1029.48 1523.8,1067.88 1526.1,900.726 1528.41,1024.36 1530.72,900.798 1533.03,778.32 1535.34,884.35 1537.64,958.677 1539.95,1030.17 1542.26,776.797 1544.57,835.836 1546.88,1022.07 1549.18,1124.22 1551.49,1040.16 1553.8,850.655 1556.11,1064.33 1558.41,1034.44 1560.72,867.372 1563.03,939.584 1565.34,1151.68 1567.65,880.216 1569.95,950.694 1572.26,1000.5 1574.57,1014.49 1576.88,890.026 1579.19,1035.79 1581.49,883.365 1583.8,1072.18 1586.11,1116.64 1588.42,930.65 1590.73,1007.8 1593.03,973.302 1595.34,1061.67 1597.65,977.799 1599.96,1083.06 1602.26,864.277 1604.57,1042.98 1606.88,1061.73 1609.19,915.514 1611.5,852.719 1613.8,808.561 1616.11,821.332 1618.42,861.102 1620.73,958.448 1623.04,803.611 1625.34,1038.74 1627.65,861.139 1629.96,985.059 1632.27,1038.11 1634.58,943.82 1636.88,760.84 1639.19,958.916 1641.5,962.621 1643.81,892.523 1646.12,968.55 1648.42,964.956 1650.73,961.81 1653.04,1174.62 1655.35,1065.16 1657.65,1015.78 1659.96,1064.3 1662.27,1014.33 1664.58,1028.64 1666.89,961.749 1669.19,864.249 1671.5,1008.43 1673.81,949.24 1676.12,942.008 1678.43,938.365 1680.73,985.8 1683.04,965.733 1685.35,901.321 1687.66,981.7 1689.97,787.2 1692.27,984.745 1694.58,899.027 1696.89,967.652 1699.2,902.359 1701.51,944.555 1703.81,944.781 1706.12,886.016 1708.43,1008.11 1710.74,1031.24 1713.04,964.306 1715.35,932.291 1717.66,924.178 1719.97,1043.7 1722.28,927.989 1724.58,1099.82 1726.89,1001.33 1729.2,940.321 1731.51,991.118 1733.82,803.989 1736.12,894.985 1738.43,801.763 1740.74,1046.05 1743.05,1005.45 1745.36,1062.58 1747.66,1034.11 1749.97,942.306 1752.28,994.995 1754.59,1058.23 1756.9,978.761 1759.2,970.213 1761.51,1089.07 1763.82,995.498 1766.13,995.633 1768.43,789.24 1770.74,1050.95 1773.05,753.606 1775.36,1147.66 1777.67,965.891 1779.97,1017.61 1782.28,874.074 1784.59,960.853 1786.9,892.369 1789.21,859.97 1791.51,1066.07 1793.82,877.674 1796.13,989.362 1798.44,922.359 1800.75,1053.05 1803.05,898.642 1805.36,943.784 1807.67,846.247 1809.98,780.469 1812.28,1056.67 1814.59,979.624 1816.9,924.302 1819.21,1021.44 1821.52,821.099 1823.82,803.636 1826.13,852.321 1828.44,983.696 1830.75,942.501 1833.06,912.013 1835.36,981.255 1837.67,988.76 1839.98,914.805 1842.29,1254.36 1844.6,855.115 1846.9,927.998 1849.21,983.47 1851.52,971.186 1853.83,980.985 1856.14,1054.85 1858.44,884.338 1860.75,989.61 1863.06,862.928 1865.37,882.318 1867.67,1139.7 1869.98,1207.52 1872.29,999.24 1874.6,971.668 1876.91,1018.92 1879.21,1148.71 1881.52,784.307 1883.83,1017.29 1886.14,1043.16 1888.45,945.475 1890.75,922.338 1893.06,902.289 1895.37,948.625 1897.68,939.025 1899.99,992.947 1902.29,942.519 1904.6,946.438 1906.91,1020.73 1909.22,1027.91 1911.53,800.79 1913.83,903.802 1916.14,888.389 1918.45,815.418 1920.76,985.912 1923.06,942.114 1925.37,878.842 1927.68,854.833 1929.99,1034.03 1932.3,849.148 1934.6,998.68 1936.91,1114.4 1939.22,880.737 1941.53,926.833 1943.84,1125.95 1946.14,1065.82 1948.45,937.09 1950.76,1068.86 1953.07,1068.2 1955.38,861.962 1957.68,1233.97 1959.99,928.833 1962.3,1111.19 1964.61,1057.18 1966.91,969.425 1969.22,860.707 1971.53,853.688 1973.84,985.236 1976.15,1040.49 1978.45,932.629 1980.76,1119.73 1983.07,809.232 1985.38,961.746 1987.69,1158.16 1989.99,898.468 1992.3,896.873 1994.61,959.427 1996.92,849.472 1999.23,769.894 2001.53,991.878 2003.84,948.45 2006.15,1023.4 2008.46,989.425 2010.77,976.413 2013.07,1261.57 2015.38,1026.82 2017.69,1085.45 2020,1028.06 2022.3,968.515 2024.61,981.066 2026.92,908.926 2029.23,871.033 2031.54,1005.29 2033.84,953.303 2036.15,1051.51 2038.46,973.97 2040.77,968.751 2043.08,1050.91 2045.38,864.833 2047.69,1017.23 2050,1041.08 2052.31,1070.31 2054.62,920.669 2056.92,948.026 2059.23,1037.9 2061.54,811.554 2063.85,1024.82 2066.16,956.626 2068.46,945.832 2070.77,937.499 2073.08,995.029 2075.39,875.586 2077.69,1041 2080,1053.29 2082.31,1162.3 2084.62,989.119 2086.93,934.562 2089.23,829.896 2091.54,773.861 2093.85,1012.21 2096.16,979.28 2098.47,872.407 2100.77,911.257 2103.08,876.516 2105.39,1045.56 2107.7,1060.84 2110.01,829.703 2112.31,1071.32 2114.62,1009.83 2116.93,1055.56 2119.24,1002.24 2121.55,1004.32 2123.85,932.331 2126.16,991.983 2128.47,933.26 2130.78,920.089 2133.08,1111.74 2135.39,1016.77 2137.7,865.753 2140.01,940.532 2142.32,873.933 2144.62,964.753 2146.93,822.253 2149.24,900.577 2151.55,992.976 2153.86,1057.52 2156.16,911.675 2158.47,1023.58 2160.78,1199.95 2163.09,1032.78 2165.4,988.122 2167.7,1090.72 2170.01,741.94 2172.32,1185.79 2174.63,1067.15 2176.93,983.617 2179.24,887.978 2181.55,893.935 2183.86,942.432 2186.17,892.845 2188.47,956.63 2190.78,1000.48 2193.09,978.685 2195.4,948.279 2197.71,936.598 2200.01,1077.31 2202.32,1122.71 2204.63,1073.67 2206.94,778.587 2209.25,1028.28 2211.55,1077.31 2213.86,1016.01 2216.17,933.035 2218.48,1033.46 2220.79,969.9 2223.09,1008.63 2225.4,820.104 2227.71,962.059 2230.02,968.98 2232.32,970.099 2234.63,971.907 2236.94,926.665 2239.25,877.593 2241.56,893.948 2243.86,899.725 2246.17,1157.47 2248.48,1067.03 2250.79,957.955 2253.1,1098.72 2255.4,797.16 2257.71,1033.83 2260.02,1074.27 2262.33,933.124 2264.64,1075.72 2266.94,798.497 2269.25,862.191 2271.56,862.897 2273.87,759.257 2276.18,924.421 2278.48,1060.32 2280.79,973.388 2283.1,821.431 2285.41,863.013 2287.71,1001.59 2290.02,893.494 2292.33,870.678 2294.64,977.908 2296.95,803.763 2299.25,884.033 2301.56,985.883 2303.87,913.441 2306.18,1029.24 2308.49,699.716 2310.79,947.722 2313.1,1142.13 2315.41,1044.28 2317.72,830.625 2320.03,1038.66 2322.33,958.186 2324.64,1026.22 2326.95,1168.8 2329.26,972.142 2331.56,1038.56 2333.87,986.241 2336.18,942.918 2338.49,961.95 2340.8,721.334 2343.1,1007.06 2345.41,1123 2347.72,927.66 2350.03,834.392 2352.34,1018.01 2354.64,875.628 2356.95,1028.17 2359.26,927.046 2361.57,1152.22 2363.88,994.3 2366.18,976.116 2368.49,1063.67 2370.8,1043.76 2373.11,849.626 2375.42,1049.03 2377.72,967.76 2380.03,942.123 2382.34,829.687 2384.65,982.323 2386.95,815.695 2389.26,958.053 2391.57,917.061 2393.88,1001.39 2396.19,1030.05 2398.49,798.109 2400.8,967.285 2403.11,849.059 2405.42,980.528 2407.73,1044.78 2410.03,1030.59 2412.34,1037.15 2414.65,1087.57 2416.96,1082.13 2419.27,920.713 2421.57,1064.46 2423.88,1057.81 2426.19,941.974 2428.5,932.626 2430.81,909.421 2433.11,980.022 2435.42,875.427 2437.73,1049.9 2440.04,1079.25 2442.34,1124.95 2444.65,1073.22 2446.96,1016.76 2449.27,947.935 2451.58,1133.78 2453.88,991.346 2456.19,784.674 2458.5,1033.27 2460.81,966.886 2463.12,1025.27 2465.42,819.446 2467.73,954.395 2470.04,900.297 2472.35,942.251 2474.66,1089.93 2476.96,1160.92 2479.27,848.79 2481.58,930.644 2483.89,852.401 2486.2,980.453 2488.5,979.489 2490.81,1026.9 2493.12,868.632 2495.43,976.665 2497.73,904.197 2500.04,1065.36 2502.35,1240.54 2504.66,995.826 2506.97,1087.08 2509.27,1052.17 2511.58,1015.21 2513.89,965.961 2516.2,993.671 2518.51,1073.91 2520.81,984.648 2523.12,945.96 2525.43,1094.8 2527.74,971.65 2530.05,880.37 2532.35,934.615 2534.66,818.294 2536.97,735.085 2539.28,1013.9 2541.58,947.823 2543.89,1084.72 2546.2,954.826 2548.51,1017.8 2550.82,951.392 2553.12,881.235 2555.43,826.793 2557.74,1080.85 2560.05,765.746 2562.36,852.167 2564.66,890.274 2566.97,761.622 2569.28,1002.89 2571.59,1029.36 "></polyline>
<polyline clip-path="url(#clip702)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,733.144 268.292,364.538 270.6,524.497 272.908,566.081 275.216,382.989 277.524,556.543 279.832,354.21 282.139,468.557 284.447,516.626 286.755,567.407 289.063,415.701 291.371,482.489 293.679,301.087 295.987,360.353 298.295,488.682 300.603,461.626 302.911,469.069 305.219,575.146 307.527,388.906 309.834,341.813 312.142,456.54 314.45,499.184 316.758,403.118 319.066,439.896 321.374,394.772 323.682,392.73 325.99,393.409 328.298,409.098 330.606,440.921 332.914,500.742 335.221,466.431 337.529,411.317 339.837,634.931 342.145,351.11 344.453,397.359 346.761,410.142 349.069,460.632 351.377,368.895 353.685,305.615 355.993,294.89 358.301,426.44 360.608,313.306 362.916,580.177 365.224,477.181 367.532,496.637 369.84,584.496 372.148,638.254 374.456,545.079 376.764,515.096 379.072,328.391 381.38,333.151 383.688,637.982 385.996,394.948 388.303,499.072 390.611,420.961 392.919,522.176 395.227,580.511 397.535,443.375 399.843,258.126 402.151,485.598 404.459,394.777 406.767,424.718 409.075,721.641 411.383,504.055 413.69,448.233 415.998,396.024 418.306,694.227 420.614,400.258 422.922,318.05 425.23,462.275 427.538,461.445 429.846,566.991 432.154,480.406 434.462,455.5 436.77,556.279 439.077,612.925 441.385,615.786 443.693,515.007 446.001,393.616 448.309,500.954 450.617,453.044 452.925,502.199 455.233,291.503 457.541,584.781 459.849,447.706 462.157,449.259 464.465,591.054 466.772,340.734 469.08,306.442 471.388,470.585 473.696,401.024 476.004,413.186 478.312,478.9 480.62,388.467 482.928,421.179 485.236,472.086 487.544,368.848 489.852,456.862 492.159,347.004 494.467,449.48 496.775,397.303 499.083,407.741 501.391,394.286 503.699,428.158 506.007,426.803 508.315,270.238 510.623,417.926 512.931,553.297 515.239,427.067 517.546,321.62 519.854,494.55 522.162,511.309 524.47,366.246 526.778,288.769 529.086,582.405 531.394,546.44 533.702,319.507 536.01,479.365 538.318,325.116 540.626,456.655 542.933,377.074 545.241,341.652 547.549,546.179 549.857,334.318 552.165,527.715 554.473,380.89 556.781,625.575 559.089,570.706 561.397,524.789 563.705,416.54 566.013,478.151 568.321,298.952 570.628,526.551 572.936,480.347 575.244,439.752 577.552,500.208 579.86,447.445 582.168,525.1 584.476,280.351 586.784,223.747 589.092,393.593 591.4,499.777 593.708,418.259 596.015,468.809 598.323,325.076 600.631,357.45 602.939,420.719 605.247,432.654 607.555,337.942 609.863,396.179 612.171,547.324 614.479,535.381 616.787,446.37 619.095,446.9 621.402,458.221 623.71,385.812 626.018,441.595 628.326,446.823 630.634,497.442 632.942,558.567 635.25,482.961 637.558,404.087 639.866,307.913 642.174,381.487 644.482,515.835 646.79,450.242 649.097,495.483 651.405,493.022 653.713,580.364 656.021,330.883 658.329,440.971 660.637,341.037 662.945,360.668 665.253,616.813 667.561,486.285 669.869,338.834 672.177,332.618 674.484,695.735 676.792,678.24 679.1,704.847 681.408,520.393 683.716,249.362 686.024,388.611 688.332,540.2 690.64,620.765 692.948,575.259 695.256,507.939 697.564,559.425 699.871,563.866 702.179,363.637 704.487,433.493 706.795,492.944 709.103,372.747 711.411,392.272 713.719,586.02 716.027,522.79 718.335,302.534 720.643,298.159 722.951,369.295 725.259,549.306 727.566,335.942 729.874,567.311 732.182,628.21 734.49,382.745 736.798,497.181 739.106,438.366 741.414,558.652 743.722,397.059 746.03,487.676 748.338,487.804 750.646,428.076 752.953,404.464 755.261,562.271 757.569,455.763 759.877,553.05 762.185,404.365 764.493,391.913 766.801,518.317 769.109,365.025 771.417,498.713 773.725,439.95 776.033,426.224 778.34,427.994 780.648,494.585 782.956,500.021 785.264,498.144 787.572,504.629 789.88,524.14 792.188,328.891 794.496,385.333 796.804,477.266 799.112,543.285 801.42,540.793 803.728,377.926 806.035,261.233 808.343,399.289 810.651,489.67 812.959,515.635 815.267,395.307 817.575,428.405 819.883,576.658 822.191,503.59 824.499,594.943 826.807,435.97 829.115,440.585 831.422,431.245 833.73,431.89 836.038,357.269 838.346,473.324 840.654,526.264 842.962,356.742 845.27,458.911 847.578,476.284 849.886,397.51 852.194,441.431 854.502,335.023 856.809,448.421 859.117,651.475 861.425,611.294 863.733,455.485 866.041,502.515 868.349,368.216 870.657,556.159 872.965,296.581 875.273,474.788 877.581,560.926 879.889,419.481 882.197,557.807 884.504,398.256 886.812,271.437 889.12,329.562 891.428,598.843 893.736,444.623 896.044,597.511 898.352,285.586 900.66,327.594 902.968,299.605 905.276,368.571 907.584,520.516 909.891,441.178 912.199,541.013 914.507,201.855 916.815,589.658 919.123,538.587 921.431,380.739 923.739,520.799 926.047,634.808 928.355,599.699 930.663,426.596 932.971,284.704 935.278,470.334 937.586,505.288 939.894,507.676 942.202,504.499 944.51,619.063 946.818,395.745 949.126,439.619 951.434,331.285 953.742,397.27 956.05,327.48 958.358,479.842 960.665,212.501 962.973,299.314 965.281,499.354 967.589,519.272 969.897,446.459 972.205,455.924 974.513,365.361 976.821,510.165 979.129,380.658 981.437,306.312 983.745,398.162 986.053,523.67 988.36,334.891 990.668,408.181 992.976,488.757 995.284,479.266 997.592,589.937 999.9,533.172 1002.21,239.364 1004.52,455.432 1006.82,335.715 1009.13,328.472 1011.44,471.678 1013.75,493.883 1016.06,383.753 1018.36,410.04 1020.67,349.72 1022.98,552.137 1025.29,194.654 1027.59,353.824 1029.9,431.57 1032.21,572.842 1034.52,284.036 1036.83,502.775 1039.13,485.58 1041.44,463.12 1043.75,364.427 1046.06,425.662 1048.37,572.167 1050.67,648.545 1052.98,516.949 1055.29,413.987 1057.6,573.835 1059.91,547.786 1062.21,437.589 1064.52,539.624 1066.83,404.589 1069.14,483.154 1071.45,401.783 1073.75,660.572 1076.06,470.506 1078.37,510.876 1080.68,238.113 1082.98,426.049 1085.29,380.1 1087.6,509 1089.91,366.719 1092.22,608.342 1094.52,518.281 1096.83,313.087 1099.14,469.764 1101.45,406.708 1103.76,412.514 1106.06,598 1108.37,503.38 1110.68,459.874 1112.99,521.408 1115.3,498.91 1117.6,573.683 1119.91,316.113 1122.22,361.071 1124.53,320.937 1126.84,484.457 1129.14,459.198 1131.45,539.368 1133.76,489.965 1136.07,389.002 1138.37,642.117 1140.68,261.866 1142.99,314.373 1145.3,377.972 1147.61,589.412 1149.91,517.248 1152.22,266.813 1154.53,458.374 1156.84,406.968 1159.15,342.921 1161.45,455.274 1163.76,819.339 1166.07,350.396 1168.38,549.43 1170.69,485.42 1172.99,527.42 1175.3,535.266 1177.61,464.971 1179.92,351.328 1182.23,491.393 1184.53,365.71 1186.84,521.024 1189.15,365.115 1191.46,691.041 1193.76,513.031 1196.07,549.824 1198.38,442.789 1200.69,671.017 1203,380.888 1205.3,275.399 1207.61,489.094 1209.92,344.654 1212.23,579.634 1214.54,461.598 1216.84,673.956 1219.15,518.08 1221.46,560.776 1223.77,357.97 1226.08,308.957 1228.38,391.697 1230.69,424.23 1233,254.921 1235.31,514.523 1237.61,482.599 1239.92,459.277 1242.23,403.218 1244.54,344.09 1246.85,474.093 1249.15,445.21 1251.46,393.578 1253.77,546.62 1256.08,361.012 1258.39,407.283 1260.69,460.971 1263,343.02 1265.31,516.861 1267.62,395.627 1269.93,418.262 1272.23,375.706 1274.54,269.518 1276.85,283.511 1279.16,545.115 1281.47,583.23 1283.77,265.81 1286.08,581.842 1288.39,508.634 1290.7,460.525 1293,629.036 1295.31,467.812 1297.62,472.311 1299.93,463.903 1302.24,349.914 1304.54,443.995 1306.85,588.914 1309.16,601.976 1311.47,658.069 1313.78,592.09 1316.08,310.793 1318.39,347.948 1320.7,393.474 1323.01,367.747 1325.32,413.021 1327.62,372.095 1329.93,504.398 1332.24,546.121 1334.55,471.318 1336.86,312.179 1339.16,480.903 1341.47,375.193 1343.78,610.524 1346.09,465.486 1348.39,252.466 1350.7,339.246 1353.01,512.163 1355.32,395.022 1357.63,676.495 1359.93,651.821 1362.24,463.751 1364.55,505.232 1366.86,509.51 1369.17,495.581 1371.47,366.508 1373.78,362.131 1376.09,324.426 1378.4,96.8724 1380.71,440.333 1383.01,417.411 1385.32,543.536 1387.63,504.615 1389.94,492.733 1392.24,347.186 1394.55,568.965 1396.86,387.464 1399.17,503.968 1401.48,518.62 1403.78,520.044 1406.09,439.414 1408.4,647.474 1410.71,422.344 1413.02,278.907 1415.32,583.831 1417.63,445.632 1419.94,341.916 1422.25,594.528 1424.56,427.087 1426.86,234.521 1429.17,295.383 1431.48,399.322 1433.79,357.474 1436.1,315.361 1438.4,384.748 1440.71,472.748 1443.02,430.976 1445.33,362.637 1447.63,484.395 1449.94,262.838 1452.25,501.908 1454.56,401.39 1456.87,478.407 1459.17,650.13 1461.48,460.332 1463.79,534.92 1466.1,396.883 1468.41,317.139 1470.71,419.474 1473.02,446.243 1475.33,326.019 1477.64,325.544 1479.95,497.195 1482.25,330.274 1484.56,523.059 1486.87,370.657 1489.18,427.419 1491.49,497.698 1493.79,374.228 1496.1,437.267 1498.41,469.842 1500.72,467.741 1503.02,451.682 1505.33,346.329 1507.64,595.084 1509.95,557.595 1512.26,479.742 1514.56,415.639 1516.87,474.788 1519.18,425.602 1521.49,397.907 1523.8,426.35 1526.1,657.701 1528.41,582.709 1530.72,292.733 1533.03,510.754 1535.34,488.982 1537.64,421.91 1539.95,437.519 1542.26,448.32 1544.57,571.18 1546.88,378.876 1549.18,389.32 1551.49,539.141 1553.8,596.482 1556.11,516.706 1558.41,447.182 1560.72,340.741 1563.03,461.315 1565.34,487.655 1567.65,400.847 1569.95,713.772 1572.26,328.889 1574.57,511.456 1576.88,314.138 1579.19,476.019 1581.49,414.67 1583.8,266.518 1586.11,529.093 1588.42,328.778 1590.73,361.154 1593.03,340.853 1595.34,336.389 1597.65,538.558 1599.96,468.887 1602.26,411.859 1604.57,642.429 1606.88,322.292 1609.19,267.286 1611.5,533.698 1613.8,365.605 1616.11,357.113 1618.42,537.713 1620.73,350.887 1623.04,450.43 1625.34,395.516 1627.65,528.253 1629.96,461.507 1632.27,540.029 1634.58,316.95 1636.88,414.811 1639.19,381.792 1641.5,495.53 1643.81,399.51 1646.12,435.978 1648.42,399.441 1650.73,302.081 1653.04,369.254 1655.35,458.043 1657.65,376.337 1659.96,522.283 1662.27,537.353 1664.58,615.71 1666.89,521.287 1669.19,430.283 1671.5,420.779 1673.81,495.551 1676.12,472.797 1678.43,341.292 1680.73,326.678 1683.04,533.917 1685.35,424.425 1687.66,448.201 1689.97,386.447 1692.27,617.73 1694.58,544.455 1696.89,595.708 1699.2,491.3 1701.51,548.43 1703.81,481.931 1706.12,645.139 1708.43,356.1 1710.74,347.296 1713.04,537.205 1715.35,357.733 1717.66,451.385 1719.97,508.189 1722.28,401.105 1724.58,641.401 1726.89,388.444 1729.2,432.23 1731.51,502.602 1733.82,464.07 1736.12,451.445 1738.43,520.905 1740.74,589.488 1743.05,394.688 1745.36,454.428 1747.66,476.249 1749.97,404.711 1752.28,324.496 1754.59,601.938 1756.9,324.832 1759.2,409.222 1761.51,524.097 1763.82,613.905 1766.13,465.268 1768.43,240.216 1770.74,473.787 1773.05,621.891 1775.36,463.885 1777.67,518.344 1779.97,379.849 1782.28,591.627 1784.59,591.111 1786.9,790.776 1789.21,339.549 1791.51,383.167 1793.82,422.845 1796.13,419.503 1798.44,416.246 1800.75,270.987 1803.05,407.715 1805.36,437.456 1807.67,511.976 1809.98,403.786 1812.28,360.72 1814.59,539.794 1816.9,472.033 1819.21,399.661 1821.52,521.963 1823.82,498.395 1826.13,398.069 1828.44,295.341 1830.75,534.048 1833.06,340.613 1835.36,461.473 1837.67,369.243 1839.98,489.013 1842.29,592.232 1844.6,495.23 1846.9,441.06 1849.21,547.759 1851.52,340.235 1853.83,406.47 1856.14,434.169 1858.44,461.985 1860.75,605.647 1863.06,411.819 1865.37,181.032 1867.67,437 1869.98,355.723 1872.29,497.008 1874.6,530.067 1876.91,487.159 1879.21,698.112 1881.52,713.936 1883.83,511.766 1886.14,745.894 1888.45,420.336 1890.75,401.585 1893.06,339.897 1895.37,498.723 1897.68,489.095 1899.99,416.128 1902.29,598.76 1904.6,398.79 1906.91,595.492 1909.22,547.436 1911.53,432.026 1913.83,413.669 1916.14,461.089 1918.45,535.458 1920.76,547.738 1923.06,508.826 1925.37,551.746 1927.68,527.698 1929.99,470.964 1932.3,478.792 1934.6,358.612 1936.91,507.85 1939.22,474.235 1941.53,484.979 1943.84,495.823 1946.14,321.223 1948.45,463.601 1950.76,510.069 1953.07,397.046 1955.38,371.792 1957.68,484.568 1959.99,552.688 1962.3,549.06 1964.61,172.271 1966.91,466.276 1969.22,186.802 1971.53,474.146 1973.84,491.027 1976.15,496.618 1978.45,380.861 1980.76,483.515 1983.07,410.366 1985.38,528.781 1987.69,576.749 1989.99,442.958 1992.3,422.547 1994.61,510.46 1996.92,482.883 1999.23,538.09 2001.53,479.463 2003.84,478.348 2006.15,501.656 2008.46,224.316 2010.77,559.347 2013.07,300.991 2015.38,483.422 2017.69,563.236 2020,628.77 2022.3,373.649 2024.61,583.825 2026.92,478.585 2029.23,423.795 2031.54,325.936 2033.84,529.042 2036.15,395.367 2038.46,394.533 2040.77,323.105 2043.08,557.655 2045.38,502.469 2047.69,482.535 2050,791.925 2052.31,466.548 2054.62,616.27 2056.92,313.168 2059.23,698.858 2061.54,485.974 2063.85,594.981 2066.16,612.673 2068.46,307.377 2070.77,357.37 2073.08,441.647 2075.39,603.821 2077.69,268.765 2080,535.552 2082.31,464.883 2084.62,436.418 2086.93,654.618 2089.23,396.424 2091.54,398.817 2093.85,606.173 2096.16,456.195 2098.47,722.727 2100.77,427.54 2103.08,412.898 2105.39,422.803 2107.7,515.274 2110.01,194.554 2112.31,302.026 2114.62,543.054 2116.93,471.59 2119.24,487.043 2121.55,493.665 2123.85,593.647 2126.16,463.659 2128.47,415.165 2130.78,220.698 2133.08,524.871 2135.39,493.259 2137.7,453.133 2140.01,429.812 2142.32,506.603 2144.62,506.163 2146.93,485.018 2149.24,478.794 2151.55,487.691 2153.86,349.216 2156.16,427.075 2158.47,510.365 2160.78,309.952 2163.09,585.173 2165.4,435.212 2167.7,403.897 2170.01,421.771 2172.32,571.25 2174.63,645.365 2176.93,414.552 2179.24,550.709 2181.55,394.707 2183.86,370.16 2186.17,333.262 2188.47,428.516 2190.78,607.459 2193.09,386.665 2195.4,471.295 2197.71,548.299 2200.01,411.702 2202.32,382.417 2204.63,458.75 2206.94,347.412 2209.25,403.188 2211.55,409.715 2213.86,509.479 2216.17,378.641 2218.48,364.105 2220.79,506.939 2223.09,529.79 2225.4,568.034 2227.71,343.135 2230.02,592.13 2232.32,453.184 2234.63,534.264 2236.94,541.267 2239.25,571.053 2241.56,387.41 2243.86,545.831 2246.17,468.337 2248.48,481.299 2250.79,442.129 2253.1,495.381 2255.4,402.044 2257.71,639.749 2260.02,351.076 2262.33,595.008 2264.64,459.867 2266.94,574.583 2269.25,433.791 2271.56,363.381 2273.87,410.866 2276.18,504.191 2278.48,277.612 2280.79,264.753 2283.1,507.196 2285.41,418.082 2287.71,370.171 2290.02,561.823 2292.33,368.676 2294.64,335.391 2296.95,481.316 2299.25,477.021 2301.56,574.356 2303.87,380.196 2306.18,424.745 2308.49,254.073 2310.79,308.495 2313.1,322.279 2315.41,602.4 2317.72,534.761 2320.03,456.499 2322.33,411.169 2324.64,517.206 2326.95,428.774 2329.26,506.997 2331.56,283.406 2333.87,512.982 2336.18,524.015 2338.49,586.176 2340.8,478.55 2343.1,639.488 2345.41,474.728 2347.72,402.645 2350.03,538.699 2352.34,505.1 2354.64,380.597 2356.95,490.526 2359.26,428.625 2361.57,588.553 2363.88,407.545 2366.18,472.63 2368.49,474.092 2370.8,583.033 2373.11,243.641 2375.42,472.347 2377.72,628.845 2380.03,584.158 2382.34,469.637 2384.65,546.333 2386.95,464.92 2389.26,615.27 2391.57,454.319 2393.88,553.743 2396.19,597.454 2398.49,508.835 2400.8,513.933 2403.11,499.794 2405.42,400.069 2407.73,406.276 2410.03,484.07 2412.34,463.542 2414.65,484.013 2416.96,290.998 2419.27,506.968 2421.57,382.487 2423.88,317.578 2426.19,366.03 2428.5,256.869 2430.81,453.64 2433.11,451.438 2435.42,458.331 2437.73,324.833 2440.04,378.205 2442.34,361.806 2444.65,534.601 2446.96,544.248 2449.27,482.078 2451.58,328.484 2453.88,460.278 2456.19,474.542 2458.5,513.318 2460.81,695.473 2463.12,343.711 2465.42,485.089 2467.73,375.313 2470.04,406.032 2472.35,436.216 2474.66,489.783 2476.96,376.852 2479.27,209.308 2481.58,575.972 2483.89,360.211 2486.2,462.644 2488.5,544.538 2490.81,293.388 2493.12,374.993 2495.43,472.99 2497.73,398.446 2500.04,501.389 2502.35,390.716 2504.66,480.249 2506.97,465.996 2509.27,420.086 2511.58,536.52 2513.89,462.746 2516.2,429.963 2518.51,606.878 2520.81,388.728 2523.12,404.425 2525.43,692.852 2527.74,564.281 2530.05,619.209 2532.35,388.799 2534.66,523.049 2536.97,416.497 2539.28,311.654 2541.58,605.155 2543.89,473.486 2546.2,421.22 2548.51,450.467 2550.82,459.435 2553.12,498.388 2555.43,623.879 2557.74,487.224 2560.05,398.572 2562.36,498.125 2564.66,691.181 2566.97,516.671 2569.28,567.56 2571.59,475.58 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -2.96775  -3.93652  -4.63295  -4.63295  …  -3.68328   -4.11578   -5.44807
 -1.48171  -1.00006  -1.2694   -1.2694      -0.163217   0.164994   0.409641
  3.3633    4.46087   3.65267   3.65267      4.86102    6.45498    6.54921

[:, :, 2] =
 -1.80548  -4.26323    -4.26912   …  -4.84086   -4.90947   -4.77392
 -1.67729  -0.0976919  -0.816277     -0.605182   0.927507  -1.14581
  2.59226   4.34612     4.46875       5.83637    5.4898     3.91336

[:, :, 3] =
 -2.97619  -4.53335  -4.86866   -4.29325   …  -5.94465  -5.27736   -5.27736
 -0.166    -0.78456  -0.745436  -0.858667      1.16211   0.443136   0.443136
  1.84243   3.53522   3.64604    3.49507       4.50862   3.37943    3.37943

[:, :, 4] =
 -3.19931  -3.46238  -4.17898  -5.33491  …  -4.51474  -3.77209  -4.55249
  1.16953   1.72475   1.43737   1.30589      1.0954    1.33416   0.517109
  1.97047   4.61766   3.74525   3.76746      6.69494   6.2811    6.42792</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -5.01418      0.990707
  0.000265581  0.989616
  4.95109      0.989236</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.47 seconds
Compute duration  = 2.47 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -4.9701    1.0074    0.0177   3226.0502   5219.8431    1.0002   ⋯
        x[2]    0.0156    1.0096    0.0175   3343.9002   4351.0060    1.0005   ⋯
        x[3]    4.9674    1.0158    0.0179   3222.2913   5159.3290    1.0018   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -6.9259   -5.6524   -4.9564   -4.2844   -2.9695
        x[2]   -1.9511   -0.6552    0.0141    0.6862    1.9833
        x[3]    2.9595    4.2884    4.9713    5.6433    6.9581</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.52 seconds
Compute duration  = 1.52 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.4974    0.1922    0.0029   4237.7482   5544.1847    1.0026   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1344    0.3511    0.4980    0.6419    0.8557</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.22 seconds
Compute duration  = 0.22 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

           x    0.4952    0.1845    0.0223    53.8439    23.7319    1.0443     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.2104    0.3395    0.4920    0.6510    0.8084</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(-0.4206789373427607, "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with -0.4206789373427607:
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/nmUhn/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/compiler.jl:579 [inlined]
  [7] demo(__model__::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, __varinfo__::DynamicPPL.ThreadSafeVarInfo{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, Vector{Base.RefValue{Float64}}}, __context__::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:592
  [8] _evaluate!!
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:973 [inlined]
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, context::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:962
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:892 [inlined]
 [11] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/values_as_in_model.jl:196 [inlined]
 [12] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/values_as_in_model.jl:195 [inlined]
 [13] getparams(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:343
 [14] Turing.Inference.Transition(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, t::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:226
 [15] transition_to_turing
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:12 [inlined]
 [16] transition_to_turing(f::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, transition::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:17
 [17] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}; initial_state::Nothing, initial_params::Nothing, kwargs::@Kwargs{})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:141
 [18] step
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:96 [inlined]
 [19] macro expansion
    @ ~/.julia/packages/AbstractMCMC/YrmkI/src/sample.jl:130 [inlined]
 [20] macro expansion
    @ ~/.julia/packages/AbstractMCMC/YrmkI/src/logging.jl:16 [inlined]
 [21] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/YrmkI/src/sample.jl:120
 [22] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/MjWTB/src/sampler.jl:93
 [23] sample
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/sampler.jl:83 [inlined]
 [24] #sample#4
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:276 [inlined]
 [25] sample
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:267 [inlined]
 [26] #sample#3
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:264 [inlined]
 [27] top-level scope
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:594</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.61 seconds
Compute duration  = 1.61 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.9333    0.6716    0.0590   175.5623    93.2582    1.0135     ⋯
           x   -0.0468    1.1724    0.1014   226.2432   143.3050    1.0044     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1094    0.4250    0.7647    1.2760    2.7257
           x   -2.6647   -0.4541    0.0111    0.4003    2.1787</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 3.11 seconds
Compute duration  = 3.11 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8997    0.6083    0.0403   287.9485   164.3425    1.0053     ⋯
           x   -0.0024    0.9635    0.0511   457.8390   372.4902    1.0027     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1529    0.4191    0.7796    1.2466    2.3782
           x   -2.2671   -0.4087    0.0316    0.4023    2.0896</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>