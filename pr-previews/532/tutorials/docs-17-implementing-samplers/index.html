<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../tutorials/docs-07-for-developers-variational-inference/index.html" rel="prev">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/docs-00-getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/00-introduction/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.34" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.34</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.34">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Users</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-00-getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-12-using-turing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Core Functionality</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Usage Tips</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-10-using-turing-autodiff/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-custom-distribution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Custom Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-probability-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Querying Model Probabilities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-modifying-logprob/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modifying the Log Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-generated-quantities/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generated Quantities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-13-using-turing-performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-15-using-turing-sampler-viz/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-11-using-turing-dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-16-using-turing-external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/00-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction: Coin Flipping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/01-gaussian-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/02-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/03-bayesian-neural-network/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/04-hidden-markov-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/05-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/06-infinite-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/07-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/08-multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/09-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/10-bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/11-probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/13-seasonal-time-series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/15-gaussian-processes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Gaussian Processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/12-gplvm/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Contributing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-01-contributing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to Contribute</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">DynamicPPL in Depth</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/dev-model-manual/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manually Defining a Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-05-for-developers-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/14-minituring/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/16-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Inference (note: outdated)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-06-for-developers-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-43.84151741080848</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-43.84151741080848</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([-1.3564775644493605, -0.6166376604130808, -0.4389195113453215]), MALAState{Vector{Float64}}([-1.3564775644493605, -0.6166376604130808, -0.4389195113453215]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -3.00853   -3.89393   -5.51967   -6.07231  …  -6.32668   -4.55398  -5.66575
  0.375432  -0.645457  -0.762706  -1.54869      0.534804   2.23125   1.87261
  3.72247    4.53642    5.54577    5.37102      6.78797    4.50653   4.25936</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -5.03451    1.00247
  0.0130517  0.997423
  4.99784    0.998459</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip110">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip110)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip111">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip110)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip112">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip112)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip112)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip112)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip112)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip112)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip112)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1710.62 2640.76,1710.62 "></polyline>
<polyline clip-path="url(#clip112)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1463.68 2640.76,1463.68 "></polyline>
<polyline clip-path="url(#clip112)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1216.74 2640.76,1216.74 "></polyline>
<polyline clip-path="url(#clip112)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,969.801 2640.76,969.801 "></polyline>
<polyline clip-path="url(#clip112)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,722.86 2640.76,722.86 "></polyline>
<polyline clip-path="url(#clip112)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,475.919 2640.76,475.919 "></polyline>
<polyline clip-path="url(#clip112)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,228.978 2640.76,228.978 "></polyline>
<polyline clip-path="url(#clip110)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip110)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip110)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip110)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip110)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip110)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip110)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip110)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip110)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1710.62 215.714,1710.62 "></polyline>
<polyline clip-path="url(#clip110)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1463.68 215.714,1463.68 "></polyline>
<polyline clip-path="url(#clip110)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1216.74 215.714,1216.74 "></polyline>
<polyline clip-path="url(#clip110)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,969.801 215.714,969.801 "></polyline>
<polyline clip-path="url(#clip110)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,722.86 215.714,722.86 "></polyline>
<polyline clip-path="url(#clip110)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,475.919 215.714,475.919 "></polyline>
<polyline clip-path="url(#clip110)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,228.978 215.714,228.978 "></polyline>
<path clip-path="url(#clip110)" d="M50.5475 1711.07 L80.2233 1711.07 L80.2233 1715.01 L50.5475 1715.01 L50.5475 1711.07 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M89.1352 1693.34 L111.357 1693.34 L111.357 1695.33 L98.8111 1727.9 L93.9269 1727.9 L105.732 1697.28 L89.1352 1697.28 L89.1352 1693.34 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M120.478 1722.02 L125.362 1722.02 L125.362 1727.9 L120.478 1727.9 L120.478 1722.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M135.593 1693.34 L153.95 1693.34 L153.95 1697.28 L139.876 1697.28 L139.876 1705.75 Q140.894 1705.4 141.913 1705.24 Q142.931 1705.06 143.95 1705.06 Q149.737 1705.06 153.116 1708.23 Q156.496 1711.4 156.496 1716.82 Q156.496 1722.39 153.024 1725.5 Q149.552 1728.57 143.232 1728.57 Q141.056 1728.57 138.788 1728.2 Q136.542 1727.83 134.135 1727.09 L134.135 1722.39 Q136.218 1723.53 138.441 1724.08 Q140.663 1724.64 143.14 1724.64 Q147.144 1724.64 149.482 1722.53 Q151.82 1720.43 151.82 1716.82 Q151.82 1713.2 149.482 1711.1 Q147.144 1708.99 143.14 1708.99 Q141.265 1708.99 139.39 1709.41 Q137.538 1709.82 135.593 1710.7 L135.593 1693.34 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M49.5521 1464.13 L79.2279 1464.13 L79.2279 1468.07 L49.5521 1468.07 L49.5521 1464.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M89.3667 1446.4 L107.723 1446.4 L107.723 1450.34 L93.6491 1450.34 L93.6491 1458.81 Q94.6676 1458.46 95.6861 1458.3 Q96.7047 1458.12 97.7232 1458.12 Q103.51 1458.12 106.89 1461.29 Q110.269 1464.46 110.269 1469.87 Q110.269 1475.45 106.797 1478.56 Q103.325 1481.63 97.0056 1481.63 Q94.8297 1481.63 92.5612 1481.26 Q90.3158 1480.89 87.9084 1480.15 L87.9084 1475.45 Q89.9917 1476.59 92.2139 1477.14 Q94.4361 1477.7 96.913 1477.7 Q100.918 1477.7 103.256 1475.59 Q105.593 1473.49 105.593 1469.87 Q105.593 1466.26 103.256 1464.16 Q100.918 1462.05 96.913 1462.05 Q95.038 1462.05 93.163 1462.47 Q91.3112 1462.88 89.3667 1463.76 L89.3667 1446.4 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M119.482 1475.08 L124.367 1475.08 L124.367 1480.96 L119.482 1480.96 L119.482 1475.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M144.552 1449.48 Q140.941 1449.48 139.112 1453.05 Q137.306 1456.59 137.306 1463.72 Q137.306 1470.82 139.112 1474.39 Q140.941 1477.93 144.552 1477.93 Q148.186 1477.93 149.991 1474.39 Q151.82 1470.82 151.82 1463.72 Q151.82 1456.59 149.991 1453.05 Q148.186 1449.48 144.552 1449.48 M144.552 1445.78 Q150.362 1445.78 153.417 1450.38 Q156.496 1454.97 156.496 1463.72 Q156.496 1472.44 153.417 1477.05 Q150.362 1481.63 144.552 1481.63 Q138.741 1481.63 135.663 1477.05 Q132.607 1472.44 132.607 1463.72 Q132.607 1454.97 135.663 1450.38 Q138.741 1445.78 144.552 1445.78 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M50.5475 1217.19 L80.2233 1217.19 L80.2233 1221.13 L50.5475 1221.13 L50.5475 1217.19 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M94.3436 1230.09 L110.663 1230.09 L110.663 1234.02 L88.7186 1234.02 L88.7186 1230.09 Q91.3806 1227.33 95.9639 1222.7 Q100.57 1218.05 101.751 1216.71 Q103.996 1214.18 104.876 1212.45 Q105.779 1210.69 105.779 1209 Q105.779 1206.24 103.834 1204.51 Q101.913 1202.77 98.8111 1202.77 Q96.6121 1202.77 94.1584 1203.54 Q91.7278 1204.3 88.9501 1205.85 L88.9501 1201.13 Q91.7741 1199.99 94.2278 1199.42 Q96.6815 1198.84 98.7185 1198.84 Q104.089 1198.84 107.283 1201.52 Q110.478 1204.21 110.478 1208.7 Q110.478 1210.83 109.668 1212.75 Q108.881 1214.65 106.774 1217.24 Q106.195 1217.91 103.094 1221.13 Q99.9917 1224.32 94.3436 1230.09 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M120.478 1228.14 L125.362 1228.14 L125.362 1234.02 L120.478 1234.02 L120.478 1228.14 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M135.593 1199.46 L153.95 1199.46 L153.95 1203.4 L139.876 1203.4 L139.876 1211.87 Q140.894 1211.52 141.913 1211.36 Q142.931 1211.17 143.95 1211.17 Q149.737 1211.17 153.116 1214.35 Q156.496 1217.52 156.496 1222.93 Q156.496 1228.51 153.024 1231.61 Q149.552 1234.69 143.232 1234.69 Q141.056 1234.69 138.788 1234.32 Q136.542 1233.95 134.135 1233.21 L134.135 1228.51 Q136.218 1229.65 138.441 1230.2 Q140.663 1230.76 143.14 1230.76 Q147.144 1230.76 149.482 1228.65 Q151.82 1226.54 151.82 1222.93 Q151.82 1219.32 149.482 1217.22 Q147.144 1215.11 143.14 1215.11 Q141.265 1215.11 139.39 1215.53 Q137.538 1215.94 135.593 1216.82 L135.593 1199.46 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M99.3204 955.6 Q95.7093 955.6 93.8806 959.164 Q92.075 962.706 92.075 969.836 Q92.075 976.942 93.8806 980.507 Q95.7093 984.049 99.3204 984.049 Q102.955 984.049 104.76 980.507 Q106.589 976.942 106.589 969.836 Q106.589 962.706 104.76 959.164 Q102.955 955.6 99.3204 955.6 M99.3204 951.896 Q105.131 951.896 108.186 956.502 Q111.265 961.086 111.265 969.836 Q111.265 978.562 108.186 983.169 Q105.131 987.752 99.3204 987.752 Q93.5102 987.752 90.4315 983.169 Q87.376 978.562 87.376 969.836 Q87.376 961.086 90.4315 956.502 Q93.5102 951.896 99.3204 951.896 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M119.482 981.201 L124.367 981.201 L124.367 987.081 L119.482 987.081 L119.482 981.201 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M144.552 955.6 Q140.941 955.6 139.112 959.164 Q137.306 962.706 137.306 969.836 Q137.306 976.942 139.112 980.507 Q140.941 984.049 144.552 984.049 Q148.186 984.049 149.991 980.507 Q151.82 976.942 151.82 969.836 Q151.82 962.706 149.991 959.164 Q148.186 955.6 144.552 955.6 M144.552 951.896 Q150.362 951.896 153.417 956.502 Q156.496 961.086 156.496 969.836 Q156.496 978.562 153.417 983.169 Q150.362 987.752 144.552 987.752 Q138.741 987.752 135.663 983.169 Q132.607 978.562 132.607 969.836 Q132.607 961.086 135.663 956.502 Q138.741 951.896 144.552 951.896 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M94.3436 736.205 L110.663 736.205 L110.663 740.14 L88.7186 740.14 L88.7186 736.205 Q91.3806 733.45 95.9639 728.821 Q100.57 724.168 101.751 722.825 Q103.996 720.302 104.876 718.566 Q105.779 716.807 105.779 715.117 Q105.779 712.362 103.834 710.626 Q101.913 708.89 98.8111 708.89 Q96.6121 708.89 94.1584 709.654 Q91.7278 710.418 88.9501 711.969 L88.9501 707.247 Q91.7741 706.112 94.2278 705.534 Q96.6815 704.955 98.7185 704.955 Q104.089 704.955 107.283 707.64 Q110.478 710.325 110.478 714.816 Q110.478 716.946 109.668 718.867 Q108.881 720.765 106.774 723.358 Q106.195 724.029 103.094 727.247 Q99.9917 730.441 94.3436 736.205 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M120.478 734.26 L125.362 734.26 L125.362 740.14 L120.478 740.14 L120.478 734.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M135.593 705.58 L153.95 705.58 L153.95 709.515 L139.876 709.515 L139.876 717.987 Q140.894 717.64 141.913 717.478 Q142.931 717.293 143.95 717.293 Q149.737 717.293 153.116 720.464 Q156.496 723.636 156.496 729.052 Q156.496 734.631 153.024 737.733 Q149.552 740.811 143.232 740.811 Q141.056 740.811 138.788 740.441 Q136.542 740.071 134.135 739.33 L134.135 734.631 Q136.218 735.765 138.441 736.321 Q140.663 736.876 143.14 736.876 Q147.144 736.876 149.482 734.77 Q151.82 732.663 151.82 729.052 Q151.82 725.441 149.482 723.335 Q147.144 721.228 143.14 721.228 Q141.265 721.228 139.39 721.645 Q137.538 722.061 135.593 722.941 L135.593 705.58 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M89.3667 458.639 L107.723 458.639 L107.723 462.574 L93.6491 462.574 L93.6491 471.047 Q94.6676 470.699 95.6861 470.537 Q96.7047 470.352 97.7232 470.352 Q103.51 470.352 106.89 473.523 Q110.269 476.695 110.269 482.111 Q110.269 487.69 106.797 490.792 Q103.325 493.87 97.0056 493.87 Q94.8297 493.87 92.5612 493.5 Q90.3158 493.13 87.9084 492.389 L87.9084 487.69 Q89.9917 488.824 92.2139 489.38 Q94.4361 489.935 96.913 489.935 Q100.918 489.935 103.256 487.829 Q105.593 485.722 105.593 482.111 Q105.593 478.5 103.256 476.394 Q100.918 474.287 96.913 474.287 Q95.038 474.287 93.163 474.704 Q91.3112 475.121 89.3667 476 L89.3667 458.639 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M119.482 487.32 L124.367 487.32 L124.367 493.199 L119.482 493.199 L119.482 487.32 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M144.552 461.718 Q140.941 461.718 139.112 465.283 Q137.306 468.824 137.306 475.954 Q137.306 483.06 139.112 486.625 Q140.941 490.167 144.552 490.167 Q148.186 490.167 149.991 486.625 Q151.82 483.06 151.82 475.954 Q151.82 468.824 149.991 465.283 Q148.186 461.718 144.552 461.718 M144.552 458.014 Q150.362 458.014 153.417 462.621 Q156.496 467.204 156.496 475.954 Q156.496 484.681 153.417 489.287 Q150.362 493.87 144.552 493.87 Q138.741 493.87 135.663 489.287 Q132.607 484.681 132.607 475.954 Q132.607 467.204 135.663 462.621 Q138.741 458.014 144.552 458.014 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M89.1352 211.698 L111.357 211.698 L111.357 213.689 L98.8111 246.258 L93.9269 246.258 L105.732 215.633 L89.1352 215.633 L89.1352 211.698 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M120.478 240.379 L125.362 240.379 L125.362 246.258 L120.478 246.258 L120.478 240.379 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip110)" d="M135.593 211.698 L153.95 211.698 L153.95 215.633 L139.876 215.633 L139.876 224.106 Q140.894 223.758 141.913 223.596 Q142.931 223.411 143.95 223.411 Q149.737 223.411 153.116 226.583 Q156.496 229.754 156.496 235.17 Q156.496 240.749 153.024 243.851 Q149.552 246.93 143.232 246.93 Q141.056 246.93 138.788 246.559 Q136.542 246.189 134.135 245.448 L134.135 240.749 Q136.218 241.883 138.441 242.439 Q140.663 242.994 143.14 242.994 Q147.144 242.994 149.482 240.888 Q151.82 238.782 151.82 235.17 Q151.82 231.559 149.482 229.453 Q147.144 227.346 143.14 227.346 Q141.265 227.346 139.39 227.763 Q137.538 228.18 135.593 229.059 L135.593 211.698 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip112)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1266.97 268.292,1570.67 270.6,1532.36 272.908,1398.11 275.216,1591.8 277.524,1390.51 279.832,1424.16 282.139,1449.23 284.447,1570.56 286.755,1416.69 289.063,1484.49 291.371,1495.6 293.679,1466.9 295.987,1495.15 298.295,1410.08 300.603,1451.73 302.911,1548.03 305.219,1339.56 307.527,1661.51 309.834,1374.29 312.142,1464.05 314.45,1273.97 316.758,1468.3 319.066,1563.36 321.374,1503.85 323.682,1419.17 325.99,1577.01 328.298,1543.82 330.606,1448.2 332.914,1594.14 335.221,1438.47 337.529,1484.13 339.837,1325.5 342.145,1638.73 344.453,1425.42 346.761,1514.03 349.069,1374.56 351.377,1485.25 353.685,1580.64 355.993,1524.17 358.301,1579.23 360.608,1519.87 362.916,1341.27 365.224,1582.8 367.532,1397.33 369.84,1531.9 372.148,1437.39 374.456,1435.79 376.764,1515.49 379.072,1551.52 381.38,1447.24 383.688,1344.71 385.996,1391.87 388.303,1494.43 390.611,1496.5 392.919,1627.1 395.227,1453.29 397.535,1621.31 399.843,1488.4 402.151,1601.25 404.459,1599.26 406.767,1496.27 409.075,1465.43 411.383,1365.37 413.69,1292.5 415.998,1518.79 418.306,1497.11 420.614,1575.05 422.922,1584.52 425.23,1326.59 427.538,1505.65 429.846,1504.83 432.154,1498.19 434.462,1440.24 436.77,1447.24 439.077,1492.68 441.385,1448.12 443.693,1492.26 446.001,1461.09 448.309,1548.79 450.617,1476.85 452.925,1570.97 455.233,1535.95 457.541,1449.58 459.849,1398.86 462.157,1474.92 464.465,1424.26 466.772,1523.23 469.08,1512.49 471.388,1513.96 473.696,1379.62 476.004,1416.33 478.312,1470.39 480.62,1538.4 482.928,1650.1 485.236,1549.34 487.544,1367.44 489.852,1271.41 492.159,1447.18 494.467,1388.89 496.775,1435.09 499.083,1393.45 501.391,1448.65 503.699,1485.98 506.007,1467.07 508.315,1564.84 510.623,1401.68 512.931,1355.8 515.239,1490.72 517.546,1414.5 519.854,1472.12 522.162,1417.81 524.47,1417.74 526.778,1379.79 529.086,1586.33 531.394,1521.9 533.702,1228.93 536.01,1586.29 538.318,1528.74 540.626,1375.54 542.933,1403.86 545.241,1439.09 547.549,1367.82 549.857,1500.57 552.165,1503.08 554.473,1363.73 556.781,1517.29 559.089,1405.2 561.397,1546.99 563.705,1480.36 566.013,1625.56 568.321,1542.56 570.628,1359.24 572.936,1453.92 575.244,1485.45 577.552,1475.42 579.86,1490.87 582.168,1422.55 584.476,1465.63 586.784,1592.6 589.092,1412.58 591.4,1421.54 593.708,1326.04 596.015,1485.79 598.323,1586.39 600.631,1442.33 602.939,1386.4 605.247,1402.55 607.555,1472.46 609.863,1360.22 612.171,1628.83 614.479,1328.1 616.787,1515.46 619.095,1436.64 621.402,1444.38 623.71,1427.85 626.018,1650.25 628.326,1402.45 630.634,1390.79 632.942,1544.64 635.25,1416.7 637.558,1333.97 639.866,1448.9 642.174,1663.65 644.482,1490.18 646.79,1468.8 649.097,1459.68 651.405,1433.42 653.713,1514.07 656.021,1463.84 658.329,1418.86 660.637,1437.9 662.945,1296.04 665.253,1368.25 667.561,1370.93 669.869,1567.03 672.177,1516.43 674.484,1529.47 676.792,1477.79 679.1,1287.55 681.408,1409.5 683.716,1425.41 686.024,1400.91 688.332,1548.74 690.64,1215.82 692.948,1452.7 695.256,1368.84 697.564,1474.41 699.871,1407 702.179,1542 704.487,1451.13 706.795,1443.81 709.103,1578.38 711.411,1566.49 713.719,1497.32 716.027,1352.15 718.335,1554.3 720.643,1364.14 722.951,1612.77 725.259,1387.42 727.566,1464.81 729.874,1546.16 732.182,1346.88 734.49,1466.58 736.798,1616.44 739.106,1608.76 741.414,1525.89 743.722,1462.45 746.03,1697.04 748.338,1505.61 750.646,1380.29 752.953,1468.67 755.261,1551.94 757.569,1532 759.877,1509.31 762.185,1523.49 764.493,1417.36 766.801,1447.7 769.109,1638.91 771.417,1355.81 773.725,1474.53 776.033,1327.05 778.34,1540.21 780.648,1425.37 782.956,1290.49 785.264,1349.26 787.572,1388.74 789.88,1380.56 792.188,1562.74 794.496,1513.37 796.804,1273.64 799.112,1424.97 801.42,1652.16 803.728,1460.3 806.035,1465.1 808.343,1394.48 810.651,1482.57 812.959,1423.42 815.267,1349.28 817.575,1364.14 819.883,1626.05 822.191,1554.83 824.499,1570.33 826.807,1341.79 829.115,1551.78 831.422,1508.09 833.73,1571.31 836.038,1485.95 838.346,1476.82 840.654,1504.4 842.962,1528.05 845.27,1467.14 847.578,1259.65 849.886,1686.92 852.194,1370.67 854.502,1186.95 856.809,1395.71 859.117,1420.69 861.425,1628.98 863.733,1583.27 866.041,1496.25 868.349,1561.18 870.657,1560.89 872.965,1466.96 875.273,1371.46 877.581,1288.28 879.889,1270.69 882.197,1464.58 884.504,1506.78 886.812,1481.99 889.12,1590.43 891.428,1543.07 893.736,1421.65 896.044,1399.3 898.352,1666.74 900.66,1445.3 902.968,1431.35 905.276,1356.99 907.584,1531.14 909.891,1493.65 912.199,1394.92 914.507,1601.68 916.815,1600.14 919.123,1470.72 921.431,1423.76 923.739,1252.23 926.047,1399.97 928.355,1516.09 930.663,1356.26 932.971,1441.66 935.278,1410.76 937.586,1509.76 939.894,1414.04 942.202,1619.22 944.51,1428.61 946.818,1465.05 949.126,1551.92 951.434,1334.91 953.742,1406.88 956.05,1556.21 958.358,1527.76 960.665,1458.1 962.973,1502.77 965.281,1411.09 967.589,1627.55 969.897,1513.99 972.205,1497.19 974.513,1464.97 976.821,1369.97 979.129,1499.67 981.437,1279.66 983.745,1539.96 986.053,1520.6 988.36,1442.32 990.668,1319.33 992.976,1328.43 995.284,1406.07 997.592,1397.68 999.9,1463.33 1002.21,1432.27 1004.52,1591.55 1006.82,1589.3 1009.13,1520.07 1011.44,1442.23 1013.75,1519.23 1016.06,1550.02 1018.36,1422.79 1020.67,1462.01 1022.98,1618.34 1025.29,1635.04 1027.59,1421.16 1029.9,1534.7 1032.21,1368.76 1034.52,1478.87 1036.83,1483.83 1039.13,1503.97 1041.44,1535.84 1043.75,1568.15 1046.06,1480.67 1048.37,1524.3 1050.67,1515.74 1052.98,1444.07 1055.29,1467.94 1057.6,1513.99 1059.91,1594.82 1062.21,1455.61 1064.52,1479.61 1066.83,1582.06 1069.14,1350.94 1071.45,1526.63 1073.75,1603.74 1076.06,1397.5 1078.37,1367.63 1080.68,1403.86 1082.98,1473.43 1085.29,1633.5 1087.6,1470.57 1089.91,1415.95 1092.22,1539.96 1094.52,1411.23 1096.83,1485.77 1099.14,1578.69 1101.45,1551.05 1103.76,1530.89 1106.06,1517 1108.37,1581.99 1110.68,1517.97 1112.99,1665.91 1115.3,1536.5 1117.6,1751.15 1119.91,1496.85 1122.22,1432.9 1124.53,1508 1126.84,1351.71 1129.14,1487.66 1131.45,1382.35 1133.76,1528.96 1136.07,1470.76 1138.37,1452.49 1140.68,1406.28 1142.99,1439.74 1145.3,1426.28 1147.61,1299.92 1149.91,1405.08 1152.22,1202.52 1154.53,1364.81 1156.84,1416.08 1159.15,1425.79 1161.45,1316.75 1163.76,1398.09 1166.07,1465.08 1168.38,1539.37 1170.69,1434.5 1172.99,1414.31 1175.3,1372.83 1177.61,1472.58 1179.92,1472.98 1182.23,1456.73 1184.53,1697.29 1186.84,1282.56 1189.15,1393.21 1191.46,1545.65 1193.76,1345.61 1196.07,1440.54 1198.38,1425.53 1200.69,1460.51 1203,1501.51 1205.3,1627 1207.61,1421.1 1209.92,1523.77 1212.23,1537.52 1214.54,1527.2 1216.84,1457.97 1219.15,1441.62 1221.46,1554.74 1223.77,1465.22 1226.08,1382.66 1228.38,1459.64 1230.69,1405.13 1233,1315.36 1235.31,1431.08 1237.61,1450.79 1239.92,1417.82 1242.23,1420.91 1244.54,1260.78 1246.85,1361.13 1249.15,1615.01 1251.46,1468.51 1253.77,1454.09 1256.08,1642.75 1258.39,1366.37 1260.69,1495.1 1263,1531.49 1265.31,1456.63 1267.62,1511.08 1269.93,1467.79 1272.23,1374.37 1274.54,1361.04 1276.85,1392.98 1279.16,1495.11 1281.47,1426.28 1283.77,1532.82 1286.08,1467.31 1288.39,1506.84 1290.7,1433.64 1293,1508.16 1295.31,1427.54 1297.62,1537.39 1299.93,1504.24 1302.24,1410.2 1304.54,1562.63 1306.85,1411.22 1309.16,1329.28 1311.47,1460.04 1313.78,1515.27 1316.08,1492.44 1318.39,1602.25 1320.7,1713.39 1323.01,1591.11 1325.32,1344.42 1327.62,1524.73 1329.93,1466 1332.24,1344.09 1334.55,1273.59 1336.86,1341.37 1339.16,1580.21 1341.47,1610.23 1343.78,1457.18 1346.09,1253.07 1348.39,1465.35 1350.7,1389.71 1353.01,1536.57 1355.32,1366.88 1357.63,1599.1 1359.93,1476.32 1362.24,1454.99 1364.55,1496.59 1366.86,1649.73 1369.17,1344.42 1371.47,1491.68 1373.78,1404.14 1376.09,1335.47 1378.4,1523.55 1380.71,1647.69 1383.01,1409.26 1385.32,1466.98 1387.63,1654.29 1389.94,1507.31 1392.24,1437.16 1394.55,1490.88 1396.86,1499.49 1399.17,1431.39 1401.48,1531.84 1403.78,1566.13 1406.09,1351.1 1408.4,1518.9 1410.71,1308.59 1413.02,1482.57 1415.32,1521.46 1417.63,1338.87 1419.94,1439.05 1422.25,1355.21 1424.56,1306.01 1426.86,1534.19 1429.17,1554.42 1431.48,1321.49 1433.79,1477.99 1436.1,1471.98 1438.4,1550.96 1440.71,1434.49 1443.02,1568.78 1445.33,1501.36 1447.63,1289.28 1449.94,1474.41 1452.25,1658.8 1454.56,1224.6 1456.87,1512.01 1459.17,1413.22 1461.48,1218.79 1463.79,1455.94 1466.1,1415.69 1468.41,1468.7 1470.71,1484.57 1473.02,1302.75 1475.33,1512.17 1477.64,1597.36 1479.95,1408.28 1482.25,1400.93 1484.56,1378.72 1486.87,1542.6 1489.18,1540.96 1491.49,1723.51 1493.79,1623.48 1496.1,1423.12 1498.41,1347.04 1500.72,1313.24 1503.02,1521.93 1505.33,1546.01 1507.64,1578.04 1509.95,1641.49 1512.26,1527.31 1514.56,1566.34 1516.87,1415.67 1519.18,1400.4 1521.49,1332.76 1523.8,1321.43 1526.1,1447.53 1528.41,1547.54 1530.72,1520.81 1533.03,1200.77 1535.34,1468.2 1537.64,1516.96 1539.95,1575.21 1542.26,1620.91 1544.57,1418.97 1546.88,1340.4 1549.18,1269.11 1551.49,1373.17 1553.8,1420.08 1556.11,1435.81 1558.41,1521.2 1560.72,1515.47 1563.03,1474.08 1565.34,1299.16 1567.65,1549.3 1569.95,1350.51 1572.26,1454.85 1574.57,1670.65 1576.88,1399.66 1579.19,1350.45 1581.49,1268.98 1583.8,1472.11 1586.11,1436.35 1588.42,1513.67 1590.73,1468.24 1593.03,1636.04 1595.34,1368.76 1597.65,1446.14 1599.96,1420.14 1602.26,1549.95 1604.57,1345.25 1606.88,1478.65 1609.19,1323.94 1611.5,1448.51 1613.8,1344.61 1616.11,1578.59 1618.42,1400.97 1620.73,1499.9 1623.04,1368.83 1625.34,1295.53 1627.65,1618.33 1629.96,1476.97 1632.27,1636.03 1634.58,1654.93 1636.88,1323.69 1639.19,1612.19 1641.5,1428.69 1643.81,1390.07 1646.12,1556.71 1648.42,1456.48 1650.73,1681.32 1653.04,1463.91 1655.35,1563.09 1657.65,1491.85 1659.96,1432.49 1662.27,1361.99 1664.58,1395.57 1666.89,1533.46 1669.19,1454.85 1671.5,1464.07 1673.81,1323.54 1676.12,1412.61 1678.43,1577.33 1680.73,1408.79 1683.04,1427.3 1685.35,1387.87 1687.66,1511.78 1689.97,1413.83 1692.27,1520.19 1694.58,1292.22 1696.89,1471.37 1699.2,1402.14 1701.51,1395.87 1703.81,1414.32 1706.12,1379.32 1708.43,1595.03 1710.74,1435.73 1713.04,1498.36 1715.35,1519.18 1717.66,1715.66 1719.97,1388.28 1722.28,1457.78 1724.58,1442.85 1726.89,1273.72 1729.2,1419.97 1731.51,1440.06 1733.82,1411.12 1736.12,1468.11 1738.43,1521.76 1740.74,1281.31 1743.05,1343.3 1745.36,1414.63 1747.66,1598.89 1749.97,1372.73 1752.28,1362.98 1754.59,1376.03 1756.9,1293.05 1759.2,1571.41 1761.51,1517.53 1763.82,1539.12 1766.13,1421.38 1768.43,1366.19 1770.74,1726.02 1773.05,1494.27 1775.36,1375.58 1777.67,1377.71 1779.97,1512.99 1782.28,1532.12 1784.59,1631.06 1786.9,1379.29 1789.21,1470.29 1791.51,1337.51 1793.82,1654.03 1796.13,1406.38 1798.44,1709.51 1800.75,1355.54 1803.05,1213.15 1805.36,1453.6 1807.67,1614.09 1809.98,1629.53 1812.28,1555.26 1814.59,1450.7 1816.9,1584.78 1819.21,1452.47 1821.52,1438.61 1823.82,1257.93 1826.13,1398.23 1828.44,1462.33 1830.75,1359.81 1833.06,1381.46 1835.36,1591.42 1837.67,1552.21 1839.98,1473.53 1842.29,1513.07 1844.6,1322.15 1846.9,1471.21 1849.21,1529.07 1851.52,1455.04 1853.83,1563.84 1856.14,1508.32 1858.44,1493.79 1860.75,1329.89 1863.06,1436.44 1865.37,1420.94 1867.67,1285.22 1869.98,1437.34 1872.29,1530.42 1874.6,1492.15 1876.91,1484.25 1879.21,1525.33 1881.52,1640.42 1883.83,1510.96 1886.14,1567.08 1888.45,1565.81 1890.75,1270.76 1893.06,1603.73 1895.37,1299.7 1897.68,1573.91 1899.99,1460.97 1902.29,1350.77 1904.6,1352.4 1906.91,1578.5 1909.22,1659.36 1911.53,1488.9 1913.83,1229.12 1916.14,1553.44 1918.45,1410.83 1920.76,1392.38 1923.06,1368.41 1925.37,1232.58 1927.68,1397 1929.99,1219.62 1932.3,1308.55 1934.6,1558.32 1936.91,1524.49 1939.22,1585.67 1941.53,1628.36 1943.84,1502.47 1946.14,1387.75 1948.45,1365.93 1950.76,1583.98 1953.07,1575.61 1955.38,1604.88 1957.68,1566.51 1959.99,1503.82 1962.3,1435.87 1964.61,1292.22 1966.91,1403.87 1969.22,1489.09 1971.53,1676.35 1973.84,1513.88 1976.15,1632.68 1978.45,1597.58 1980.76,1508.1 1983.07,1520.88 1985.38,1513.72 1987.69,1622.59 1989.99,1596.23 1992.3,1450.06 1994.61,1429.39 1996.92,1205.12 1999.23,1632.63 2001.53,1550.19 2003.84,1565.02 2006.15,1548.49 2008.46,1232.24 2010.77,1633.52 2013.07,1502.34 2015.38,1398.37 2017.69,1455.14 2020,1601.53 2022.3,1496.93 2024.61,1349.07 2026.92,1588.09 2029.23,1473.1 2031.54,1528.42 2033.84,1549.73 2036.15,1682.69 2038.46,1499.82 2040.77,1428.63 2043.08,1374.53 2045.38,1314.73 2047.69,1452.15 2050,1503.49 2052.31,1392.47 2054.62,1500.29 2056.92,1509.18 2059.23,1511.3 2061.54,1272.85 2063.85,1563 2066.16,1450.95 2068.46,1355.54 2070.77,1599.43 2073.08,1566.98 2075.39,1642.8 2077.69,1317.28 2080,1394.55 2082.31,1435.93 2084.62,1466.01 2086.93,1482.61 2089.23,1531.25 2091.54,1478.42 2093.85,1479.22 2096.16,1571.95 2098.47,1460.78 2100.77,1493.69 2103.08,1554.67 2105.39,1526.04 2107.7,1559.12 2110.01,1323.34 2112.31,1412.51 2114.62,1472.23 2116.93,1438.11 2119.24,1613.83 2121.55,1693.44 2123.85,1597.54 2126.16,1689.9 2128.47,1388.2 2130.78,1505.04 2133.08,1407.07 2135.39,1598.47 2137.7,1493.53 2140.01,1361.54 2142.32,1577.13 2144.62,1395.29 2146.93,1377.24 2149.24,1676.46 2151.55,1552.98 2153.86,1628.58 2156.16,1628.39 2158.47,1356.45 2160.78,1308.79 2163.09,1543.3 2165.4,1613.3 2167.7,1402.45 2170.01,1419.51 2172.32,1363.53 2174.63,1520.9 2176.93,1342.8 2179.24,1531.23 2181.55,1366.22 2183.86,1352.59 2186.17,1495.41 2188.47,1619.47 2190.78,1310.98 2193.09,1580.95 2195.4,1556.68 2197.71,1695.17 2200.01,1250.38 2202.32,1348.61 2204.63,1565.87 2206.94,1594.55 2209.25,1497.72 2211.55,1476.43 2213.86,1343.12 2216.17,1483.01 2218.48,1573.07 2220.79,1364.56 2223.09,1333.16 2225.4,1606.48 2227.71,1531.81 2230.02,1572.46 2232.32,1409.48 2234.63,1423.79 2236.94,1564.17 2239.25,1528.74 2241.56,1404.21 2243.86,1606.38 2246.17,1534.39 2248.48,1480.64 2250.79,1576.44 2253.1,1470.54 2255.4,1547.55 2257.71,1446.16 2260.02,1476.84 2262.33,1463.71 2264.64,1555.21 2266.94,1393.96 2269.25,1599.52 2271.56,1416.29 2273.87,1477.13 2276.18,1421.34 2278.48,1491.68 2280.79,1461.11 2283.1,1505.08 2285.41,1580.98 2287.71,1363.91 2290.02,1458.65 2292.33,1537.12 2294.64,1418.61 2296.95,1442.21 2299.25,1356.72 2301.56,1374.07 2303.87,1507.89 2306.18,1536.61 2308.49,1483.57 2310.79,1435.2 2313.1,1401.1 2315.41,1365.67 2317.72,1194.4 2320.03,1551.13 2322.33,1532.88 2324.64,1528.49 2326.95,1514.88 2329.26,1506.33 2331.56,1566.53 2333.87,1573.7 2336.18,1446.99 2338.49,1419.67 2340.8,1482.41 2343.1,1508.89 2345.41,1490.86 2347.72,1564 2350.03,1560.09 2352.34,1356.68 2354.64,1601.95 2356.95,1491.94 2359.26,1529.59 2361.57,1464.88 2363.88,1569.13 2366.18,1607.91 2368.49,1307.57 2370.8,1632.55 2373.11,1477.93 2375.42,1519.44 2377.72,1494.18 2380.03,1490.89 2382.34,1569.62 2384.65,1519.49 2386.95,1509.6 2389.26,1646.78 2391.57,1510.46 2393.88,1509.63 2396.19,1575.21 2398.49,1409.36 2400.8,1315.26 2403.11,1476.9 2405.42,1441.76 2407.73,1372.99 2410.03,1550.4 2412.34,1299.82 2414.65,1424.66 2416.96,1420.26 2419.27,1475.29 2421.57,1442.81 2423.88,1331.76 2426.19,1539.73 2428.5,1549.8 2430.81,1455.81 2433.11,1415.38 2435.42,1725.02 2437.73,1296.49 2440.04,1479.71 2442.34,1540.63 2444.65,1399.38 2446.96,1535.23 2449.27,1511.45 2451.58,1356.13 2453.88,1437.24 2456.19,1535.97 2458.5,1444.32 2460.81,1560.05 2463.12,1403.93 2465.42,1475.65 2467.73,1428.33 2470.04,1330.61 2472.35,1505.99 2474.66,1639.02 2476.96,1541.18 2479.27,1470.3 2481.58,1407.03 2483.89,1567.08 2486.2,1451.59 2488.5,1460.1 2490.81,1440.99 2493.12,1437.86 2495.43,1315.27 2497.73,1639.63 2500.04,1381.39 2502.35,1472.73 2504.66,1366.88 2506.97,1517.47 2509.27,1459.31 2511.58,1528.37 2513.89,1364.54 2516.2,1552.71 2518.51,1476.31 2520.81,1586.82 2523.12,1525.12 2525.43,1506.5 2527.74,1475.59 2530.05,1423.44 2532.35,1489.76 2534.66,1466.94 2536.97,1455.4 2539.28,1615.92 2541.58,1718.54 2543.89,1523.74 2546.2,1710.01 2548.51,1432.04 2550.82,1572.6 2553.12,1490.45 2555.43,1450.88 2557.74,1391.29 2560.05,1227.98 2562.36,1525.54 2564.66,1504.96 2566.97,1537.09 2569.28,1532.29 2571.59,1388.06 "></polyline>
<polyline clip-path="url(#clip112)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,932.717 268.292,848.515 270.6,1014.55 272.908,980.232 275.216,1028.45 277.524,993.306 279.832,959.279 282.139,908.32 284.447,1052.21 286.755,998.636 289.063,896.021 291.371,857.002 293.679,1119.57 295.987,1074.54 298.295,910.257 300.603,893.507 302.911,948.189 305.219,1041.35 307.527,1013.94 309.834,971.529 312.142,891.725 314.45,916.437 316.758,951.65 319.066,994.074 321.374,886.214 323.682,973.707 325.99,846.913 328.298,865.473 330.606,950.762 332.914,902.351 335.221,961.778 337.529,920.762 339.837,1014.14 342.145,1009.43 344.453,920.725 346.761,983.065 349.069,1036.16 351.377,898.14 353.685,746.923 355.993,913.642 358.301,931.803 360.608,952.159 362.916,916.373 365.224,1016.1 367.532,1156.5 369.84,947.969 372.148,992.267 374.456,960.671 376.764,913.829 379.072,1094.16 381.38,818.606 383.688,875.279 385.996,941.843 388.303,986.617 390.611,1122.69 392.919,989.59 395.227,983.577 397.535,764.054 399.843,1018.86 402.151,934.765 404.459,904.47 406.767,1035.84 409.075,973.935 411.383,1049.22 413.69,1051.17 415.998,880.273 418.306,871.191 420.614,881.833 422.922,965.393 425.23,806.28 427.538,851.466 429.846,1017.92 432.154,1153.78 434.462,1066.8 436.77,850.765 439.077,1021.53 441.385,1047.89 443.693,970.867 446.001,981.979 448.309,854.571 450.617,874.696 452.925,946.878 455.233,812.953 457.541,906.501 459.849,972.601 462.157,1033.35 464.465,1205.45 466.772,906.692 469.08,870.128 471.388,961.552 473.696,1009.13 476.004,849.971 478.312,977.948 480.62,846.358 482.928,837.219 485.236,1161.19 487.544,894.611 489.852,1075.26 492.159,990.516 494.467,869.415 496.775,959.665 499.083,998.527 501.391,924.115 503.699,950.746 506.007,914.323 508.315,762.023 510.623,928.691 512.931,1004.55 515.239,943.979 517.546,742.215 519.854,1010.59 522.162,1049.75 524.47,959.613 526.778,1038.35 529.086,892.788 531.394,804.838 533.702,1093.7 536.01,760.318 538.318,1079.38 540.626,1028.87 542.933,921.102 545.241,944.601 547.549,924.483 549.857,959.448 552.165,820.457 554.473,1076.96 556.781,1065.71 559.089,945.549 561.397,928.596 563.705,975.061 566.013,901.816 568.321,891.502 570.628,1123.48 572.936,986.423 575.244,992.915 577.552,878.614 579.86,866.588 582.168,966.742 584.476,823.823 586.784,956.833 589.092,955.318 591.4,935.21 593.708,1121.12 596.015,939.271 598.323,836.101 600.631,1043.2 602.939,894.324 605.247,861.833 607.555,1038.86 609.863,901.305 612.171,1131.27 614.479,914.127 616.787,1048.1 619.095,1050.21 621.402,741.912 623.71,826.949 626.018,1006.87 628.326,973.735 630.634,773.964 632.942,1056.12 635.25,930.742 637.558,962.301 639.866,1094.37 642.174,859.478 644.482,984.963 646.79,1113.53 649.097,1069.98 651.405,919.02 653.713,1174.59 656.021,875.074 658.329,836.169 660.637,964.775 662.945,1011.53 665.253,971.468 667.561,937.782 669.869,906.076 672.177,945.867 674.484,920.122 676.792,814.445 679.1,928.578 681.408,947.003 683.716,862.573 686.024,1003.41 688.332,1005.88 690.64,995.809 692.948,965.181 695.256,852.41 697.564,1045.62 699.871,1047.83 702.179,1021.5 704.487,771.068 706.795,1107.84 709.103,911.908 711.411,875.629 713.719,991.278 716.027,841.766 718.335,1140.5 720.643,1015.38 722.951,1047.74 725.259,917.922 727.566,877.109 729.874,986.305 732.182,777.644 734.49,883.742 736.798,901.892 739.106,930.449 741.414,1018.98 743.722,1013.43 746.03,811.723 748.338,977.607 750.646,1046.11 752.953,907.036 755.261,954.013 757.569,918.547 759.877,1065.15 762.185,924.607 764.493,1115.04 766.801,927.459 769.109,735.89 771.417,1067.79 773.725,1139.52 776.033,873.372 778.34,923.154 780.648,1038.85 782.956,1075.66 785.264,963.201 787.572,889.51 789.88,947.974 792.188,934.095 794.496,1021.21 796.804,968.708 799.112,923.634 801.42,813.823 803.728,1118.55 806.035,980.504 808.343,1047.7 810.651,792.692 812.959,1075.84 815.267,1000.46 817.575,1072.27 819.883,1212.85 822.191,932.773 824.499,1079.25 826.807,912.356 829.115,1030.95 831.422,922.936 833.73,1132.9 836.038,860.979 838.346,1125.86 840.654,990.7 842.962,1019.26 845.27,1016.75 847.578,992.186 849.886,1144.98 852.194,979.133 854.502,1041.13 856.809,851.955 859.117,1007.7 861.425,893.266 863.733,1107.2 866.041,1125.19 868.349,971.118 870.657,891.243 872.965,1031.02 875.273,1257.85 877.581,1099.03 879.889,968.773 882.197,1054.19 884.504,1052.6 886.812,806.102 889.12,932.655 891.428,1094.2 893.736,1017.39 896.044,781.901 898.352,1087.45 900.66,963.972 902.968,979.159 905.276,990.714 907.584,1092.39 909.891,893.532 912.199,938.261 914.507,827.119 916.815,1087.75 919.123,940.593 921.431,892.71 923.739,1017.76 926.047,917.052 928.355,931.52 930.663,1012.49 932.971,1182.71 935.278,1099.72 937.586,1037.79 939.894,948.881 942.202,1056.44 944.51,1084.62 946.818,1020.38 949.126,1065.37 951.434,939.483 953.742,934.331 956.05,1288.05 958.358,1032.59 960.665,1057.25 962.973,976.074 965.281,939.552 967.589,984.418 969.897,910.476 972.205,871.92 974.513,883.85 976.821,944.455 979.129,1011.63 981.437,786.801 983.745,1034.66 986.053,957.22 988.36,1033.65 990.668,942.753 992.976,1071.45 995.284,1012.31 997.592,970.76 999.9,981.853 1002.21,872.127 1004.52,944.556 1006.82,946.805 1009.13,860.282 1011.44,1065.37 1013.75,993.646 1016.06,922.694 1018.36,1057.43 1020.67,786.43 1022.98,952.704 1025.29,977.214 1027.59,815.393 1029.9,1048.6 1032.21,1105.66 1034.52,895.673 1036.83,918.479 1039.13,864.257 1041.44,1017.41 1043.75,1090.04 1046.06,998.404 1048.37,1053.07 1050.67,871.174 1052.98,954.638 1055.29,990.925 1057.6,927.887 1059.91,1085.12 1062.21,823.69 1064.52,1093.35 1066.83,852.467 1069.14,962.309 1071.45,869.393 1073.75,1072.03 1076.06,943.203 1078.37,872.367 1080.68,922.145 1082.98,1045.98 1085.29,928.214 1087.6,992.93 1089.91,1040.98 1092.22,1020.43 1094.52,913.685 1096.83,883.406 1099.14,951.872 1101.45,1042.69 1103.76,856.384 1106.06,1053.36 1108.37,913.881 1110.68,1017 1112.99,1067.79 1115.3,1018.84 1117.6,828.266 1119.91,1035.08 1122.22,927.998 1124.53,885.58 1126.84,762.444 1129.14,1096.52 1131.45,784.391 1133.76,1016.07 1136.07,936.725 1138.37,765.461 1140.68,945.247 1142.99,942.484 1145.3,796.881 1147.61,1092.79 1149.91,1153.16 1152.22,916.871 1154.53,971.163 1156.84,981.415 1159.15,615.497 1161.45,963.779 1163.76,1032.61 1166.07,1064.24 1168.38,896.154 1170.69,1032.23 1172.99,821.587 1175.3,660.35 1177.61,740.225 1179.92,1084.54 1182.23,921.479 1184.53,1136.8 1186.84,938.478 1189.15,1012.29 1191.46,996.991 1193.76,1075.83 1196.07,1007.69 1198.38,932.132 1200.69,881.275 1203,998.97 1205.3,909.489 1207.61,1122.43 1209.92,901.524 1212.23,843.378 1214.54,866.291 1216.84,963.186 1219.15,884.209 1221.46,1107.29 1223.77,969.788 1226.08,1008.42 1228.38,976.769 1230.69,1008.83 1233,730.923 1235.31,924.144 1237.61,969.308 1239.92,855.919 1242.23,826.126 1244.54,1016.48 1246.85,915.502 1249.15,1025.92 1251.46,790.801 1253.77,1093.15 1256.08,1047.64 1258.39,1110.89 1260.69,957.062 1263,996.249 1265.31,1079.46 1267.62,973.526 1269.93,1070.74 1272.23,1066.45 1274.54,779.21 1276.85,894.423 1279.16,1073.9 1281.47,1039.78 1283.77,882.697 1286.08,924.114 1288.39,961.242 1290.7,1162.19 1293,854.026 1295.31,891.553 1297.62,945.549 1299.93,1048.77 1302.24,998.563 1304.54,1184.55 1306.85,903.123 1309.16,1106.11 1311.47,921.218 1313.78,1057.55 1316.08,986.608 1318.39,908.373 1320.7,796.175 1323.01,973.338 1325.32,836.577 1327.62,1046.6 1329.93,975.278 1332.24,963.137 1334.55,909.224 1336.86,937.176 1339.16,922.939 1341.47,1069.67 1343.78,1010.03 1346.09,949.747 1348.39,1046.16 1350.7,960.142 1353.01,908.714 1355.32,904.475 1357.63,933.135 1359.93,809.827 1362.24,985.617 1364.55,1102.67 1366.86,901.241 1369.17,1075.79 1371.47,1083.89 1373.78,1010.89 1376.09,1005.32 1378.4,1154.95 1380.71,948.353 1383.01,1116.04 1385.32,898.581 1387.63,898.196 1389.94,789.848 1392.24,1014.83 1394.55,1000.37 1396.86,965.391 1399.17,948.364 1401.48,1060.56 1403.78,1024.66 1406.09,976.164 1408.4,1005.55 1410.71,1093.24 1413.02,1006.86 1415.32,995.424 1417.63,966.573 1419.94,1027.71 1422.25,862.038 1424.56,1033.84 1426.86,859.265 1429.17,934.679 1431.48,937.108 1433.79,1034.29 1436.1,1035.46 1438.4,1200.46 1440.71,864.71 1443.02,1010.34 1445.33,892.378 1447.63,1206.3 1449.94,1015.46 1452.25,950.816 1454.56,897.789 1456.87,924.53 1459.17,964.208 1461.48,1094.04 1463.79,1127.73 1466.1,976.407 1468.41,843.418 1470.71,1035.87 1473.02,938.11 1475.33,811.868 1477.64,985.428 1479.95,1097.74 1482.25,903.786 1484.56,976.244 1486.87,888.128 1489.18,914.592 1491.49,880.032 1493.79,898.054 1496.1,1078.6 1498.41,950.472 1500.72,1085.77 1503.02,768.324 1505.33,835.146 1507.64,1147.44 1509.95,930.632 1512.26,1042.29 1514.56,1012.91 1516.87,1174.1 1519.18,899.964 1521.49,914.067 1523.8,996.175 1526.1,802.584 1528.41,1018.67 1530.72,1020.19 1533.03,1129.35 1535.34,966.802 1537.64,1046.68 1539.95,1065.73 1542.26,992.733 1544.57,1213.92 1546.88,914.09 1549.18,981.058 1551.49,1038.99 1553.8,876.268 1556.11,911.563 1558.41,1068.71 1560.72,917.783 1563.03,1019 1565.34,945.239 1567.65,878.133 1569.95,1006.97 1572.26,1074.4 1574.57,1076.31 1576.88,850.018 1579.19,827.851 1581.49,968.246 1583.8,975.718 1586.11,885.609 1588.42,1035.2 1590.73,887.631 1593.03,988.634 1595.34,1045.15 1597.65,979.22 1599.96,924.973 1602.26,930.299 1604.57,933.798 1606.88,971.893 1609.19,990.229 1611.5,795.611 1613.8,753.207 1616.11,842.701 1618.42,977.808 1620.73,898.774 1623.04,1036.63 1625.34,922.333 1627.65,929.655 1629.96,968.13 1632.27,923.385 1634.58,879.463 1636.88,833.302 1639.19,1048.6 1641.5,973.856 1643.81,1026.8 1646.12,908.123 1648.42,784.341 1650.73,1112.19 1653.04,897.512 1655.35,836.587 1657.65,853.14 1659.96,805.09 1662.27,1130.72 1664.58,1089.59 1666.89,912.831 1669.19,907.234 1671.5,944.52 1673.81,936.706 1676.12,946.438 1678.43,826.611 1680.73,929.259 1683.04,1051.12 1685.35,1006.46 1687.66,891.056 1689.97,1079.47 1692.27,1072.88 1694.58,998.101 1696.89,999.055 1699.2,1063.02 1701.51,851.056 1703.81,1045.14 1706.12,1109.37 1708.43,857.906 1710.74,1074.6 1713.04,884.261 1715.35,884.181 1717.66,858.038 1719.97,1096.61 1722.28,1065.66 1724.58,864.645 1726.89,1077.51 1729.2,967.675 1731.51,996.828 1733.82,920.209 1736.12,894.496 1738.43,961.027 1740.74,1052.04 1743.05,830.043 1745.36,1115.44 1747.66,838.289 1749.97,1075.54 1752.28,893.602 1754.59,1072.94 1756.9,1026.64 1759.2,960.715 1761.51,1004.84 1763.82,989.166 1766.13,1019.31 1768.43,916.781 1770.74,781.446 1773.05,1199.25 1775.36,1058.38 1777.67,994.814 1779.97,912.021 1782.28,1105.76 1784.59,893.276 1786.9,968.786 1789.21,887.828 1791.51,991.659 1793.82,1129.15 1796.13,1022.2 1798.44,847.346 1800.75,826.055 1803.05,995.476 1805.36,1098.52 1807.67,999.312 1809.98,997.888 1812.28,955.68 1814.59,972.674 1816.9,1013.12 1819.21,871.503 1821.52,972.886 1823.82,1132.73 1826.13,1037.49 1828.44,1125.6 1830.75,970.373 1833.06,937.606 1835.36,883.644 1837.67,800.841 1839.98,986.794 1842.29,1030.86 1844.6,966.3 1846.9,1032.93 1849.21,1026.36 1851.52,919.809 1853.83,896.419 1856.14,1017.53 1858.44,895.03 1860.75,1014.68 1863.06,933.743 1865.37,1084.04 1867.67,1017.67 1869.98,974.554 1872.29,829.81 1874.6,1032.58 1876.91,853.684 1879.21,1004.03 1881.52,945.68 1883.83,775.092 1886.14,935.254 1888.45,930.109 1890.75,1029.02 1893.06,1096.02 1895.37,1208.73 1897.68,1004.45 1899.99,940.235 1902.29,1105.57 1904.6,920.836 1906.91,1102.43 1909.22,1138.12 1911.53,843.102 1913.83,1038.32 1916.14,1012.1 1918.45,878.491 1920.76,1108.64 1923.06,1030.26 1925.37,1050.64 1927.68,828.505 1929.99,1077.53 1932.3,904.003 1934.6,904.249 1936.91,1107.87 1939.22,943.821 1941.53,879.166 1943.84,1033.39 1946.14,908.567 1948.45,897.84 1950.76,833.633 1953.07,1005 1955.38,1032.15 1957.68,877.472 1959.99,958.921 1962.3,967.09 1964.61,1068.06 1966.91,915.352 1969.22,1042.29 1971.53,1017.52 1973.84,931.639 1976.15,1130.01 1978.45,980.216 1980.76,974.59 1983.07,978.562 1985.38,988.401 1987.69,886.511 1989.99,890.835 1992.3,1115.55 1994.61,972.635 1996.92,1096.65 1999.23,987.079 2001.53,985.332 2003.84,835.338 2006.15,1210.05 2008.46,979.616 2010.77,971.948 2013.07,782.917 2015.38,1067.1 2017.69,1074.43 2020,1120.01 2022.3,900.063 2024.61,951.685 2026.92,920.597 2029.23,1174.65 2031.54,1054.31 2033.84,1193.29 2036.15,995.336 2038.46,1037.07 2040.77,936.198 2043.08,1027.08 2045.38,1068.06 2047.69,912.421 2050,1040.91 2052.31,848.085 2054.62,1100.29 2056.92,994.659 2059.23,1089.2 2061.54,864.367 2063.85,1043.41 2066.16,802.481 2068.46,922.49 2070.77,935.064 2073.08,1017.58 2075.39,847.74 2077.69,930.443 2080,882.11 2082.31,939.737 2084.62,1018.93 2086.93,935.395 2089.23,1096.79 2091.54,904.259 2093.85,1000.57 2096.16,853.53 2098.47,859.766 2100.77,842.937 2103.08,938.72 2105.39,957.294 2107.7,915.447 2110.01,1084.11 2112.31,853.29 2114.62,966.882 2116.93,1086.31 2119.24,1012.87 2121.55,879.662 2123.85,795.364 2126.16,914.544 2128.47,886.521 2130.78,789.054 2133.08,1137.34 2135.39,926.747 2137.7,964.876 2140.01,1008.78 2142.32,1142.83 2144.62,798.676 2146.93,1089.99 2149.24,981.655 2151.55,967.153 2153.86,961.538 2156.16,868.667 2158.47,954.217 2160.78,953.558 2163.09,961.928 2165.4,1094.12 2167.7,896.445 2170.01,1100.32 2172.32,1070.01 2174.63,1017.11 2176.93,888.824 2179.24,854.493 2181.55,863.59 2183.86,1110.81 2186.17,897.266 2188.47,1145.01 2190.78,960.852 2193.09,1072.14 2195.4,895.562 2197.71,1117.91 2200.01,1038.52 2202.32,786.466 2204.63,1016.3 2206.94,1122.5 2209.25,895.926 2211.55,781.258 2213.86,910.969 2216.17,1061.3 2218.48,942.254 2220.79,1049.11 2223.09,1204.82 2225.4,823.175 2227.71,1117.56 2230.02,1075.87 2232.32,916.713 2234.63,951.465 2236.94,1020.53 2239.25,854.653 2241.56,883.216 2243.86,1020.66 2246.17,872.429 2248.48,1045.59 2250.79,1077.99 2253.1,913.462 2255.4,1025.82 2257.71,778.206 2260.02,897.65 2262.33,1036.88 2264.64,1031.42 2266.94,984.261 2269.25,1111.93 2271.56,826.897 2273.87,935.718 2276.18,995.633 2278.48,1030.7 2280.79,928.447 2283.1,1021.8 2285.41,930.607 2287.71,895.233 2290.02,994.439 2292.33,985.803 2294.64,795.212 2296.95,879.678 2299.25,1114.64 2301.56,1042.03 2303.87,925.461 2306.18,880.005 2308.49,868.031 2310.79,983.05 2313.1,1062.56 2315.41,985.422 2317.72,846.428 2320.03,976.756 2322.33,1094.19 2324.64,1054.44 2326.95,844.699 2329.26,875.843 2331.56,907.82 2333.87,881.23 2336.18,1151.6 2338.49,1130.76 2340.8,1041.36 2343.1,1002.37 2345.41,1070.4 2347.72,841.432 2350.03,1041.89 2352.34,1040.65 2354.64,1212.56 2356.95,991.456 2359.26,897.501 2361.57,1077.24 2363.88,1052.85 2366.18,1075.07 2368.49,977.258 2370.8,843.134 2373.11,777.829 2375.42,890.968 2377.72,1021.27 2380.03,1036.8 2382.34,956.18 2384.65,1049.67 2386.95,863.936 2389.26,823.82 2391.57,969.966 2393.88,986.365 2396.19,1118.8 2398.49,965.87 2400.8,924.958 2403.11,827.937 2405.42,1112.66 2407.73,842.414 2410.03,1003.66 2412.34,880.598 2414.65,975.065 2416.96,822.22 2419.27,1001.19 2421.57,888.325 2423.88,896.487 2426.19,1120.66 2428.5,1045.91 2430.81,930.623 2433.11,747.872 2435.42,972.859 2437.73,972.401 2440.04,1113.82 2442.34,925.012 2444.65,961.051 2446.96,863.641 2449.27,1033.38 2451.58,1094.36 2453.88,926.329 2456.19,1057.78 2458.5,936.573 2460.81,1221.81 2463.12,1029.71 2465.42,928.236 2467.73,932.921 2470.04,925.269 2472.35,860.365 2474.66,890.896 2476.96,909.074 2479.27,768.32 2481.58,853.931 2483.89,999.265 2486.2,921.634 2488.5,1077.71 2490.81,1017.56 2493.12,928.424 2495.43,1042.42 2497.73,1095.1 2500.04,895.065 2502.35,889.563 2504.66,890.863 2506.97,888.205 2509.27,976.749 2511.58,977.498 2513.89,947.501 2516.2,827.823 2518.51,1055.08 2520.81,1217.57 2523.12,847.683 2525.43,975.436 2527.74,1102.68 2530.05,978.461 2532.35,843.211 2534.66,951.548 2536.97,840.834 2539.28,1137.44 2541.58,879.355 2543.89,1106.66 2546.2,1070.63 2548.51,1033.21 2550.82,1055.16 2553.12,877.055 2555.43,878.363 2557.74,935.026 2560.05,869.18 2562.36,1066.15 2564.66,1080.27 2566.97,898.941 2569.28,896.334 2571.59,1022.92 "></polyline>
<polyline clip-path="url(#clip112)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,602.109 268.292,510.425 270.6,512.953 272.908,684.503 275.216,465.883 277.524,345.536 279.832,273.13 282.139,485.913 284.447,509.534 286.755,433.854 289.063,515.019 291.371,409.44 293.679,412.19 295.987,515.067 298.295,391.898 300.603,490.879 302.911,423.368 305.219,626.629 307.527,454.84 309.834,557.487 312.142,482.224 314.45,490.77 316.758,370.921 319.066,303.599 321.374,425.27 323.682,448.836 325.99,479.758 328.298,572.112 330.606,411.001 332.914,307.103 335.221,626.383 337.529,401.935 339.837,319.715 342.145,283.071 344.453,317.06 346.761,443.902 349.069,600.473 351.377,441.287 353.685,566.519 355.993,482.856 358.301,622.978 360.608,457.39 362.916,431.723 365.224,585.404 367.532,726.078 369.84,461.286 372.148,600.58 374.456,616.161 376.764,440.435 379.072,558.02 381.38,375.543 383.688,534.558 385.996,489.149 388.303,503.307 390.611,435.012 392.919,424.719 395.227,484.653 397.535,319.909 399.843,397.996 402.151,487.874 404.459,613.184 406.767,482.876 409.075,570.859 411.383,597.644 413.69,417.016 415.998,503.771 418.306,423.786 420.614,456.835 422.922,449.068 425.23,565.485 427.538,436.915 429.846,492.157 432.154,250.259 434.462,663.836 436.77,587.49 439.077,424.447 441.385,730.895 443.693,485.795 446.001,422.064 448.309,447.697 450.617,655.842 452.925,476.757 455.233,575.441 457.541,541.599 459.849,500.762 462.157,669.484 464.465,520.819 466.772,534.056 469.08,487.443 471.388,355.697 473.696,467.541 476.004,514.931 478.312,469.569 480.62,628.055 482.928,421.813 485.236,382.713 487.544,669.953 489.852,449.358 492.159,476.931 494.467,615.383 496.775,519.647 499.083,541.937 501.391,556.633 503.699,500.693 506.007,451.825 508.315,542.135 510.623,351.003 512.931,228.937 515.239,621.839 517.546,616.708 519.854,412.319 522.162,264.251 524.47,454.878 526.778,476.378 529.086,435.994 531.394,468.077 533.702,526.254 536.01,404.861 538.318,334.99 540.626,616.107 542.933,509.201 545.241,317.899 547.549,470.726 549.857,600.878 552.165,371.749 554.473,486.05 556.781,438.905 559.089,547.604 561.397,772.023 563.705,456.814 566.013,470.564 568.321,469.623 570.628,447.544 572.936,498.924 575.244,381.473 577.552,422.836 579.86,502.409 582.168,445.793 584.476,426.438 586.784,453.578 589.092,386.168 591.4,440.728 593.708,527.774 596.015,457.729 598.323,475.248 600.631,463.42 602.939,516.3 605.247,414.129 607.555,586.913 609.863,407.067 612.171,450.955 614.479,348.169 616.787,470.975 619.095,562.844 621.402,486.705 623.71,583.425 626.018,530.128 628.326,505.928 630.634,483.621 632.942,422.796 635.25,458.422 637.558,656.761 639.866,495.884 642.174,581.418 644.482,517.476 646.79,455.605 649.097,332.947 651.405,535.897 653.713,435.934 656.021,518.43 658.329,566.594 660.637,410.782 662.945,508.658 665.253,412.685 667.561,411.585 669.869,670.106 672.177,333.081 674.484,654.743 676.792,366.199 679.1,642.614 681.408,349.424 683.716,627.091 686.024,604.642 688.332,519.816 690.64,328.342 692.948,359.608 695.256,575.675 697.564,301.251 699.871,253.871 702.179,429.945 704.487,514.243 706.795,496.314 709.103,576.536 711.411,544.853 713.719,383.34 716.027,363.114 718.335,433.486 720.643,482.171 722.951,492.729 725.259,536.782 727.566,521.498 729.874,407.166 732.182,468.5 734.49,505.178 736.798,478.533 739.106,364.591 741.414,650.784 743.722,396.006 746.03,454.101 748.338,634.352 750.646,557.376 752.953,480.3 755.261,457.343 757.569,588.605 759.877,496.981 762.185,379.157 764.493,608.485 766.801,443.525 769.109,312.173 771.417,399.327 773.725,462.981 776.033,526.679 778.34,486.115 780.648,503.519 782.956,511.426 785.264,575.688 787.572,597.505 789.88,339.797 792.188,519.325 794.496,457.826 796.804,424.919 799.112,507.72 801.42,418.012 803.728,517.821 806.035,324.428 808.343,549.313 810.651,445.251 812.959,333.506 815.267,446.377 817.575,493.094 819.883,570.461 822.191,308.084 824.499,559.387 826.807,632.444 829.115,344.655 831.422,397.688 833.73,461.501 836.038,476.591 838.346,644.871 840.654,525.893 842.962,400.069 845.27,534.447 847.578,536.595 849.886,674.712 852.194,628.953 854.502,529.443 856.809,606.931 859.117,461.153 861.425,409.999 863.733,385.898 866.041,396.37 868.349,380.1 870.657,465.548 872.965,440.542 875.273,417.473 877.581,487.755 879.889,446.348 882.197,560.051 884.504,404.813 886.812,512.843 889.12,601.039 891.428,246.826 893.736,444.557 896.044,456.507 898.352,549.394 900.66,513.57 902.968,563.767 905.276,360.758 907.584,463.945 909.891,566.506 912.199,583.08 914.507,418.048 916.815,393.765 919.123,445.581 921.431,565.12 923.739,561.761 926.047,558.893 928.355,502.484 930.663,492.269 932.971,484.852 935.278,445.032 937.586,332.878 939.894,399.362 942.202,520.157 944.51,488.259 946.818,431.105 949.126,377.524 951.434,469.642 953.742,319.811 956.05,326.764 958.358,315.755 960.665,599.974 962.973,503.43 965.281,565.324 967.589,585.304 969.897,357.851 972.205,725.907 974.513,566.289 976.821,454.042 979.129,398.979 981.437,433.023 983.745,456.412 986.053,635.32 988.36,488.543 990.668,630.444 992.976,487.844 995.284,433.201 997.592,490.089 999.9,436.683 1002.21,589.409 1004.52,610.796 1006.82,605.006 1009.13,446.144 1011.44,463.9 1013.75,358.76 1016.06,650.563 1018.36,416.484 1020.67,537.189 1022.98,548.113 1025.29,456.63 1027.59,529.661 1029.9,513.744 1032.21,597.65 1034.52,357.261 1036.83,415.35 1039.13,291.896 1041.44,677.362 1043.75,478.997 1046.06,417.105 1048.37,620.595 1050.67,377.112 1052.98,546.513 1055.29,502.1 1057.6,302.774 1059.91,304.099 1062.21,309.098 1064.52,514.706 1066.83,277.032 1069.14,370.471 1071.45,333.521 1073.75,514.197 1076.06,546.102 1078.37,492.018 1080.68,388.717 1082.98,476.032 1085.29,615.973 1087.6,638.416 1089.91,671.874 1092.22,480.769 1094.52,361.042 1096.83,571.248 1099.14,529.901 1101.45,535.946 1103.76,406.289 1106.06,394.438 1108.37,512.304 1110.68,337.555 1112.99,615.06 1115.3,426.029 1117.6,602.92 1119.91,538.203 1122.22,669.855 1124.53,496.73 1126.84,399.026 1129.14,577.274 1131.45,580.871 1133.76,633.244 1136.07,550.55 1138.37,484.429 1140.68,467.936 1142.99,507.647 1145.3,504.237 1147.61,410.071 1149.91,514.704 1152.22,554.366 1154.53,567.596 1156.84,413.144 1159.15,467.39 1161.45,603.46 1163.76,407.382 1166.07,565.932 1168.38,440.226 1170.69,359.681 1172.99,710.468 1175.3,375.306 1177.61,470.055 1179.92,591.97 1182.23,587.414 1184.53,454.688 1186.84,365.635 1189.15,418.838 1191.46,526.203 1193.76,452.964 1196.07,381.422 1198.38,386.291 1200.69,594.603 1203,729.501 1205.3,377.625 1207.61,622.69 1209.92,389.019 1212.23,355.39 1214.54,343.05 1216.84,375.076 1219.15,444.317 1221.46,337.358 1223.77,578.084 1226.08,531.262 1228.38,460.485 1230.69,369.039 1233,547.749 1235.31,664.07 1237.61,588.465 1239.92,547.805 1242.23,380.849 1244.54,518.595 1246.85,327.499 1249.15,585.967 1251.46,378.964 1253.77,550.218 1256.08,490.005 1258.39,361.835 1260.69,404.074 1263,498.587 1265.31,521.805 1267.62,417.792 1269.93,390.847 1272.23,346.109 1274.54,500.401 1276.85,639.051 1279.16,627.475 1281.47,545.473 1283.77,289.238 1286.08,402.648 1288.39,547.383 1290.7,557.112 1293,450.881 1295.31,410.34 1297.62,354.237 1299.93,159.171 1302.24,300.574 1304.54,323.838 1306.85,522.102 1309.16,368.83 1311.47,309.95 1313.78,677.57 1316.08,585.711 1318.39,506.941 1320.7,447.452 1323.01,403.476 1325.32,366.901 1327.62,272.812 1329.93,477.736 1332.24,570.842 1334.55,505.059 1336.86,648.982 1339.16,459.035 1341.47,395.101 1343.78,592.65 1346.09,538.549 1348.39,527.337 1350.7,450.629 1353.01,426.571 1355.32,449.03 1357.63,553.945 1359.93,437.62 1362.24,418.587 1364.55,478.169 1366.86,600.251 1369.17,627.865 1371.47,628.958 1373.78,504.72 1376.09,330.45 1378.4,618.431 1380.71,510.585 1383.01,371.591 1385.32,452.309 1387.63,618.383 1389.94,370.064 1392.24,353.136 1394.55,366.816 1396.86,321.711 1399.17,383.528 1401.48,444.947 1403.78,367.714 1406.09,564.021 1408.4,583.299 1410.71,557.631 1413.02,587.28 1415.32,562.619 1417.63,589.27 1419.94,478.398 1422.25,444.047 1424.56,456.889 1426.86,512.668 1429.17,433.591 1431.48,386.738 1433.79,552.492 1436.1,314.465 1438.4,541.275 1440.71,476.682 1443.02,538.811 1445.33,639.26 1447.63,357.391 1449.94,677.082 1452.25,467.884 1454.56,387.517 1456.87,457.043 1459.17,377.68 1461.48,413.563 1463.79,468.107 1466.1,543.653 1468.41,555.245 1470.71,603.529 1473.02,477.333 1475.33,393.031 1477.64,394.393 1479.95,520.135 1482.25,433.261 1484.56,421.481 1486.87,474.709 1489.18,611.291 1491.49,614.121 1493.79,590.351 1496.1,410.636 1498.41,656.825 1500.72,388.949 1503.02,586.718 1505.33,389.3 1507.64,429.787 1509.95,368.865 1512.26,620.166 1514.56,194.017 1516.87,398.038 1519.18,525.337 1521.49,695.898 1523.8,601.389 1526.1,496.285 1528.41,473.283 1530.72,435.158 1533.03,533.474 1535.34,528.922 1537.64,721.186 1539.95,463.465 1542.26,491.46 1544.57,729.114 1546.88,395.443 1549.18,449.717 1551.49,325.431 1553.8,577.834 1556.11,601.494 1558.41,493.935 1560.72,626.33 1563.03,596.374 1565.34,496.656 1567.65,547.759 1569.95,577.453 1572.26,271.077 1574.57,610.075 1576.88,410.979 1579.19,393.585 1581.49,672.382 1583.8,451.218 1586.11,425.221 1588.42,564.541 1590.73,612.184 1593.03,388.973 1595.34,422.901 1597.65,416.206 1599.96,357.603 1602.26,408.794 1604.57,598.645 1606.88,482.727 1609.19,624.048 1611.5,421.725 1613.8,499.558 1616.11,381.251 1618.42,535.573 1620.73,349.95 1623.04,549.146 1625.34,553.251 1627.65,354.385 1629.96,559.252 1632.27,403.854 1634.58,490.843 1636.88,493.039 1639.19,434.032 1641.5,445.328 1643.81,700.721 1646.12,407.515 1648.42,471.344 1650.73,499.844 1653.04,605.499 1655.35,474.273 1657.65,603.862 1659.96,569.576 1662.27,435.268 1664.58,463.75 1666.89,423.98 1669.19,477.216 1671.5,573.306 1673.81,385.289 1676.12,503.993 1678.43,313.125 1680.73,472.043 1683.04,644.374 1685.35,506.81 1687.66,532.892 1689.97,471.828 1692.27,284.407 1694.58,422.795 1696.89,475.703 1699.2,535.79 1701.51,446.726 1703.81,566.062 1706.12,354.007 1708.43,667.294 1710.74,263.214 1713.04,387.836 1715.35,438.907 1717.66,575.765 1719.97,417.537 1722.28,431.558 1724.58,646.536 1726.89,501.378 1729.2,431.138 1731.51,412.54 1733.82,311.405 1736.12,386.287 1738.43,583.753 1740.74,256.36 1743.05,578.75 1745.36,391.477 1747.66,681.471 1749.97,601.145 1752.28,512.492 1754.59,435.774 1756.9,500.205 1759.2,553.95 1761.51,573.633 1763.82,199.466 1766.13,416.366 1768.43,472.634 1770.74,367.929 1773.05,535.582 1775.36,323.79 1777.67,432.172 1779.97,671.001 1782.28,566.241 1784.59,622.616 1786.9,365.671 1789.21,531.122 1791.51,438.765 1793.82,433.988 1796.13,195.685 1798.44,349.615 1800.75,612.763 1803.05,539.493 1805.36,548.628 1807.67,466.51 1809.98,413.182 1812.28,318.576 1814.59,498.161 1816.9,462.511 1819.21,433.039 1821.52,506.074 1823.82,418.216 1826.13,487.77 1828.44,505.317 1830.75,533.295 1833.06,450.599 1835.36,457.999 1837.67,469.466 1839.98,546.103 1842.29,422.72 1844.6,561.457 1846.9,634.394 1849.21,668.223 1851.52,593.53 1853.83,568.631 1856.14,462.826 1858.44,445.778 1860.75,547.718 1863.06,596.965 1865.37,442.152 1867.67,416.461 1869.98,397 1872.29,580.509 1874.6,467.405 1876.91,352.248 1879.21,573.973 1881.52,541.109 1883.83,642.811 1886.14,420.939 1888.45,447.263 1890.75,525.656 1893.06,327.31 1895.37,625.937 1897.68,489.02 1899.99,502.881 1902.29,430.523 1904.6,586.829 1906.91,235.479 1909.22,633.529 1911.53,638.674 1913.83,552.707 1916.14,345.833 1918.45,664.432 1920.76,482.764 1923.06,545.641 1925.37,517.798 1927.68,358.639 1929.99,645.373 1932.3,493.82 1934.6,500.217 1936.91,530.958 1939.22,582 1941.53,643.567 1943.84,480.576 1946.14,510.816 1948.45,641.913 1950.76,225.849 1953.07,345.887 1955.38,542.003 1957.68,544.658 1959.99,576.961 1962.3,424.326 1964.61,481.678 1966.91,435.887 1969.22,376.09 1971.53,511.751 1973.84,499.991 1976.15,494.875 1978.45,410.028 1980.76,458.193 1983.07,456.054 1985.38,450.164 1987.69,581.957 1989.99,443.337 1992.3,575.895 1994.61,390.568 1996.92,506.511 1999.23,397.402 2001.53,641.394 2003.84,361.321 2006.15,613.43 2008.46,550.15 2010.77,519.078 2013.07,582.416 2015.38,453.269 2017.69,704.861 2020,510.727 2022.3,586.271 2024.61,627.936 2026.92,518.25 2029.23,448.534 2031.54,692.681 2033.84,584.25 2036.15,595.648 2038.46,345.979 2040.77,508.54 2043.08,558.76 2045.38,533.126 2047.69,601.951 2050,369.027 2052.31,401.45 2054.62,595.296 2056.92,585.726 2059.23,431.837 2061.54,552.561 2063.85,449.134 2066.16,444.743 2068.46,422.205 2070.77,364.459 2073.08,336.589 2075.39,306.829 2077.69,435.697 2080,546.13 2082.31,363.988 2084.62,484.987 2086.93,324.824 2089.23,426.587 2091.54,536.885 2093.85,416.678 2096.16,533.806 2098.47,537.985 2100.77,514.252 2103.08,449.989 2105.39,461.462 2107.7,539.072 2110.01,443.027 2112.31,439.312 2114.62,437.987 2116.93,369.275 2119.24,606.992 2121.55,474.402 2123.85,518.73 2126.16,363.999 2128.47,567.021 2130.78,442.011 2133.08,565.787 2135.39,411.358 2137.7,497.654 2140.01,521.904 2142.32,403.641 2144.62,614.698 2146.93,416.755 2149.24,352.373 2151.55,538.245 2153.86,555.629 2156.16,514.625 2158.47,534.544 2160.78,323.173 2163.09,588.497 2165.4,334.67 2167.7,586.341 2170.01,527.571 2172.32,515.519 2174.63,431.996 2176.93,526.835 2179.24,498.459 2181.55,329.961 2183.86,536.812 2186.17,359.155 2188.47,359.479 2190.78,362.566 2193.09,575.675 2195.4,284.111 2197.71,368.58 2200.01,479.952 2202.32,509.744 2204.63,545.603 2206.94,447.575 2209.25,481.932 2211.55,550.903 2213.86,411.851 2216.17,552.006 2218.48,331.039 2220.79,509.504 2223.09,460.635 2225.4,469.892 2227.71,528.828 2230.02,635.675 2232.32,679.938 2234.63,598.493 2236.94,625.746 2239.25,96.8724 2241.56,521.118 2243.86,459.084 2246.17,537.661 2248.48,553.126 2250.79,523.942 2253.1,574.809 2255.4,661.074 2257.71,569.185 2260.02,630.666 2262.33,417.901 2264.64,610.782 2266.94,491.695 2269.25,603.095 2271.56,538.238 2273.87,472.23 2276.18,495.784 2278.48,371.065 2280.79,652.804 2283.1,385.24 2285.41,643.67 2287.71,458.496 2290.02,501.543 2292.33,403.201 2294.64,542.65 2296.95,458.704 2299.25,237.363 2301.56,404.122 2303.87,506.695 2306.18,561.863 2308.49,414.586 2310.79,359.519 2313.1,609.572 2315.41,319.249 2317.72,483.64 2320.03,350.72 2322.33,417.905 2324.64,520.387 2326.95,485.36 2329.26,416.624 2331.56,452.126 2333.87,502.655 2336.18,417.448 2338.49,461.269 2340.8,435.439 2343.1,594.831 2345.41,431.996 2347.72,377.207 2350.03,167.47 2352.34,447.425 2354.64,567.491 2356.95,348.965 2359.26,337.942 2361.57,388.889 2363.88,480.496 2366.18,271.15 2368.49,509.843 2370.8,436.481 2373.11,426.884 2375.42,642.624 2377.72,394.988 2380.03,637.12 2382.34,520.335 2384.65,471.434 2386.95,520.671 2389.26,516.037 2391.57,602.724 2393.88,421.078 2396.19,273.526 2398.49,546.661 2400.8,477.239 2403.11,371.234 2405.42,440.63 2407.73,349.6 2410.03,565.314 2412.34,494.813 2414.65,429.07 2416.96,669.444 2419.27,534.002 2421.57,455.422 2423.88,451.87 2426.19,398.328 2428.5,452.648 2430.81,471.107 2433.11,556.191 2435.42,553.611 2437.73,335.339 2440.04,538.163 2442.34,566 2444.65,405.51 2446.96,518.018 2449.27,355.412 2451.58,432.342 2453.88,430.331 2456.19,385.502 2458.5,355.029 2460.81,518.185 2463.12,456.503 2465.42,494.746 2467.73,383.643 2470.04,448.355 2472.35,561.675 2474.66,439.591 2476.96,325.169 2479.27,504.51 2481.58,296.156 2483.89,466.841 2486.2,442.311 2488.5,352.634 2490.81,483.644 2493.12,520.805 2495.43,397.419 2497.73,577.444 2500.04,311.242 2502.35,316.173 2504.66,571.658 2506.97,414.916 2509.27,366.147 2511.58,531.422 2513.89,674.359 2516.2,450.772 2518.51,507.521 2520.81,662.973 2523.12,423.112 2525.43,424.709 2527.74,627.66 2530.05,400.571 2532.35,563.679 2534.66,507.666 2536.97,411.143 2539.28,535.324 2541.58,154.308 2543.89,309.469 2546.2,551.019 2548.51,438.499 2550.82,652.008 2553.12,646.744 2555.43,556.758 2557.74,539.281 2560.05,480.914 2562.36,424.02 2564.66,503.242 2566.97,505.324 2569.28,492.866 2571.59,494.891 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -3.94419  -3.44186   -2.90574      …  -7.08255  -4.90877   -4.83772
  1.31055   0.167583  -0.000838721     -1.5573   -0.711222  -1.34933
  1.63507   3.75326    5.10349          5.57431   5.71195    4.64226

[:, :, 2] =
 -2.1852   -5.62032  -4.77352    …  -3.45941   -5.41971   -5.25314
 -1.45217  -1.15863  -0.0513665      0.830252  -0.771499  -0.964379
  3.15567   5.20584   4.55901        6.22924    5.54114    5.61807

[:, :, 3] =
 -1.35575  -3.93697  -3.93697  …  -3.87107    -3.35641    -4.46172
  0.40796   1.49001   1.49001     -0.0232652   0.0944961   0.0953106
  3.18128   4.69899   4.69899      5.58778     6.39697     5.96043

[:, :, 4] =
 -1.38225   -4.21586  -4.53851  -3.99762   …  -6.51825   -4.64847  -5.23349
  0.727447   2.13417   1.51852  -0.749047     -0.706936  -1.65342  -1.57801
  2.60199    3.61701   4.34865   3.47999       5.573      6.41823   4.57714</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.99542    1.01208
 -0.0337167  0.994526
  5.0108     0.991767</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.64 seconds
Compute duration  = 2.64 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -5.0330    0.9994    0.0172   3384.4260   4994.5653    1.0010   ⋯
        x[2]    0.0049    1.0069    0.0178   3212.4362   4847.8855    0.9999   ⋯
        x[3]    5.0203    1.0001    0.0173   3331.3281   5151.1302    0.9999   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -7.0368   -5.6999   -5.0397   -4.3700   -3.0630
        x[2]   -1.9810   -0.6765    0.0068    0.6905    1.9781
        x[3]    3.0732    4.3456    5.0274    5.7018    6.9616</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.55 seconds
Compute duration  = 1.55 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.5047    0.1893    0.0028   4475.2414   5319.5727    1.0007   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1485    0.3626    0.5059    0.6456    0.8540</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.26 seconds
Compute duration  = 0.26 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

           x    0.4914    0.1489    0.0138    98.8065    51.0969    1.0455     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.2513    0.3692    0.4898    0.6161    0.7456</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(-0.21011569648788508, "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with -0.21011569648788508:
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/uuqsE/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/uuqsE/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/uuqsE/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/uuqsE/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/uuqsE/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/DvdZw/src/compiler.jl:579 [inlined]
  [7] demo(__model__::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, __varinfo__::DynamicPPL.ThreadSafeVarInfo{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, Vector{Base.RefValue{Float64}}}, __context__::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:593
  [8] _evaluate!!
    @ ~/.julia/packages/DynamicPPL/DvdZw/src/model.jl:973 [inlined]
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, context::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/DvdZw/src/model.jl:962
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/DvdZw/src/model.jl:892 [inlined]
 [11] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/DvdZw/src/values_as_in_model.jl:196 [inlined]
 [12] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/DvdZw/src/values_as_in_model.jl:195 [inlined]
 [13] getparams(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64})
    @ Turing.Inference ~/.julia/packages/Turing/QN7BL/src/mcmc/Inference.jl:343
 [14] Turing.Inference.Transition(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, t::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/QN7BL/src/mcmc/Inference.jl:226
 [15] transition_to_turing
    @ ~/.julia/packages/Turing/QN7BL/src/mcmc/abstractmcmc.jl:12 [inlined]
 [16] transition_to_turing(f::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, transition::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/QN7BL/src/mcmc/abstractmcmc.jl:17
 [17] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}; initial_state::Nothing, initial_params::Nothing, kwargs::@Kwargs{})
    @ Turing.Inference ~/.julia/packages/Turing/QN7BL/src/mcmc/abstractmcmc.jl:147
 [18] macro expansion
    @ ~/.julia/packages/AbstractMCMC/z1nwm/src/logging.jl:0 [inlined]
 [19] macro expansion
    @ ~/.julia/packages/AbstractMCMC/z1nwm/src/logging.jl:16 [inlined]
 [20] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, num_warmup::Int64, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/z1nwm/src/sample.jl:142
 [21] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/DvdZw/src/sampler.jl:93
 [22] sample
    @ ~/.julia/packages/DynamicPPL/DvdZw/src/sampler.jl:83 [inlined]
 [23] #sample#4
    @ ~/.julia/packages/Turing/QN7BL/src/mcmc/Inference.jl:276 [inlined]
 [24] sample
    @ ~/.julia/packages/Turing/QN7BL/src/mcmc/Inference.jl:267 [inlined]
 [25] #sample#3
    @ ~/.julia/packages/Turing/QN7BL/src/mcmc/Inference.jl:264 [inlined]
 [26] top-level scope
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:595</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.68 seconds
Compute duration  = 1.68 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    8.2419    0.0000    0.0000        NaN        NaN       NaN     ⋯
           x   -1.4774    0.0000    0.0000        NaN        NaN       NaN     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    8.2419    8.2419    8.2419    8.2419    8.2419
           x   -1.4774   -1.4774   -1.4774   -1.4774   -1.4774</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 3.08 seconds
Compute duration  = 3.08 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.4043    0.0000    0.0000        NaN        NaN       NaN     ⋯
           x    1.4511    0.0000    0.0000        NaN        NaN       NaN     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.4043    0.4043    0.4043    0.4043    0.4043
           x    1.4511    1.4511    1.4511    1.4511    1.4511</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>