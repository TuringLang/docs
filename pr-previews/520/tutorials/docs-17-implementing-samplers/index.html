<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../tutorials/docs-07-for-developers-variational-inference/index.html" rel="prev">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/docs-00-getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/00-introduction/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.34" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.34</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.34">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Users</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-00-getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-12-using-turing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Core Functionality</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Usage Tips</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-09-using-turing-advanced/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced Usage</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-10-using-turing-autodiff/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-13-using-turing-performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-11-using-turing-dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-15-using-turing-sampler-viz/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-16-using-turing-external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Worked Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/00-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction: Coin Flipping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/01-gaussian-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/02-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/03-bayesian-neural-network/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/04-hidden-markov-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/05-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/06-infinite-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/07-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/08-multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/09-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/10-bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/11-probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/13-seasonal-time-series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/15-gaussian-processes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Gaussian Processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/12-gplvm/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Contributing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-01-contributing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to Contribute</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">DynamicPPL in Depth</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-05-for-developers-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/14-minituring/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/16-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Inference (note: outdated)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-06-for-developers-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-23.703897635263203</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-23.703897635263203</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([0.0, 0.0, 0.0]), MALAState{Vector{Float64}}([0.0, 0.0, 0.0]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -1.00889   -3.28601   -4.91439  …  -4.6515     -3.1427    -5.55418
  0.592127  -0.774532  -1.76435     -0.0692567  -0.727592   0.637323
  2.26907    3.59877    4.8887       4.97541     5.04213    3.87043</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.98377     0.996588
 -0.00154645  0.996629
  4.99452     1.00727</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip310">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip310)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip311">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip310)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip312">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1648.59 2640.76,1648.59 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1405.78 2640.76,1405.78 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1162.98 2640.76,1162.98 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,920.182 2640.76,920.182 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,677.38 2640.76,677.38 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,434.579 2640.76,434.579 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,191.777 2640.76,191.777 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip310)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1648.59 215.714,1648.59 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1405.78 215.714,1405.78 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1162.98 215.714,1162.98 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,920.182 215.714,920.182 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,677.38 215.714,677.38 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,434.579 215.714,434.579 "></polyline>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,191.777 215.714,191.777 "></polyline>
<path clip-path="url(#clip310)" d="M50.5475 1649.04 L80.2233 1649.04 L80.2233 1652.97 L50.5475 1652.97 L50.5475 1649.04 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M89.1352 1631.31 L111.357 1631.31 L111.357 1633.3 L98.8111 1665.87 L93.9269 1665.87 L105.732 1635.24 L89.1352 1635.24 L89.1352 1631.31 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M120.478 1659.99 L125.362 1659.99 L125.362 1665.87 L120.478 1665.87 L120.478 1659.99 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M135.593 1631.31 L153.95 1631.31 L153.95 1635.24 L139.876 1635.24 L139.876 1643.71 Q140.894 1643.37 141.913 1643.2 Q142.931 1643.02 143.95 1643.02 Q149.737 1643.02 153.116 1646.19 Q156.496 1649.36 156.496 1654.78 Q156.496 1660.36 153.024 1663.46 Q149.552 1666.54 143.232 1666.54 Q141.056 1666.54 138.788 1666.17 Q136.542 1665.8 134.135 1665.06 L134.135 1660.36 Q136.218 1661.49 138.441 1662.05 Q140.663 1662.6 143.14 1662.6 Q147.144 1662.6 149.482 1660.5 Q151.82 1658.39 151.82 1654.78 Q151.82 1651.17 149.482 1649.06 Q147.144 1646.95 143.14 1646.95 Q141.265 1646.95 139.39 1647.37 Q137.538 1647.79 135.593 1648.67 L135.593 1631.31 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M49.5521 1406.24 L79.2279 1406.24 L79.2279 1410.17 L49.5521 1410.17 L49.5521 1406.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M89.3667 1388.5 L107.723 1388.5 L107.723 1392.44 L93.6491 1392.44 L93.6491 1400.91 Q94.6676 1400.57 95.6861 1400.4 Q96.7047 1400.22 97.7232 1400.22 Q103.51 1400.22 106.89 1403.39 Q110.269 1406.56 110.269 1411.98 Q110.269 1417.56 106.797 1420.66 Q103.325 1423.74 97.0056 1423.74 Q94.8297 1423.74 92.5612 1423.37 Q90.3158 1423 87.9084 1422.25 L87.9084 1417.56 Q89.9917 1418.69 92.2139 1419.25 Q94.4361 1419.8 96.913 1419.8 Q100.918 1419.8 103.256 1417.69 Q105.593 1415.59 105.593 1411.98 Q105.593 1408.37 103.256 1406.26 Q100.918 1404.15 96.913 1404.15 Q95.038 1404.15 93.163 1404.57 Q91.3112 1404.99 89.3667 1405.87 L89.3667 1388.5 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M119.482 1417.19 L124.367 1417.19 L124.367 1423.06 L119.482 1423.06 L119.482 1417.19 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M144.552 1391.58 Q140.941 1391.58 139.112 1395.15 Q137.306 1398.69 137.306 1405.82 Q137.306 1412.93 139.112 1416.49 Q140.941 1420.03 144.552 1420.03 Q148.186 1420.03 149.991 1416.49 Q151.82 1412.93 151.82 1405.82 Q151.82 1398.69 149.991 1395.15 Q148.186 1391.58 144.552 1391.58 M144.552 1387.88 Q150.362 1387.88 153.417 1392.49 Q156.496 1397.07 156.496 1405.82 Q156.496 1414.55 153.417 1419.15 Q150.362 1423.74 144.552 1423.74 Q138.741 1423.74 135.663 1419.15 Q132.607 1414.55 132.607 1405.82 Q132.607 1397.07 135.663 1392.49 Q138.741 1387.88 144.552 1387.88 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M50.5475 1163.43 L80.2233 1163.43 L80.2233 1167.37 L50.5475 1167.37 L50.5475 1163.43 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M94.3436 1176.33 L110.663 1176.33 L110.663 1180.26 L88.7186 1180.26 L88.7186 1176.33 Q91.3806 1173.57 95.9639 1168.94 Q100.57 1164.29 101.751 1162.95 Q103.996 1160.43 104.876 1158.69 Q105.779 1156.93 105.779 1155.24 Q105.779 1152.49 103.834 1150.75 Q101.913 1149.01 98.8111 1149.01 Q96.6121 1149.01 94.1584 1149.78 Q91.7278 1150.54 88.9501 1152.09 L88.9501 1147.37 Q91.7741 1146.24 94.2278 1145.66 Q96.6815 1145.08 98.7185 1145.08 Q104.089 1145.08 107.283 1147.76 Q110.478 1150.45 110.478 1154.94 Q110.478 1157.07 109.668 1158.99 Q108.881 1160.89 106.774 1163.48 Q106.195 1164.15 103.094 1167.37 Q99.9917 1170.56 94.3436 1176.33 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M120.478 1174.38 L125.362 1174.38 L125.362 1180.26 L120.478 1180.26 L120.478 1174.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M135.593 1145.7 L153.95 1145.7 L153.95 1149.64 L139.876 1149.64 L139.876 1158.11 Q140.894 1157.76 141.913 1157.6 Q142.931 1157.42 143.95 1157.42 Q149.737 1157.42 153.116 1160.59 Q156.496 1163.76 156.496 1169.18 Q156.496 1174.75 153.024 1177.86 Q149.552 1180.93 143.232 1180.93 Q141.056 1180.93 138.788 1180.56 Q136.542 1180.19 134.135 1179.45 L134.135 1174.75 Q136.218 1175.89 138.441 1176.44 Q140.663 1177 143.14 1177 Q147.144 1177 149.482 1174.89 Q151.82 1172.79 151.82 1169.18 Q151.82 1165.56 149.482 1163.46 Q147.144 1161.35 143.14 1161.35 Q141.265 1161.35 139.39 1161.77 Q137.538 1162.18 135.593 1163.06 L135.593 1145.7 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M99.3204 905.98 Q95.7093 905.98 93.8806 909.545 Q92.075 913.087 92.075 920.217 Q92.075 927.323 93.8806 930.888 Q95.7093 934.429 99.3204 934.429 Q102.955 934.429 104.76 930.888 Q106.589 927.323 106.589 920.217 Q106.589 913.087 104.76 909.545 Q102.955 905.98 99.3204 905.98 M99.3204 902.277 Q105.131 902.277 108.186 906.883 Q111.265 911.467 111.265 920.217 Q111.265 928.943 108.186 933.55 Q105.131 938.133 99.3204 938.133 Q93.5102 938.133 90.4315 933.55 Q87.376 928.943 87.376 920.217 Q87.376 911.467 90.4315 906.883 Q93.5102 902.277 99.3204 902.277 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M119.482 931.582 L124.367 931.582 L124.367 937.462 L119.482 937.462 L119.482 931.582 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M144.552 905.98 Q140.941 905.98 139.112 909.545 Q137.306 913.087 137.306 920.217 Q137.306 927.323 139.112 930.888 Q140.941 934.429 144.552 934.429 Q148.186 934.429 149.991 930.888 Q151.82 927.323 151.82 920.217 Q151.82 913.087 149.991 909.545 Q148.186 905.98 144.552 905.98 M144.552 902.277 Q150.362 902.277 153.417 906.883 Q156.496 911.467 156.496 920.217 Q156.496 928.943 153.417 933.55 Q150.362 938.133 144.552 938.133 Q138.741 938.133 135.663 933.55 Q132.607 928.943 132.607 920.217 Q132.607 911.467 135.663 906.883 Q138.741 902.277 144.552 902.277 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M94.3436 690.725 L110.663 690.725 L110.663 694.66 L88.7186 694.66 L88.7186 690.725 Q91.3806 687.97 95.9639 683.341 Q100.57 678.688 101.751 677.345 Q103.996 674.822 104.876 673.086 Q105.779 671.327 105.779 669.637 Q105.779 666.883 103.834 665.146 Q101.913 663.41 98.8111 663.41 Q96.6121 663.41 94.1584 664.174 Q91.7278 664.938 88.9501 666.489 L88.9501 661.767 Q91.7741 660.633 94.2278 660.054 Q96.6815 659.475 98.7185 659.475 Q104.089 659.475 107.283 662.16 Q110.478 664.846 110.478 669.336 Q110.478 671.466 109.668 673.387 Q108.881 675.285 106.774 677.878 Q106.195 678.549 103.094 681.767 Q99.9917 684.961 94.3436 690.725 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M120.478 688.781 L125.362 688.781 L125.362 694.66 L120.478 694.66 L120.478 688.781 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M135.593 660.1 L153.95 660.1 L153.95 664.035 L139.876 664.035 L139.876 672.508 Q140.894 672.16 141.913 671.998 Q142.931 671.813 143.95 671.813 Q149.737 671.813 153.116 674.984 Q156.496 678.156 156.496 683.572 Q156.496 689.151 153.024 692.253 Q149.552 695.332 143.232 695.332 Q141.056 695.332 138.788 694.961 Q136.542 694.591 134.135 693.85 L134.135 689.151 Q136.218 690.285 138.441 690.841 Q140.663 691.396 143.14 691.396 Q147.144 691.396 149.482 689.29 Q151.82 687.183 151.82 683.572 Q151.82 679.961 149.482 677.855 Q147.144 675.748 143.14 675.748 Q141.265 675.748 139.39 676.165 Q137.538 676.582 135.593 677.461 L135.593 660.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M89.3667 417.299 L107.723 417.299 L107.723 421.234 L93.6491 421.234 L93.6491 429.706 Q94.6676 429.359 95.6861 429.197 Q96.7047 429.012 97.7232 429.012 Q103.51 429.012 106.89 432.183 Q110.269 435.354 110.269 440.771 Q110.269 446.349 106.797 449.451 Q103.325 452.53 97.0056 452.53 Q94.8297 452.53 92.5612 452.16 Q90.3158 451.789 87.9084 451.048 L87.9084 446.349 Q89.9917 447.484 92.2139 448.039 Q94.4361 448.595 96.913 448.595 Q100.918 448.595 103.256 446.488 Q105.593 444.382 105.593 440.771 Q105.593 437.16 103.256 435.053 Q100.918 432.947 96.913 432.947 Q95.038 432.947 93.163 433.363 Q91.3112 433.78 89.3667 434.66 L89.3667 417.299 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M119.482 445.979 L124.367 445.979 L124.367 451.859 L119.482 451.859 L119.482 445.979 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M144.552 420.377 Q140.941 420.377 139.112 423.942 Q137.306 427.484 137.306 434.613 Q137.306 441.72 139.112 445.285 Q140.941 448.826 144.552 448.826 Q148.186 448.826 149.991 445.285 Q151.82 441.72 151.82 434.613 Q151.82 427.484 149.991 423.942 Q148.186 420.377 144.552 420.377 M144.552 416.674 Q150.362 416.674 153.417 421.28 Q156.496 425.863 156.496 434.613 Q156.496 443.34 153.417 447.947 Q150.362 452.53 144.552 452.53 Q138.741 452.53 135.663 447.947 Q132.607 443.34 132.607 434.613 Q132.607 425.863 135.663 421.28 Q138.741 416.674 144.552 416.674 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M89.1352 174.497 L111.357 174.497 L111.357 176.488 L98.8111 209.057 L93.9269 209.057 L105.732 178.432 L89.1352 178.432 L89.1352 174.497 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M120.478 203.177 L125.362 203.177 L125.362 209.057 L120.478 209.057 L120.478 203.177 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip310)" d="M135.593 174.497 L153.95 174.497 L153.95 178.432 L139.876 178.432 L139.876 186.904 Q140.894 186.557 141.913 186.395 Q142.931 186.21 143.95 186.21 Q149.737 186.21 153.116 189.381 Q156.496 192.553 156.496 197.969 Q156.496 203.548 153.024 206.65 Q149.552 209.728 143.232 209.728 Q141.056 209.728 138.788 209.358 Q136.542 208.988 134.135 208.247 L134.135 203.548 Q136.218 204.682 138.441 205.238 Q140.663 205.793 143.14 205.793 Q147.144 205.793 149.482 203.687 Q151.82 201.58 151.82 197.969 Q151.82 194.358 149.482 192.252 Q147.144 190.145 143.14 190.145 Q141.265 190.145 139.39 190.562 Q137.538 190.978 135.593 191.858 L135.593 174.497 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip312)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1018.17 268.292,1414.65 270.6,1390.52 272.908,1520.62 275.216,1320.63 277.524,1411.72 279.832,1365.89 282.139,1291.09 284.447,1307 286.755,1131.49 289.063,1396.24 291.371,1362.23 293.679,1332.27 295.987,1427.63 298.295,1221.77 300.603,1246.75 302.911,1344.7 305.219,1389.09 307.527,1263.59 309.834,1463.36 312.142,1322.94 314.45,1339.57 316.758,1295.53 319.066,1378.31 321.374,1407.86 323.682,1350.02 325.99,1393.35 328.298,1360.85 330.606,1388.31 332.914,1454.39 335.221,1241.29 337.529,1238.85 339.837,1336.33 342.145,1440 344.453,1430.88 346.761,1461.22 349.069,1504.83 351.377,1573.54 353.685,1382.82 355.993,1494.43 358.301,1562.28 360.608,1374.87 362.916,1445.4 365.224,1285.36 367.532,1313.21 369.84,1389.89 372.148,1427.35 374.456,1620.84 376.764,1384.2 379.072,1391.39 381.38,1361.53 383.688,1391.02 385.996,1272.71 388.303,1406.06 390.611,1419.08 392.919,1367.51 395.227,1395.27 397.535,1398.96 399.843,1408.79 402.151,1491.3 404.459,1380.94 406.767,1317.68 409.075,1456.27 411.383,1533.85 413.69,1202.46 415.998,1256.24 418.306,1569.56 420.614,1557.67 422.922,1510.34 425.23,1293.21 427.538,1368.82 429.846,1372.13 432.154,1418.93 434.462,1443.93 436.77,1442.37 439.077,1526.73 441.385,1563.32 443.693,1404.47 446.001,1390.79 448.309,1433.3 450.617,1313.25 452.925,1449.15 455.233,1222.75 457.541,1424.54 459.849,1204.72 462.157,1450.84 464.465,1420.19 466.772,1436.52 469.08,1323.54 471.388,1362.96 473.696,1429.49 476.004,1371.63 478.312,1330.36 480.62,1619.61 482.928,1461.8 485.236,1379.67 487.544,1479 489.852,1382.19 492.159,1206.16 494.467,1400.66 496.775,1455.92 499.083,1320.81 501.391,1349.35 503.699,1580.02 506.007,1517.03 508.315,1508.59 510.623,1556.75 512.931,1332.78 515.239,1432.11 517.546,1373 519.854,1561.89 522.162,1511.84 524.47,1473.29 526.778,1515.41 529.086,1448.52 531.394,1586.58 533.702,1456.13 536.01,1508.26 538.318,1453.56 540.626,1614.38 542.933,1509.33 545.241,1396.64 547.549,1267.46 549.857,1435.27 552.165,1616.24 554.473,1504.48 556.781,1433.84 559.089,1370.88 561.397,1295.54 563.705,1284.57 566.013,1409.76 568.321,1396.16 570.628,1433.82 572.936,1635.4 575.244,1297.47 577.552,1431.54 579.86,1312.24 582.168,1550.71 584.476,1454.15 586.784,1209.78 589.092,1434.87 591.4,1407.21 593.708,1517.69 596.015,1314.5 598.323,1456.43 600.631,1353 602.939,1479.78 605.247,1529.43 607.555,1373.48 609.863,1243.43 612.171,1487.45 614.479,1192.6 616.787,1296.69 619.095,1406.72 621.402,1222.08 623.71,1310.09 626.018,1423 628.326,1387.76 630.634,1484.58 632.942,1341.04 635.25,1452.18 637.558,1414.12 639.866,1315.69 642.174,1404.45 644.482,1296.73 646.79,1356.08 649.097,1396.19 651.405,1438.13 653.713,1397.49 656.021,1249.23 658.329,1442.31 660.637,1454.25 662.945,1565.73 665.253,1535.84 667.561,1415.32 669.869,1389.84 672.177,1368.49 674.484,1266.33 676.792,1372.51 679.1,1397.79 681.408,1751.15 683.716,1345.99 686.024,1304.16 688.332,1388.89 690.64,1469.73 692.948,1411.66 695.256,1437.78 697.564,1459.9 699.871,1324.68 702.179,1368.95 704.487,1371.69 706.795,1304.88 709.103,1255.32 711.411,1460.38 713.719,1392.1 716.027,1460.61 718.335,1409.58 720.643,1412.24 722.951,1288.23 725.259,1500.74 727.566,1387.75 729.874,1236.19 732.182,1248.42 734.49,1420.82 736.798,1337.83 739.106,1376.05 741.414,1458.17 743.722,1099.82 746.03,1451.69 748.338,1455.54 750.646,1435.71 752.953,1488.35 755.261,1671.35 757.569,1459.75 759.877,1479.29 762.185,1323.1 764.493,1405.99 766.801,1221.83 769.109,1460.32 771.417,1457.39 773.725,1285.47 776.033,1325.09 778.34,1413.36 780.648,1509.26 782.956,1412.98 785.264,1448.54 787.572,1262.57 789.88,1431.37 792.188,1460.64 794.496,1375.33 796.804,1444.83 799.112,1383.34 801.42,1403.16 803.728,1464.93 806.035,1438.17 808.343,1560.84 810.651,1437.33 812.959,1307.7 815.267,1621.34 817.575,1472.11 819.883,1370.29 822.191,1404.23 824.499,1405.52 826.807,1298.5 829.115,1373.11 831.422,1410.44 833.73,1454.32 836.038,1292.07 838.346,1505.82 840.654,1242.59 842.962,1414.16 845.27,1413.84 847.578,1480.32 849.886,1443.06 852.194,1543.15 854.502,1324.05 856.809,1375.08 859.117,1521.43 861.425,1399.28 863.733,1424.79 866.041,1279.23 868.349,1453.27 870.657,1304.28 872.965,1574.42 875.273,1429.41 877.581,1343.02 879.889,1393.21 882.197,1320.49 884.504,1394.16 886.812,1394.67 889.12,1308.27 891.428,1491.46 893.736,1235.89 896.044,1448.33 898.352,1405.98 900.66,1419.02 902.968,1430.61 905.276,1303.33 907.584,1310.38 909.891,1296.94 912.199,1341.85 914.507,1302.06 916.815,1393.06 919.123,1437.21 921.431,1584.01 923.739,1399.04 926.047,1203.62 928.355,1306.77 930.663,1279.88 932.971,1395.8 935.278,1392.31 937.586,1494.47 939.894,1391.31 942.202,1458.56 944.51,1468.01 946.818,1476.14 949.126,1450.61 951.434,1411.45 953.742,1416.45 956.05,1481.07 958.358,1439.91 960.665,1450.72 962.973,1365.5 965.281,1467.13 967.589,1309.21 969.897,1315.47 972.205,1280.5 974.513,1201.65 976.821,1426.39 979.129,1448.91 981.437,1318.52 983.745,1460.04 986.053,1297.73 988.36,1457.37 990.668,1310.71 992.976,1324.25 995.284,1197.06 997.592,1353.43 999.9,1499.08 1002.21,1229.72 1004.52,1249.49 1006.82,1458.05 1009.13,1499.77 1011.44,1504.88 1013.75,1276.23 1016.06,1264.23 1018.36,1347.86 1020.67,1489.11 1022.98,1432.15 1025.29,1426.45 1027.59,1406.32 1029.9,1386.76 1032.21,1465.37 1034.52,1415.15 1036.83,1405.98 1039.13,1573.88 1041.44,1405.35 1043.75,1387.41 1046.06,1457.26 1048.37,1366.33 1050.67,1532.02 1052.98,1452.58 1055.29,1453.82 1057.6,1398.3 1059.91,1438.7 1062.21,1304.88 1064.52,1335.16 1066.83,1150.33 1069.14,1343.24 1071.45,1237.32 1073.75,1400.26 1076.06,1445.63 1078.37,1493.12 1080.68,1404.34 1082.98,1562.93 1085.29,1441.73 1087.6,1529.47 1089.91,1561.31 1092.22,1480.28 1094.52,1342.01 1096.83,1175.85 1099.14,1393.68 1101.45,1477.22 1103.76,1329.98 1106.06,1349.67 1108.37,1397.01 1110.68,1290.9 1112.99,1385.58 1115.3,1493.97 1117.6,1599.39 1119.91,1284.95 1122.22,1444.07 1124.53,1314.54 1126.84,1299.96 1129.14,1369.94 1131.45,1375.95 1133.76,1333.11 1136.07,1335.45 1138.37,1319.43 1140.68,1463.63 1142.99,1381.75 1145.3,1381.26 1147.61,1535.06 1149.91,1356.1 1152.22,1434.81 1154.53,1370 1156.84,1410.04 1159.15,1312.63 1161.45,1335.97 1163.76,1424.94 1166.07,1424.15 1168.38,1428.92 1170.69,1586.46 1172.99,1378.95 1175.3,1472.75 1177.61,1426.74 1179.92,1334.36 1182.23,1480.25 1184.53,1274.53 1186.84,1459.9 1189.15,1374.72 1191.46,1542.41 1193.76,1244.7 1196.07,1344.75 1198.38,1291.76 1200.69,1341.32 1203,1420.13 1205.3,1238.2 1207.61,1481.38 1209.92,1540.75 1212.23,1501.95 1214.54,1478.85 1216.84,1396.07 1219.15,1442.51 1221.46,1304.48 1223.77,1322.97 1226.08,1238.45 1228.38,1515.17 1230.69,1429.87 1233,1611.48 1235.31,1417.32 1237.61,1428.01 1239.92,1614.68 1242.23,1536.51 1244.54,1436.42 1246.85,1230.69 1249.15,1212.19 1251.46,1583.41 1253.77,1464.11 1256.08,1398.72 1258.39,1422.97 1260.69,1348.13 1263,1401.83 1265.31,1547.79 1267.62,1453.52 1269.93,1402.68 1272.23,1271.32 1274.54,1354.8 1276.85,1297.67 1279.16,1492.96 1281.47,1463.14 1283.77,1342.73 1286.08,1548.23 1288.39,1585.29 1290.7,1348.34 1293,1480.34 1295.31,1443.14 1297.62,1340.64 1299.93,1418.84 1302.24,1587.79 1304.54,1193.85 1306.85,1500.67 1309.16,1220.9 1311.47,1357.58 1313.78,1377.13 1316.08,1501.47 1318.39,1369.61 1320.7,1221.14 1323.01,1565.75 1325.32,1428.83 1327.62,1488.78 1329.93,1304.97 1332.24,1242 1334.55,1290.91 1336.86,1338.2 1339.16,1474.06 1341.47,1442.14 1343.78,1407.59 1346.09,1364.41 1348.39,1302.84 1350.7,1385.34 1353.01,1314.47 1355.32,1396.09 1357.63,1557.69 1359.93,1362.21 1362.24,1508.01 1364.55,1463.55 1366.86,1461.84 1369.17,1354.05 1371.47,1443.43 1373.78,1414.26 1376.09,1310.64 1378.4,1464.82 1380.71,1484.81 1383.01,1149.23 1385.32,1416.34 1387.63,1469.53 1389.94,1495.73 1392.24,1444.71 1394.55,1490.5 1396.86,1437.96 1399.17,1287.6 1401.48,1360.51 1403.78,1513.83 1406.09,1552.41 1408.4,1456.26 1410.71,1315.5 1413.02,1395.58 1415.32,1481.26 1417.63,1363.51 1419.94,1415.43 1422.25,1363.54 1424.56,1497 1426.86,1518.3 1429.17,1498.76 1431.48,1425.39 1433.79,1327.94 1436.1,1445.59 1438.4,1430.99 1440.71,1456.72 1443.02,1553.4 1445.33,1429.67 1447.63,1555.82 1449.94,1431.89 1452.25,1131.37 1454.56,1361.84 1456.87,1646.38 1459.17,1391.76 1461.48,1342.56 1463.79,1404.57 1466.1,1380.47 1468.41,1288.06 1470.71,1318.93 1473.02,1462.47 1475.33,1385.72 1477.64,1267.74 1479.95,1492.82 1482.25,1514.54 1484.56,1374.89 1486.87,1267.11 1489.18,1365.43 1491.49,1355.83 1493.79,1403.05 1496.1,1314.3 1498.41,1428.58 1500.72,1477.56 1503.02,1409.48 1505.33,1315.32 1507.64,1376.84 1509.95,1487.6 1512.26,1403.02 1514.56,1444.76 1516.87,1586.25 1519.18,1390.37 1521.49,1374.99 1523.8,1539.89 1526.1,1335.09 1528.41,1285.34 1530.72,1442.44 1533.03,1395.96 1535.34,1381.07 1537.64,1384.98 1539.95,1445.31 1542.26,1285.43 1544.57,1394.88 1546.88,1398.34 1549.18,1392.39 1551.49,1418.94 1553.8,1424.18 1556.11,1371.99 1558.41,1429.96 1560.72,1427.25 1563.03,1409.06 1565.34,1554.1 1567.65,1480.04 1569.95,1348.36 1572.26,1425.4 1574.57,1303.03 1576.88,1483.1 1579.19,1337.58 1581.49,1271.55 1583.8,1539.77 1586.11,1349.87 1588.42,1309.21 1590.73,1451.6 1593.03,1436.3 1595.34,1456.66 1597.65,1463.55 1599.96,1578.99 1602.26,1337.9 1604.57,1418.42 1606.88,1480.88 1609.19,1392.76 1611.5,1289.19 1613.8,1478.18 1616.11,1540.42 1618.42,1518.98 1620.73,1335.63 1623.04,1421.06 1625.34,1272.53 1627.65,1462.75 1629.96,1428.18 1632.27,1377.02 1634.58,1463.14 1636.88,1283.25 1639.19,1397.52 1641.5,1313.63 1643.81,1463.05 1646.12,1379.91 1648.42,1445.67 1650.73,1437.51 1653.04,1365.99 1655.35,1362.94 1657.65,1270.02 1659.96,1474.22 1662.27,1393.99 1664.58,1204.84 1666.89,1412.46 1669.19,1363.9 1671.5,1253.1 1673.81,1475.45 1676.12,1206.71 1678.43,1263.27 1680.73,1486.07 1683.04,1533.56 1685.35,1572.81 1687.66,1548.44 1689.97,1318.38 1692.27,1427.58 1694.58,1464.93 1696.89,1342.52 1699.2,1538.23 1701.51,1219.16 1703.81,1414.81 1706.12,1449.74 1708.43,1238.46 1710.74,1489.76 1713.04,1405.68 1715.35,1249.47 1717.66,1321.36 1719.97,1404.17 1722.28,1422.02 1724.58,1415.8 1726.89,1532.13 1729.2,1505.45 1731.51,1545.26 1733.82,1405.18 1736.12,1481.3 1738.43,1362.97 1740.74,1246.54 1743.05,1301.84 1745.36,1343.47 1747.66,1476.72 1749.97,1322.58 1752.28,1331.58 1754.59,1274.49 1756.9,1499.84 1759.2,1669.26 1761.51,1535.03 1763.82,1445.11 1766.13,1487.14 1768.43,1418.81 1770.74,1489.41 1773.05,1361.41 1775.36,1473.76 1777.67,1427.47 1779.97,1406.45 1782.28,1414.13 1784.59,1279.9 1786.9,1512.47 1789.21,1478.56 1791.51,1448.06 1793.82,1322.47 1796.13,1402.08 1798.44,1479.62 1800.75,1535.56 1803.05,1156.97 1805.36,1412.21 1807.67,1400.31 1809.98,1232.15 1812.28,1372.19 1814.59,1210.26 1816.9,1453.75 1819.21,1622.8 1821.52,1360.09 1823.82,1403.89 1826.13,1461.57 1828.44,1451.53 1830.75,1473.34 1833.06,1303.57 1835.36,1389.65 1837.67,1376.95 1839.98,1353.88 1842.29,1495.71 1844.6,1366 1846.9,1315.46 1849.21,1424.66 1851.52,1395.61 1853.83,1301.61 1856.14,1546.39 1858.44,1321.19 1860.75,1384.27 1863.06,1450.07 1865.37,1343.56 1867.67,1421.33 1869.98,1378.01 1872.29,1381.13 1874.6,1250.03 1876.91,1475.94 1879.21,1448.15 1881.52,1339.33 1883.83,1450.27 1886.14,1488.17 1888.45,1505.73 1890.75,1297.57 1893.06,1379.28 1895.37,1164.53 1897.68,1351 1899.99,1252.62 1902.29,1365.41 1904.6,1325.2 1906.91,1385.01 1909.22,1356.95 1911.53,1500.67 1913.83,1306.94 1916.14,1311.94 1918.45,1435.73 1920.76,1432.6 1923.06,1477.99 1925.37,1270.37 1927.68,1611.72 1929.99,1425.28 1932.3,1403.53 1934.6,1530.63 1936.91,1358.62 1939.22,1326.96 1941.53,1356.32 1943.84,1387.27 1946.14,1411.16 1948.45,1344.99 1950.76,1392.07 1953.07,1340.35 1955.38,1502.15 1957.68,1557.4 1959.99,1256.74 1962.3,1305.06 1964.61,1542.15 1966.91,1367.6 1969.22,1273.78 1971.53,1384.53 1973.84,1505.02 1976.15,1589.81 1978.45,1258.97 1980.76,1343 1983.07,1283.62 1985.38,1484.49 1987.69,1244.54 1989.99,1279.57 1992.3,1325.53 1994.61,1270.24 1996.92,1482.4 1999.23,1444.34 2001.53,1397.54 2003.84,1409.35 2006.15,1295.33 2008.46,1175.5 2010.77,1479.65 2013.07,1470.55 2015.38,1550.88 2017.69,1416.96 2020,1539.77 2022.3,1520.33 2024.61,1310.49 2026.92,1344.52 2029.23,1516.23 2031.54,1488.87 2033.84,1425.06 2036.15,1318.49 2038.46,1433.01 2040.77,1451.61 2043.08,1465.5 2045.38,1381.98 2047.69,1472.56 2050,1481.71 2052.31,1472.65 2054.62,1483.63 2056.92,1234.96 2059.23,1224.99 2061.54,1474.24 2063.85,1456.77 2066.16,1510.4 2068.46,1388.31 2070.77,1577.26 2073.08,1370.53 2075.39,1510.88 2077.69,1371.71 2080,1372.39 2082.31,1403.86 2084.62,1413.36 2086.93,1364.82 2089.23,1379.76 2091.54,1389.45 2093.85,1277.88 2096.16,1445.47 2098.47,1425.93 2100.77,1442.15 2103.08,1351.5 2105.39,1314.55 2107.7,1562 2110.01,1669.74 2112.31,1381.35 2114.62,1306.61 2116.93,1359.54 2119.24,1353.74 2121.55,1393.67 2123.85,1306.67 2126.16,1522.66 2128.47,1522.41 2130.78,1472.21 2133.08,1467.79 2135.39,1436.89 2137.7,1618.52 2140.01,1405.79 2142.32,1329.46 2144.62,1379.23 2146.93,1597.66 2149.24,1378.69 2151.55,1328.33 2153.86,1528.41 2156.16,1455.21 2158.47,1444.88 2160.78,1453.46 2163.09,1475.4 2165.4,1594.64 2167.7,1469.22 2170.01,1366.07 2172.32,1432.72 2174.63,1385.98 2176.93,1439.48 2179.24,1463.37 2181.55,1267.54 2183.86,1446.16 2186.17,1499.94 2188.47,1373.19 2190.78,1427.24 2193.09,1565.47 2195.4,1415.78 2197.71,1512.93 2200.01,1404.45 2202.32,1478.12 2204.63,1292.47 2206.94,1400.13 2209.25,1382.9 2211.55,1407.67 2213.86,1421.39 2216.17,1483 2218.48,1418.41 2220.79,1351.19 2223.09,1511.19 2225.4,1380.69 2227.71,1433.49 2230.02,1275.57 2232.32,1505.64 2234.63,1622.46 2236.94,1362.51 2239.25,1486.45 2241.56,1440.2 2243.86,1365.07 2246.17,1452.7 2248.48,1415.73 2250.79,1290.41 2253.1,1247.75 2255.4,1308.23 2257.71,1432.77 2260.02,1190.47 2262.33,1552.58 2264.64,1313.4 2266.94,1378.49 2269.25,1515.07 2271.56,1627.05 2273.87,1392.85 2276.18,1368.7 2278.48,1263.56 2280.79,1419.47 2283.1,1520.86 2285.41,1419.05 2287.71,1415.9 2290.02,1431.92 2292.33,1293.77 2294.64,1389.78 2296.95,1338.06 2299.25,1391.71 2301.56,1184.77 2303.87,1489.52 2306.18,1390.87 2308.49,1430.21 2310.79,1329.79 2313.1,1377.87 2315.41,1598.6 2317.72,1437.45 2320.03,1369.16 2322.33,1509.3 2324.64,1273.21 2326.95,1413.42 2329.26,1566.33 2331.56,1621.91 2333.87,1315.25 2336.18,1282.2 2338.49,1342.8 2340.8,1435.48 2343.1,1463.99 2345.41,1495.17 2347.72,1525.61 2350.03,1456.36 2352.34,1449.03 2354.64,1434.2 2356.95,1399.87 2359.26,1406.44 2361.57,1339.47 2363.88,1333.75 2366.18,1358.82 2368.49,1363.72 2370.8,1352.29 2373.11,1577.04 2375.42,1586.56 2377.72,1356.41 2380.03,1378.27 2382.34,1446.17 2384.65,1558.37 2386.95,1383.22 2389.26,1451.78 2391.57,1214.04 2393.88,1507.29 2396.19,1393.09 2398.49,1282.86 2400.8,1242.43 2403.11,1526.12 2405.42,1453.32 2407.73,1479.1 2410.03,1551.32 2412.34,1682.88 2414.65,1381.17 2416.96,1260.76 2419.27,1478.18 2421.57,1465.2 2423.88,1369.67 2426.19,1339.82 2428.5,1492.6 2430.81,1409.99 2433.11,1457.36 2435.42,1398.4 2437.73,1558.29 2440.04,1415.73 2442.34,1378.51 2444.65,1435.04 2446.96,1571.85 2449.27,1431.32 2451.58,1398.81 2453.88,1497.52 2456.19,1492.22 2458.5,1440.23 2460.81,1419.78 2463.12,1224.54 2465.42,1449.48 2467.73,1545.63 2470.04,1376.16 2472.35,1530.93 2474.66,1411.77 2476.96,1348.71 2479.27,1418.25 2481.58,1332.11 2483.89,1439.86 2486.2,1317.61 2488.5,1273.53 2490.81,1368.6 2493.12,1245.63 2495.43,1360.04 2497.73,1490.36 2500.04,1397.06 2502.35,1480.23 2504.66,1458.88 2506.97,1379.52 2509.27,1228.02 2511.58,1316.45 2513.89,1181.29 2516.2,1226.9 2518.51,1381.74 2520.81,1315.04 2523.12,1452.02 2525.43,1490.71 2527.74,1504.59 2530.05,1426.82 2532.35,1525.19 2534.66,1314.93 2536.97,1470.31 2539.28,1323.13 2541.58,1502.45 2543.89,1346.34 2546.2,1398.84 2548.51,1340.74 2550.82,1310.27 2553.12,1342.28 2555.43,1470.63 2557.74,1505.5 2560.05,1279.89 2562.36,1375.29 2564.66,1346.9 2566.97,1469.69 2569.28,1642.44 2571.59,1513.43 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,862.674 268.292,864.349 270.6,970.123 272.908,1043.62 275.216,1007.43 277.524,1061.46 279.832,1114.81 282.139,908.116 284.447,915.243 286.755,1005.37 289.063,887.082 291.371,885.685 293.679,794.914 295.987,1002.36 298.295,929.391 300.603,844.73 302.911,875.188 305.219,925.856 307.527,951.833 309.834,933.068 312.142,903.114 314.45,941.873 316.758,863.947 319.066,1041.54 321.374,1075.97 323.682,1147.94 325.99,879.829 328.298,979.958 330.606,869.241 332.914,775.578 335.221,946.788 337.529,884.646 339.837,882.956 342.145,850.117 344.453,959.707 346.761,898.46 349.069,868.311 351.377,816.208 353.685,919.546 355.993,1007.8 358.301,862.384 360.608,826.06 362.916,1015.56 365.224,848.198 367.532,978.506 369.84,1001.46 372.148,1017.11 374.456,870.447 376.764,910.945 379.072,966.489 381.38,887.827 383.688,1008.13 385.996,823.038 388.303,932.98 390.611,880.416 392.919,791.369 395.227,937.74 397.535,966.194 399.843,946.373 402.151,978.073 404.459,910.447 406.767,918.097 409.075,977.391 411.383,972.847 413.69,1126.95 415.998,817.266 418.306,829.662 420.614,1033.34 422.922,915.105 425.23,836.03 427.538,1024.23 429.846,718.221 432.154,935.128 434.462,1028.93 436.77,843.776 439.077,940.859 441.385,998.06 443.693,948.849 446.001,992.027 448.309,974.422 450.617,876.793 452.925,917.256 455.233,913.499 457.541,943.421 459.849,882.688 462.157,1010.39 464.465,953.689 466.772,956.068 469.08,872.841 471.388,1024.06 473.696,942.164 476.004,859.215 478.312,947.433 480.62,997.031 482.928,875.329 485.236,858.47 487.544,875.163 489.852,1064.3 492.159,1055.33 494.467,707.54 496.775,791.218 499.083,798.346 501.391,981.498 503.699,971.45 506.007,847.4 508.315,993.561 510.623,831.694 512.931,836.516 515.239,879.187 517.546,974.154 519.854,962.958 522.162,1029.31 524.47,979.011 526.778,950.376 529.086,1014.35 531.394,921.325 533.702,785.128 536.01,986.034 538.318,947.192 540.626,899.813 542.933,1195.84 545.241,991.459 547.549,1081.12 549.857,746.705 552.165,946.542 554.473,917.089 556.781,938.068 559.089,826.555 561.397,1026.78 563.705,797.582 566.013,916.486 568.321,921.732 570.628,942.93 572.936,827.054 575.244,966.223 577.552,789.46 579.86,980.403 582.168,971.667 584.476,967.084 586.784,1054.3 589.092,803.714 591.4,1008.1 593.708,1179.93 596.015,960.613 598.323,760.89 600.631,935.645 602.939,957.989 605.247,1006.73 607.555,776.226 609.863,938.905 612.171,902.34 614.479,865.711 616.787,827.399 619.095,860.582 621.402,1021.51 623.71,771.715 626.018,739.381 628.326,855.592 630.634,945.479 632.942,906.555 635.25,938.971 637.558,1017.77 639.866,1055.54 642.174,819.896 644.482,909.312 646.79,877.012 649.097,959.364 651.405,830.659 653.713,925.611 656.021,984.147 658.329,975.94 660.637,965.244 662.945,879.168 665.253,692.46 667.561,786.004 669.869,1155.79 672.177,985.384 674.484,832.33 676.792,938.222 679.1,815.504 681.408,818.701 683.716,1064.09 686.024,866.478 688.332,1137.8 690.64,979.183 692.948,838.674 695.256,962.523 697.564,972.532 699.871,740.444 702.179,907.249 704.487,1033.81 706.795,827.253 709.103,904.385 711.411,814.63 713.719,889.219 716.027,794.145 718.335,715.455 720.643,769.383 722.951,994.057 725.259,760.57 727.566,778.569 729.874,839.317 732.182,899.163 734.49,862.247 736.798,834.223 739.106,822.95 741.414,824.776 743.722,960.501 746.03,1047.3 748.338,844.009 750.646,1108.51 752.953,823.159 755.261,784.599 757.569,975.942 759.877,978.872 762.185,913.951 764.493,1076.62 766.801,909.01 769.109,959.534 771.417,888.724 773.725,1041.62 776.033,886.028 778.34,1031.14 780.648,1042.72 782.956,868.318 785.264,848.335 787.572,868.038 789.88,952.487 792.188,865.914 794.496,786.642 796.804,756.099 799.112,832.766 801.42,986.716 803.728,1090.22 806.035,970.425 808.343,993.751 810.651,887.356 812.959,873.048 815.267,1021.75 817.575,902.49 819.883,926.385 822.191,988.32 824.499,901.178 826.807,772.557 829.115,939.408 831.422,769.589 833.73,1017.66 836.038,947.558 838.346,940.528 840.654,929.521 842.962,1085.53 845.27,996.328 847.578,912.353 849.886,1003.21 852.194,1015.56 854.502,976.833 856.809,1026.2 859.117,951.937 861.425,1011.24 863.733,870.173 866.041,914.902 868.349,846.819 870.657,954.92 872.965,1102 875.273,749.31 877.581,810.154 879.889,914.43 882.197,828.484 884.504,1031.24 886.812,944.571 889.12,849.484 891.428,957.724 893.736,1056.39 896.044,902.407 898.352,843.169 900.66,968.893 902.968,783.423 905.276,766.568 907.584,864.508 909.891,739.802 912.199,1002.51 914.507,968.956 916.815,1006.81 919.123,827.505 921.431,967.758 923.739,1086.94 926.047,1004.18 928.355,997.464 930.663,932.988 932.971,993.297 935.278,1030.12 937.586,984.831 939.894,835.767 942.202,846.91 944.51,969.7 946.818,943.434 949.126,855.015 951.434,962.21 953.742,877.763 956.05,887.7 958.358,938.548 960.665,1038.1 962.973,958.488 965.281,1007.16 967.589,985.421 969.897,733.328 972.205,896.154 974.513,943.23 976.821,819.871 979.129,974.066 981.437,902.022 983.745,968.435 986.053,940.069 988.36,1016.85 990.668,1058.34 992.976,862.669 995.284,965.762 997.592,846.919 999.9,791.947 1002.21,1016.31 1004.52,965.629 1006.82,752.756 1009.13,870.853 1011.44,1038.17 1013.75,930.963 1016.06,903.831 1018.36,852.049 1020.67,978.281 1022.98,1035.28 1025.29,650.96 1027.59,1023.75 1029.9,920.75 1032.21,844.288 1034.52,1000.17 1036.83,845.238 1039.13,889.549 1041.44,910.786 1043.75,978.494 1046.06,853.934 1048.37,969.742 1050.67,829.495 1052.98,882.858 1055.29,886.456 1057.6,1051.02 1059.91,948.108 1062.21,767.518 1064.52,903.024 1066.83,983.978 1069.14,810.369 1071.45,815.324 1073.75,995.102 1076.06,956.023 1078.37,941.196 1080.68,912.527 1082.98,1006.85 1085.29,829.893 1087.6,955.773 1089.91,850.334 1092.22,992.868 1094.52,979.415 1096.83,1012.33 1099.14,980.948 1101.45,890.747 1103.76,883.507 1106.06,938.92 1108.37,986.566 1110.68,748.214 1112.99,1021.9 1115.3,850.374 1117.6,911.393 1119.91,867.627 1122.22,927.463 1124.53,853.583 1126.84,1005.05 1129.14,1082.97 1131.45,830.176 1133.76,912.532 1136.07,1091.63 1138.37,824.513 1140.68,913.841 1142.99,990.816 1145.3,1025.41 1147.61,917.355 1149.91,850.189 1152.22,1099.77 1154.53,1064.09 1156.84,833.01 1159.15,958.478 1161.45,906.189 1163.76,998.158 1166.07,988.898 1168.38,868.341 1170.69,984.881 1172.99,831.262 1175.3,881.054 1177.61,950.989 1179.92,785.059 1182.23,690.174 1184.53,850.858 1186.84,1023.59 1189.15,873.176 1191.46,874.932 1193.76,915.663 1196.07,912.591 1198.38,1046.39 1200.69,935.535 1203,907.388 1205.3,918.379 1207.61,917.037 1209.92,968.732 1212.23,951.196 1214.54,882.093 1216.84,872.297 1219.15,861.852 1221.46,857.731 1223.77,882.039 1226.08,942.555 1228.38,824.223 1230.69,876.567 1233,1098.97 1235.31,908.036 1237.61,710.416 1239.92,901.076 1242.23,760.282 1244.54,754.559 1246.85,981.854 1249.15,686.839 1251.46,964.836 1253.77,862.749 1256.08,848.522 1258.39,933.75 1260.69,636.371 1263,1010.94 1265.31,772.605 1267.62,746.164 1269.93,863.044 1272.23,742.845 1274.54,845.385 1276.85,897.508 1279.16,862.29 1281.47,827.713 1283.77,927.802 1286.08,971.675 1288.39,939.191 1290.7,970.636 1293,1010.19 1295.31,865.426 1297.62,881.882 1299.93,829.868 1302.24,928.119 1304.54,970.066 1306.85,968.348 1309.16,884.621 1311.47,778.412 1313.78,1005.64 1316.08,658.434 1318.39,861.02 1320.7,802.402 1323.01,940.936 1325.32,940.044 1327.62,889.381 1329.93,951.431 1332.24,865.203 1334.55,832.313 1336.86,768.293 1339.16,826.744 1341.47,798.576 1343.78,1069.36 1346.09,839.581 1348.39,1026.28 1350.7,793.265 1353.01,897.335 1355.32,841.624 1357.63,1032.47 1359.93,794.541 1362.24,895.839 1364.55,860.97 1366.86,820.711 1369.17,888.509 1371.47,822.821 1373.78,882.864 1376.09,860.922 1378.4,995.726 1380.71,1010.72 1383.01,973.084 1385.32,926.598 1387.63,745.668 1389.94,941.542 1392.24,899.806 1394.55,855.136 1396.86,1015.56 1399.17,992.249 1401.48,1196.18 1403.78,1120.3 1406.09,796.089 1408.4,1033.85 1410.71,914.855 1413.02,857.09 1415.32,927.059 1417.63,814.854 1419.94,863.289 1422.25,1030.62 1424.56,956.326 1426.86,797.633 1429.17,1130.95 1431.48,840.049 1433.79,969.879 1436.1,854.381 1438.4,1007.54 1440.71,835.193 1443.02,864.809 1445.33,748.335 1447.63,1047.47 1449.94,873.873 1452.25,975.373 1454.56,1027.33 1456.87,915.113 1459.17,859.662 1461.48,885.686 1463.79,961.122 1466.1,864.019 1468.41,895.171 1470.71,941.449 1473.02,920.258 1475.33,881.176 1477.64,872.861 1479.95,921.176 1482.25,834.276 1484.56,849.14 1486.87,875.963 1489.18,768.216 1491.49,799.871 1493.79,988.267 1496.1,872.976 1498.41,936.731 1500.72,920.792 1503.02,901.53 1505.33,915.51 1507.64,1064.06 1509.95,1118.65 1512.26,1003.74 1514.56,876.482 1516.87,864.544 1519.18,956.058 1521.49,848.451 1523.8,1126.12 1526.1,894.904 1528.41,1004.43 1530.72,1113.92 1533.03,789.062 1535.34,895.101 1537.64,760.278 1539.95,922.053 1542.26,796.54 1544.57,808.889 1546.88,997.291 1549.18,925.331 1551.49,1001.74 1553.8,1056.1 1556.11,948.644 1558.41,940.161 1560.72,803.905 1563.03,842.045 1565.34,873.672 1567.65,1008.03 1569.95,865.659 1572.26,930.854 1574.57,751.562 1576.88,938.501 1579.19,874.128 1581.49,885.658 1583.8,858.588 1586.11,920.024 1588.42,894.191 1590.73,943.508 1593.03,985.578 1595.34,895.311 1597.65,916.523 1599.96,946.11 1602.26,1153.98 1604.57,1139.48 1606.88,714.339 1609.19,1035.56 1611.5,1163.63 1613.8,855.211 1616.11,828.409 1618.42,934.65 1620.73,1057.93 1623.04,882.494 1625.34,959.295 1627.65,815.272 1629.96,911.216 1632.27,845.788 1634.58,880.021 1636.88,930.937 1639.19,765.696 1641.5,792.707 1643.81,932.54 1646.12,959.281 1648.42,844.698 1650.73,888.312 1653.04,858.793 1655.35,923.517 1657.65,843.393 1659.96,862.541 1662.27,844.285 1664.58,897.231 1666.89,926.697 1669.19,772.926 1671.5,1051.11 1673.81,1017.05 1676.12,915.783 1678.43,958.07 1680.73,976.041 1683.04,964.396 1685.35,1064.69 1687.66,740.745 1689.97,947.981 1692.27,934.545 1694.58,745.125 1696.89,790.35 1699.2,777.209 1701.51,883.963 1703.81,994.401 1706.12,995.129 1708.43,974.41 1710.74,1047.48 1713.04,923.935 1715.35,797.542 1717.66,922.341 1719.97,971.739 1722.28,985.227 1724.58,839.378 1726.89,938.899 1729.2,949.667 1731.51,973.837 1733.82,1120.18 1736.12,931.198 1738.43,799.009 1740.74,982.632 1743.05,838.663 1745.36,796.826 1747.66,1086.34 1749.97,840.151 1752.28,913.557 1754.59,806.466 1756.9,1147.03 1759.2,965.776 1761.51,1028.11 1763.82,947.428 1766.13,973.09 1768.43,892.99 1770.74,942.504 1773.05,1154.1 1775.36,861.494 1777.67,829.04 1779.97,779.733 1782.28,945.73 1784.59,997.199 1786.9,843.592 1789.21,745.289 1791.51,956.455 1793.82,843.136 1796.13,817.583 1798.44,849.612 1800.75,928.145 1803.05,989.012 1805.36,864.997 1807.67,1091.35 1809.98,745.569 1812.28,860.279 1814.59,1020.75 1816.9,866.233 1819.21,827.495 1821.52,797.968 1823.82,877.035 1826.13,784.069 1828.44,1004.18 1830.75,849.583 1833.06,949.148 1835.36,806.886 1837.67,853.806 1839.98,897.873 1842.29,1044.92 1844.6,913.647 1846.9,1081.2 1849.21,934.596 1851.52,974.114 1853.83,968.736 1856.14,879.267 1858.44,1003.66 1860.75,793.864 1863.06,1048.08 1865.37,1008.93 1867.67,840.565 1869.98,1018.34 1872.29,924.222 1874.6,1132.59 1876.91,1035.04 1879.21,1093.68 1881.52,836.328 1883.83,1066.46 1886.14,757.233 1888.45,1049.92 1890.75,871.238 1893.06,903.1 1895.37,969.954 1897.68,882.654 1899.99,893.188 1902.29,1108.98 1904.6,951.645 1906.91,740.876 1909.22,1101.88 1911.53,941.882 1913.83,903.999 1916.14,708.703 1918.45,1035.48 1920.76,907.122 1923.06,889.198 1925.37,1036.06 1927.68,946.854 1929.99,896.265 1932.3,920.997 1934.6,947.241 1936.91,852.929 1939.22,966.563 1941.53,926.174 1943.84,1125.27 1946.14,1031.02 1948.45,794.539 1950.76,902.265 1953.07,836.299 1955.38,1042.29 1957.68,949.708 1959.99,1062.6 1962.3,975.636 1964.61,956.108 1966.91,1015.61 1969.22,815.291 1971.53,899.748 1973.84,911.667 1976.15,797.96 1978.45,1037.46 1980.76,927.407 1983.07,847.067 1985.38,878.958 1987.69,867.861 1989.99,827.279 1992.3,855.546 1994.61,924.339 1996.92,925.199 1999.23,988.769 2001.53,872.452 2003.84,930.054 2006.15,846.101 2008.46,858.169 2010.77,1016.48 2013.07,862.042 2015.38,1046.95 2017.69,983.702 2020,933.589 2022.3,910.998 2024.61,1010.92 2026.92,893.351 2029.23,989.315 2031.54,858.278 2033.84,979.182 2036.15,786.024 2038.46,967.814 2040.77,1085.91 2043.08,857.899 2045.38,935.862 2047.69,997.625 2050,964.765 2052.31,948.625 2054.62,876.042 2056.92,774.016 2059.23,789.179 2061.54,890.983 2063.85,1055.83 2066.16,737.371 2068.46,862.945 2070.77,805.946 2073.08,826.898 2075.39,728.691 2077.69,1061.97 2080,958.542 2082.31,891.221 2084.62,863.705 2086.93,872.322 2089.23,836.887 2091.54,1062.02 2093.85,654.985 2096.16,1057.11 2098.47,993.172 2100.77,1030.67 2103.08,771.877 2105.39,1070.63 2107.7,1070.29 2110.01,814.496 2112.31,850.379 2114.62,990.579 2116.93,986.247 2119.24,959.219 2121.55,919.912 2123.85,712.799 2126.16,1035.1 2128.47,944.542 2130.78,899.874 2133.08,980.252 2135.39,988.859 2137.7,855.369 2140.01,975.021 2142.32,1001.29 2144.62,870.027 2146.93,849.544 2149.24,1112.93 2151.55,720.464 2153.86,761.802 2156.16,859.009 2158.47,911.452 2160.78,962.027 2163.09,817.397 2165.4,939.284 2167.7,911.331 2170.01,884.558 2172.32,1024.15 2174.63,877.217 2176.93,893.034 2179.24,955.182 2181.55,896.123 2183.86,919.138 2186.17,837.576 2188.47,937.092 2190.78,1113.37 2193.09,1119.59 2195.4,903.195 2197.71,1063.5 2200.01,747.705 2202.32,889.519 2204.63,1114.98 2206.94,856.552 2209.25,794.869 2211.55,1011.54 2213.86,971.833 2216.17,1041.19 2218.48,993.785 2220.79,1105 2223.09,1032.22 2225.4,1023.71 2227.71,936.041 2230.02,796.873 2232.32,776.356 2234.63,838.589 2236.94,741.04 2239.25,726.392 2241.56,1031.44 2243.86,788.907 2246.17,927.777 2248.48,917.31 2250.79,979.613 2253.1,884.539 2255.4,908.004 2257.71,891.798 2260.02,907.479 2262.33,1051.43 2264.64,901.494 2266.94,804.289 2269.25,1046.31 2271.56,905.091 2273.87,842.277 2276.18,820.113 2278.48,922.026 2280.79,971.293 2283.1,983.745 2285.41,1067.45 2287.71,865.401 2290.02,1004.42 2292.33,1020.18 2294.64,984.901 2296.95,932.241 2299.25,816.133 2301.56,890.808 2303.87,873.031 2306.18,987.737 2308.49,993.643 2310.79,770.985 2313.1,884.854 2315.41,1008.09 2317.72,758.396 2320.03,836.71 2322.33,881.703 2324.64,998.131 2326.95,760.521 2329.26,925.624 2331.56,853.608 2333.87,718.745 2336.18,1051.1 2338.49,757.61 2340.8,1063.74 2343.1,814.608 2345.41,950.792 2347.72,955.948 2350.03,1045.09 2352.34,972.951 2354.64,1002.89 2356.95,744.739 2359.26,848.151 2361.57,1050.32 2363.88,1064.12 2366.18,901.363 2368.49,648.834 2370.8,727.62 2373.11,851.098 2375.42,941.408 2377.72,1073.49 2380.03,750.503 2382.34,1022.61 2384.65,872.914 2386.95,804.126 2389.26,801.377 2391.57,916.854 2393.88,874.393 2396.19,872.405 2398.49,830.357 2400.8,989.596 2403.11,1089.12 2405.42,900.603 2407.73,1098.94 2410.03,1021.13 2412.34,836.339 2414.65,1026.21 2416.96,941.946 2419.27,948.316 2421.57,1005.74 2423.88,1031.53 2426.19,987.109 2428.5,931.595 2430.81,1039.23 2433.11,840.549 2435.42,778.123 2437.73,773.151 2440.04,802.547 2442.34,1028.37 2444.65,945.208 2446.96,846.577 2449.27,871.528 2451.58,854.522 2453.88,794.796 2456.19,819.961 2458.5,741.912 2460.81,876.659 2463.12,931.789 2465.42,904.732 2467.73,869.442 2470.04,731.979 2472.35,1205.65 2474.66,918.175 2476.96,819.455 2479.27,769.392 2481.58,923.018 2483.89,904.466 2486.2,1150.33 2488.5,889.759 2490.81,768.394 2493.12,987.171 2495.43,825.192 2497.73,887.023 2500.04,988.404 2502.35,988.452 2504.66,873.564 2506.97,955.031 2509.27,847.989 2511.58,958.471 2513.89,1111.36 2516.2,949.988 2518.51,997.585 2520.81,947.281 2523.12,983.783 2525.43,985.405 2527.74,867.455 2530.05,865.124 2532.35,1114.64 2534.66,953.506 2536.97,954.879 2539.28,1165.01 2541.58,890.136 2543.89,919.107 2546.2,838.501 2548.51,901.827 2550.82,977.788 2553.12,989.606 2555.43,935.514 2557.74,924.719 2560.05,916.342 2562.36,875.334 2564.66,913.792 2566.97,710.03 2569.28,887.869 2571.59,986.935 "></polyline>
<polyline clip-path="url(#clip312)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,699.808 268.292,529.134 270.6,369.04 272.908,553.135 275.216,423.264 277.524,426.33 279.832,423.274 282.139,432.864 284.447,635.209 286.755,506.082 289.063,441.706 291.371,527.545 293.679,381.068 295.987,335.928 298.295,330.943 300.603,445.917 302.911,488.792 305.219,456.223 307.527,530.93 309.834,468.166 312.142,416.067 314.45,565.5 316.758,587.882 319.066,629.966 321.374,541.897 323.682,276.007 325.99,471.672 328.298,493.756 330.606,381.613 332.914,338.1 335.221,463.592 337.529,451.978 339.837,449.396 342.145,487.107 344.453,455.094 346.761,484.129 349.069,388.436 351.377,437.383 353.685,430.281 355.993,534.3 358.301,458.908 360.608,393.209 362.916,581.966 365.224,512.838 367.532,334.3 369.84,568.64 372.148,363.479 374.456,317.843 376.764,576.997 379.072,376.477 381.38,416.073 383.688,298.358 385.996,349.283 388.303,347.201 390.611,348.157 392.919,350.718 395.227,489.094 397.535,486.245 399.843,513.156 402.151,410.482 404.459,222.523 406.767,527.145 409.075,405.54 411.383,367.099 413.69,506.499 415.998,586.128 418.306,449.229 420.614,506.358 422.922,436.25 425.23,449.593 427.538,451.762 429.846,318.628 432.154,511.587 434.462,457.903 436.77,517.652 439.077,352.894 441.385,491.977 443.693,408.443 446.001,426.517 448.309,531.549 450.617,526.253 452.925,315.567 455.233,522.602 457.541,443.396 459.849,342.438 462.157,268.908 464.465,460.959 466.772,501.386 469.08,498.947 471.388,387.157 473.696,476.373 476.004,375.64 478.312,244.625 480.62,492.222 482.928,447.474 485.236,203.462 487.544,283.555 489.852,530.614 492.159,472.131 494.467,282.38 496.775,401.072 499.083,259.953 501.391,460.32 503.699,327.798 506.007,546.658 508.315,574.226 510.623,467.13 512.931,383.448 515.239,406.995 517.546,538.873 519.854,417.31 522.162,400.2 524.47,485.335 526.778,431.899 529.086,479.674 531.394,412.466 533.702,548.121 536.01,474.163 538.318,395.943 540.626,328.884 542.933,478.627 545.241,530.5 547.549,413.555 549.857,629.671 552.165,451.443 554.473,323.71 556.781,316.733 559.089,495.404 561.397,570.138 563.705,409.124 566.013,603.703 568.321,418.02 570.628,367.875 572.936,467.3 575.244,317.975 577.552,448.545 579.86,281.369 582.168,483.412 584.476,414.01 586.784,403.617 589.092,421.77 591.4,481.274 593.708,398.731 596.015,354.191 598.323,411 600.631,299.131 602.939,472.747 605.247,402.934 607.555,509.85 609.863,510.106 612.171,359.315 614.479,452.541 616.787,253.786 619.095,519.187 621.402,318.815 623.71,429.289 626.018,326.333 628.326,376.352 630.634,404.702 632.942,478.373 635.25,336.656 637.558,433.507 639.866,544.211 642.174,549.588 644.482,262.597 646.79,568.483 649.097,483.781 651.405,446.872 653.713,390.409 656.021,591.661 658.329,355.12 660.637,487.439 662.945,470.075 665.253,565.547 667.561,620.953 669.869,563.924 672.177,430.852 674.484,365.607 676.792,375.143 679.1,524.888 681.408,414.483 683.716,449.609 686.024,528.374 688.332,576.189 690.64,632.045 692.948,367.524 695.256,474.996 697.564,563.142 699.871,364.99 702.179,483.098 704.487,462.304 706.795,487.014 709.103,403.286 711.411,439.051 713.719,499.503 716.027,361.869 718.335,523.823 720.643,437.405 722.951,485.148 725.259,466.421 727.566,473.488 729.874,496.312 732.182,463.643 734.49,450.735 736.798,456.483 739.106,440.744 741.414,651.585 743.722,486.645 746.03,478.633 748.338,299.893 750.646,331.804 752.953,465.058 755.261,374.739 757.569,674.505 759.877,508.778 762.185,494.338 764.493,325.352 766.801,292.737 769.109,421.333 771.417,595.255 773.725,415.686 776.033,340.08 778.34,465.411 780.648,431.766 782.956,452.317 785.264,316.494 787.572,322.299 789.88,401.407 792.188,358.705 794.496,561.936 796.804,611.099 799.112,556.052 801.42,268.104 803.728,412.225 806.035,453.87 808.343,598.356 810.651,369.315 812.959,243.755 815.267,554.092 817.575,270.26 819.883,473.398 822.191,366.804 824.499,500.254 826.807,648.076 829.115,333.948 831.422,433.274 833.73,496.349 836.038,507.708 838.346,527.436 840.654,550.671 842.962,354.318 845.27,439.793 847.578,285.913 849.886,390.894 852.194,464.646 854.502,468.21 856.809,530.181 859.117,548.737 861.425,284.409 863.733,439.825 866.041,330.512 868.349,366.989 870.657,380.508 872.965,503.733 875.273,432.021 877.581,454.409 879.889,296.901 882.197,390.628 884.504,238.029 886.812,472.734 889.12,401.157 891.428,487.829 893.736,256.287 896.044,548.308 898.352,332.128 900.66,436.161 902.968,399.138 905.276,413.606 907.584,410.013 909.891,412.01 912.199,483.777 914.507,391.684 916.815,297.651 919.123,608.997 921.431,514.089 923.739,596.326 926.047,410.923 928.355,318.213 930.663,316.443 932.971,458.285 935.278,454.651 937.586,455.306 939.894,292.308 942.202,395.725 944.51,476.175 946.818,469.789 949.126,276.559 951.434,478.921 953.742,435.58 956.05,472.135 958.358,449.796 960.665,384.076 962.973,305.218 965.281,468.975 967.589,459.716 969.897,403.856 972.205,518.314 974.513,231.266 976.821,550.957 979.129,446.212 981.437,334.385 983.745,304.052 986.053,539.425 988.36,366.939 990.668,338.502 992.976,556.424 995.284,477.01 997.592,390.104 999.9,405.831 1002.21,376.747 1004.52,419.022 1006.82,349.427 1009.13,439.797 1011.44,453.897 1013.75,419.585 1016.06,291.271 1018.36,357.322 1020.67,218.647 1022.98,482.315 1025.29,243.676 1027.59,529.048 1029.9,458.028 1032.21,452.757 1034.52,419.355 1036.83,521.35 1039.13,521.679 1041.44,529.279 1043.75,396.513 1046.06,649.975 1048.37,494.264 1050.67,439.136 1052.98,385.969 1055.29,367.651 1057.6,474.407 1059.91,435.48 1062.21,483.26 1064.52,436.71 1066.83,473.048 1069.14,372.45 1071.45,306.318 1073.75,369.946 1076.06,522.366 1078.37,583.955 1080.68,401.307 1082.98,460.043 1085.29,382.765 1087.6,393.663 1089.91,456.732 1092.22,610.318 1094.52,427.691 1096.83,571.156 1099.14,486.315 1101.45,505.085 1103.76,424.538 1106.06,577.094 1108.37,505.467 1110.68,441.2 1112.99,290.785 1115.3,280.808 1117.6,484.795 1119.91,476.045 1122.22,442.312 1124.53,503.341 1126.84,434.283 1129.14,459.646 1131.45,340.583 1133.76,212.074 1136.07,537.655 1138.37,219.226 1140.68,492.039 1142.99,510.067 1145.3,433.122 1147.61,348.84 1149.91,332.46 1152.22,402.619 1154.53,436.519 1156.84,494.398 1159.15,443.261 1161.45,565.472 1163.76,428.193 1166.07,574.899 1168.38,592.463 1170.69,359.049 1172.99,455.025 1175.3,534.577 1177.61,283.582 1179.92,281.348 1182.23,491.436 1184.53,464.059 1186.84,584.527 1189.15,486.41 1191.46,390.702 1193.76,311.142 1196.07,441.788 1198.38,615.856 1200.69,363.477 1203,390.044 1205.3,291.999 1207.61,347.051 1209.92,374.818 1212.23,578.112 1214.54,448.891 1216.84,450.949 1219.15,397.259 1221.46,530.707 1223.77,481.671 1226.08,477.465 1228.38,492.333 1230.69,351.852 1233,362.309 1235.31,331.42 1237.61,439.494 1239.92,426.705 1242.23,345.327 1244.54,450.506 1246.85,428.359 1249.15,483.372 1251.46,620.508 1253.77,535.719 1256.08,434.398 1258.39,460.159 1260.69,480.344 1263,570.507 1265.31,620.837 1267.62,250.068 1269.93,465.396 1272.23,403.616 1274.54,580.087 1276.85,545.922 1279.16,497.306 1281.47,368.211 1283.77,491.094 1286.08,455.747 1288.39,481.307 1290.7,280.148 1293,595.024 1295.31,357.709 1297.62,590.104 1299.93,376.182 1302.24,485.644 1304.54,528.561 1306.85,565.15 1309.16,233.707 1311.47,472.504 1313.78,352.586 1316.08,351.334 1318.39,445.068 1320.7,611.434 1323.01,115.745 1325.32,435.652 1327.62,306.204 1329.93,221.875 1332.24,495.85 1334.55,529.683 1336.86,427.522 1339.16,443.257 1341.47,354.683 1343.78,705.422 1346.09,397.602 1348.39,520.619 1350.7,219.287 1353.01,429.228 1355.32,686.554 1357.63,369.411 1359.93,402.94 1362.24,443.621 1364.55,426.207 1366.86,492.34 1369.17,317.068 1371.47,469.152 1373.78,533.1 1376.09,470.395 1378.4,424.206 1380.71,334.489 1383.01,505.46 1385.32,459.968 1387.63,434.403 1389.94,349.743 1392.24,290.736 1394.55,279.56 1396.86,613.658 1399.17,459.939 1401.48,359.73 1403.78,380.203 1406.09,403.338 1408.4,328.591 1410.71,486.736 1413.02,600.183 1415.32,378.771 1417.63,485.326 1419.94,488.505 1422.25,351.54 1424.56,531.024 1426.86,437.534 1429.17,530.309 1431.48,623.189 1433.79,263.531 1436.1,450.19 1438.4,345.881 1440.71,405.867 1443.02,416.11 1445.33,492.369 1447.63,469.013 1449.94,527.154 1452.25,390.184 1454.56,408.265 1456.87,416.484 1459.17,487.733 1461.48,295.746 1463.79,461.389 1466.1,352.824 1468.41,409.093 1470.71,302.706 1473.02,291.007 1475.33,341.399 1477.64,393.103 1479.95,421.919 1482.25,342.939 1484.56,481.588 1486.87,152.468 1489.18,389.928 1491.49,403.202 1493.79,513.615 1496.1,474.475 1498.41,313.592 1500.72,463.278 1503.02,509.917 1505.33,293.191 1507.64,450.1 1509.95,530.239 1512.26,647.784 1514.56,326.838 1516.87,514.314 1519.18,287.566 1521.49,530.452 1523.8,395.688 1526.1,285.594 1528.41,375.129 1530.72,305.764 1533.03,261.706 1535.34,376.462 1537.64,527.694 1539.95,409.775 1542.26,303.414 1544.57,351.217 1546.88,582.406 1549.18,566.133 1551.49,393.017 1553.8,293.45 1556.11,362.981 1558.41,376.736 1560.72,352.783 1563.03,545.561 1565.34,586.476 1567.65,416.789 1569.95,283.11 1572.26,432.022 1574.57,330.03 1576.88,331.477 1579.19,461.275 1581.49,338.551 1583.8,392.015 1586.11,623.221 1588.42,373.11 1590.73,442.953 1593.03,417.496 1595.34,359.46 1597.65,311.175 1599.96,235.629 1602.26,350.552 1604.57,276.569 1606.88,350.018 1609.19,268.109 1611.5,510.55 1613.8,459.691 1616.11,388.039 1618.42,382.333 1620.73,368.968 1623.04,669.291 1625.34,390.93 1627.65,529.303 1629.96,385.965 1632.27,388.097 1634.58,497.16 1636.88,178.199 1639.19,540.018 1641.5,452.62 1643.81,534.328 1646.12,555.277 1648.42,453.813 1650.73,461.96 1653.04,349.211 1655.35,471.206 1657.65,642.507 1659.96,311.89 1662.27,289.723 1664.58,520.138 1666.89,96.8724 1669.19,376.987 1671.5,406.873 1673.81,300.62 1676.12,413.636 1678.43,381.735 1680.73,480.797 1683.04,535.207 1685.35,266.471 1687.66,761.012 1689.97,482.476 1692.27,510.154 1694.58,547.651 1696.89,556.766 1699.2,480.468 1701.51,451.78 1703.81,604.382 1706.12,393.937 1708.43,402.197 1710.74,300.835 1713.04,306.672 1715.35,316.056 1717.66,288.713 1719.97,370.245 1722.28,417.793 1724.58,465.186 1726.89,512.401 1729.2,419.068 1731.51,485.969 1733.82,447.379 1736.12,510.221 1738.43,609.433 1740.74,368.66 1743.05,172.705 1745.36,354.632 1747.66,315.981 1749.97,419.977 1752.28,372.827 1754.59,291.039 1756.9,640.57 1759.2,526.656 1761.51,381.346 1763.82,226.408 1766.13,570.437 1768.43,457.468 1770.74,601.358 1773.05,569.801 1775.36,428.597 1777.67,428.574 1779.97,502.201 1782.28,471.218 1784.59,493.536 1786.9,654.198 1789.21,366.303 1791.51,270.621 1793.82,692.432 1796.13,532.537 1798.44,455.285 1800.75,525.77 1803.05,159.302 1805.36,541.008 1807.67,456.223 1809.98,373.932 1812.28,194.513 1814.59,410.705 1816.9,482.904 1819.21,415.026 1821.52,401.577 1823.82,422.762 1826.13,501.601 1828.44,291.991 1830.75,426.885 1833.06,509.351 1835.36,399.464 1837.67,403.185 1839.98,534.422 1842.29,576.957 1844.6,451.078 1846.9,432.558 1849.21,463.374 1851.52,286.402 1853.83,453.662 1856.14,326.27 1858.44,479.322 1860.75,542.947 1863.06,353.545 1865.37,461.434 1867.67,539.634 1869.98,432.073 1872.29,743.744 1874.6,665.268 1876.91,405.788 1879.21,457.822 1881.52,417.135 1883.83,427.304 1886.14,339.572 1888.45,499.352 1890.75,299.115 1893.06,471.363 1895.37,425.448 1897.68,220.128 1899.99,509.499 1902.29,571.34 1904.6,472.033 1906.91,365.781 1909.22,651.407 1911.53,487.688 1913.83,373.952 1916.14,536.321 1918.45,441.273 1920.76,332.877 1923.06,552.824 1925.37,538.076 1927.68,517.246 1929.99,442.5 1932.3,366.945 1934.6,355.444 1936.91,311.092 1939.22,602.586 1941.53,378.832 1943.84,500.584 1946.14,318.366 1948.45,471.033 1950.76,274.948 1953.07,408.519 1955.38,427.291 1957.68,530.378 1959.99,355.815 1962.3,340.506 1964.61,259.241 1966.91,376.738 1969.22,292.221 1971.53,299.248 1973.84,363.548 1976.15,422.404 1978.45,573.025 1980.76,325.753 1983.07,411.039 1985.38,541.941 1987.69,395.974 1989.99,387.712 1992.3,624.352 1994.61,649.102 1996.92,400.496 1999.23,333.575 2001.53,496.133 2003.84,332.573 2006.15,428.95 2008.46,382.76 2010.77,313.057 2013.07,347.269 2015.38,460.839 2017.69,536.925 2020,430.808 2022.3,295.314 2024.61,362.869 2026.92,368.918 2029.23,234.316 2031.54,592.282 2033.84,448.123 2036.15,411.621 2038.46,474.882 2040.77,461.65 2043.08,410.504 2045.38,260.575 2047.69,361.889 2050,393.038 2052.31,449.474 2054.62,486.494 2056.92,257.521 2059.23,411.288 2061.54,450.277 2063.85,352.908 2066.16,212.166 2068.46,367.149 2070.77,535.192 2073.08,517.218 2075.39,399.661 2077.69,463.938 2080,401.443 2082.31,461.202 2084.62,593.762 2086.93,569.884 2089.23,441.894 2091.54,234.617 2093.85,371.709 2096.16,457.131 2098.47,599.897 2100.77,481.177 2103.08,778.779 2105.39,546.986 2107.7,390.304 2110.01,492.6 2112.31,407.215 2114.62,432.287 2116.93,494.454 2119.24,498.955 2121.55,567.105 2123.85,434.466 2126.16,339.711 2128.47,478.029 2130.78,317.161 2133.08,496.004 2135.39,543.524 2137.7,652.542 2140.01,386.221 2142.32,382.144 2144.62,334.207 2146.93,427.263 2149.24,403.71 2151.55,474.916 2153.86,266.164 2156.16,502.926 2158.47,463.632 2160.78,499.936 2163.09,423.98 2165.4,478.1 2167.7,458.774 2170.01,478.827 2172.32,395.587 2174.63,333.201 2176.93,387.356 2179.24,506.259 2181.55,474.977 2183.86,546.024 2186.17,546.228 2188.47,498.209 2190.78,417.526 2193.09,607.099 2195.4,407.597 2197.71,383.967 2200.01,301.769 2202.32,632.139 2204.63,491.309 2206.94,528.198 2209.25,365.86 2211.55,441.703 2213.86,383.221 2216.17,470.773 2218.48,407.224 2220.79,374.976 2223.09,490.665 2225.4,478.519 2227.71,425.357 2230.02,362.46 2232.32,382.37 2234.63,329.596 2236.94,281.285 2239.25,374.57 2241.56,413.846 2243.86,488.036 2246.17,564.321 2248.48,452.199 2250.79,407.461 2253.1,562.248 2255.4,639.089 2257.71,343.54 2260.02,549.497 2262.33,565.43 2264.64,566.99 2266.94,459.992 2269.25,502.081 2271.56,473.316 2273.87,467.648 2276.18,535.268 2278.48,410.721 2280.79,406.243 2283.1,417.948 2285.41,275.735 2287.71,459.483 2290.02,466.418 2292.33,410.335 2294.64,556.98 2296.95,410.05 2299.25,427.732 2301.56,528.591 2303.87,616.779 2306.18,424.408 2308.49,490.288 2310.79,400.792 2313.1,425.847 2315.41,498.581 2317.72,491.383 2320.03,460.294 2322.33,439.556 2324.64,485.756 2326.95,366.201 2329.26,617.719 2331.56,548.282 2333.87,454.536 2336.18,549.064 2338.49,336.953 2340.8,315.428 2343.1,423.807 2345.41,453.855 2347.72,513.918 2350.03,543.329 2352.34,417.617 2354.64,469.751 2356.95,570.604 2359.26,320.593 2361.57,117.418 2363.88,321.615 2366.18,525.985 2368.49,551.556 2370.8,385.413 2373.11,209.511 2375.42,568.27 2377.72,461.574 2380.03,490.151 2382.34,388.306 2384.65,598.051 2386.95,504.907 2389.26,421.639 2391.57,349.164 2393.88,440.78 2396.19,462.374 2398.49,276.453 2400.8,685.984 2403.11,621.728 2405.42,473.272 2407.73,448.003 2410.03,343.921 2412.34,328.38 2414.65,369.435 2416.96,610.416 2419.27,459.913 2421.57,99.0826 2423.88,347.27 2426.19,494.009 2428.5,209.418 2430.81,540.354 2433.11,570.273 2435.42,465.938 2437.73,505.116 2440.04,551.255 2442.34,542.066 2444.65,442.874 2446.96,401.446 2449.27,358.118 2451.58,297.459 2453.88,326.695 2456.19,345.164 2458.5,578.851 2460.81,533.583 2463.12,482.771 2465.42,478.435 2467.73,354.101 2470.04,397 2472.35,446.199 2474.66,363.727 2476.96,491.083 2479.27,271.232 2481.58,494.395 2483.89,394.287 2486.2,400.317 2488.5,484.269 2490.81,488.515 2493.12,364.148 2495.43,477.15 2497.73,588.638 2500.04,465.352 2502.35,471.72 2504.66,417.399 2506.97,290.757 2509.27,524.759 2511.58,317.287 2513.89,397.035 2516.2,227.035 2518.51,536.848 2520.81,481.005 2523.12,705.452 2525.43,460.549 2527.74,515.371 2530.05,447.896 2532.35,381.721 2534.66,421.344 2536.97,279.884 2539.28,274.536 2541.58,517.956 2543.89,402.554 2546.2,519.315 2548.51,438.592 2550.82,333.124 2553.12,385.625 2555.43,386.115 2557.74,400.227 2560.05,407.923 2562.36,337.839 2564.66,390.292 2566.97,437.228 2569.28,549.262 2571.59,342.105 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -0.783276  -3.89941   -5.6703    -5.6703    …  -4.34808  -5.1655   -5.40084
 -0.204342  -0.253186  -0.308362  -0.308362      1.11462   1.03454  -1.19132
  0.930077   1.99409    4.09974    4.09974       4.4653    6.95591   7.3368

[:, :, 2] =
 -1.61445  -2.64489   -2.789    -2.94922   …  -5.29216   -5.84731   -6.37584
  1.26672  -0.183613  -1.5954    0.197177     -0.247706  -0.352613   1.33548
  2.43108   3.45495    3.27918   2.88987       4.90603    4.55899    4.55868

[:, :, 3] =
 -0.912169  -2.08455   -4.70185   …  -5.97497   -5.73841   -5.57581
  1.45443    0.151613   0.600093     -0.483497  -0.594937  -0.964543
  2.1669     4.42598    4.14632       5.01309    4.57748    4.7074

[:, :, 4] =
 -1.22213   -2.33813  -2.33813  -1.3926    …  -4.31413   -3.72649   -3.72649
  0.103898   0.4397    0.4397    0.945046      0.322714   0.790722   0.790722
  4.00724    5.93562   5.93562   5.08196       4.49624    4.5423     4.5423</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -5.0099    0.988064
 -0.010603  0.990696
  5.00949   0.99969</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.57 seconds
Compute duration  = 2.57 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -5.0048    1.0110    0.0172   3468.3511   5256.7470    1.0003   ⋯
        x[2]    0.0016    0.9952    0.0177   3173.7047   5050.0807    1.0002   ⋯
        x[3]    5.0042    1.0061    0.0172   3418.8334   5764.1739    1.0001   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -6.9668   -5.7074   -4.9902   -4.3262   -3.0095
        x[2]   -1.9489   -0.6784    0.0121    0.6747    1.9318
        x[3]    3.0009    4.3387    5.0145    5.6830    6.9306</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.51 seconds
Compute duration  = 1.51 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.5017    0.1872    0.0029   4168.5973   5638.4438    1.0001   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1504    0.3645    0.5008    0.6402    0.8554</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.24 seconds
Compute duration  = 0.24 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

           x    0.4913    0.1586    0.0178    63.2108    31.3432    1.0669     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.2237    0.3635    0.4982    0.6165    0.7531</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}(-1.0936756381813753,1.0,0.0), "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}(-1.0936756381813753,1.0,0.0):
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/nmUhn/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/compiler.jl:579 [inlined]
  [7] demo(__model__::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, __varinfo__::DynamicPPL.ThreadSafeVarInfo{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}}, ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Base.RefValue{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, __context__::DynamicPPL.DefaultContext)
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:592
  [8] _evaluate!!
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:973 [inlined]
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}}, ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, context::DynamicPPL.DefaultContext)
    @ DynamicPPL ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:962
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:892 [inlined]
 [11] logdensity
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/logdensityfunction.jl:140 [inlined]
 [12] Fix1
    @ ./operators.jl:1118 [inlined]
 [13] vector_mode_dual_eval!(f::Base.Fix1{typeof(LogDensityProblems.logdensity), LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}}, cfg::ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}, x::Vector{Float64})
    @ ForwardDiff ~/.julia/packages/ForwardDiff/PcZ48/src/apiutils.jl:24
 [14] vector_mode_gradient!(result::DiffResults.MutableDiffResult{1, Float64, Tuple{Vector{Float64}}}, f::Base.Fix1{typeof(LogDensityProblems.logdensity), LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}}, x::Vector{Float64}, cfg::ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}})
    @ ForwardDiff ~/.julia/packages/ForwardDiff/PcZ48/src/gradient.jl:96
 [15] gradient!
    @ ~/.julia/packages/ForwardDiff/PcZ48/src/gradient.jl:37 [inlined]
 [16] gradient!
    @ ~/.julia/packages/ForwardDiff/PcZ48/src/gradient.jl:35 [inlined]
 [17] logdensity_and_gradient
    @ ~/.julia/packages/LogDensityProblemsAD/rBlLq/ext/LogDensityProblemsADForwardDiffExt.jl:118 [inlined]
 [18] leapfrog_step(model::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, x::Vector{Float64}, p::Vector{Float64}, ϵ::Int64, M::UniformScaling{Bool})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:369
 [19] step(rng::TaskLocalRNG, model_wrapper::AbstractMCMC.LogDensityModel{LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}}, sampler::MALA{Int64, UniformScaling{Bool}}, state::MALAState{Vector{Float64}}; kwargs::@Kwargs{})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:334
 [20] step
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:316 [inlined]
 [21] #step#107
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:155 [inlined]
 [22] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, state::Turing.Inference.TuringState{MALAState{Vector{Float64}}, LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:144
 [23] macro expansion
    @ ~/.julia/packages/AbstractMCMC/YrmkI/src/sample.jl:176 [inlined]
 [24] macro expansion
    @ ~/.julia/packages/AbstractMCMC/YrmkI/src/logging.jl:16 [inlined]
 [25] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/YrmkI/src/sample.jl:120
 [26] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/MjWTB/src/sampler.jl:93
 [27] sample
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/sampler.jl:83 [inlined]
 [28] #sample#4
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:276 [inlined]
 [29] sample
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:267 [inlined]
 [30] #sample#3
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:264 [inlined]
 [31] top-level scope
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:594</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.55 seconds
Compute duration  = 0.55 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8119    0.6035    0.0441    87.9499    24.2982    1.0166     ⋯
           x   -0.0074    0.8970    0.0442   434.0656   593.0027    1.0195     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.0884    0.3447    0.6600    1.1666    2.3726
           x   -1.9240   -0.3707    0.0453    0.3490    1.9091</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 3.02 seconds
Compute duration  = 3.02 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    3.8409    0.0000    0.0000        NaN        NaN       NaN     ⋯
           x    1.5227    0.0000    0.0000        NaN        NaN       NaN     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    3.8409    3.8409    3.8409    3.8409    3.8409
           x    1.5227    1.5227    1.5227    1.5227    1.5227</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>