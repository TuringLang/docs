<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.0">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../tutorials/docs-07-for-developers-variational-inference/index.html" rel="prev">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-23b5d515405460ba008ebd3366b1cbf2.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-1f07eb2c514cf428db5cebb7a2aa15a2.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-5a965d03c83b9a52a3a52c83f34fadca.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-03f81fcb35c69179f531195cac5ac726.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/docs-00-getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/00-introduction/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.34" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.34</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.34">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Users</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-00-getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-12-using-turing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Core Functionality</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Usage Tips</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-10-using-turing-autodiff/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-custom-distribution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Custom Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-probability-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Querying Model Probabilities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-modifying-logprob/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modifying the Log Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-generated-quantities/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generated Quantities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-13-using-turing-performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-15-using-turing-sampler-viz/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-11-using-turing-dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-16-using-turing-external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/00-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction: Coin Flipping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/01-gaussian-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/02-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/03-bayesian-neural-network/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/04-hidden-markov-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/05-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/06-infinite-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/07-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/08-multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/09-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/10-bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/11-probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/13-seasonal-time-series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/15-gaussian-processes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Gaussian Processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/12-gplvm/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Contributing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-01-contributing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to Contribute</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">DynamicPPL in Depth</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/dev-model-manual/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manually Defining a Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-05-for-developers-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/14-minituring/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/16-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Inference (note: outdated)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-06-for-developers-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-21.797623825814455</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-21.797623825814455</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([0.0, 0.0, 0.0]), MALAState{Vector{Float64}}([0.0, 0.0, 0.0]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -3.40296   -3.47486   -4.40371   -3.74627   …  -3.8801    -4.56992  -4.59945
 -0.342539   0.266792   0.373652   0.168032     -0.861782  -1.44622  -0.65591
  2.69616    4.89009    3.55073    2.36404       4.80084    4.80383   3.40396</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -5.00149    0.988787
 -0.0341285  0.989652
  5.0096     1.0035</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip820">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip820)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip821">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip820)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip822">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1698.18 2640.76,1698.18 "></polyline>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1450.35 2640.76,1450.35 "></polyline>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1202.52 2640.76,1202.52 "></polyline>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,954.689 2640.76,954.689 "></polyline>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,706.86 2640.76,706.86 "></polyline>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,459.03 2640.76,459.03 "></polyline>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,211.2 2640.76,211.2 "></polyline>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip820)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1698.18 215.714,1698.18 "></polyline>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1450.35 215.714,1450.35 "></polyline>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1202.52 215.714,1202.52 "></polyline>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,954.689 215.714,954.689 "></polyline>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,706.86 215.714,706.86 "></polyline>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,459.03 215.714,459.03 "></polyline>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,211.2 215.714,211.2 "></polyline>
<path clip-path="url(#clip820)" d="M50.5475 1698.63 L80.2233 1698.63 L80.2233 1702.56 L50.5475 1702.56 L50.5475 1698.63 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M89.1352 1680.9 L111.357 1680.9 L111.357 1682.89 L98.8111 1715.46 L93.9269 1715.46 L105.732 1684.83 L89.1352 1684.83 L89.1352 1680.9 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M120.478 1709.58 L125.362 1709.58 L125.362 1715.46 L120.478 1715.46 L120.478 1709.58 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M135.593 1680.9 L153.95 1680.9 L153.95 1684.83 L139.876 1684.83 L139.876 1693.31 Q140.894 1692.96 141.913 1692.8 Q142.931 1692.61 143.95 1692.61 Q149.737 1692.61 153.116 1695.78 Q156.496 1698.95 156.496 1704.37 Q156.496 1709.95 153.024 1713.05 Q149.552 1716.13 143.232 1716.13 Q141.056 1716.13 138.788 1715.76 Q136.542 1715.39 134.135 1714.65 L134.135 1709.95 Q136.218 1711.08 138.441 1711.64 Q140.663 1712.19 143.14 1712.19 Q147.144 1712.19 149.482 1710.09 Q151.82 1707.98 151.82 1704.37 Q151.82 1700.76 149.482 1698.65 Q147.144 1696.55 143.14 1696.55 Q141.265 1696.55 139.39 1696.96 Q137.538 1697.38 135.593 1698.26 L135.593 1680.9 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M49.5521 1450.8 L79.2279 1450.8 L79.2279 1454.74 L49.5521 1454.74 L49.5521 1450.8 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M89.3667 1433.07 L107.723 1433.07 L107.723 1437 L93.6491 1437 L93.6491 1445.48 Q94.6676 1445.13 95.6861 1444.97 Q96.7047 1444.78 97.7232 1444.78 Q103.51 1444.78 106.89 1447.95 Q110.269 1451.12 110.269 1456.54 Q110.269 1462.12 106.797 1465.22 Q103.325 1468.3 97.0056 1468.3 Q94.8297 1468.3 92.5612 1467.93 Q90.3158 1467.56 87.9084 1466.82 L87.9084 1462.12 Q89.9917 1463.25 92.2139 1463.81 Q94.4361 1464.36 96.913 1464.36 Q100.918 1464.36 103.256 1462.26 Q105.593 1460.15 105.593 1456.54 Q105.593 1452.93 103.256 1450.82 Q100.918 1448.72 96.913 1448.72 Q95.038 1448.72 93.163 1449.13 Q91.3112 1449.55 89.3667 1450.43 L89.3667 1433.07 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M119.482 1461.75 L124.367 1461.75 L124.367 1467.63 L119.482 1467.63 L119.482 1461.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M144.552 1436.15 Q140.941 1436.15 139.112 1439.71 Q137.306 1443.25 137.306 1450.38 Q137.306 1457.49 139.112 1461.05 Q140.941 1464.6 144.552 1464.6 Q148.186 1464.6 149.991 1461.05 Q151.82 1457.49 151.82 1450.38 Q151.82 1443.25 149.991 1439.71 Q148.186 1436.15 144.552 1436.15 M144.552 1432.44 Q150.362 1432.44 153.417 1437.05 Q156.496 1441.63 156.496 1450.38 Q156.496 1459.11 153.417 1463.72 Q150.362 1468.3 144.552 1468.3 Q138.741 1468.3 135.663 1463.72 Q132.607 1459.11 132.607 1450.38 Q132.607 1441.63 135.663 1437.05 Q138.741 1432.44 144.552 1432.44 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M50.5475 1202.97 L80.2233 1202.97 L80.2233 1206.91 L50.5475 1206.91 L50.5475 1202.97 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M94.3436 1215.86 L110.663 1215.86 L110.663 1219.8 L88.7186 1219.8 L88.7186 1215.86 Q91.3806 1213.11 95.9639 1208.48 Q100.57 1203.83 101.751 1202.48 Q103.996 1199.96 104.876 1198.23 Q105.779 1196.47 105.779 1194.78 Q105.779 1192.02 103.834 1190.29 Q101.913 1188.55 98.8111 1188.55 Q96.6121 1188.55 94.1584 1189.31 Q91.7278 1190.08 88.9501 1191.63 L88.9501 1186.91 Q91.7741 1185.77 94.2278 1185.19 Q96.6815 1184.61 98.7185 1184.61 Q104.089 1184.61 107.283 1187.3 Q110.478 1189.98 110.478 1194.48 Q110.478 1196.6 109.668 1198.53 Q108.881 1200.42 106.774 1203.02 Q106.195 1203.69 103.094 1206.91 Q99.9917 1210.1 94.3436 1215.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M120.478 1213.92 L125.362 1213.92 L125.362 1219.8 L120.478 1219.8 L120.478 1213.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M135.593 1185.24 L153.95 1185.24 L153.95 1189.17 L139.876 1189.17 L139.876 1197.65 Q140.894 1197.3 141.913 1197.14 Q142.931 1196.95 143.95 1196.95 Q149.737 1196.95 153.116 1200.12 Q156.496 1203.29 156.496 1208.71 Q156.496 1214.29 153.024 1217.39 Q149.552 1220.47 143.232 1220.47 Q141.056 1220.47 138.788 1220.1 Q136.542 1219.73 134.135 1218.99 L134.135 1214.29 Q136.218 1215.42 138.441 1215.98 Q140.663 1216.54 143.14 1216.54 Q147.144 1216.54 149.482 1214.43 Q151.82 1212.32 151.82 1208.71 Q151.82 1205.1 149.482 1202.99 Q147.144 1200.89 143.14 1200.89 Q141.265 1200.89 139.39 1201.3 Q137.538 1201.72 135.593 1202.6 L135.593 1185.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M99.3204 940.488 Q95.7093 940.488 93.8806 944.053 Q92.075 947.594 92.075 954.724 Q92.075 961.83 93.8806 965.395 Q95.7093 968.937 99.3204 968.937 Q102.955 968.937 104.76 965.395 Q106.589 961.83 106.589 954.724 Q106.589 947.594 104.76 944.053 Q102.955 940.488 99.3204 940.488 M99.3204 936.784 Q105.131 936.784 108.186 941.391 Q111.265 945.974 111.265 954.724 Q111.265 963.451 108.186 968.057 Q105.131 972.641 99.3204 972.641 Q93.5102 972.641 90.4315 968.057 Q87.376 963.451 87.376 954.724 Q87.376 945.974 90.4315 941.391 Q93.5102 936.784 99.3204 936.784 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M119.482 966.09 L124.367 966.09 L124.367 971.969 L119.482 971.969 L119.482 966.09 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M144.552 940.488 Q140.941 940.488 139.112 944.053 Q137.306 947.594 137.306 954.724 Q137.306 961.83 139.112 965.395 Q140.941 968.937 144.552 968.937 Q148.186 968.937 149.991 965.395 Q151.82 961.83 151.82 954.724 Q151.82 947.594 149.991 944.053 Q148.186 940.488 144.552 940.488 M144.552 936.784 Q150.362 936.784 153.417 941.391 Q156.496 945.974 156.496 954.724 Q156.496 963.451 153.417 968.057 Q150.362 972.641 144.552 972.641 Q138.741 972.641 135.663 968.057 Q132.607 963.451 132.607 954.724 Q132.607 945.974 135.663 941.391 Q138.741 936.784 144.552 936.784 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M94.3436 720.204 L110.663 720.204 L110.663 724.14 L88.7186 724.14 L88.7186 720.204 Q91.3806 717.45 95.9639 712.82 Q100.57 708.168 101.751 706.825 Q103.996 704.302 104.876 702.566 Q105.779 700.806 105.779 699.117 Q105.779 696.362 103.834 694.626 Q101.913 692.89 98.8111 692.89 Q96.6121 692.89 94.1584 693.654 Q91.7278 694.418 88.9501 695.969 L88.9501 691.246 Q91.7741 690.112 94.2278 689.533 Q96.6815 688.955 98.7185 688.955 Q104.089 688.955 107.283 691.64 Q110.478 694.325 110.478 698.816 Q110.478 700.945 109.668 702.867 Q108.881 704.765 106.774 707.357 Q106.195 708.029 103.094 711.246 Q99.9917 714.441 94.3436 720.204 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M120.478 718.26 L125.362 718.26 L125.362 724.14 L120.478 724.14 L120.478 718.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M135.593 689.58 L153.95 689.58 L153.95 693.515 L139.876 693.515 L139.876 701.987 Q140.894 701.64 141.913 701.478 Q142.931 701.293 143.95 701.293 Q149.737 701.293 153.116 704.464 Q156.496 707.635 156.496 713.052 Q156.496 718.63 153.024 721.732 Q149.552 724.811 143.232 724.811 Q141.056 724.811 138.788 724.441 Q136.542 724.07 134.135 723.329 L134.135 718.63 Q136.218 719.765 138.441 720.32 Q140.663 720.876 143.14 720.876 Q147.144 720.876 149.482 718.769 Q151.82 716.663 151.82 713.052 Q151.82 709.441 149.482 707.334 Q147.144 705.228 143.14 705.228 Q141.265 705.228 139.39 705.644 Q137.538 706.061 135.593 706.941 L135.593 689.58 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M89.3667 441.75 L107.723 441.75 L107.723 445.685 L93.6491 445.685 L93.6491 454.157 Q94.6676 453.81 95.6861 453.648 Q96.7047 453.463 97.7232 453.463 Q103.51 453.463 106.89 456.634 Q110.269 459.805 110.269 465.222 Q110.269 470.801 106.797 473.903 Q103.325 476.981 97.0056 476.981 Q94.8297 476.981 92.5612 476.611 Q90.3158 476.241 87.9084 475.5 L87.9084 470.801 Q89.9917 471.935 92.2139 472.491 Q94.4361 473.046 96.913 473.046 Q100.918 473.046 103.256 470.94 Q105.593 468.833 105.593 465.222 Q105.593 461.611 103.256 459.505 Q100.918 457.398 96.913 457.398 Q95.038 457.398 93.163 457.815 Q91.3112 458.231 89.3667 459.111 L89.3667 441.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M119.482 470.43 L124.367 470.43 L124.367 476.31 L119.482 476.31 L119.482 470.43 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M144.552 444.829 Q140.941 444.829 139.112 448.393 Q137.306 451.935 137.306 459.065 Q137.306 466.171 139.112 469.736 Q140.941 473.278 144.552 473.278 Q148.186 473.278 149.991 469.736 Q151.82 466.171 151.82 459.065 Q151.82 451.935 149.991 448.393 Q148.186 444.829 144.552 444.829 M144.552 441.125 Q150.362 441.125 153.417 445.731 Q156.496 450.315 156.496 459.065 Q156.496 467.792 153.417 472.398 Q150.362 476.981 144.552 476.981 Q138.741 476.981 135.663 472.398 Q132.607 467.792 132.607 459.065 Q132.607 450.315 135.663 445.731 Q138.741 441.125 144.552 441.125 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M89.1352 193.92 L111.357 193.92 L111.357 195.911 L98.8111 228.48 L93.9269 228.48 L105.732 197.856 L89.1352 197.856 L89.1352 193.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M120.478 222.601 L125.362 222.601 L125.362 228.48 L120.478 228.48 L120.478 222.601 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip820)" d="M135.593 193.92 L153.95 193.92 L153.95 197.856 L139.876 197.856 L139.876 206.328 Q140.894 205.98 141.913 205.818 Q142.931 205.633 143.95 205.633 Q149.737 205.633 153.116 208.805 Q156.496 211.976 156.496 217.392 Q156.496 222.971 153.024 226.073 Q149.552 229.152 143.232 229.152 Q141.056 229.152 138.788 228.781 Q136.542 228.411 134.135 227.67 L134.135 222.971 Q136.218 224.105 138.441 224.661 Q140.663 225.216 143.14 225.216 Q147.144 225.216 149.482 223.11 Q151.82 221.004 151.82 217.392 Q151.82 213.781 149.482 211.675 Q147.144 209.568 143.14 209.568 Q141.265 209.568 139.39 209.985 Q137.538 210.402 135.593 211.281 L135.593 193.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip822)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1292.03 268.292,1562.84 270.6,1423.13 272.908,1554.44 275.216,1481.56 277.524,1461.52 279.832,1363.24 282.139,1531.89 284.447,1385.86 286.755,1528.41 289.063,1406.97 291.371,1551.33 293.679,1699.14 295.987,1373.84 298.295,1245.17 300.603,1558.91 302.911,1420.8 305.219,1327.63 307.527,1542.58 309.834,1457.72 312.142,1426.96 314.45,1500.32 316.758,1305.37 319.066,1475.24 321.374,1458.99 323.682,1314.3 325.99,1435.95 328.298,1527.32 330.606,1527.34 332.914,1468.02 335.221,1499.93 337.529,1389.76 339.837,1424.23 342.145,1538.44 344.453,1452.6 346.761,1346.94 349.069,1514.1 351.377,1546.55 353.685,1277.45 355.993,1267.36 358.301,1678.82 360.608,1587.21 362.916,1443.14 365.224,1298.55 367.532,1442.22 369.84,1225.74 372.148,1410.69 374.456,1355.15 376.764,1410.52 379.072,1261.81 381.38,1257.38 383.688,1477.9 385.996,1527.3 388.303,1452.55 390.611,1560.96 392.919,1469.91 395.227,1510.74 397.535,1328.66 399.843,1473.51 402.151,1450.54 404.459,1331.91 406.767,1386.45 409.075,1381.69 411.383,1537.57 413.69,1590.52 415.998,1577.66 418.306,1515.2 420.614,1466.29 422.922,1491.67 425.23,1426.2 427.538,1435.75 429.846,1576.87 432.154,1457.3 434.462,1451.43 436.77,1437.51 439.077,1506.27 441.385,1410.21 443.693,1451.04 446.001,1421.5 448.309,1261.27 450.617,1357.92 452.925,1289.92 455.233,1548.37 457.541,1506.78 459.849,1390.83 462.157,1544.74 464.465,1517.19 466.772,1396.31 469.08,1238.23 471.388,1510.32 473.696,1397.59 476.004,1341.07 478.312,1547.97 480.62,1472.34 482.928,1280.2 485.236,1387.34 487.544,1416.36 489.852,1494.26 492.159,1401.65 494.467,1502.85 496.775,1486.11 499.083,1303.96 501.391,1551.52 503.699,1454.44 506.007,1444.39 508.315,1421.27 510.623,1545.44 512.931,1361.9 515.239,1534.95 517.546,1513.23 519.854,1446.67 522.162,1420.67 524.47,1515.85 526.778,1467.91 529.086,1546.88 531.394,1581.53 533.702,1329.81 536.01,1428.79 538.318,1438.63 540.626,1360.54 542.933,1334.24 545.241,1363.66 547.549,1377.44 549.857,1525.59 552.165,1709.11 554.473,1539.11 556.781,1386.16 559.089,1550.38 561.397,1359.72 563.705,1365.37 566.013,1508.93 568.321,1460.15 570.628,1448.9 572.936,1371.53 575.244,1407.52 577.552,1484.61 579.86,1422.03 582.168,1475.48 584.476,1362.67 586.784,1450.01 589.092,1298.36 591.4,1584.59 593.708,1489.39 596.015,1416.04 598.323,1438.51 600.631,1295.09 602.939,1230.57 605.247,1362.64 607.555,1220.28 609.863,1625.26 612.171,1418.52 614.479,1576.98 616.787,1608.46 619.095,1430.2 621.402,1376.78 623.71,1429.61 626.018,1652.79 628.326,1517.59 630.634,1501.2 632.942,1521.03 635.25,1353.89 637.558,1404.33 639.866,1547.83 642.174,1581.2 644.482,1524.86 646.79,1617.61 649.097,1564.68 651.405,1537.9 653.713,1573.16 656.021,1358.58 658.329,1445.79 660.637,1518.62 662.945,1452.06 665.253,1697.54 667.561,1463.69 669.869,1551.32 672.177,1386.98 674.484,1564.31 676.792,1370.22 679.1,1494.46 681.408,1431.61 683.716,1474.63 686.024,1336.66 688.332,1577.47 690.64,1511.42 692.948,1498.99 695.256,1208.51 697.564,1599.63 699.871,1464.38 702.179,1666.69 704.487,1560 706.795,1444.84 709.103,1344.44 711.411,1319.7 713.719,1477.26 716.027,1494.65 718.335,1482.35 720.643,1500.11 722.951,1499.35 725.259,1540.6 727.566,1604.45 729.874,1591.88 732.182,1521.13 734.49,1550.16 736.798,1391.82 739.106,1463.95 741.414,1332.22 743.722,1600.82 746.03,1483.37 748.338,1393.29 750.646,1531.26 752.953,1248.96 755.261,1496.94 757.569,1626.57 759.877,1450.84 762.185,1523.66 764.493,1548.97 766.801,1539.74 769.109,1455.02 771.417,1509.36 773.725,1405.59 776.033,1309.99 778.34,1605.64 780.648,1326.44 782.956,1355.48 785.264,1481.45 787.572,1424.56 789.88,1278.92 792.188,1593.86 794.496,1403.28 796.804,1519.24 799.112,1335.65 801.42,1394.47 803.728,1556.07 806.035,1408.13 808.343,1521.91 810.651,1588.1 812.959,1364.1 815.267,1454.84 817.575,1520.04 819.883,1352.43 822.191,1412.38 824.499,1413.92 826.807,1581.63 829.115,1472.08 831.422,1563.98 833.73,1323.69 836.038,1374.11 838.346,1402.15 840.654,1303.05 842.962,1385.48 845.27,1326.91 847.578,1434.44 849.886,1422.3 852.194,1248.53 854.502,1492.84 856.809,1405.37 859.117,1585.97 861.425,1499.59 863.733,1423.96 866.041,1433.24 868.349,1173.85 870.657,1633.62 872.965,1644.71 875.273,1495.42 877.581,1575.2 879.889,1428.58 882.197,1602.61 884.504,1557.38 886.812,1325.81 889.12,1353.39 891.428,1517.14 893.736,1452.84 896.044,1268.83 898.352,1396.91 900.66,1560.95 902.968,1455.98 905.276,1508.16 907.584,1647.47 909.891,1457.42 912.199,1303.86 914.507,1511.54 916.815,1307.82 919.123,1476.57 921.431,1567.75 923.739,1435.62 926.047,1306.53 928.355,1536.62 930.663,1623.37 932.971,1415.98 935.278,1515.43 937.586,1394.73 939.894,1346.43 942.202,1201.79 944.51,1440.79 946.818,1653.77 949.126,1410.46 951.434,1443.37 953.742,1536.92 956.05,1494 958.358,1525.74 960.665,1359.87 962.973,1356.02 965.281,1398.41 967.589,1257.79 969.897,1425.13 972.205,1519.31 974.513,1427.9 976.821,1375.81 979.129,1347.98 981.437,1499.91 983.745,1272.57 986.053,1436.41 988.36,1467.01 990.668,1619.93 992.976,1354.21 995.284,1460.19 997.592,1539.34 999.9,1474.49 1002.21,1503.73 1004.52,1328.76 1006.82,1598.68 1009.13,1455.03 1011.44,1484.92 1013.75,1535.93 1016.06,1443.57 1018.36,1367.52 1020.67,1537.28 1022.98,1352.27 1025.29,1344.25 1027.59,1146.38 1029.9,1715.95 1032.21,1441.66 1034.52,1493.32 1036.83,1485.93 1039.13,1496.86 1041.44,1580.31 1043.75,1467.4 1046.06,1353.73 1048.37,1564.65 1050.67,1419.26 1052.98,1517.82 1055.29,1436.25 1057.6,1494.85 1059.91,1514.77 1062.21,1507.07 1064.52,1531.64 1066.83,1540.11 1069.14,1432.29 1071.45,1541.77 1073.75,1438.21 1076.06,1310.95 1078.37,1434.84 1080.68,1559.28 1082.98,1590.61 1085.29,1463.03 1087.6,1582.96 1089.91,1416.17 1092.22,1506.06 1094.52,1460.24 1096.83,1448.28 1099.14,1449.02 1101.45,1333.37 1103.76,1486.93 1106.06,1384.19 1108.37,1403.34 1110.68,1367.77 1112.99,1562.73 1115.3,1407.03 1117.6,1179.38 1119.91,1440.72 1122.22,1475.36 1124.53,1509.81 1126.84,1321.51 1129.14,1381.72 1131.45,1396.08 1133.76,1540.32 1136.07,1350.43 1138.37,1371.6 1140.68,1618.35 1142.99,1433.4 1145.3,1245.83 1147.61,1551.63 1149.91,1439.45 1152.22,1535.29 1154.53,1465.41 1156.84,1423.2 1159.15,1379.4 1161.45,1535.65 1163.76,1461.87 1166.07,1495.07 1168.38,1508.53 1170.69,1372.14 1172.99,1418.74 1175.3,1397.07 1177.61,1481.53 1179.92,1544.86 1182.23,1547.82 1184.53,1419.32 1186.84,1513.46 1189.15,1544.97 1191.46,1751.15 1193.76,1433.24 1196.07,1563.43 1198.38,1487.83 1200.69,1446.23 1203,1389.08 1205.3,1318.15 1207.61,1405.61 1209.92,1505.47 1212.23,1347.69 1214.54,1185.23 1216.84,1429.85 1219.15,1382.7 1221.46,1366.86 1223.77,1557.16 1226.08,1448.88 1228.38,1520.63 1230.69,1332.97 1233,1489.6 1235.31,1435.6 1237.61,1226.1 1239.92,1579.88 1242.23,1420.92 1244.54,1377.98 1246.85,1361.68 1249.15,1545.32 1251.46,1524.06 1253.77,1478.31 1256.08,1603.57 1258.39,1486.45 1260.69,1389.23 1263,1434.88 1265.31,1294.16 1267.62,1418.87 1269.93,1361.07 1272.23,1554.1 1274.54,1429.4 1276.85,1451.28 1279.16,1486.21 1281.47,1515.24 1283.77,1597.15 1286.08,1516.72 1288.39,1367.24 1290.7,1528.68 1293,1518.85 1295.31,1511.04 1297.62,1299.81 1299.93,1339.65 1302.24,1501.03 1304.54,1550.45 1306.85,1645.22 1309.16,1366.38 1311.47,1345.66 1313.78,1527.32 1316.08,1348.68 1318.39,1507.17 1320.7,1302.73 1323.01,1367.7 1325.32,1466.55 1327.62,1334.7 1329.93,1482.25 1332.24,1498.4 1334.55,1567.79 1336.86,1375.91 1339.16,1421.45 1341.47,1258.85 1343.78,1581.8 1346.09,1487.69 1348.39,1444.25 1350.7,1546.42 1353.01,1480.25 1355.32,1415.78 1357.63,1494.46 1359.93,1448.69 1362.24,1588.32 1364.55,1516.94 1366.86,1543.23 1369.17,1483.98 1371.47,1469.09 1373.78,1390.37 1376.09,1405 1378.4,1465.34 1380.71,1360.36 1383.01,1455.75 1385.32,1404.27 1387.63,1511.78 1389.94,1331.98 1392.24,1501.76 1394.55,1479.84 1396.86,1589.21 1399.17,1479.44 1401.48,1483.21 1403.78,1439.47 1406.09,1318.32 1408.4,1491.52 1410.71,1496.06 1413.02,1316.46 1415.32,1484.2 1417.63,1374.19 1419.94,1393.48 1422.25,1466.45 1424.56,1411.87 1426.86,1444.68 1429.17,1465.31 1431.48,1330.01 1433.79,1270.36 1436.1,1479.38 1438.4,1560.43 1440.71,1264.61 1443.02,1370.79 1445.33,1506.04 1447.63,1482.87 1449.94,1460.47 1452.25,1421.21 1454.56,1458.95 1456.87,1458.1 1459.17,1543.05 1461.48,1388.53 1463.79,1558.08 1466.1,1503.46 1468.41,1509.53 1470.71,1506.35 1473.02,1544.56 1475.33,1283.37 1477.64,1697.86 1479.95,1443.66 1482.25,1296.99 1484.56,1328.39 1486.87,1319.98 1489.18,1298.54 1491.49,1517.96 1493.79,1524.25 1496.1,1448.5 1498.41,1590.44 1500.72,1561.75 1503.02,1384.3 1505.33,1530.87 1507.64,1562.44 1509.95,1402.08 1512.26,1434.43 1514.56,1380.57 1516.87,1382.06 1519.18,1298.04 1521.49,1464.65 1523.8,1410.43 1526.1,1337.91 1528.41,1495.91 1530.72,1578.69 1533.03,1569.39 1535.34,1451.64 1537.64,1420.15 1539.95,1461.6 1542.26,1314.7 1544.57,1498.04 1546.88,1456.97 1549.18,1435.22 1551.49,1230.48 1553.8,1593.22 1556.11,1555.23 1558.41,1486.21 1560.72,1307.94 1563.03,1564.29 1565.34,1384.24 1567.65,1500.3 1569.95,1638.59 1572.26,1349.29 1574.57,1400.56 1576.88,1558.19 1579.19,1554.7 1581.49,1560.05 1583.8,1476.26 1586.11,1607.61 1588.42,1534.95 1590.73,1485.35 1593.03,1385.58 1595.34,1409.64 1597.65,1232.75 1599.96,1593.57 1602.26,1421.59 1604.57,1391.44 1606.88,1400.11 1609.19,1305.82 1611.5,1384.83 1613.8,1555.74 1616.11,1308.75 1618.42,1445.83 1620.73,1359.26 1623.04,1509.24 1625.34,1457.7 1627.65,1399.22 1629.96,1582.39 1632.27,1572.66 1634.58,1383.76 1636.88,1487.62 1639.19,1544.38 1641.5,1415.95 1643.81,1366.01 1646.12,1445.6 1648.42,1365.56 1650.73,1264.69 1653.04,1507.42 1655.35,1417.73 1657.65,1402.8 1659.96,1566.12 1662.27,1542.81 1664.58,1366.2 1666.89,1472.59 1669.19,1434.52 1671.5,1645.13 1673.81,1549.91 1676.12,1349.43 1678.43,1539.27 1680.73,1556.35 1683.04,1370.07 1685.35,1555.74 1687.66,1668.93 1689.97,1523.5 1692.27,1425.38 1694.58,1316.73 1696.89,1510.79 1699.2,1452.91 1701.51,1345.92 1703.81,1702.24 1706.12,1459.88 1708.43,1362.17 1710.74,1725.55 1713.04,1547.74 1715.35,1154.63 1717.66,1552.57 1719.97,1678.7 1722.28,1433.94 1724.58,1500.46 1726.89,1485.71 1729.2,1493.86 1731.51,1442.67 1733.82,1302.83 1736.12,1475.43 1738.43,1295.98 1740.74,1522.14 1743.05,1636.26 1745.36,1342.94 1747.66,1567.23 1749.97,1473.53 1752.28,1375.02 1754.59,1336.65 1756.9,1354.68 1759.2,1408.69 1761.51,1356.53 1763.82,1409.53 1766.13,1310.18 1768.43,1484.9 1770.74,1304.45 1773.05,1550.84 1775.36,1443.04 1777.67,1484.81 1779.97,1454.01 1782.28,1456.51 1784.59,1474.61 1786.9,1457.48 1789.21,1398.99 1791.51,1340.65 1793.82,1369.86 1796.13,1500.68 1798.44,1439.05 1800.75,1580.46 1803.05,1345.6 1805.36,1402.9 1807.67,1345.85 1809.98,1404.25 1812.28,1545.37 1814.59,1474.65 1816.9,1305.96 1819.21,1397.49 1821.52,1480.48 1823.82,1461.82 1826.13,1490.9 1828.44,1458.53 1830.75,1459.52 1833.06,1485.92 1835.36,1393.86 1837.67,1621.21 1839.98,1340.64 1842.29,1413.36 1844.6,1315.11 1846.9,1573.02 1849.21,1669.15 1851.52,1407.54 1853.83,1537.82 1856.14,1321.69 1858.44,1383.32 1860.75,1313.68 1863.06,1455.93 1865.37,1590.81 1867.67,1488.5 1869.98,1393.9 1872.29,1445.96 1874.6,1491.79 1876.91,1433.25 1879.21,1411.64 1881.52,1435.06 1883.83,1443.42 1886.14,1591.96 1888.45,1460.13 1890.75,1353.25 1893.06,1531.22 1895.37,1289.35 1897.68,1533.98 1899.99,1379.37 1902.29,1417.76 1904.6,1198.04 1906.91,1481.5 1909.22,1417 1911.53,1497.43 1913.83,1481.52 1916.14,1381.79 1918.45,1439.61 1920.76,1482.02 1923.06,1544.65 1925.37,1440.67 1927.68,1549.1 1929.99,1340.14 1932.3,1509.07 1934.6,1442.18 1936.91,1387.71 1939.22,1367.01 1941.53,1463.04 1943.84,1402.62 1946.14,1416.8 1948.45,1448.63 1950.76,1291.09 1953.07,1429.02 1955.38,1445.94 1957.68,1298.78 1959.99,1335.94 1962.3,1435.7 1964.61,1332.38 1966.91,1418.19 1969.22,1747.58 1971.53,1342.73 1973.84,1415.94 1976.15,1283.98 1978.45,1355.2 1980.76,1421.34 1983.07,1241.64 1985.38,1573.79 1987.69,1396.2 1989.99,1564.02 1992.3,1607.59 1994.61,1402.09 1996.92,1482.67 1999.23,1430.14 2001.53,1151.07 2003.84,1498.15 2006.15,1397.96 2008.46,1235.08 2010.77,1404.35 2013.07,1614.12 2015.38,1684.24 2017.69,1634.91 2020,1500.77 2022.3,1359.38 2024.61,1509.45 2026.92,1537.32 2029.23,1448.98 2031.54,1351.81 2033.84,1560.91 2036.15,1495.53 2038.46,1436.05 2040.77,1532.4 2043.08,1424.84 2045.38,1221.67 2047.69,1396.34 2050,1490.37 2052.31,1553.24 2054.62,1382.09 2056.92,1269.64 2059.23,1591.75 2061.54,1510.21 2063.85,1312.23 2066.16,1526.28 2068.46,1509.76 2070.77,1518.16 2073.08,1316.07 2075.39,1367.04 2077.69,1586.13 2080,1405.14 2082.31,1430.11 2084.62,1448.9 2086.93,1596.74 2089.23,1443.5 2091.54,1329.39 2093.85,1409.68 2096.16,1602.01 2098.47,1480.85 2100.77,1427.89 2103.08,1395.77 2105.39,1521.14 2107.7,1416.08 2110.01,1615.24 2112.31,1463.13 2114.62,1369.09 2116.93,1482.39 2119.24,1257.11 2121.55,1390.94 2123.85,1460.69 2126.16,1535.45 2128.47,1397.45 2130.78,1515.51 2133.08,1289.81 2135.39,1719.62 2137.7,1430.22 2140.01,1327.87 2142.32,1453.85 2144.62,1586.33 2146.93,1462.71 2149.24,1345.46 2151.55,1335.7 2153.86,1412.61 2156.16,1619.16 2158.47,1619.36 2160.78,1574.95 2163.09,1400.87 2165.4,1441.83 2167.7,1422.08 2170.01,1525.46 2172.32,1371.95 2174.63,1429.27 2176.93,1607.74 2179.24,1501.41 2181.55,1652.06 2183.86,1430.01 2186.17,1460.88 2188.47,1416.91 2190.78,1394.81 2193.09,1274.73 2195.4,1525.7 2197.71,1379.5 2200.01,1556.34 2202.32,1437.3 2204.63,1393.12 2206.94,1444.46 2209.25,1297.53 2211.55,1308.28 2213.86,1462.16 2216.17,1505.96 2218.48,1447.85 2220.79,1426.6 2223.09,1697.97 2225.4,1526.46 2227.71,1331.13 2230.02,1391.17 2232.32,1502.5 2234.63,1695.84 2236.94,1514.9 2239.25,1436.02 2241.56,1408.49 2243.86,1457.98 2246.17,1477.15 2248.48,1560.76 2250.79,1407.21 2253.1,1391.77 2255.4,1519.34 2257.71,1410.46 2260.02,1317.38 2262.33,1408.72 2264.64,1494.81 2266.94,1310.47 2269.25,1453.93 2271.56,1475.79 2273.87,1513.45 2276.18,1574.08 2278.48,1605.09 2280.79,1445.87 2283.1,1275.18 2285.41,1294.35 2287.71,1350.7 2290.02,1374.39 2292.33,1551.75 2294.64,1288.08 2296.95,1413.31 2299.25,1366.17 2301.56,1563.88 2303.87,1316.69 2306.18,1337.69 2308.49,1574.63 2310.79,1284.8 2313.1,1459.81 2315.41,1444.39 2317.72,1387.7 2320.03,1480.51 2322.33,1406.46 2324.64,1622.65 2326.95,1435.41 2329.26,1501.12 2331.56,1308.62 2333.87,1621.61 2336.18,1501.45 2338.49,1428.34 2340.8,1492.63 2343.1,1643.67 2345.41,1350.03 2347.72,1572.24 2350.03,1456.96 2352.34,1346.18 2354.64,1537.62 2356.95,1353.12 2359.26,1387.08 2361.57,1338.44 2363.88,1388.05 2366.18,1221.13 2368.49,1388.66 2370.8,1394.45 2373.11,1612.12 2375.42,1466.44 2377.72,1390.59 2380.03,1515.09 2382.34,1569.87 2384.65,1523.92 2386.95,1295.46 2389.26,1430.99 2391.57,1485.65 2393.88,1433.21 2396.19,1409.69 2398.49,1386.65 2400.8,1370.95 2403.11,1404.44 2405.42,1541.34 2407.73,1429.39 2410.03,1484.25 2412.34,1399.19 2414.65,1468.49 2416.96,1458 2419.27,1406.48 2421.57,1500.1 2423.88,1460.92 2426.19,1650.5 2428.5,1425.68 2430.81,1456.09 2433.11,1307.89 2435.42,1574.27 2437.73,1413.73 2440.04,1445.92 2442.34,1495.52 2444.65,1437.54 2446.96,1322.21 2449.27,1539.94 2451.58,1434.78 2453.88,1504.32 2456.19,1503.28 2458.5,1305.19 2460.81,1599.86 2463.12,1435.27 2465.42,1400.67 2467.73,1352.11 2470.04,1492.4 2472.35,1468.23 2474.66,1222.44 2476.96,1534.25 2479.27,1501.28 2481.58,1318.47 2483.89,1566.19 2486.2,1427.64 2488.5,1345.35 2490.81,1370.25 2493.12,1366.03 2495.43,1303.23 2497.73,1418.02 2500.04,1537.44 2502.35,1497.69 2504.66,1453.34 2506.97,1439.37 2509.27,1406.07 2511.58,1316.53 2513.89,1369.36 2516.2,1465.72 2518.51,1540.67 2520.81,1404.7 2523.12,1485.25 2525.43,1402.63 2527.74,1481.78 2530.05,1581.35 2532.35,1476.66 2534.66,1401.23 2536.97,1533.65 2539.28,1478.17 2541.58,1448.09 2543.89,1467.04 2546.2,1580.83 2548.51,1383.81 2550.82,1594.83 2553.12,1412.32 2555.43,1602.24 2557.74,1376.22 2560.05,1309.35 2562.36,1368.15 2564.66,1381.89 2566.97,1393.41 2569.28,1438.36 2571.59,1297.59 "></polyline>
<polyline clip-path="url(#clip822)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,988.646 268.292,970.016 270.6,871.111 272.908,1200.73 275.216,995.236 277.524,951.087 279.832,809.982 282.139,1085.42 284.447,944.576 286.755,935.9 289.063,1067.3 291.371,1010.74 293.679,997.982 295.987,928.796 298.295,996.389 300.603,972.002 302.911,937.401 305.219,861.76 307.527,938.584 309.834,1020.72 312.142,1047.31 314.45,863.669 316.758,1035.28 319.066,902.247 321.374,995.143 323.682,1034.72 325.99,1040.88 328.298,1157.77 330.606,986.435 332.914,913.995 335.221,832.867 337.529,955.269 339.837,998.076 342.145,896.751 344.453,1175.75 346.761,737.559 349.069,977.768 351.377,988.872 353.685,951.339 355.993,1068.09 358.301,973.73 360.608,1089.01 362.916,868.999 365.224,998.21 367.532,974.025 369.84,917.168 372.148,923.12 374.456,917.1 376.764,1138.15 379.072,912.865 381.38,1028.31 383.688,1007.43 385.996,922.356 388.303,898.076 390.611,1005.55 392.919,1091.15 395.227,1144.46 397.535,905.171 399.843,878.952 402.151,901.625 404.459,1028 406.767,1047.42 409.075,1095.68 411.383,853.941 413.69,945.145 415.998,960.014 418.306,800.173 420.614,1060.45 422.922,1055.85 425.23,1022.54 427.538,916.586 429.846,884.234 432.154,948.884 434.462,1059.14 436.77,894.866 439.077,951.672 441.385,1166.78 443.693,999.902 446.001,1042.35 448.309,959.702 450.617,890.273 452.925,878.885 455.233,1192.95 457.541,899.169 459.849,1018.96 462.157,945.844 464.465,971.872 466.772,1154.25 469.08,967.787 471.388,979.611 473.696,937.733 476.004,791.939 478.312,1044.99 480.62,911.207 482.928,1104.85 485.236,872.869 487.544,916.164 489.852,1000.37 492.159,945.882 494.467,1003.35 496.775,902.794 499.083,948.822 501.391,902.718 503.699,805.558 506.007,953.221 508.315,1055.35 510.623,1118.96 512.931,1148.68 515.239,861.759 517.546,887.581 519.854,1064.4 522.162,944.455 524.47,995.65 526.778,800.29 529.086,926.372 531.394,927.822 533.702,895.375 536.01,920.978 538.318,847.259 540.626,1000.11 542.933,869.499 545.241,973.501 547.549,963.417 549.857,945.628 552.165,1065.64 554.473,794.372 556.781,1003.91 559.089,857.123 561.397,1065 563.705,874.55 566.013,975.968 568.321,1048.36 570.628,1018.37 572.936,954.998 575.244,917.035 577.552,1052.82 579.86,982.132 582.168,968.23 584.476,921.821 586.784,1007.54 589.092,921.599 591.4,858.488 593.708,1008.06 596.015,1054.31 598.323,836.465 600.631,826.595 602.939,1031.76 605.247,997.645 607.555,869.295 609.863,968.93 612.171,1023.52 614.479,961.739 616.787,724.475 619.095,864.879 621.402,1030.01 623.71,782.979 626.018,936.992 628.326,771.187 630.634,927.816 632.942,1028.24 635.25,1038.88 637.558,1055.21 639.866,758.212 642.174,1020.23 644.482,990.626 646.79,1113.54 649.097,979.651 651.405,1165.26 653.713,970.528 656.021,1024.56 658.329,978.514 660.637,1158.46 662.945,900.215 665.253,723.163 667.561,948.789 669.869,981.282 672.177,995.714 674.484,893.082 676.792,941.566 679.1,1170.92 681.408,832.451 683.716,1021.55 686.024,979.585 688.332,972.773 690.64,988.406 692.948,1047.26 695.256,948.282 697.564,1059.55 699.871,881.001 702.179,1058.2 704.487,845.921 706.795,1168.12 709.103,938.658 711.411,892.752 713.719,979.945 716.027,787.941 718.335,838.676 720.643,1048.85 722.951,1110.08 725.259,965.118 727.566,1058.84 729.874,778.412 732.182,778.502 734.49,824.976 736.798,1094.59 739.106,941.715 741.414,1041.74 743.722,1073.14 746.03,759.585 748.338,845.956 750.646,1048.75 752.953,1108.11 755.261,904.837 757.569,984.499 759.877,865.582 762.185,860.104 764.493,1005.79 766.801,1044.27 769.109,941.698 771.417,966.671 773.725,958.448 776.033,992.858 778.34,765.731 780.648,882.021 782.956,985.802 785.264,1008.49 787.572,946.771 789.88,894.869 792.188,931.406 794.496,881.858 796.804,1033.31 799.112,1019.51 801.42,873.842 803.728,958.303 806.035,1040.01 808.343,1012.25 810.651,969.805 812.959,1032.78 815.267,941.958 817.575,759.868 819.883,968.365 822.191,871.622 824.499,912.262 826.807,954.916 829.115,1008.78 831.422,1092.66 833.73,1062.2 836.038,966.278 838.346,832.974 840.654,1079.21 842.962,874.262 845.27,887.799 847.578,1030.24 849.886,910.82 852.194,999.273 854.502,840.044 856.809,812.657 859.117,770.629 861.425,708.63 863.733,900.625 866.041,950.844 868.349,919.559 870.657,1073.58 872.965,1062.15 875.273,1044.16 877.581,1033.66 879.889,889.416 882.197,1016.89 884.504,1119.98 886.812,1050.86 889.12,1101.31 891.428,989.457 893.736,1092.93 896.044,976.076 898.352,808.278 900.66,956.61 902.968,1032.67 905.276,966.607 907.584,989.659 909.891,834.926 912.199,912.202 914.507,707.922 916.815,828.155 919.123,991.566 921.431,947.954 923.739,853.521 926.047,1069.07 928.355,1019.72 930.663,929.986 932.971,723.033 935.278,788.995 937.586,1024.99 939.894,874.147 942.202,1013.33 944.51,1132.83 946.818,964.05 949.126,916.198 951.434,1049.86 953.742,945.514 956.05,1042.97 958.358,907.299 960.665,841.094 962.973,959.684 965.281,863.332 967.589,1172.66 969.897,981.366 972.205,962.608 974.513,924.89 976.821,920.356 979.129,882.136 981.437,880.463 983.745,1034.28 986.053,862.094 988.36,788.246 990.668,1167.69 992.976,838.893 995.284,898.041 997.592,820.587 999.9,932.994 1002.21,869.044 1004.52,922.34 1006.82,959.453 1009.13,921.026 1011.44,973.221 1013.75,1101.38 1016.06,1118.09 1018.36,957.105 1020.67,946.575 1022.98,936.948 1025.29,960.624 1027.59,743.355 1029.9,985.772 1032.21,878.167 1034.52,1019.35 1036.83,1088.67 1039.13,974.112 1041.44,908.163 1043.75,989.949 1046.06,979.374 1048.37,997.47 1050.67,846.836 1052.98,838.146 1055.29,1021.71 1057.6,956.467 1059.91,902.718 1062.21,917.134 1064.52,907.77 1066.83,1008.42 1069.14,993.342 1071.45,877.864 1073.75,849.234 1076.06,1118.31 1078.37,906.963 1080.68,914.392 1082.98,1100.37 1085.29,991.565 1087.6,1030.48 1089.91,911.297 1092.22,981.652 1094.52,1063.45 1096.83,1081.36 1099.14,954.297 1101.45,1088.68 1103.76,854.24 1106.06,915.923 1108.37,902.072 1110.68,871.895 1112.99,939.945 1115.3,906.202 1117.6,1093.52 1119.91,957.699 1122.22,838.751 1124.53,1032.6 1126.84,972.431 1129.14,902.715 1131.45,883.733 1133.76,923.102 1136.07,1044.17 1138.37,979.327 1140.68,733.783 1142.99,1053.87 1145.3,888.731 1147.61,960.472 1149.91,979.14 1152.22,838.71 1154.53,871.786 1156.84,1065.56 1159.15,960.993 1161.45,1030.57 1163.76,892.404 1166.07,980.306 1168.38,983.506 1170.69,1159.18 1172.99,1005.25 1175.3,874.89 1177.61,875.522 1179.92,1036.37 1182.23,758.499 1184.53,1016.9 1186.84,1104.62 1189.15,941.184 1191.46,979.889 1193.76,908.434 1196.07,933.884 1198.38,1123.27 1200.69,950.888 1203,863.386 1205.3,940.215 1207.61,1060.03 1209.92,891.731 1212.23,997.048 1214.54,1105.67 1216.84,942.856 1219.15,979.992 1221.46,809.701 1223.77,876.804 1226.08,1089.78 1228.38,952.251 1230.69,970.291 1233,806.06 1235.31,1128.23 1237.61,916.212 1239.92,1220.91 1242.23,958.34 1244.54,1018.74 1246.85,828.312 1249.15,820.36 1251.46,909.593 1253.77,1148.99 1256.08,945.246 1258.39,1126.79 1260.69,867.805 1263,838.973 1265.31,927.971 1267.62,994.064 1269.93,1195.46 1272.23,959.998 1274.54,891.355 1276.85,890.967 1279.16,1008.71 1281.47,823.585 1283.77,803.801 1286.08,1104.82 1288.39,1087.87 1290.7,904.291 1293,944.254 1295.31,1229.73 1297.62,1032.74 1299.93,924.554 1302.24,789.545 1304.54,824.538 1306.85,907.794 1309.16,1158.58 1311.47,777.124 1313.78,1017.66 1316.08,1084.9 1318.39,898.618 1320.7,895.631 1323.01,997.507 1325.32,813.213 1327.62,933.124 1329.93,820.119 1332.24,820.028 1334.55,1000.15 1336.86,1106.38 1339.16,1113.97 1341.47,801.594 1343.78,936.685 1346.09,1041.06 1348.39,937.438 1350.7,925.774 1353.01,707.456 1355.32,902.912 1357.63,985.482 1359.93,1067.08 1362.24,815.132 1364.55,901.163 1366.86,988.88 1369.17,912.18 1371.47,987.401 1373.78,992.129 1376.09,920.349 1378.4,952.47 1380.71,944.398 1383.01,920.308 1385.32,831.869 1387.63,1118.15 1389.94,940.92 1392.24,884.021 1394.55,1153.66 1396.86,947.105 1399.17,896.395 1401.48,909.492 1403.78,929.155 1406.09,973.857 1408.4,1000.3 1410.71,894.878 1413.02,980.816 1415.32,919.421 1417.63,709.901 1419.94,1018.36 1422.25,1077.67 1424.56,944.184 1426.86,991.181 1429.17,816.842 1431.48,916.975 1433.79,1053.07 1436.1,953.78 1438.4,1000.36 1440.71,1080.55 1443.02,839.523 1445.33,1040.1 1447.63,983.964 1449.94,1134.02 1452.25,1013.72 1454.56,1079.63 1456.87,1037.92 1459.17,1018.53 1461.48,1051.24 1463.79,1056.41 1466.1,906.334 1468.41,1011.63 1470.71,1123.93 1473.02,989.778 1475.33,953.941 1477.64,912.902 1479.95,1024.17 1482.25,1008.38 1484.56,947.294 1486.87,1009.8 1489.18,984.339 1491.49,1071.45 1493.79,901.852 1496.1,950.671 1498.41,1093.52 1500.72,967.54 1503.02,769.841 1505.33,1049.87 1507.64,910.104 1509.95,862.855 1512.26,864.213 1514.56,1145.01 1516.87,866.059 1519.18,907.636 1521.49,821.755 1523.8,1012.58 1526.1,1110.37 1528.41,881.679 1530.72,902.32 1533.03,926.617 1535.34,909.674 1537.64,875.616 1539.95,927.323 1542.26,1053.91 1544.57,817.865 1546.88,759.172 1549.18,915.267 1551.49,1042.08 1553.8,1088.46 1556.11,857.704 1558.41,939.644 1560.72,1104.88 1563.03,971.381 1565.34,941.192 1567.65,811.046 1569.95,916.656 1572.26,882.749 1574.57,845.143 1576.88,987.203 1579.19,1070.17 1581.49,1022.35 1583.8,1061.39 1586.11,976.045 1588.42,1092.89 1590.73,1045.02 1593.03,838.06 1595.34,1092.68 1597.65,1087.69 1599.96,923.163 1602.26,815.801 1604.57,867.553 1606.88,918.297 1609.19,882.002 1611.5,803.757 1613.8,1071.42 1616.11,794.608 1618.42,957.665 1620.73,1185.56 1623.04,1091.03 1625.34,967.024 1627.65,902.142 1629.96,889.238 1632.27,982.081 1634.58,1055 1636.88,798.897 1639.19,988.445 1641.5,902.921 1643.81,1095.11 1646.12,804.153 1648.42,1031 1650.73,1020.07 1653.04,948.915 1655.35,729.35 1657.65,844.317 1659.96,955.412 1662.27,1015.92 1664.58,1029.97 1666.89,1060.78 1669.19,983.192 1671.5,877.298 1673.81,1020.69 1676.12,975.839 1678.43,973.221 1680.73,825.894 1683.04,890.059 1685.35,938.652 1687.66,1055.49 1689.97,856.105 1692.27,966.7 1694.58,1032.57 1696.89,899.623 1699.2,978.112 1701.51,1034.85 1703.81,1072.65 1706.12,1043.24 1708.43,830.6 1710.74,1027.67 1713.04,1021.97 1715.35,980.852 1717.66,956.901 1719.97,1011.66 1722.28,827.019 1724.58,907.724 1726.89,813.572 1729.2,961.949 1731.51,963.38 1733.82,1011.74 1736.12,1116.57 1738.43,886.262 1740.74,998.087 1743.05,784.461 1745.36,960.684 1747.66,885.608 1749.97,988.489 1752.28,931.572 1754.59,902.665 1756.9,1011.49 1759.2,899.567 1761.51,793.583 1763.82,993.223 1766.13,1069.61 1768.43,912.097 1770.74,1043.87 1773.05,842.491 1775.36,1024.92 1777.67,943.328 1779.97,961.746 1782.28,956.41 1784.59,931.866 1786.9,1084.76 1789.21,1001.44 1791.51,1015.88 1793.82,895.01 1796.13,940.403 1798.44,1043.61 1800.75,891.904 1803.05,972.654 1805.36,1095.3 1807.67,996.549 1809.98,1139.73 1812.28,953.326 1814.59,1071.74 1816.9,1084.47 1819.21,915.429 1821.52,990.572 1823.82,872.839 1826.13,1059.57 1828.44,937.514 1830.75,1004.53 1833.06,929.117 1835.36,916.648 1837.67,1035.49 1839.98,916.362 1842.29,1162.87 1844.6,861.098 1846.9,1105.29 1849.21,883.368 1851.52,1227.79 1853.83,945.263 1856.14,993.678 1858.44,871.216 1860.75,1061.63 1863.06,1096.95 1865.37,940.437 1867.67,972.233 1869.98,941.506 1872.29,878.546 1874.6,891.564 1876.91,875.272 1879.21,1108.99 1881.52,919.342 1883.83,975.965 1886.14,1081.22 1888.45,1054.61 1890.75,1115.09 1893.06,859.987 1895.37,897.089 1897.68,978.533 1899.99,836.329 1902.29,1030.61 1904.6,1015.26 1906.91,1009.12 1909.22,1108.06 1911.53,963.287 1913.83,882.375 1916.14,1065.87 1918.45,896.265 1920.76,1082.5 1923.06,890.513 1925.37,893.512 1927.68,1013.22 1929.99,1069.77 1932.3,1008.68 1934.6,1130.41 1936.91,777.545 1939.22,969.085 1941.53,969.788 1943.84,824.961 1946.14,989.635 1948.45,733.745 1950.76,739.148 1953.07,1052.58 1955.38,847.263 1957.68,1097.46 1959.99,960.106 1962.3,853.567 1964.61,1196.12 1966.91,929.457 1969.22,917.273 1971.53,1014.43 1973.84,766.117 1976.15,995.857 1978.45,1104.54 1980.76,872.207 1983.07,865.246 1985.38,1051.24 1987.69,1064.89 1989.99,938.304 1992.3,1230.96 1994.61,952.417 1996.92,861.16 1999.23,1134.81 2001.53,945.421 2003.84,959.339 2006.15,929.231 2008.46,1005.84 2010.77,969.453 2013.07,1128.61 2015.38,746.284 2017.69,898.076 2020,928.486 2022.3,873.028 2024.61,1030.31 2026.92,993.381 2029.23,1007.12 2031.54,837.447 2033.84,974.064 2036.15,971.145 2038.46,854.733 2040.77,1055.93 2043.08,972.781 2045.38,1078.98 2047.69,1107.52 2050,887.36 2052.31,960.322 2054.62,939.465 2056.92,935.882 2059.23,999.146 2061.54,1041.35 2063.85,631.691 2066.16,848.562 2068.46,887.914 2070.77,1054.2 2073.08,976.296 2075.39,719.182 2077.69,958.457 2080,1181.44 2082.31,888.27 2084.62,960.259 2086.93,863.996 2089.23,974.205 2091.54,1046.67 2093.85,1002.88 2096.16,970.833 2098.47,841.061 2100.77,855.427 2103.08,1159.42 2105.39,872.535 2107.7,982.607 2110.01,916.436 2112.31,911.756 2114.62,827.875 2116.93,1130.4 2119.24,1015.15 2121.55,967.473 2123.85,1052.92 2126.16,885.585 2128.47,1089.21 2130.78,1063.61 2133.08,1142.04 2135.39,913.902 2137.7,944.287 2140.01,1056.82 2142.32,1072.2 2144.62,878.489 2146.93,1077.65 2149.24,1119.35 2151.55,980.487 2153.86,987.859 2156.16,888.005 2158.47,914.226 2160.78,874.161 2163.09,978.238 2165.4,957.919 2167.7,890.54 2170.01,1001.03 2172.32,995.728 2174.63,1012.24 2176.93,908.955 2179.24,833.928 2181.55,910.229 2183.86,660.798 2186.17,1020.94 2188.47,948.795 2190.78,1096.11 2193.09,926.418 2195.4,792.911 2197.71,1134.1 2200.01,907.994 2202.32,1172.2 2204.63,1063.36 2206.94,845.215 2209.25,849.633 2211.55,993.876 2213.86,903.833 2216.17,844.605 2218.48,1019.78 2220.79,871.746 2223.09,692.593 2225.4,932.249 2227.71,876.155 2230.02,927.637 2232.32,1012.79 2234.63,840.858 2236.94,1009.85 2239.25,880.015 2241.56,1041.22 2243.86,914.789 2246.17,1032.49 2248.48,978.769 2250.79,760.514 2253.1,969.54 2255.4,1184.62 2257.71,980.29 2260.02,880.127 2262.33,1071.54 2264.64,931.633 2266.94,807.107 2269.25,930.016 2271.56,929.57 2273.87,875.446 2276.18,1082.15 2278.48,954.357 2280.79,924.459 2283.1,939.098 2285.41,736.487 2287.71,926.489 2290.02,923.191 2292.33,980.161 2294.64,1033.76 2296.95,937.704 2299.25,1126.75 2301.56,1017.02 2303.87,1083.08 2306.18,859.733 2308.49,1160.27 2310.79,864.962 2313.1,965.388 2315.41,973.587 2317.72,927.262 2320.03,1039.3 2322.33,992.636 2324.64,1067.9 2326.95,1041.2 2329.26,898.255 2331.56,829.528 2333.87,1006.69 2336.18,1033.11 2338.49,980.346 2340.8,1070.07 2343.1,992.535 2345.41,802.846 2347.72,1034.62 2350.03,934.564 2352.34,979.048 2354.64,873.701 2356.95,972.043 2359.26,1065.63 2361.57,1026.46 2363.88,936.228 2366.18,1063.99 2368.49,924.181 2370.8,1006.78 2373.11,908.019 2375.42,1033.22 2377.72,969.769 2380.03,1094.17 2382.34,905.4 2384.65,677.103 2386.95,1030.18 2389.26,970.54 2391.57,746.599 2393.88,1052.2 2396.19,636.952 2398.49,1036.41 2400.8,956.787 2403.11,935.21 2405.42,846.288 2407.73,927.12 2410.03,987.67 2412.34,840.338 2414.65,861.325 2416.96,864.255 2419.27,913.24 2421.57,988.536 2423.88,1065.62 2426.19,887.893 2428.5,932.209 2430.81,1080.18 2433.11,1055.07 2435.42,923.144 2437.73,996.311 2440.04,945.315 2442.34,1064.32 2444.65,944.49 2446.96,840.914 2449.27,1047.52 2451.58,1090.49 2453.88,1028.96 2456.19,1003.72 2458.5,1118.15 2460.81,977.478 2463.12,934.6 2465.42,897.292 2467.73,931.184 2470.04,1019.65 2472.35,973.294 2474.66,1062.77 2476.96,789.683 2479.27,956.252 2481.58,987.296 2483.89,965.844 2486.2,829.62 2488.5,1119.76 2490.81,1012.9 2493.12,819.103 2495.43,853.207 2497.73,1039.03 2500.04,991.512 2502.35,1010.93 2504.66,990.833 2506.97,1081.62 2509.27,828.118 2511.58,996.463 2513.89,962.535 2516.2,886.5 2518.51,903.94 2520.81,933.828 2523.12,984.68 2525.43,964.772 2527.74,1110.91 2530.05,927.823 2532.35,827.21 2534.66,1159.95 2536.97,1008.31 2539.28,872.416 2541.58,838.695 2543.89,1022.42 2546.2,1065.87 2548.51,917.921 2550.82,959.724 2553.12,844.111 2555.43,1011.1 2557.74,867.509 2560.05,1121.68 2562.36,1003.03 2564.66,1006.43 2566.97,829.566 2569.28,915.941 2571.59,959.882 "></polyline>
<polyline clip-path="url(#clip822)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,687.414 268.292,507.177 270.6,514.726 272.908,303.857 275.216,663.207 277.524,434.141 279.832,503.174 282.139,353.957 284.447,375.226 286.755,361.045 289.063,460.879 291.371,646.393 293.679,521.752 295.987,541.352 298.295,401.396 300.603,422.248 302.911,258.551 305.219,627.49 307.527,378.266 309.834,464.107 312.142,292.412 314.45,581.191 316.758,509.611 319.066,481.574 321.374,434.925 323.682,384.218 325.99,586.571 328.298,306.425 330.606,475.17 332.914,411.479 335.221,362.061 337.529,287.869 339.837,532.123 342.145,682.044 344.453,482.874 346.761,652.094 349.069,357.398 351.377,342.043 353.685,266.32 355.993,310.567 358.301,530.906 360.608,482.949 362.916,372.588 365.224,475.423 367.532,593.362 369.84,462.007 372.148,628.035 374.456,524.584 376.764,591.882 379.072,489.099 381.38,415.904 383.688,396.791 385.996,566.641 388.303,502.987 390.611,443.698 392.919,503.85 395.227,383.848 397.535,357.767 399.843,379.153 402.151,441.117 404.459,619.455 406.767,676.66 409.075,444.374 411.383,448.887 413.69,459.996 415.998,481.253 418.306,452.115 420.614,584.701 422.922,467.733 425.23,657.974 427.538,366.006 429.846,543.298 432.154,534.153 434.462,553.62 436.77,436.383 439.077,515.9 441.385,368.114 443.693,404.757 446.001,441.106 448.309,312.351 450.617,515.318 452.925,695.291 455.233,478.952 457.541,291.174 459.849,478.967 462.157,434.541 464.465,658.543 466.772,529.487 469.08,302.487 471.388,490.077 473.696,477.16 476.004,473.028 478.312,539.896 480.62,638.385 482.928,312.296 485.236,372.33 487.544,490.076 489.852,566.719 492.159,387.048 494.467,398.082 496.775,464.064 499.083,400.791 501.391,619.842 503.699,344.855 506.007,385.758 508.315,591.195 510.623,578.776 512.931,552.075 515.239,443.207 517.546,301.046 519.854,453.864 522.162,585.353 524.47,651.448 526.778,515.695 529.086,396.77 531.394,512.512 533.702,372.431 536.01,518.925 538.318,324.76 540.626,446.855 542.933,612.123 545.241,393.742 547.549,287.967 549.857,524.488 552.165,328.875 554.473,421.925 556.781,412.546 559.089,287.796 561.397,461.558 563.705,585.94 566.013,325.606 568.321,437.929 570.628,242.463 572.936,618.015 575.244,529.131 577.552,501.132 579.86,569.081 582.168,358.963 584.476,486.951 586.784,482.664 589.092,456.79 591.4,414.602 593.708,522.53 596.015,543.303 598.323,455.221 600.631,431.176 602.939,258.893 605.247,449.99 607.555,493.991 609.863,424.229 612.171,490.875 614.479,396.245 616.787,485.252 619.095,517.661 621.402,402.536 623.71,472.511 626.018,338.997 628.326,417.036 630.634,407.452 632.942,562.978 635.25,497.658 637.558,503.15 639.866,479.082 642.174,574.634 644.482,447.084 646.79,640.018 649.097,653.41 651.405,495.696 653.713,581.961 656.021,556.715 658.329,697.076 660.637,616.233 662.945,572.772 665.253,480.499 667.561,257.874 669.869,373.968 672.177,305.338 674.484,561.809 676.792,530.978 679.1,638.903 681.408,444.935 683.716,238.332 686.024,449.515 688.332,399.441 690.64,367.216 692.948,491.904 695.256,405.225 697.564,599.013 699.871,412.424 702.179,461.376 704.487,429.685 706.795,503.316 709.103,457.134 711.411,477.556 713.719,486.007 716.027,453.906 718.335,359.23 720.643,393.591 722.951,461.108 725.259,421.787 727.566,572.653 729.874,456.128 732.182,444.223 734.49,569.709 736.798,433.066 739.106,456.185 741.414,485.746 743.722,294.606 746.03,538.857 748.338,646.147 750.646,432.93 752.953,307.102 755.261,295.87 757.569,523.263 759.877,546.323 762.185,482.073 764.493,618.564 766.801,433.856 769.109,376.587 771.417,418.604 773.725,355.514 776.033,607.25 778.34,398.73 780.648,615.628 782.956,408.433 785.264,478.184 787.572,503.131 789.88,308.278 792.188,478.114 794.496,502.089 796.804,377.094 799.112,506.069 801.42,515.593 803.728,549.964 806.035,304.003 808.343,376.86 810.651,365.86 812.959,504.128 815.267,183.044 817.575,593.273 819.883,385.977 822.191,587.78 824.499,473.954 826.807,271.735 829.115,610.424 831.422,485.039 833.73,362.461 836.038,307.613 838.346,378.258 840.654,423.953 842.962,96.8724 845.27,467.569 847.578,462.977 849.886,362.216 852.194,637.608 854.502,584.409 856.809,355.812 859.117,446.797 861.425,385.433 863.733,450.045 866.041,537.3 868.349,503.055 870.657,587.505 872.965,551.619 875.273,444.275 877.581,446.969 879.889,388.012 882.197,401.807 884.504,336.039 886.812,535.475 889.12,493.262 891.428,522.913 893.736,596.91 896.044,379.749 898.352,307.747 900.66,508.038 902.968,478.746 905.276,426.74 907.584,491.793 909.891,363.425 912.199,503.725 914.507,549.44 916.815,417.002 919.123,580.695 921.431,313.918 923.739,553.588 926.047,458.751 928.355,380.231 930.663,396.021 932.971,493.086 935.278,518.778 937.586,492.345 939.894,432.408 942.202,467.428 944.51,462.836 946.818,533.508 949.126,381.3 951.434,570.791 953.742,611.537 956.05,456.733 958.358,508.285 960.665,499.21 962.973,441.552 965.281,501.355 967.589,465.599 969.897,602.431 972.205,617.367 974.513,347.594 976.821,513.488 979.129,458.54 981.437,400.863 983.745,535.678 986.053,300.341 988.36,644.763 990.668,342.921 992.976,589.56 995.284,645.751 997.592,396.612 999.9,381.25 1002.21,349.746 1004.52,447.757 1006.82,435.51 1009.13,433.57 1011.44,465.709 1013.75,344.743 1016.06,449.944 1018.36,498.943 1020.67,548.105 1022.98,422.145 1025.29,657.239 1027.59,373.539 1029.9,345.169 1032.21,606.354 1034.52,346.413 1036.83,639.716 1039.13,470.098 1041.44,484.145 1043.75,553.332 1046.06,468.235 1048.37,504.257 1050.67,682.807 1052.98,604.622 1055.29,583.348 1057.6,392.794 1059.91,444.522 1062.21,504.109 1064.52,459.528 1066.83,339.796 1069.14,373.417 1071.45,608.047 1073.75,500.425 1076.06,543.771 1078.37,462.28 1080.68,417.838 1082.98,505.372 1085.29,431.021 1087.6,469.182 1089.91,483.136 1092.22,500.856 1094.52,357.366 1096.83,407.148 1099.14,425.137 1101.45,420.672 1103.76,619.824 1106.06,355.808 1108.37,538.65 1110.68,482.797 1112.99,564.753 1115.3,461.709 1117.6,560.828 1119.91,242.12 1122.22,346.894 1124.53,562.317 1126.84,490.665 1129.14,428.336 1131.45,450.81 1133.76,453.639 1136.07,485.161 1138.37,472.646 1140.68,423.659 1142.99,492.612 1145.3,531.861 1147.61,594.286 1149.91,468.252 1152.22,330.167 1154.53,405.888 1156.84,614.017 1159.15,474.424 1161.45,397.376 1163.76,509.291 1166.07,446.089 1168.38,459.278 1170.69,606.186 1172.99,571.37 1175.3,375.193 1177.61,642.322 1179.92,570.974 1182.23,357.795 1184.53,493.096 1186.84,470.981 1189.15,406.401 1191.46,501.481 1193.76,530.051 1196.07,471.042 1198.38,368.868 1200.69,434.866 1203,590.28 1205.3,561.454 1207.61,395.37 1209.92,610.754 1212.23,470.995 1214.54,358.177 1216.84,338.291 1219.15,377.934 1221.46,313.396 1223.77,185.079 1226.08,501.636 1228.38,414.438 1230.69,339.402 1233,500.374 1235.31,485.139 1237.61,464.701 1239.92,407.66 1242.23,421.851 1244.54,471.707 1246.85,567.359 1249.15,473.052 1251.46,454.792 1253.77,428.371 1256.08,590.754 1258.39,520.001 1260.69,440.741 1263,643.921 1265.31,530.751 1267.62,360.286 1269.93,308.056 1272.23,567.114 1274.54,455.576 1276.85,416.737 1279.16,437.428 1281.47,350.508 1283.77,514.132 1286.08,695.867 1288.39,570.751 1290.7,468.369 1293,425.938 1295.31,452.965 1297.62,403.401 1299.93,396.01 1302.24,530.781 1304.54,444.067 1306.85,381.379 1309.16,401.194 1311.47,591.834 1313.78,668.626 1316.08,403.334 1318.39,359.438 1320.7,287.209 1323.01,289.543 1325.32,369.157 1327.62,421.176 1329.93,516.054 1332.24,305.311 1334.55,469.671 1336.86,385.246 1339.16,373.239 1341.47,455.901 1343.78,477.974 1346.09,492.97 1348.39,395.594 1350.7,476.831 1353.01,388.206 1355.32,473.776 1357.63,565.725 1359.93,388.766 1362.24,463.647 1364.55,303.645 1366.86,470.788 1369.17,491.021 1371.47,458.402 1373.78,464.233 1376.09,432.197 1378.4,571.208 1380.71,493.807 1383.01,387.637 1385.32,457.622 1387.63,454.307 1389.94,405.729 1392.24,380.186 1394.55,647.827 1396.86,240.39 1399.17,613.197 1401.48,389.339 1403.78,402.649 1406.09,495.327 1408.4,457.433 1410.71,481.876 1413.02,457.423 1415.32,443.109 1417.63,626.387 1419.94,388.796 1422.25,425.469 1424.56,493.614 1426.86,476.038 1429.17,499.982 1431.48,319.053 1433.79,316.107 1436.1,452.563 1438.4,377.462 1440.71,371.544 1443.02,473.389 1445.33,678.264 1447.63,330.649 1449.94,542.739 1452.25,571.521 1454.56,499.113 1456.87,449.773 1459.17,351.194 1461.48,646.259 1463.79,438.171 1466.1,605.083 1468.41,514.067 1470.71,441.799 1473.02,307.385 1475.33,444.696 1477.64,324.635 1479.95,277.333 1482.25,368.523 1484.56,518.664 1486.87,458.396 1489.18,552.35 1491.49,534.936 1493.79,456.745 1496.1,308.826 1498.41,433.432 1500.72,552.604 1503.02,478.059 1505.33,481.003 1507.64,349.448 1509.95,151.264 1512.26,363.814 1514.56,526.012 1516.87,582.952 1519.18,323.858 1521.49,389.967 1523.8,332.819 1526.1,440.772 1528.41,408.143 1530.72,390.132 1533.03,468.45 1535.34,425.714 1537.64,392.103 1539.95,567.209 1542.26,410.91 1544.57,418.645 1546.88,440.288 1549.18,446.284 1551.49,533.565 1553.8,447 1556.11,465.114 1558.41,445.24 1560.72,491.271 1563.03,411.383 1565.34,571.743 1567.65,548.684 1569.95,474.163 1572.26,535.666 1574.57,452.552 1576.88,599.886 1579.19,274.696 1581.49,497.266 1583.8,435.592 1586.11,437.241 1588.42,565.173 1590.73,427.249 1593.03,586.787 1595.34,449.659 1597.65,212.399 1599.96,560.926 1602.26,735.228 1604.57,485.15 1606.88,515.472 1609.19,666.812 1611.5,517.636 1613.8,527.876 1616.11,523.066 1618.42,544.521 1620.73,598.32 1623.04,402.361 1625.34,460.397 1627.65,529.982 1629.96,376.626 1632.27,281.536 1634.58,487.155 1636.88,398.103 1639.19,449.319 1641.5,395.612 1643.81,485.38 1646.12,326.249 1648.42,423.242 1650.73,465.972 1653.04,370.831 1655.35,210.66 1657.65,278.469 1659.96,482.789 1662.27,410.131 1664.58,508.38 1666.89,228.107 1669.19,376.399 1671.5,561.336 1673.81,519.397 1676.12,419.368 1678.43,374.369 1680.73,335.524 1683.04,451.775 1685.35,499.212 1687.66,493.457 1689.97,482.688 1692.27,462.483 1694.58,410.932 1696.89,470.231 1699.2,496.197 1701.51,452.226 1703.81,534.425 1706.12,441.854 1708.43,454.77 1710.74,552.073 1713.04,643.728 1715.35,346.738 1717.66,504.171 1719.97,376.554 1722.28,434.557 1724.58,618.174 1726.89,162.65 1729.2,436.215 1731.51,299.567 1733.82,447.306 1736.12,350.532 1738.43,482.079 1740.74,350.882 1743.05,465.486 1745.36,459.68 1747.66,499.492 1749.97,391.508 1752.28,527.162 1754.59,507.651 1756.9,452.936 1759.2,476.265 1761.51,382.498 1763.82,534.061 1766.13,589.952 1768.43,331.673 1770.74,500.414 1773.05,380.18 1775.36,501.788 1777.67,308.713 1779.97,451.736 1782.28,439.729 1784.59,373.484 1786.9,504.129 1789.21,601.824 1791.51,475.93 1793.82,538.067 1796.13,667.144 1798.44,676.891 1800.75,460.62 1803.05,505.686 1805.36,496.569 1807.67,470.271 1809.98,480.07 1812.28,463.089 1814.59,444.298 1816.9,511.381 1819.21,458.144 1821.52,497.301 1823.82,483.888 1826.13,451.514 1828.44,424.622 1830.75,464.636 1833.06,456.263 1835.36,281.937 1837.67,590.266 1839.98,436.963 1842.29,493.782 1844.6,497.974 1846.9,583.935 1849.21,589.397 1851.52,436.62 1853.83,467.572 1856.14,383.827 1858.44,513.397 1860.75,677.587 1863.06,470.217 1865.37,527.599 1867.67,453.366 1869.98,384.35 1872.29,563.214 1874.6,373.643 1876.91,271.49 1879.21,397.73 1881.52,590.714 1883.83,615.56 1886.14,484.045 1888.45,411.632 1890.75,624.284 1893.06,629.061 1895.37,564.518 1897.68,166.92 1899.99,427.075 1902.29,497.187 1904.6,456.165 1906.91,393.394 1909.22,293.908 1911.53,392.171 1913.83,661.591 1916.14,426.079 1918.45,313.895 1920.76,274.487 1923.06,337.801 1925.37,358.325 1927.68,388.249 1929.99,458.048 1932.3,321.466 1934.6,451.525 1936.91,478.488 1939.22,412.267 1941.53,493.366 1943.84,505.947 1946.14,254.914 1948.45,500.695 1950.76,484.142 1953.07,454.745 1955.38,374.823 1957.68,374.894 1959.99,417.576 1962.3,426.304 1964.61,479.987 1966.91,312.175 1969.22,522.02 1971.53,669.586 1973.84,378.839 1976.15,452.072 1978.45,472.598 1980.76,344.802 1983.07,751.192 1985.38,224.903 1987.69,539.057 1989.99,369.988 1992.3,484.298 1994.61,516.598 1996.92,365.1 1999.23,562.322 2001.53,519.284 2003.84,358.61 2006.15,495.882 2008.46,570.182 2010.77,396.854 2013.07,660.073 2015.38,374.672 2017.69,296.985 2020,641.42 2022.3,344.265 2024.61,462.901 2026.92,440.453 2029.23,306.247 2031.54,418.372 2033.84,555.232 2036.15,454.977 2038.46,466.768 2040.77,577.682 2043.08,487.251 2045.38,591.237 2047.69,519.351 2050,510.602 2052.31,528.653 2054.62,463.049 2056.92,609.524 2059.23,358.903 2061.54,629.864 2063.85,491.68 2066.16,316.633 2068.46,567.041 2070.77,488.275 2073.08,411.61 2075.39,342.556 2077.69,411.118 2080,348.737 2082.31,183.752 2084.62,556.088 2086.93,403.736 2089.23,376.83 2091.54,573.784 2093.85,508.748 2096.16,374.968 2098.47,379.556 2100.77,428.651 2103.08,463.746 2105.39,524.571 2107.7,372.801 2110.01,663.456 2112.31,400.483 2114.62,350.523 2116.93,455.764 2119.24,392.121 2121.55,436.41 2123.85,499.314 2126.16,721.577 2128.47,429.489 2130.78,397.668 2133.08,310.324 2135.39,479.671 2137.7,383.407 2140.01,367.106 2142.32,627.659 2144.62,379.196 2146.93,481.045 2149.24,345.882 2151.55,503.163 2153.86,440.448 2156.16,523.045 2158.47,359.355 2160.78,478.769 2163.09,381.075 2165.4,519.075 2167.7,478.297 2170.01,576.27 2172.32,379.707 2174.63,390.42 2176.93,509.03 2179.24,313.972 2181.55,457.589 2183.86,536.24 2186.17,427.635 2188.47,444.021 2190.78,379.89 2193.09,492.068 2195.4,230.868 2197.71,611.048 2200.01,412.141 2202.32,538.642 2204.63,350.372 2206.94,475.041 2209.25,333.959 2211.55,528.922 2213.86,458.163 2216.17,400.67 2218.48,466.836 2220.79,434.347 2223.09,584.025 2225.4,489.337 2227.71,443.277 2230.02,537.698 2232.32,469.928 2234.63,431.375 2236.94,397.12 2239.25,372.178 2241.56,543.078 2243.86,516.434 2246.17,173.041 2248.48,442.86 2250.79,400.47 2253.1,494.248 2255.4,555.775 2257.71,678.902 2260.02,431.662 2262.33,363.913 2264.64,362.977 2266.94,434.466 2269.25,541.345 2271.56,367.197 2273.87,444.927 2276.18,486.989 2278.48,334.767 2280.79,469.487 2283.1,383.23 2285.41,472.66 2287.71,294.243 2290.02,635.665 2292.33,560.168 2294.64,400.757 2296.95,493.453 2299.25,514.895 2301.56,548.52 2303.87,630.795 2306.18,342.666 2308.49,561.457 2310.79,481.185 2313.1,343.592 2315.41,400.72 2317.72,375.859 2320.03,443.674 2322.33,481.381 2324.64,524.406 2326.95,437.448 2329.26,448.9 2331.56,528.368 2333.87,492.14 2336.18,451.728 2338.49,382.491 2340.8,323.071 2343.1,356.973 2345.41,479.39 2347.72,445.534 2350.03,533.563 2352.34,532.369 2354.64,322.072 2356.95,516.804 2359.26,468.247 2361.57,367.578 2363.88,338.216 2366.18,418.039 2368.49,465.217 2370.8,718.279 2373.11,442.839 2375.42,391.189 2377.72,639.262 2380.03,343.296 2382.34,511.079 2384.65,255.798 2386.95,384.729 2389.26,324.723 2391.57,352.81 2393.88,514.876 2396.19,380.195 2398.49,375.139 2400.8,245.072 2403.11,422.08 2405.42,320.453 2407.73,520.164 2410.03,467.577 2412.34,402.625 2414.65,391.51 2416.96,501.245 2419.27,503.018 2421.57,130.749 2423.88,417.886 2426.19,437.457 2428.5,385.826 2430.81,408.987 2433.11,325.791 2435.42,422.801 2437.73,390.255 2440.04,330.984 2442.34,556.579 2444.65,420.069 2446.96,430.645 2449.27,491.267 2451.58,681.72 2453.88,409.657 2456.19,478.62 2458.5,495.33 2460.81,404.966 2463.12,373.964 2465.42,498.716 2467.73,659.266 2470.04,326.519 2472.35,324.409 2474.66,470.057 2476.96,377.833 2479.27,432.847 2481.58,368.679 2483.89,436.972 2486.2,733.084 2488.5,499.913 2490.81,108.966 2493.12,342.21 2495.43,279.188 2497.73,358.123 2500.04,498.876 2502.35,420.777 2504.66,435.128 2506.97,434.738 2509.27,382.107 2511.58,587.476 2513.89,590.769 2516.2,404.099 2518.51,451.046 2520.81,400.934 2523.12,396.518 2525.43,293.547 2527.74,415.241 2530.05,288.634 2532.35,473.696 2534.66,441.465 2536.97,494.005 2539.28,500.426 2541.58,541.206 2543.89,508.611 2546.2,442.323 2548.51,339.522 2550.82,501.049 2553.12,343.904 2555.43,270.08 2557.74,481.77 2560.05,351.327 2562.36,708.231 2564.66,525.653 2566.97,651.047 2569.28,271.814 2571.59,411.596 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -1.97718   -2.92455  -1.91145   -2.11113   …  -5.06344   -4.47681  -4.71418
  0.387369   1.09493   0.348066  -0.886453     -0.438943  -0.76708  -0.238871
  4.01749    2.86005   4.30572    4.97806       5.86815    6.51246   4.28039

[:, :, 2] =
 -2.93535    -4.73929   -4.78163   …  -4.73452   -5.19941    -4.86968
 -0.0110295  -0.135384  -0.911165     -0.133692   0.0358293   0.641132
  0.0366411   1.17712    3.00634       3.66128    2.00011     4.49989

[:, :, 3] =
 -1.68635  -4.01628   -3.83148  -2.42947   …  -4.58592   -4.08458   -4.61463
 -0.04175  -0.673535  -1.16693  -0.735474     -0.410354  -0.961081   0.535942
  2.49125   1.9064     4.54199   5.8362        5.5218     5.91821    3.92732

[:, :, 4] =
 -1.94586  -3.5408    -3.61374   -3.52614  …  -5.7387   -7.90635   -7.32993
 -1.06201  -0.013425   0.737267   1.44526     -1.5279   -0.640276   0.731135
  2.50672   4.36455    4.94618    4.75682      4.40575   5.77059    6.91342</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.97949    0.989885
 -0.0132914  0.989697
  4.98442    0.993425</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.45 seconds
Compute duration  = 2.45 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -4.9924    1.0034    0.0188   2836.7509   4368.2855    1.0001   ⋯
        x[2]    0.0180    0.9871    0.0173   3250.1485   5316.2133    1.0008   ⋯
        x[3]    4.9716    1.0025    0.0181   3053.2699   4872.3634    1.0006   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -6.9996   -5.6769   -4.9813   -4.3058   -3.0537
        x[2]   -1.9425   -0.6388    0.0208    0.6858    1.9134
        x[3]    2.9937    4.2879    4.9710    5.6589    6.9561</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.41 seconds
Compute duration  = 1.41 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.4991    0.1923    0.0029   4253.0415   5869.5240    1.0001   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1441    0.3523    0.4999    0.6422    0.8561</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.22 seconds
Compute duration  = 0.22 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

           x    0.5154    0.1252    0.0104   137.9379    62.3767    1.0267     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.2705    0.4268    0.5077    0.6092    0.7669</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}(-0.19242734798814065,1.0,0.0), "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}(-0.19242734798814065,1.0,0.0):
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/Qeo2J/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/Qeo2J/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/Qeo2J/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/Qeo2J/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/Qeo2J/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/ooLj8/src/compiler.jl:579 [inlined]
  [7] demo(__model__::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, __varinfo__::DynamicPPL.ThreadSafeVarInfo{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}}, ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Base.RefValue{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, __context__::DynamicPPL.DefaultContext)
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:593
  [8] _evaluate!!
    @ ~/.julia/packages/DynamicPPL/ooLj8/src/model.jl:975 [inlined]
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}}, ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, context::DynamicPPL.DefaultContext)
    @ DynamicPPL ~/.julia/packages/DynamicPPL/ooLj8/src/model.jl:964
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/ooLj8/src/model.jl:894 [inlined]
 [11] logdensity
    @ ~/.julia/packages/DynamicPPL/ooLj8/src/logdensityfunction.jl:140 [inlined]
 [12] Fix1
    @ ./operators.jl:1118 [inlined]
 [13] vector_mode_dual_eval!(f::Base.Fix1{typeof(LogDensityProblems.logdensity), LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}}, cfg::ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}, x::Vector{Float64})
    @ ForwardDiff ~/.julia/packages/ForwardDiff/UBbGT/src/apiutils.jl:24
 [14] vector_mode_gradient!(result::DiffResults.MutableDiffResult{1, Float64, Tuple{Vector{Float64}}}, f::Base.Fix1{typeof(LogDensityProblems.logdensity), LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}}, x::Vector{Float64}, cfg::ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}})
    @ ForwardDiff ~/.julia/packages/ForwardDiff/UBbGT/src/gradient.jl:98
 [15] gradient!
    @ ~/.julia/packages/ForwardDiff/UBbGT/src/gradient.jl:39 [inlined]
 [16] gradient!
    @ ~/.julia/packages/ForwardDiff/UBbGT/src/gradient.jl:36 [inlined]
 [17] logdensity_and_gradient
    @ ~/.julia/packages/LogDensityProblemsAD/9uEsH/ext/LogDensityProblemsADForwardDiffExt.jl:116 [inlined]
 [18] leapfrog_step(model::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, x::Vector{Float64}, p::Vector{Float64}, ϵ::Int64, M::UniformScaling{Bool})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:369
 [19] step(rng::TaskLocalRNG, model_wrapper::AbstractMCMC.LogDensityModel{LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}}, sampler::MALA{Int64, UniformScaling{Bool}}, state::MALAState{Vector{Float64}}; kwargs::@Kwargs{})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:334
 [20] step
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:316 [inlined]
 [21] #step#103
    @ ~/.julia/packages/Turing/bUZEC/src/mcmc/abstractmcmc.jl:161 [inlined]
 [22] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, state::Turing.Inference.TuringState{MALAState{Vector{Float64}}, LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}})
    @ Turing.Inference ~/.julia/packages/Turing/bUZEC/src/mcmc/abstractmcmc.jl:150
 [23] macro expansion
    @ ~/.julia/packages/AbstractMCMC/FSyVk/src/sample.jl:217 [inlined]
 [24] macro expansion
    @ ~/.julia/packages/AbstractMCMC/FSyVk/src/logging.jl:16 [inlined]
 [25] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, num_warmup::Int64, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/FSyVk/src/sample.jl:142
 [26] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/ooLj8/src/sampler.jl:93
 [27] sample
    @ ~/.julia/packages/DynamicPPL/ooLj8/src/sampler.jl:83 [inlined]
 [28] #sample#4
    @ ~/.julia/packages/Turing/bUZEC/src/mcmc/Inference.jl:305 [inlined]
 [29] sample
    @ ~/.julia/packages/Turing/bUZEC/src/mcmc/Inference.jl:296 [inlined]
 [30] #sample#3
    @ ~/.julia/packages/Turing/bUZEC/src/mcmc/Inference.jl:293 [inlined]
 [31] top-level scope
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:595</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.55 seconds
Compute duration  = 0.55 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.9263    0.6040    0.0310   272.2059   190.3750    1.0022     ⋯
           x   -0.1085    1.1454    0.0711   320.7585   280.5448    1.0231     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1400    0.4285    0.8089    1.3036    2.4078
           x   -2.8565   -0.5175   -0.0316    0.3752    2.4000</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 3.05 seconds
Compute duration  = 3.05 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8822    0.5320    0.0230   690.6296   292.9276    1.0023     ⋯
           x   -0.0677    1.0919    0.0779   376.9729   125.1608    1.0066     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1862    0.4654    0.7750    1.2100    2.0922
           x   -2.5363   -0.4715   -0.0143    0.4195    2.1115</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>