<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.3">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../tutorials/docs-07-for-developers-variational-inference/index.html" rel="prev">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-81b5c3e63835cfde897ecd3d35a35a41.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-c634bf5241e7a0f0add955421922332b.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-f80257e2a36ff81c57cea0ffaf822744.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-3042bfe894fb86cfc239603025ade02d.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/docs-00-getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/00-introduction/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.35" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.35</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.35">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Users</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-00-getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-12-using-turing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Core Functionality</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Usage Tips</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-10-using-turing-autodiff/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-custom-distribution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Custom Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-probability-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Querying Model Probabilities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-modifying-logprob/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modifying the Log Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-generated-quantities/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generated Quantities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-13-using-turing-performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-15-using-turing-sampler-viz/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-11-using-turing-dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-16-using-turing-external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/00-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction: Coin Flipping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/01-gaussian-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/02-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/03-bayesian-neural-network/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/04-hidden-markov-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/05-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/06-infinite-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/07-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/08-multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/09-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/10-bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/11-probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/13-seasonal-time-series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/15-gaussian-processes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Gaussian Processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/12-gplvm/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Contributing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-01-contributing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to Contribute</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">DynamicPPL in Depth</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/dev-model-manual/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manually Defining a Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-05-for-developers-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/14-minituring/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/16-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Inference (note: outdated)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-06-for-developers-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-21.294934449714454</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-21.294934449714454</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([0.0, 0.0, 0.0]), MALAState{Vector{Float64}}([0.0, 0.0, 0.0]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -0.858101  -2.75679  -2.75679  -4.2899   …  -5.26452   -5.04986   -5.35598
 -1.17955   -2.0956   -2.0956   -1.96961     -0.647132  -0.717402  -0.0960524
  3.08003    4.57587   4.57587   5.43392      5.6369     5.45616    5.47391</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -5.00142     1.02348
  0.00554565  1.01646
  5.01473     0.99372</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip190">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip190)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip191">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip190)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip192">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip192)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip192)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip192)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip192)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip192)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip192)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1678.59 2640.76,1678.59 "></polyline>
<polyline clip-path="url(#clip192)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1436.17 2640.76,1436.17 "></polyline>
<polyline clip-path="url(#clip192)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1193.76 2640.76,1193.76 "></polyline>
<polyline clip-path="url(#clip192)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,951.351 2640.76,951.351 "></polyline>
<polyline clip-path="url(#clip192)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,708.94 2640.76,708.94 "></polyline>
<polyline clip-path="url(#clip192)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,466.528 2640.76,466.528 "></polyline>
<polyline clip-path="url(#clip192)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,224.116 2640.76,224.116 "></polyline>
<polyline clip-path="url(#clip190)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip190)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip190)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip190)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip190)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip190)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip190)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip190)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip190)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1678.59 215.714,1678.59 "></polyline>
<polyline clip-path="url(#clip190)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1436.17 215.714,1436.17 "></polyline>
<polyline clip-path="url(#clip190)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1193.76 215.714,1193.76 "></polyline>
<polyline clip-path="url(#clip190)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,951.351 215.714,951.351 "></polyline>
<polyline clip-path="url(#clip190)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,708.94 215.714,708.94 "></polyline>
<polyline clip-path="url(#clip190)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,466.528 215.714,466.528 "></polyline>
<polyline clip-path="url(#clip190)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,224.116 215.714,224.116 "></polyline>
<path clip-path="url(#clip190)" d="M50.5475 1679.04 L80.2233 1679.04 L80.2233 1682.97 L50.5475 1682.97 L50.5475 1679.04 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M89.1352 1661.31 L111.357 1661.31 L111.357 1663.3 L98.8111 1695.87 L93.9269 1695.87 L105.732 1665.24 L89.1352 1665.24 L89.1352 1661.31 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M120.478 1689.99 L125.362 1689.99 L125.362 1695.87 L120.478 1695.87 L120.478 1689.99 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M135.593 1661.31 L153.95 1661.31 L153.95 1665.24 L139.876 1665.24 L139.876 1673.71 Q140.894 1673.37 141.913 1673.2 Q142.931 1673.02 143.95 1673.02 Q149.737 1673.02 153.116 1676.19 Q156.496 1679.36 156.496 1684.78 Q156.496 1690.36 153.024 1693.46 Q149.552 1696.54 143.232 1696.54 Q141.056 1696.54 138.788 1696.17 Q136.542 1695.8 134.135 1695.06 L134.135 1690.36 Q136.218 1691.49 138.441 1692.05 Q140.663 1692.6 143.14 1692.6 Q147.144 1692.6 149.482 1690.5 Q151.82 1688.39 151.82 1684.78 Q151.82 1681.17 149.482 1679.06 Q147.144 1676.95 143.14 1676.95 Q141.265 1676.95 139.39 1677.37 Q137.538 1677.79 135.593 1678.67 L135.593 1661.31 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M49.5521 1436.63 L79.2279 1436.63 L79.2279 1440.56 L49.5521 1440.56 L49.5521 1436.63 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M89.3667 1418.89 L107.723 1418.89 L107.723 1422.83 L93.6491 1422.83 L93.6491 1431.3 Q94.6676 1430.95 95.6861 1430.79 Q96.7047 1430.61 97.7232 1430.61 Q103.51 1430.61 106.89 1433.78 Q110.269 1436.95 110.269 1442.37 Q110.269 1447.95 106.797 1451.05 Q103.325 1454.13 97.0056 1454.13 Q94.8297 1454.13 92.5612 1453.76 Q90.3158 1453.39 87.9084 1452.64 L87.9084 1447.95 Q89.9917 1449.08 92.2139 1449.64 Q94.4361 1450.19 96.913 1450.19 Q100.918 1450.19 103.256 1448.08 Q105.593 1445.98 105.593 1442.37 Q105.593 1438.76 103.256 1436.65 Q100.918 1434.54 96.913 1434.54 Q95.038 1434.54 93.163 1434.96 Q91.3112 1435.38 89.3667 1436.26 L89.3667 1418.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M119.482 1447.57 L124.367 1447.57 L124.367 1453.45 L119.482 1453.45 L119.482 1447.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M144.552 1421.97 Q140.941 1421.97 139.112 1425.54 Q137.306 1429.08 137.306 1436.21 Q137.306 1443.32 139.112 1446.88 Q140.941 1450.42 144.552 1450.42 Q148.186 1450.42 149.991 1446.88 Q151.82 1443.32 151.82 1436.21 Q151.82 1429.08 149.991 1425.54 Q148.186 1421.97 144.552 1421.97 M144.552 1418.27 Q150.362 1418.27 153.417 1422.88 Q156.496 1427.46 156.496 1436.21 Q156.496 1444.94 153.417 1449.54 Q150.362 1454.13 144.552 1454.13 Q138.741 1454.13 135.663 1449.54 Q132.607 1444.94 132.607 1436.21 Q132.607 1427.46 135.663 1422.88 Q138.741 1418.27 144.552 1418.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M50.5475 1194.21 L80.2233 1194.21 L80.2233 1198.15 L50.5475 1198.15 L50.5475 1194.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M94.3436 1207.11 L110.663 1207.11 L110.663 1211.04 L88.7186 1211.04 L88.7186 1207.11 Q91.3806 1204.35 95.9639 1199.72 Q100.57 1195.07 101.751 1193.73 Q103.996 1191.21 104.876 1189.47 Q105.779 1187.71 105.779 1186.02 Q105.779 1183.27 103.834 1181.53 Q101.913 1179.79 98.8111 1179.79 Q96.6121 1179.79 94.1584 1180.56 Q91.7278 1181.32 88.9501 1182.87 L88.9501 1178.15 Q91.7741 1177.02 94.2278 1176.44 Q96.6815 1175.86 98.7185 1175.86 Q104.089 1175.86 107.283 1178.54 Q110.478 1181.23 110.478 1185.72 Q110.478 1187.85 109.668 1189.77 Q108.881 1191.67 106.774 1194.26 Q106.195 1194.93 103.094 1198.15 Q99.9917 1201.34 94.3436 1207.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M120.478 1205.16 L125.362 1205.16 L125.362 1211.04 L120.478 1211.04 L120.478 1205.16 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M135.593 1176.48 L153.95 1176.48 L153.95 1180.42 L139.876 1180.42 L139.876 1188.89 Q140.894 1188.54 141.913 1188.38 Q142.931 1188.2 143.95 1188.2 Q149.737 1188.2 153.116 1191.37 Q156.496 1194.54 156.496 1199.95 Q156.496 1205.53 153.024 1208.64 Q149.552 1211.71 143.232 1211.71 Q141.056 1211.71 138.788 1211.34 Q136.542 1210.97 134.135 1210.23 L134.135 1205.53 Q136.218 1206.67 138.441 1207.22 Q140.663 1207.78 143.14 1207.78 Q147.144 1207.78 149.482 1205.67 Q151.82 1203.57 151.82 1199.95 Q151.82 1196.34 149.482 1194.24 Q147.144 1192.13 143.14 1192.13 Q141.265 1192.13 139.39 1192.55 Q137.538 1192.96 135.593 1193.84 L135.593 1176.48 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M99.3204 937.15 Q95.7093 937.15 93.8806 940.715 Q92.075 944.256 92.075 951.386 Q92.075 958.492 93.8806 962.057 Q95.7093 965.599 99.3204 965.599 Q102.955 965.599 104.76 962.057 Q106.589 958.492 106.589 951.386 Q106.589 944.256 104.76 940.715 Q102.955 937.15 99.3204 937.15 M99.3204 933.446 Q105.131 933.446 108.186 938.053 Q111.265 942.636 111.265 951.386 Q111.265 960.113 108.186 964.719 Q105.131 969.303 99.3204 969.303 Q93.5102 969.303 90.4315 964.719 Q87.376 960.113 87.376 951.386 Q87.376 942.636 90.4315 938.053 Q93.5102 933.446 99.3204 933.446 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M119.482 962.752 L124.367 962.752 L124.367 968.631 L119.482 968.631 L119.482 962.752 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M144.552 937.15 Q140.941 937.15 139.112 940.715 Q137.306 944.256 137.306 951.386 Q137.306 958.492 139.112 962.057 Q140.941 965.599 144.552 965.599 Q148.186 965.599 149.991 962.057 Q151.82 958.492 151.82 951.386 Q151.82 944.256 149.991 940.715 Q148.186 937.15 144.552 937.15 M144.552 933.446 Q150.362 933.446 153.417 938.053 Q156.496 942.636 156.496 951.386 Q156.496 960.113 153.417 964.719 Q150.362 969.303 144.552 969.303 Q138.741 969.303 135.663 964.719 Q132.607 960.113 132.607 951.386 Q132.607 942.636 135.663 938.053 Q138.741 933.446 144.552 933.446 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M94.3436 722.284 L110.663 722.284 L110.663 726.22 L88.7186 726.22 L88.7186 722.284 Q91.3806 719.53 95.9639 714.9 Q100.57 710.247 101.751 708.905 Q103.996 706.382 104.876 704.646 Q105.779 702.886 105.779 701.197 Q105.779 698.442 103.834 696.706 Q101.913 694.97 98.8111 694.97 Q96.6121 694.97 94.1584 695.734 Q91.7278 696.498 88.9501 698.048 L88.9501 693.326 Q91.7741 692.192 94.2278 691.613 Q96.6815 691.035 98.7185 691.035 Q104.089 691.035 107.283 693.72 Q110.478 696.405 110.478 700.896 Q110.478 703.025 109.668 704.947 Q108.881 706.845 106.774 709.437 Q106.195 710.109 103.094 713.326 Q99.9917 716.521 94.3436 722.284 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M120.478 720.34 L125.362 720.34 L125.362 726.22 L120.478 726.22 L120.478 720.34 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M135.593 691.66 L153.95 691.66 L153.95 695.595 L139.876 695.595 L139.876 704.067 Q140.894 703.72 141.913 703.558 Q142.931 703.372 143.95 703.372 Q149.737 703.372 153.116 706.544 Q156.496 709.715 156.496 715.132 Q156.496 720.71 153.024 723.812 Q149.552 726.891 143.232 726.891 Q141.056 726.891 138.788 726.521 Q136.542 726.15 134.135 725.409 L134.135 720.71 Q136.218 721.845 138.441 722.4 Q140.663 722.956 143.14 722.956 Q147.144 722.956 149.482 720.849 Q151.82 718.743 151.82 715.132 Q151.82 711.521 149.482 709.414 Q147.144 707.308 143.14 707.308 Q141.265 707.308 139.39 707.724 Q137.538 708.141 135.593 709.021 L135.593 691.66 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M89.3667 449.248 L107.723 449.248 L107.723 453.183 L93.6491 453.183 L93.6491 461.655 Q94.6676 461.308 95.6861 461.146 Q96.7047 460.961 97.7232 460.961 Q103.51 460.961 106.89 464.132 Q110.269 467.303 110.269 472.72 Q110.269 478.299 106.797 481.401 Q103.325 484.479 97.0056 484.479 Q94.8297 484.479 92.5612 484.109 Q90.3158 483.738 87.9084 482.998 L87.9084 478.299 Q89.9917 479.433 92.2139 479.988 Q94.4361 480.544 96.913 480.544 Q100.918 480.544 103.256 478.438 Q105.593 476.331 105.593 472.72 Q105.593 469.109 103.256 467.002 Q100.918 464.896 96.913 464.896 Q95.038 464.896 93.163 465.313 Q91.3112 465.729 89.3667 466.609 L89.3667 449.248 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M119.482 477.928 L124.367 477.928 L124.367 483.808 L119.482 483.808 L119.482 477.928 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M144.552 452.327 Q140.941 452.327 139.112 455.891 Q137.306 459.433 137.306 466.563 Q137.306 473.669 139.112 477.234 Q140.941 480.776 144.552 480.776 Q148.186 480.776 149.991 477.234 Q151.82 473.669 151.82 466.563 Q151.82 459.433 149.991 455.891 Q148.186 452.327 144.552 452.327 M144.552 448.623 Q150.362 448.623 153.417 453.229 Q156.496 457.813 156.496 466.563 Q156.496 475.289 153.417 479.896 Q150.362 484.479 144.552 484.479 Q138.741 484.479 135.663 479.896 Q132.607 475.289 132.607 466.563 Q132.607 457.813 135.663 453.229 Q138.741 448.623 144.552 448.623 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M89.1352 206.836 L111.357 206.836 L111.357 208.827 L98.8111 241.396 L93.9269 241.396 L105.732 210.771 L89.1352 210.771 L89.1352 206.836 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M120.478 235.517 L125.362 235.517 L125.362 241.396 L120.478 241.396 L120.478 235.517 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip190)" d="M135.593 206.836 L153.95 206.836 L153.95 210.771 L139.876 210.771 L139.876 219.244 Q140.894 218.896 141.913 218.734 Q142.931 218.549 143.95 218.549 Q149.737 218.549 153.116 221.72 Q156.496 224.892 156.496 230.308 Q156.496 235.887 153.024 238.989 Q149.552 242.068 143.232 242.068 Q141.056 242.068 138.788 241.697 Q136.542 241.327 134.135 240.586 L134.135 235.887 Q136.218 237.021 138.441 237.577 Q140.663 238.132 143.14 238.132 Q147.144 238.132 149.482 236.026 Q151.82 233.919 151.82 230.308 Q151.82 226.697 149.482 224.591 Q147.144 222.484 143.14 222.484 Q141.265 222.484 139.39 222.901 Q137.538 223.318 135.593 224.197 L135.593 206.836 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip192)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1034.56 268.292,1448.56 270.6,1463.84 272.908,1334.05 275.216,1328.51 277.524,1434.3 279.832,1368.94 282.139,1328.04 284.447,1234.39 286.755,1502.07 289.063,1377.39 291.371,1441.05 293.679,1577.84 295.987,1454.44 298.295,1633.28 300.603,1410.26 302.911,1522.2 305.219,1324.1 307.527,1485.78 309.834,1443.31 312.142,1553.39 314.45,1428.65 316.758,1582.86 319.066,1392.09 321.374,1434.57 323.682,1585.94 325.99,1243.08 328.298,1442.58 330.606,1479.92 332.914,1483.68 335.221,1335.53 337.529,1315.05 339.837,1474.73 342.145,1442.27 344.453,1445.86 346.761,1599.01 349.069,1510.87 351.377,1672.42 353.685,1485.33 355.993,1184.11 358.301,1507.15 360.608,1419.34 362.916,1428.81 365.224,1406.02 367.532,1319.14 369.84,1498.53 372.148,1312.94 374.456,1290.69 376.764,1604.74 379.072,1435.37 381.38,1377.26 383.688,1533.5 385.996,1382.82 388.303,1395 390.611,1510.88 392.919,1751.15 395.227,1426.81 397.535,1485.78 399.843,1609.59 402.151,1566.59 404.459,1559.68 406.767,1512.43 409.075,1294.13 411.383,1267.53 413.69,1365.54 415.998,1373.7 418.306,1333.31 420.614,1474.42 422.922,1468.38 425.23,1471.42 427.538,1386.61 429.846,1466.9 432.154,1278.63 434.462,1332.55 436.77,1432.42 439.077,1432.29 441.385,1549.35 443.693,1475.6 446.001,1548.12 448.309,1442.4 450.617,1289.05 452.925,1402.22 455.233,1297.35 457.541,1410.66 459.849,1509.71 462.157,1562.41 464.465,1535.66 466.772,1481.71 469.08,1476.8 471.388,1348.11 473.696,1471.73 476.004,1424.64 478.312,1457.74 480.62,1269.64 482.928,1547.39 485.236,1359.71 487.544,1361.92 489.852,1422.84 492.159,1450.88 494.467,1379.25 496.775,1417.92 499.083,1461.76 501.391,1473.8 503.699,1473.49 506.007,1328.52 508.315,1411.52 510.623,1428.37 512.931,1317 515.239,1365.15 517.546,1479.96 519.854,1484.09 522.162,1369.86 524.47,1414.33 526.778,1427.42 529.086,1431.67 531.394,1426.42 533.702,1371.52 536.01,1217.28 538.318,1421.06 540.626,1368.61 542.933,1532.68 545.241,1409.27 547.549,1360.65 549.857,1390.83 552.165,1469.04 554.473,1545.71 556.781,1531.7 559.089,1451.81 561.397,1348.95 563.705,1510.31 566.013,1550.42 568.321,1529.43 570.628,1425.07 572.936,1296.43 575.244,1300.28 577.552,1424.25 579.86,1225.14 582.168,1389.11 584.476,1490.31 586.784,1458.62 589.092,1595.77 591.4,1422.45 593.708,1393.61 596.015,1408.77 598.323,1413.11 600.631,1357.14 602.939,1290.64 605.247,1342.69 607.555,1350.72 609.863,1390.21 612.171,1386.77 614.479,1355.19 616.787,1515.61 619.095,1485.26 621.402,1628.79 623.71,1289.93 626.018,1332.73 628.326,1414.48 630.634,1318.03 632.942,1728.71 635.25,1485.51 637.558,1481.46 639.866,1494.74 642.174,1266.33 644.482,1393.95 646.79,1339.68 649.097,1395.32 651.405,1397.05 653.713,1460 656.021,1480.02 658.329,1151.77 660.637,1537.39 662.945,1405.29 665.253,1172.59 667.561,1345.97 669.869,1132.86 672.177,1412.44 674.484,1461.82 676.792,1354.34 679.1,1350.44 681.408,1341.54 683.716,1396.5 686.024,1496.1 688.332,1361.17 690.64,1272.79 692.948,1282.57 695.256,1391.5 697.564,1445.42 699.871,1602.55 702.179,1439.97 704.487,1262.7 706.795,1540.6 709.103,1302.47 711.411,1354.92 713.719,1630.85 716.027,1315.51 718.335,1422.44 720.643,1459.02 722.951,1531.27 725.259,1558.62 727.566,1526.23 729.874,1319.15 732.182,1380.66 734.49,1515.07 736.798,1250.55 739.106,1496.88 741.414,1303.25 743.722,1500.54 746.03,1398.77 748.338,1386.68 750.646,1302.13 752.953,1418.95 755.261,1369.94 757.569,1412.96 759.877,1682.13 762.185,1493.32 764.493,1406.16 766.801,1462.76 769.109,1196.76 771.417,1557.48 773.725,1616.55 776.033,1396.49 778.34,1477.84 780.648,1575.24 782.956,1470.21 785.264,1464.49 787.572,1235.31 789.88,1520.42 792.188,1488.36 794.496,1269.2 796.804,1372.38 799.112,1430.72 801.42,1593.07 803.728,1465.53 806.035,1615.8 808.343,1433.07 810.651,1413.67 812.959,1383.53 815.267,1518.78 817.575,1289.72 819.883,1512.24 822.191,1415.17 824.499,1473.15 826.807,1377.18 829.115,1423.46 831.422,1575.56 833.73,1528.33 836.038,1415.1 838.346,1564.88 840.654,1430.61 842.962,1389.93 845.27,1636.33 847.578,1324.07 849.886,1421.62 852.194,1300.66 854.502,1181.83 856.809,1352.02 859.117,1258.83 861.425,1517.33 863.733,1550.05 866.041,1615.91 868.349,1386.46 870.657,1361.04 872.965,1347.95 875.273,1280.78 877.581,1423.24 879.889,1352.21 882.197,1475.88 884.504,1459.56 886.812,1428.93 889.12,1586.35 891.428,1640.49 893.736,1398.87 896.044,1682.54 898.352,1294.73 900.66,1423.52 902.968,1459.39 905.276,1557.13 907.584,1486.41 909.891,1348.21 912.199,1468.89 914.507,1292.12 916.815,1548.39 919.123,1372.35 921.431,1556.92 923.739,1242.94 926.047,1422 928.355,1371.86 930.663,1666.63 932.971,1271.56 935.278,1391.93 937.586,1277.84 939.894,1506.22 942.202,1343.42 944.51,1268.88 946.818,1518.31 949.126,1694.88 951.434,1514.32 953.742,1413.25 956.05,1409.75 958.358,1432.48 960.665,1466.18 962.973,1445.14 965.281,1301.11 967.589,1444.87 969.897,1514.18 972.205,1417.17 974.513,1369.62 976.821,1612.29 979.129,1634.32 981.437,1394.97 983.745,1345.99 986.053,1728.68 988.36,1534.58 990.668,1348.02 992.976,1368.11 995.284,1208.72 997.592,1608.37 999.9,1619.17 1002.21,1512.83 1004.52,1381.8 1006.82,1520.37 1009.13,1250.44 1011.44,1467.59 1013.75,1407.02 1016.06,1512.73 1018.36,1331.37 1020.67,1406.03 1022.98,1531.47 1025.29,1292.78 1027.59,1319.3 1029.9,1300.63 1032.21,1464.95 1034.52,1543.17 1036.83,1336.58 1039.13,1556.35 1041.44,1494.9 1043.75,1630.29 1046.06,1529.37 1048.37,1327.67 1050.67,1384.38 1052.98,1503.92 1055.29,1396.13 1057.6,1560.39 1059.91,1506.89 1062.21,1554.7 1064.52,1557.1 1066.83,1492.77 1069.14,1323.42 1071.45,1327.92 1073.75,1505 1076.06,1303 1078.37,1329.7 1080.68,1556.49 1082.98,1562.23 1085.29,1392.55 1087.6,1374.28 1089.91,1453.17 1092.22,1496.26 1094.52,1490.74 1096.83,1267.45 1099.14,1459.03 1101.45,1338.73 1103.76,1410.85 1106.06,1431.97 1108.37,1349.54 1110.68,1383.25 1112.99,1356.75 1115.3,1430.28 1117.6,1613.38 1119.91,1390.99 1122.22,1407.62 1124.53,1499.58 1126.84,1369.75 1129.14,1352.13 1131.45,1371.94 1133.76,1309.46 1136.07,1427.21 1138.37,1393.88 1140.68,1495.21 1142.99,1320.58 1145.3,1476 1147.61,1468.37 1149.91,1445.23 1152.22,1207.35 1154.53,1334.44 1156.84,1473.23 1159.15,1382.64 1161.45,1354.56 1163.76,1482.48 1166.07,1601.52 1168.38,1501.39 1170.69,1398.9 1172.99,1296.6 1175.3,1415.91 1177.61,1510.36 1179.92,1254.88 1182.23,1512.34 1184.53,1374.75 1186.84,1489.8 1189.15,1542.96 1191.46,1575.39 1193.76,1545.29 1196.07,1362.25 1198.38,1344.48 1200.69,1473.97 1203,1579.02 1205.3,1349.03 1207.61,1341.68 1209.92,1503.12 1212.23,1381.68 1214.54,1487.09 1216.84,1310.56 1219.15,1489.78 1221.46,1470.21 1223.77,1340.32 1226.08,1526.06 1228.38,1438.46 1230.69,1350.22 1233,1721.72 1235.31,1524.34 1237.61,1377.57 1239.92,1467.29 1242.23,1328.33 1244.54,1466.96 1246.85,1354.75 1249.15,1350.48 1251.46,1424.07 1253.77,1364.86 1256.08,1459.89 1258.39,1371.89 1260.69,1443.39 1263,1520.62 1265.31,1497.22 1267.62,1589.89 1269.93,1418.67 1272.23,1512.21 1274.54,1554.89 1276.85,1386.1 1279.16,1369.64 1281.47,1370.72 1283.77,1488.74 1286.08,1443.37 1288.39,1386.26 1290.7,1457.13 1293,1503.79 1295.31,1329.64 1297.62,1452.5 1299.93,1519.98 1302.24,1064.64 1304.54,1511.16 1306.85,1378.55 1309.16,1408.52 1311.47,1382.49 1313.78,1309.26 1316.08,1448.29 1318.39,1417.99 1320.7,1457.3 1323.01,1431.44 1325.32,1342.19 1327.62,1448.76 1329.93,1482.59 1332.24,1430.42 1334.55,1457.12 1336.86,1608.51 1339.16,1395.08 1341.47,1389.45 1343.78,1286.2 1346.09,1501.49 1348.39,1485.51 1350.7,1441.26 1353.01,1318.21 1355.32,1282.34 1357.63,1225.29 1359.93,1390.12 1362.24,1520.39 1364.55,1559.51 1366.86,1380.26 1369.17,1374.35 1371.47,1475.78 1373.78,1412.69 1376.09,1451.15 1378.4,1369.84 1380.71,1494.54 1383.01,1489.29 1385.32,1550.55 1387.63,1407.31 1389.94,1441.62 1392.24,1574.69 1394.55,1330.79 1396.86,1299.8 1399.17,1288.6 1401.48,1374.24 1403.78,1294.07 1406.09,1443.45 1408.4,1439.15 1410.71,1335.19 1413.02,1447.41 1415.32,1299.14 1417.63,1498.4 1419.94,1517.59 1422.25,1643.05 1424.56,1661.33 1426.86,1356.55 1429.17,1557.01 1431.48,1454.14 1433.79,1566.14 1436.1,1583.28 1438.4,1593.97 1440.71,1514.19 1443.02,1441.19 1445.33,1418.18 1447.63,1313.59 1449.94,1271.65 1452.25,1261.64 1454.56,1465.73 1456.87,1573.74 1459.17,1358.79 1461.48,1502.04 1463.79,1430.47 1466.1,1476.21 1468.41,1295.73 1470.71,1498.98 1473.02,1410.79 1475.33,1559.57 1477.64,1341.25 1479.95,1711.06 1482.25,1561.77 1484.56,1341.74 1486.87,1360.17 1489.18,1406.78 1491.49,1511.24 1493.79,1478.43 1496.1,1148.54 1498.41,1482.47 1500.72,1504.82 1503.02,1314.16 1505.33,1452.05 1507.64,1566.43 1509.95,1448.51 1512.26,1406.91 1514.56,1434.25 1516.87,1486.67 1519.18,1458.68 1521.49,1445.33 1523.8,1440.5 1526.1,1355.78 1528.41,1297.99 1530.72,1354.78 1533.03,1457.27 1535.34,1498.62 1537.64,1316.92 1539.95,1287.45 1542.26,1406.02 1544.57,1601.11 1546.88,1542.71 1549.18,1320.34 1551.49,1516.45 1553.8,1385.56 1556.11,1468.89 1558.41,1429.59 1560.72,1384.97 1563.03,1395.8 1565.34,1632.41 1567.65,1294.92 1569.95,1466.88 1572.26,1448.08 1574.57,1466.62 1576.88,1395.65 1579.19,1567.32 1581.49,1303.19 1583.8,1378.66 1586.11,1491.84 1588.42,1415.05 1590.73,1358.84 1593.03,1444.94 1595.34,1586.42 1597.65,1178.28 1599.96,1363.47 1602.26,1541.81 1604.57,1606.47 1606.88,1315.51 1609.19,1537.22 1611.5,1449.86 1613.8,1479.2 1616.11,1651.88 1618.42,1218.42 1620.73,1333 1623.04,1375.89 1625.34,1361.78 1627.65,1444.48 1629.96,1511.41 1632.27,1175 1634.58,1492.09 1636.88,1459.14 1639.19,1448 1641.5,1393.72 1643.81,1311.71 1646.12,1361.56 1648.42,1359.93 1650.73,1565.81 1653.04,1495.51 1655.35,1497.15 1657.65,1445.71 1659.96,1501.87 1662.27,1439.67 1664.58,1401.44 1666.89,1285.7 1669.19,1415.8 1671.5,1733.56 1673.81,1532.69 1676.12,1439.67 1678.43,1422.25 1680.73,1201.3 1683.04,1373.68 1685.35,1405.24 1687.66,1324.48 1689.97,1316.46 1692.27,1336.27 1694.58,1441.61 1696.89,1578.71 1699.2,1404.52 1701.51,1427.44 1703.81,1416.71 1706.12,1216.73 1708.43,1383.26 1710.74,1271.21 1713.04,1481.96 1715.35,1513.12 1717.66,1500.64 1719.97,1557.77 1722.28,1473.75 1724.58,1467.9 1726.89,1285.88 1729.2,1445.68 1731.51,1418.92 1733.82,1384.98 1736.12,1506.32 1738.43,1648.97 1740.74,1245.92 1743.05,1443.89 1745.36,1632.49 1747.66,1319.91 1749.97,1307.28 1752.28,1461.93 1754.59,1471.47 1756.9,1442.81 1759.2,1284.52 1761.51,1230 1763.82,1500.69 1766.13,1468.48 1768.43,1318.75 1770.74,1493.49 1773.05,1441.75 1775.36,1250.89 1777.67,1446.46 1779.97,1229.29 1782.28,1361.36 1784.59,1501.5 1786.9,1316.1 1789.21,1266.58 1791.51,1592.32 1793.82,1257.64 1796.13,1512.62 1798.44,1479.78 1800.75,1402.11 1803.05,1328.7 1805.36,1483.9 1807.67,1318 1809.98,1558.84 1812.28,1438.74 1814.59,1567.83 1816.9,1603.09 1819.21,1377.96 1821.52,1341.76 1823.82,1480.05 1826.13,1398.65 1828.44,1310.62 1830.75,1426.84 1833.06,1354.93 1835.36,1553.82 1837.67,1605.04 1839.98,1427.1 1842.29,1387.07 1844.6,1349.12 1846.9,1554.73 1849.21,1486.14 1851.52,1353.41 1853.83,1447.63 1856.14,1589.75 1858.44,1642.02 1860.75,1321.45 1863.06,1364.66 1865.37,1487.43 1867.67,1343.05 1869.98,1205.36 1872.29,1521.2 1874.6,1540.05 1876.91,1474.81 1879.21,1395.28 1881.52,1419.05 1883.83,1482.25 1886.14,1450.62 1888.45,1527.37 1890.75,1472.68 1893.06,1489.58 1895.37,1383.39 1897.68,1614.89 1899.99,1417.13 1902.29,1488.96 1904.6,1438.22 1906.91,1388.56 1909.22,1364.92 1911.53,1342.6 1913.83,1373.74 1916.14,1593.6 1918.45,1420.42 1920.76,1398.11 1923.06,1528.97 1925.37,1535.01 1927.68,1481.22 1929.99,1418.59 1932.3,1347.04 1934.6,1471.86 1936.91,1615.26 1939.22,1465.42 1941.53,1435.27 1943.84,1451.85 1946.14,1204.62 1948.45,1487.59 1950.76,1477.27 1953.07,1562.7 1955.38,1517.11 1957.68,1428.42 1959.99,1479.98 1962.3,1516.58 1964.61,1475.95 1966.91,1434.12 1969.22,1239.66 1971.53,1372.3 1973.84,1379.83 1976.15,1335.91 1978.45,1493.18 1980.76,1510.2 1983.07,1487.71 1985.38,1257.65 1987.69,1296.71 1989.99,1543.28 1992.3,1530.07 1994.61,1469.37 1996.92,1466.44 1999.23,1609.13 2001.53,1590.23 2003.84,1416.86 2006.15,1315.56 2008.46,1396.15 2010.77,1435.81 2013.07,1555.35 2015.38,1460.45 2017.69,1439.99 2020,1527.33 2022.3,1524.65 2024.61,1491.57 2026.92,1490.78 2029.23,1615.71 2031.54,1358.37 2033.84,1430.16 2036.15,1553.34 2038.46,1452.72 2040.77,1339.18 2043.08,1336.12 2045.38,1460.62 2047.69,1197.93 2050,1501.41 2052.31,1411.18 2054.62,1452.83 2056.92,1380.05 2059.23,1449.48 2061.54,1547.79 2063.85,1442.16 2066.16,1370.7 2068.46,1521.75 2070.77,1405.22 2073.08,1502.64 2075.39,1415.72 2077.69,1363.52 2080,1405.88 2082.31,1436.37 2084.62,1493.96 2086.93,1341.1 2089.23,1357.96 2091.54,1249.72 2093.85,1374.42 2096.16,1656.52 2098.47,1285.46 2100.77,1502.99 2103.08,1464.34 2105.39,1354.13 2107.7,1283.98 2110.01,1459.54 2112.31,1425.1 2114.62,1387.16 2116.93,1423.39 2119.24,1488.02 2121.55,1447.44 2123.85,1564.33 2126.16,1296.86 2128.47,1630.85 2130.78,1409.46 2133.08,1430.08 2135.39,1472.35 2137.7,1380.4 2140.01,1427.37 2142.32,1433.8 2144.62,1498.55 2146.93,1537.68 2149.24,1512.97 2151.55,1457.05 2153.86,1496.95 2156.16,1600.69 2158.47,1540.41 2160.78,1632.25 2163.09,1531.4 2165.4,1304.02 2167.7,1416.3 2170.01,1503.97 2172.32,1519.64 2174.63,1397.79 2176.93,1434.93 2179.24,1488.44 2181.55,1558.68 2183.86,1453.83 2186.17,1316.55 2188.47,1417.21 2190.78,1279.22 2193.09,1443.19 2195.4,1446.56 2197.71,1637.34 2200.01,1506.69 2202.32,1414.76 2204.63,1449.99 2206.94,1483.9 2209.25,1498 2211.55,1541.18 2213.86,1202.51 2216.17,1317.35 2218.48,1593.22 2220.79,1378.13 2223.09,1584.18 2225.4,1507.26 2227.71,1439.18 2230.02,1622.51 2232.32,1541.4 2234.63,1389.87 2236.94,1355.54 2239.25,1346.9 2241.56,1362.45 2243.86,1541.39 2246.17,1512.86 2248.48,1429.02 2250.79,1384.55 2253.1,1468.72 2255.4,1455.62 2257.71,1540.43 2260.02,1434.4 2262.33,1407.55 2264.64,1483.3 2266.94,1555.65 2269.25,1477.79 2271.56,1452.2 2273.87,1408.5 2276.18,1494.53 2278.48,1372.66 2280.79,1483.01 2283.1,1312.74 2285.41,1444.73 2287.71,1504.89 2290.02,1329.32 2292.33,1557.57 2294.64,1371.76 2296.95,1322.56 2299.25,1399.09 2301.56,1186.46 2303.87,1580.36 2306.18,1233.58 2308.49,1365.24 2310.79,1346.74 2313.1,1405.72 2315.41,1691.47 2317.72,1455.28 2320.03,1300.27 2322.33,1364.92 2324.64,1408.08 2326.95,1281.37 2329.26,1470.29 2331.56,1541.84 2333.87,1479.21 2336.18,1447.08 2338.49,1501.22 2340.8,1376.08 2343.1,1394.08 2345.41,1646.74 2347.72,1484.86 2350.03,1674.61 2352.34,1404.67 2354.64,1474.73 2356.95,1402.4 2359.26,1495.11 2361.57,1344.96 2363.88,1460.19 2366.18,1257.24 2368.49,1446 2370.8,1544.81 2373.11,1427.35 2375.42,1399.51 2377.72,1377.45 2380.03,1330.17 2382.34,1482.3 2384.65,1437.66 2386.95,1226.74 2389.26,1414.45 2391.57,1311.57 2393.88,1379.43 2396.19,1505 2398.49,1387.53 2400.8,1432.78 2403.11,1495.47 2405.42,1460.22 2407.73,1449.68 2410.03,1457.91 2412.34,1616.54 2414.65,1365.76 2416.96,1273.16 2419.27,1429.44 2421.57,1374.98 2423.88,1359.34 2426.19,1331.19 2428.5,1513.88 2430.81,1408.16 2433.11,1580.59 2435.42,1335.99 2437.73,1426.04 2440.04,1482.34 2442.34,1258.75 2444.65,1477.4 2446.96,1650.81 2449.27,1600.15 2451.58,1555.24 2453.88,1328.93 2456.19,1322.84 2458.5,1502.22 2460.81,1376.76 2463.12,1452.03 2465.42,1391.99 2467.73,1412.21 2470.04,1451.34 2472.35,1332.49 2474.66,1610.8 2476.96,1556.69 2479.27,1460.67 2481.58,1573.93 2483.89,1606.35 2486.2,1369.99 2488.5,1344.01 2490.81,1411.07 2493.12,1297.27 2495.43,1424.71 2497.73,1435.84 2500.04,1203.65 2502.35,1298.33 2504.66,1533.45 2506.97,1293.79 2509.27,1497.38 2511.58,1313.99 2513.89,1269.1 2516.2,1273.44 2518.51,1426.4 2520.81,1484.71 2523.12,1476.46 2525.43,1402.31 2527.74,1343.47 2530.05,1580.83 2532.35,1372.31 2534.66,1601.11 2536.97,1333.98 2539.28,1650.96 2541.58,1280.68 2543.89,1372.96 2546.2,1387.76 2548.51,1400.96 2550.82,1419.09 2553.12,1322.79 2555.43,1440.96 2557.74,1390.82 2560.05,1335.66 2562.36,1495.82 2564.66,1560.56 2566.97,1523.76 2569.28,1394.09 2571.59,1430.94 "></polyline>
<polyline clip-path="url(#clip192)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1065.73 268.292,919.604 270.6,946.195 272.908,930.034 275.216,1070.57 277.524,1009.19 279.832,837.383 282.139,998.503 284.447,986.683 286.755,1035.96 289.063,904.664 291.371,1018.06 293.679,853.287 295.987,980.164 298.295,863.004 300.603,725.975 302.911,821.675 305.219,984.789 307.527,1025.91 309.834,1099.82 312.142,974.256 314.45,798.646 316.758,972.174 319.066,1076.39 321.374,1074.35 323.682,862.301 325.99,972.603 328.298,969.343 330.606,862.792 332.914,880.285 335.221,961.287 337.529,947.758 339.837,900.761 342.145,938.91 344.453,859.872 346.761,1000.42 349.069,812.543 351.377,963.024 353.685,718.383 355.993,969.876 358.301,921.543 360.608,1023.44 362.916,890.973 365.224,810.575 367.532,1174.72 369.84,900.517 372.148,1064.15 374.456,835.624 376.764,958.958 379.072,1003.42 381.38,817.243 383.688,1187.89 385.996,924.341 388.303,1095.29 390.611,1028.44 392.919,1055.96 395.227,1020.25 397.535,1091.76 399.843,1126.16 402.151,1060.44 404.459,1012.6 406.767,920.525 409.075,839.931 411.383,804.541 413.69,1058.99 415.998,990.739 418.306,1074.38 420.614,901.748 422.922,980.054 425.23,1090.9 427.538,1031.24 429.846,1093.2 432.154,763.826 434.462,962.909 436.77,1022.22 439.077,1073.72 441.385,921.492 443.693,1084.1 446.001,986.632 448.309,688.732 450.617,952.585 452.925,872.855 455.233,1027.86 457.541,1059.37 459.849,913.157 462.157,939.215 464.465,811.535 466.772,872.728 469.08,807.812 471.388,905.757 473.696,975.643 476.004,741.222 478.312,771.301 480.62,971.172 482.928,1038.22 485.236,1050.26 487.544,897.891 489.852,990.385 492.159,798.088 494.467,911.986 496.775,853.203 499.083,985.952 501.391,1186.78 503.699,903.479 506.007,939.091 508.315,998.572 510.623,913.293 512.931,968.689 515.239,1041.07 517.546,1042.72 519.854,1038.53 522.162,1052.23 524.47,969.262 526.778,1100.04 529.086,1131.28 531.394,1070.9 533.702,939.374 536.01,1060.32 538.318,1149.19 540.626,918.735 542.933,1053.83 545.241,1090 547.549,1033.07 549.857,1073.13 552.165,996.573 554.473,739.396 556.781,851.487 559.089,921.348 561.397,1055.77 563.705,1118.49 566.013,991.919 568.321,852.131 570.628,977.095 572.936,916.99 575.244,1008.05 577.552,981.483 579.86,1044.58 582.168,855.129 584.476,770.87 586.784,961.692 589.092,1026.29 591.4,953.67 593.708,1010.48 596.015,1013.94 598.323,927.28 600.631,969.46 602.939,1159.84 605.247,950.249 607.555,1003.62 609.863,1028.65 612.171,1044.92 614.479,834.814 616.787,811.592 619.095,1051.39 621.402,1094.6 623.71,1111.11 626.018,876.922 628.326,941.369 630.634,970.117 632.942,837.586 635.25,1080.3 637.558,1043.33 639.866,885.218 642.174,929.367 644.482,945.359 646.79,849.695 649.097,845.747 651.405,774.328 653.713,898.772 656.021,842.891 658.329,1064.69 660.637,958.267 662.945,932.477 665.253,1130.43 667.561,1123.09 669.869,1028.34 672.177,750.319 674.484,993.415 676.792,1014.14 679.1,711.11 681.408,1059.83 683.716,938.751 686.024,1028.1 688.332,1170.67 690.64,1157.67 692.948,954.893 695.256,826.245 697.564,908.833 699.871,900.113 702.179,919.671 704.487,1070.15 706.795,934.215 709.103,1094.98 711.411,784.551 713.719,776.283 716.027,1027.72 718.335,915.565 720.643,944.518 722.951,885.65 725.259,960.316 727.566,980.916 729.874,823.006 732.182,975.901 734.49,916.135 736.798,1062.24 739.106,998.395 741.414,786.317 743.722,784.854 746.03,887.026 748.338,974.36 750.646,894.755 752.953,699.144 755.261,1107.27 757.569,867.482 759.877,829.437 762.185,1012.21 764.493,1044.39 766.801,831.875 769.109,946.895 771.417,1082.75 773.725,827.024 776.033,1053.42 778.34,877.036 780.648,1122.39 782.956,1061.09 785.264,930.107 787.572,1018.5 789.88,791.768 792.188,969.826 794.496,1117.04 796.804,999.352 799.112,1064.97 801.42,932.072 803.728,889.969 806.035,942.119 808.343,738.319 810.651,998.556 812.959,1098.62 815.267,991.008 817.575,1000.67 819.883,837.964 822.191,852.703 824.499,922.029 826.807,896.784 829.115,1045.89 831.422,1073.93 833.73,857.054 836.038,953.855 838.346,951.747 840.654,790.765 842.962,979.62 845.27,966.189 847.578,982.751 849.886,998.31 852.194,1198.27 854.502,866.988 856.809,900.787 859.117,856.081 861.425,857.17 863.733,973.855 866.041,927.656 868.349,788.315 870.657,933.575 872.965,981.673 875.273,947.893 877.581,990.879 879.889,1066.47 882.197,940.961 884.504,829.894 886.812,1031.71 889.12,909.591 891.428,1102.2 893.736,796.936 896.044,1057.56 898.352,952.652 900.66,1098.45 902.968,723.932 905.276,888.302 907.584,1133.42 909.891,961.361 912.199,974.417 914.507,952.261 916.815,1043.97 919.123,992.583 921.431,1044.75 923.739,989.069 926.047,929.856 928.355,987.195 930.663,1000.77 932.971,901.984 935.278,1185.13 937.586,954.936 939.894,1106.23 942.202,942.604 944.51,968.938 946.818,775.001 949.126,1052.76 951.434,970.26 953.742,881.936 956.05,938.582 958.358,1047.28 960.665,991.705 962.973,860.658 965.281,1221.17 967.589,851.406 969.897,1009.01 972.205,825.425 974.513,911.078 976.821,930.512 979.129,948.394 981.437,1069.95 983.745,865.364 986.053,1028.05 988.36,970.36 990.668,964.924 992.976,1081.69 995.284,860.695 997.592,814.575 999.9,1113.94 1002.21,1161.67 1004.52,872.843 1006.82,956.777 1009.13,1046.33 1011.44,1077.45 1013.75,1035.87 1016.06,1035.17 1018.36,957.632 1020.67,1126.77 1022.98,1049.71 1025.29,793.26 1027.59,953.747 1029.9,1038.07 1032.21,1037.23 1034.52,852.132 1036.83,986.323 1039.13,967.197 1041.44,909.831 1043.75,1067.67 1046.06,1179.83 1048.37,756.865 1050.67,1043.55 1052.98,923.702 1055.29,1033.71 1057.6,903.094 1059.91,818.933 1062.21,994.717 1064.52,988.562 1066.83,914.365 1069.14,923.102 1071.45,936.604 1073.75,1205.75 1076.06,1045.75 1078.37,910.531 1080.68,1002.96 1082.98,927.673 1085.29,1059.54 1087.6,893.094 1089.91,1001.47 1092.22,1084.86 1094.52,1118.5 1096.83,1095.65 1099.14,809.071 1101.45,907.127 1103.76,1027.85 1106.06,1043.63 1108.37,782.731 1110.68,796.471 1112.99,792.368 1115.3,902.547 1117.6,937.071 1119.91,854.9 1122.22,855.287 1124.53,747.356 1126.84,742.377 1129.14,1031.95 1131.45,1095.15 1133.76,923.748 1136.07,960.179 1138.37,1027.74 1140.68,1006.53 1142.99,835.148 1145.3,1007.81 1147.61,924.607 1149.91,1016.62 1152.22,854.495 1154.53,810.669 1156.84,834.852 1159.15,904.07 1161.45,1049.61 1163.76,1124.17 1166.07,951.965 1168.38,940.679 1170.69,1139.69 1172.99,993.874 1175.3,1099.86 1177.61,785.119 1179.92,1044.82 1182.23,829.605 1184.53,905.885 1186.84,964.192 1189.15,907.808 1191.46,1039.36 1193.76,999.523 1196.07,967.735 1198.38,912.493 1200.69,932.787 1203,891.677 1205.3,858.957 1207.61,945.768 1209.92,1033.8 1212.23,1071.76 1214.54,927.485 1216.84,842.183 1219.15,848.753 1221.46,942.64 1223.77,993.538 1226.08,893.322 1228.38,960.421 1230.69,893.293 1233,876.007 1235.31,817.53 1237.61,917.051 1239.92,919.242 1242.23,832.319 1244.54,1242.98 1246.85,861.599 1249.15,860.172 1251.46,891.085 1253.77,1019.64 1256.08,849.418 1258.39,889.67 1260.69,1043.94 1263,917.494 1265.31,917.927 1267.62,816.826 1269.93,954.017 1272.23,848.25 1274.54,912.52 1276.85,838.442 1279.16,959.959 1281.47,960.842 1283.77,1012.59 1286.08,884.485 1288.39,899.972 1290.7,901.609 1293,945.022 1295.31,1028.01 1297.62,1090.75 1299.93,917.751 1302.24,1089.28 1304.54,876.81 1306.85,774.096 1309.16,961.141 1311.47,861.807 1313.78,984.057 1316.08,827.056 1318.39,977.778 1320.7,1105.16 1323.01,753.107 1325.32,885.663 1327.62,1093.55 1329.93,972.597 1332.24,947.398 1334.55,848.744 1336.86,1120.3 1339.16,849.474 1341.47,918.279 1343.78,849.031 1346.09,1011.43 1348.39,957.83 1350.7,822.088 1353.01,931.233 1355.32,844.359 1357.63,960.047 1359.93,844.374 1362.24,1103.6 1364.55,885.13 1366.86,986.21 1369.17,812.327 1371.47,930.239 1373.78,882.514 1376.09,1046.68 1378.4,959.398 1380.71,1094.42 1383.01,810.512 1385.32,1001.33 1387.63,938.732 1389.94,876.048 1392.24,815.368 1394.55,968.558 1396.86,1074.58 1399.17,948.946 1401.48,1039.51 1403.78,1059.09 1406.09,915.485 1408.4,868.215 1410.71,944.576 1413.02,1157.04 1415.32,848.293 1417.63,945.722 1419.94,927.107 1422.25,1175.41 1424.56,882.188 1426.86,975.866 1429.17,900.601 1431.48,937.369 1433.79,1016.36 1436.1,885.706 1438.4,1021.96 1440.71,958.53 1443.02,1022.51 1445.33,856.919 1447.63,1013.6 1449.94,945.121 1452.25,1017.78 1454.56,1038.51 1456.87,866.171 1459.17,842.941 1461.48,938.289 1463.79,997.976 1466.1,1075.19 1468.41,875.027 1470.71,879.718 1473.02,1033.8 1475.33,1006.51 1477.64,933.957 1479.95,1002.34 1482.25,908.456 1484.56,982.31 1486.87,869.722 1489.18,933.281 1491.49,916.121 1493.79,833.27 1496.1,896.983 1498.41,983.376 1500.72,836.491 1503.02,962.833 1505.33,981.779 1507.64,798.202 1509.95,1011.31 1512.26,794.669 1514.56,1117.98 1516.87,897.49 1519.18,1015.44 1521.49,1080.71 1523.8,1118.87 1526.1,1032.76 1528.41,891.962 1530.72,1045.68 1533.03,915.658 1535.34,1016.52 1537.64,1024.09 1539.95,964.045 1542.26,964.449 1544.57,976.326 1546.88,1018.01 1549.18,961.788 1551.49,1103.74 1553.8,891.882 1556.11,971.111 1558.41,961.447 1560.72,937.289 1563.03,1076.8 1565.34,868.815 1567.65,1009.91 1569.95,1110.54 1572.26,1225.63 1574.57,916.588 1576.88,984.865 1579.19,690.459 1581.49,1105.69 1583.8,1092.48 1586.11,1080.06 1588.42,942.825 1590.73,1072.2 1593.03,841.676 1595.34,840.401 1597.65,1014.37 1599.96,941.102 1602.26,1014.99 1604.57,786.497 1606.88,638.347 1609.19,958.015 1611.5,1062.97 1613.8,1059.2 1616.11,1024.96 1618.42,1037.87 1620.73,1098.6 1623.04,798.904 1625.34,773.25 1627.65,869.746 1629.96,813.77 1632.27,944.257 1634.58,847.237 1636.88,771.666 1639.19,886.365 1641.5,1181.56 1643.81,986.112 1646.12,786.613 1648.42,952.323 1650.73,970.084 1653.04,948.725 1655.35,986.691 1657.65,934.997 1659.96,1053.59 1662.27,914.88 1664.58,971.394 1666.89,911.873 1669.19,926.443 1671.5,1096.33 1673.81,824.631 1676.12,1055.18 1678.43,1042.65 1680.73,996.977 1683.04,1133.67 1685.35,1182.99 1687.66,1047.71 1689.97,914.94 1692.27,891.421 1694.58,919.601 1696.89,771.612 1699.2,972.521 1701.51,891.022 1703.81,866.669 1706.12,951.612 1708.43,796.882 1710.74,1008.99 1713.04,1034.4 1715.35,938.343 1717.66,1074.26 1719.97,923.556 1722.28,1069.89 1724.58,982.833 1726.89,854.838 1729.2,814.901 1731.51,785.253 1733.82,809.374 1736.12,882.086 1738.43,905.383 1740.74,1067.69 1743.05,961.709 1745.36,827.946 1747.66,918.638 1749.97,1020.92 1752.28,957.755 1754.59,872.657 1756.9,995.283 1759.2,706.992 1761.51,767.799 1763.82,931.854 1766.13,996.58 1768.43,880.72 1770.74,1024.3 1773.05,749.558 1775.36,995.45 1777.67,1008.28 1779.97,947.989 1782.28,909.218 1784.59,822.006 1786.9,1054.1 1789.21,1086.75 1791.51,1045.39 1793.82,950.235 1796.13,975.564 1798.44,1005.41 1800.75,844.786 1803.05,974.555 1805.36,972.299 1807.67,946.402 1809.98,917.305 1812.28,971.239 1814.59,895.453 1816.9,843.285 1819.21,1033.25 1821.52,937.934 1823.82,837.188 1826.13,1000.93 1828.44,813.995 1830.75,922.096 1833.06,1006.29 1835.36,801.43 1837.67,955.958 1839.98,969.77 1842.29,938.762 1844.6,818.248 1846.9,841.732 1849.21,1040.94 1851.52,1020.47 1853.83,1054.76 1856.14,916.808 1858.44,902.96 1860.75,938.053 1863.06,971.454 1865.37,901.444 1867.67,1029.67 1869.98,941.831 1872.29,981.749 1874.6,1095.06 1876.91,937.03 1879.21,997.699 1881.52,982.477 1883.83,985.787 1886.14,890.088 1888.45,919.746 1890.75,1170.69 1893.06,850.65 1895.37,986.634 1897.68,886.689 1899.99,918.821 1902.29,938.862 1904.6,1072.73 1906.91,1095.41 1909.22,765.978 1911.53,894.556 1913.83,856.967 1916.14,1033.55 1918.45,933.404 1920.76,931.313 1923.06,983.371 1925.37,1007.86 1927.68,884.27 1929.99,907.025 1932.3,994.969 1934.6,890.537 1936.91,889.381 1939.22,860.213 1941.53,971.137 1943.84,1084.38 1946.14,954.719 1948.45,859.682 1950.76,901.294 1953.07,939.334 1955.38,866.361 1957.68,869.393 1959.99,1118.5 1962.3,845.118 1964.61,861.507 1966.91,839.896 1969.22,781.601 1971.53,736.73 1973.84,942.171 1976.15,929.049 1978.45,912.806 1980.76,1112.02 1983.07,816.36 1985.38,972.588 1987.69,987.175 1989.99,987.598 1992.3,789.385 1994.61,804.909 1996.92,944.705 1999.23,1193.72 2001.53,982.877 2003.84,1036.78 2006.15,921.821 2008.46,920.105 2010.77,876.164 2013.07,715 2015.38,793.977 2017.69,915.593 2020,1111.5 2022.3,886.374 2024.61,906.556 2026.92,867.903 2029.23,1019.13 2031.54,993.117 2033.84,965.79 2036.15,771.093 2038.46,1186.55 2040.77,954.13 2043.08,876.207 2045.38,977.253 2047.69,890.719 2050,1049.53 2052.31,929.037 2054.62,983.37 2056.92,1040.52 2059.23,972.227 2061.54,933.403 2063.85,845.58 2066.16,840.772 2068.46,961.544 2070.77,888.758 2073.08,971.481 2075.39,1027.59 2077.69,1058.8 2080,983.385 2082.31,1129.15 2084.62,814.676 2086.93,873.483 2089.23,1028.7 2091.54,778.05 2093.85,1016.51 2096.16,930.356 2098.47,910.14 2100.77,853.344 2103.08,877.371 2105.39,919.507 2107.7,852.646 2110.01,930.89 2112.31,933.682 2114.62,853.651 2116.93,1070.55 2119.24,734.525 2121.55,971.221 2123.85,891.949 2126.16,1028.58 2128.47,878.237 2130.78,898.14 2133.08,972.509 2135.39,840.763 2137.7,983.59 2140.01,839.431 2142.32,1030.49 2144.62,1060.46 2146.93,1062.24 2149.24,861.121 2151.55,917.116 2153.86,727.964 2156.16,1132.53 2158.47,960.067 2160.78,908.061 2163.09,1020.22 2165.4,1011.08 2167.7,917.163 2170.01,936.337 2172.32,1142.77 2174.63,954.17 2176.93,1111.53 2179.24,1076.19 2181.55,942.854 2183.86,994.617 2186.17,800.019 2188.47,1163.29 2190.78,1012.07 2193.09,939.401 2195.4,962.282 2197.71,929.352 2200.01,973.479 2202.32,858.22 2204.63,1053.98 2206.94,940.666 2209.25,985.407 2211.55,863.7 2213.86,893.861 2216.17,1157.32 2218.48,936.498 2220.79,836.346 2223.09,969.096 2225.4,904.352 2227.71,990.513 2230.02,780.95 2232.32,978.339 2234.63,1097.88 2236.94,766.222 2239.25,957.819 2241.56,844.315 2243.86,989.841 2246.17,1121.57 2248.48,807.175 2250.79,963.201 2253.1,1068.28 2255.4,1080.81 2257.71,1032.66 2260.02,1052.42 2262.33,934.955 2264.64,864.491 2266.94,1017.51 2269.25,964.997 2271.56,812.369 2273.87,823.494 2276.18,975.437 2278.48,894.643 2280.79,848.203 2283.1,976.247 2285.41,1123.03 2287.71,786.21 2290.02,894.786 2292.33,1009.72 2294.64,878.528 2296.95,1016.28 2299.25,926.736 2301.56,1006.66 2303.87,1057.11 2306.18,800.394 2308.49,962.222 2310.79,983.47 2313.1,946.79 2315.41,946.339 2317.72,949.303 2320.03,788.687 2322.33,1007.42 2324.64,884.638 2326.95,1068.2 2329.26,1103.35 2331.56,1018.93 2333.87,893.933 2336.18,776.607 2338.49,975.066 2340.8,992.136 2343.1,935.364 2345.41,986.071 2347.72,887.43 2350.03,1189.09 2352.34,992.361 2354.64,913.871 2356.95,967.7 2359.26,1050.06 2361.57,1015.45 2363.88,1049.51 2366.18,1022.59 2368.49,734.886 2370.8,893.563 2373.11,873.183 2375.42,842.379 2377.72,849.917 2380.03,922.576 2382.34,927.912 2384.65,1059.97 2386.95,818.212 2389.26,1024.97 2391.57,1041.4 2393.88,967.407 2396.19,923.089 2398.49,960.248 2400.8,859.134 2403.11,973.853 2405.42,945.715 2407.73,937.884 2410.03,983.572 2412.34,947.218 2414.65,961.962 2416.96,1145.1 2419.27,922.795 2421.57,911.668 2423.88,880.406 2426.19,908.788 2428.5,956.573 2430.81,899.474 2433.11,851.96 2435.42,899.274 2437.73,989.81 2440.04,991.923 2442.34,1009.52 2444.65,992.896 2446.96,1041.27 2449.27,903.7 2451.58,1181.51 2453.88,1097.37 2456.19,1018.17 2458.5,936.346 2460.81,906.72 2463.12,896.865 2465.42,855.176 2467.73,998.48 2470.04,988.334 2472.35,980.645 2474.66,928.969 2476.96,922.896 2479.27,883.88 2481.58,939.816 2483.89,874.936 2486.2,1008.3 2488.5,963.175 2490.81,994.896 2493.12,859.048 2495.43,943.089 2497.73,857.485 2500.04,995.829 2502.35,983.128 2504.66,843.826 2506.97,1125.63 2509.27,915.549 2511.58,933.246 2513.89,1154.16 2516.2,911.844 2518.51,1145.21 2520.81,1079.94 2523.12,931.492 2525.43,883.675 2527.74,730.059 2530.05,865.873 2532.35,812.064 2534.66,787.152 2536.97,1073.01 2539.28,798.355 2541.58,866.548 2543.89,983.763 2546.2,1052.48 2548.51,1014.86 2550.82,1084.2 2553.12,899.97 2555.43,1009.86 2557.74,897.044 2560.05,947.168 2562.36,788.481 2564.66,920.678 2566.97,902.902 2569.28,1167.94 2571.59,976.656 "></polyline>
<polyline clip-path="url(#clip192)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,652.697 268.292,505.357 270.6,481.263 272.908,404.636 275.216,495.847 277.524,551.608 279.832,353.463 282.139,695.142 284.447,543.178 286.755,310.227 289.063,588.577 291.371,576.557 293.679,467.57 295.987,530.499 298.295,450.29 300.603,495.961 302.911,472.164 305.219,448.972 307.527,424.207 309.834,271.439 312.142,448.712 314.45,528.683 316.758,418.187 319.066,501.423 321.374,473.997 323.682,456.482 325.99,438.309 328.298,508.761 330.606,409.429 332.914,392.63 335.221,482.595 337.529,537.474 339.837,569.332 342.145,472.567 344.453,406.124 346.761,555.557 349.069,581.933 351.377,459.559 353.685,165.553 355.993,524.267 358.301,298.883 360.608,511.649 362.916,434.209 365.224,551.652 367.532,470.939 369.84,532.575 372.148,436.515 374.456,462.962 376.764,482.797 379.072,522.184 381.38,396.486 383.688,596.606 385.996,486.31 388.303,501.238 390.611,544.001 392.919,455.552 395.227,616.417 397.535,488.403 399.843,446.13 402.151,570.986 404.459,323.421 406.767,625.712 409.075,361.791 411.383,658.751 413.69,559.183 415.998,505.545 418.306,602.27 420.614,400.963 422.922,346.592 425.23,215.896 427.538,315.774 429.846,320.185 432.154,593.388 434.462,458.039 436.77,258.107 439.077,268.296 441.385,96.8724 443.693,397.209 446.001,470.895 448.309,480.703 450.617,535.345 452.925,486.227 455.233,679.274 457.541,646.698 459.849,428.603 462.157,340.74 464.465,518.363 466.772,332.283 469.08,420.044 471.388,421.789 473.696,578.16 476.004,370.331 478.312,571.009 480.62,529.173 482.928,448.778 485.236,481.055 487.544,619.739 489.852,572.119 492.159,441.332 494.467,415.451 496.775,529.35 499.083,296.871 501.391,455.11 503.699,455.666 506.007,372.416 508.315,438.138 510.623,436.173 512.931,618.429 515.239,421.265 517.546,493 519.854,351.08 522.162,434.326 524.47,449.241 526.778,526.194 529.086,323.62 531.394,308.933 533.702,443.263 536.01,642.139 538.318,386.461 540.626,359.502 542.933,612.145 545.241,272.634 547.549,619.424 549.857,703.939 552.165,556.991 554.473,376.888 556.781,588.09 559.089,404.653 561.397,474.497 563.705,454.92 566.013,353.438 568.321,393.764 570.628,243.032 572.936,428.32 575.244,527.773 577.552,502.483 579.86,417.062 582.168,402.461 584.476,336.102 586.784,268.409 589.092,379.058 591.4,493.167 593.708,436.008 596.015,515.664 598.323,345.093 600.631,513.814 602.939,436.422 605.247,408.737 607.555,558.819 609.863,286.418 612.171,498.596 614.479,538.808 616.787,422.621 619.095,462.971 621.402,290.355 623.71,612.185 626.018,466.014 628.326,370.497 630.634,371.385 632.942,434.753 635.25,436.8 637.558,388.435 639.866,607.45 642.174,290.661 644.482,559.709 646.79,398.546 649.097,500.716 651.405,518.366 653.713,579.967 656.021,318.891 658.329,472.856 660.637,598.094 662.945,333.211 665.253,416.573 667.561,413.837 669.869,369.737 672.177,479.046 674.484,325.594 676.792,548.879 679.1,293.139 681.408,439.074 683.716,578.163 686.024,426.84 688.332,723.436 690.64,428.211 692.948,445.149 695.256,267.102 697.564,578.441 699.871,451.085 702.179,509.099 704.487,463.443 706.795,442.949 709.103,515.793 711.411,469.505 713.719,557.581 716.027,481.438 718.335,336.729 720.643,499.188 722.951,438.095 725.259,425.213 727.566,573.713 729.874,434.582 732.182,509.006 734.49,563.015 736.798,385.472 739.106,550.838 741.414,419.285 743.722,764.069 746.03,365.486 748.338,572.892 750.646,639.284 752.953,375.661 755.261,545.64 757.569,658.473 759.877,331.81 762.185,420.737 764.493,324.894 766.801,471.051 769.109,650.022 771.417,520.709 773.725,512.424 776.033,594.222 778.34,391.71 780.648,530.433 782.956,416.308 785.264,564.502 787.572,626.918 789.88,421.81 792.188,319.207 794.496,486.101 796.804,498.151 799.112,647.025 801.42,402.262 803.728,446.444 806.035,611.194 808.343,457.032 810.651,610.817 812.959,481.085 815.267,415.065 817.575,426.5 819.883,511.295 822.191,287.089 824.499,499.35 826.807,399.464 829.115,517.658 831.422,503.463 833.73,457.687 836.038,508.164 838.346,392.184 840.654,386.96 842.962,595.909 845.27,495.449 847.578,495.701 849.886,477.804 852.194,424.017 854.502,411.485 856.809,426.593 859.117,365.904 861.425,424.078 863.733,441.22 866.041,520.096 868.349,662.767 870.657,391.688 872.965,521.593 875.273,442.887 877.581,482.886 879.889,335.403 882.197,433.578 884.504,534.904 886.812,563.662 889.12,462.626 891.428,597.932 893.736,551.477 896.044,325.514 898.352,454.492 900.66,502.535 902.968,367.305 905.276,295.228 907.584,470.498 909.891,454.181 912.199,538.214 914.507,539.113 916.815,482.173 919.123,378.798 921.431,428.765 923.739,517.9 926.047,522.251 928.355,556.882 930.663,374.887 932.971,488.324 935.278,472.076 937.586,322.005 939.894,629.681 942.202,427.673 944.51,376.219 946.818,446.095 949.126,686.914 951.434,452.979 953.742,603.382 956.05,419.638 958.358,535.737 960.665,505.715 962.973,656.299 965.281,396.779 967.589,399.216 969.897,339.429 972.205,542.739 974.513,542.175 976.821,547.653 979.129,508.317 981.437,798.293 983.745,252.26 986.053,214.833 988.36,403.647 990.668,342.82 992.976,405.522 995.284,359.541 997.592,508.309 999.9,386.972 1002.21,332.787 1004.52,331.605 1006.82,361.216 1009.13,307.134 1011.44,402.17 1013.75,229.559 1016.06,487.806 1018.36,458.862 1020.67,543.945 1022.98,443.487 1025.29,456.805 1027.59,491.944 1029.9,405.699 1032.21,525.099 1034.52,435.209 1036.83,536.345 1039.13,374.911 1041.44,475.22 1043.75,556.094 1046.06,277.434 1048.37,506.452 1050.67,541.761 1052.98,252.197 1055.29,674.315 1057.6,418.78 1059.91,540.382 1062.21,362.668 1064.52,682.317 1066.83,465.485 1069.14,357.532 1071.45,349.926 1073.75,541.117 1076.06,518.489 1078.37,493.603 1080.68,261.954 1082.98,515.678 1085.29,507.851 1087.6,337.634 1089.91,581.333 1092.22,573.879 1094.52,486.142 1096.83,525.735 1099.14,493.069 1101.45,224.154 1103.76,521.722 1106.06,345.069 1108.37,437.845 1110.68,590.827 1112.99,554.876 1115.3,580.863 1117.6,478.23 1119.91,416.033 1122.22,630.019 1124.53,270.639 1126.84,537.642 1129.14,670.807 1131.45,485.429 1133.76,448.559 1136.07,515.149 1138.37,411.906 1140.68,514.166 1142.99,373.625 1145.3,474.891 1147.61,505.629 1149.91,421.594 1152.22,551.074 1154.53,460.749 1156.84,217.372 1159.15,367.584 1161.45,559.224 1163.76,489.387 1166.07,576.513 1168.38,489.03 1170.69,411.782 1172.99,509.432 1175.3,578.121 1177.61,558.749 1179.92,412.573 1182.23,499.687 1184.53,658.856 1186.84,570.905 1189.15,540.455 1191.46,244.995 1193.76,379.033 1196.07,605.564 1198.38,628.9 1200.69,424.682 1203,526.753 1205.3,476.532 1207.61,406.454 1209.92,539.513 1212.23,393.114 1214.54,577.507 1216.84,283.222 1219.15,321.027 1221.46,639.701 1223.77,508.191 1226.08,440.588 1228.38,424.982 1230.69,480.751 1233,408.599 1235.31,623.683 1237.61,323.408 1239.92,396.933 1242.23,470.127 1244.54,543.335 1246.85,413.685 1249.15,510.173 1251.46,551.475 1253.77,414.759 1256.08,477.554 1258.39,486.256 1260.69,502.207 1263,438.01 1265.31,497.863 1267.62,354.426 1269.93,572.507 1272.23,530.716 1274.54,509.102 1276.85,472.938 1279.16,656.393 1281.47,402.635 1283.77,567.671 1286.08,480.152 1288.39,536.441 1290.7,590.385 1293,433.445 1295.31,490.312 1297.62,430.487 1299.93,492.987 1302.24,417.171 1304.54,462.008 1306.85,549.035 1309.16,471.199 1311.47,477.517 1313.78,492.748 1316.08,486.961 1318.39,546.401 1320.7,565.166 1323.01,578.44 1325.32,492.849 1327.62,423.389 1329.93,571.656 1332.24,517.085 1334.55,444.783 1336.86,389.821 1339.16,468.378 1341.47,369.51 1343.78,542.687 1346.09,530.163 1348.39,489.585 1350.7,613.062 1353.01,534.575 1355.32,344.061 1357.63,267.049 1359.93,602.469 1362.24,379.577 1364.55,459.03 1366.86,530.251 1369.17,489.263 1371.47,456.864 1373.78,522.247 1376.09,336.015 1378.4,372.182 1380.71,329.857 1383.01,167.441 1385.32,559.569 1387.63,404.253 1389.94,506.793 1392.24,379.87 1394.55,320.492 1396.86,474.246 1399.17,413.427 1401.48,420.619 1403.78,573.906 1406.09,452.434 1408.4,475.385 1410.71,489.451 1413.02,433.817 1415.32,459.334 1417.63,444.165 1419.94,334.499 1422.25,521.705 1424.56,534.636 1426.86,473.758 1429.17,563.585 1431.48,519.204 1433.79,652.633 1436.1,293.043 1438.4,538.744 1440.71,457.19 1443.02,614.514 1445.33,435.542 1447.63,311.164 1449.94,454.499 1452.25,505.224 1454.56,567.036 1456.87,438.251 1459.17,482.999 1461.48,464.065 1463.79,468.273 1466.1,457.185 1468.41,550.646 1470.71,428.962 1473.02,459.439 1475.33,503.284 1477.64,584.895 1479.95,537.728 1482.25,621.835 1484.56,158.576 1486.87,366.712 1489.18,562.963 1491.49,521.612 1493.79,373.089 1496.1,515.045 1498.41,567.195 1500.72,538.212 1503.02,413.074 1505.33,441.674 1507.64,329.404 1509.95,599.443 1512.26,466.836 1514.56,492.23 1516.87,510.439 1519.18,372.687 1521.49,480.359 1523.8,263.458 1526.1,531.625 1528.41,523.184 1530.72,431.186 1533.03,539.471 1535.34,488.039 1537.64,592.106 1539.95,390.094 1542.26,352.02 1544.57,487.596 1546.88,509.294 1549.18,514.231 1551.49,360.28 1553.8,675.622 1556.11,246.871 1558.41,471.553 1560.72,520.473 1563.03,454.574 1565.34,429.24 1567.65,424.762 1569.95,382.877 1572.26,464.713 1574.57,528.409 1576.88,391.036 1579.19,467.8 1581.49,362.907 1583.8,606.019 1586.11,482.552 1588.42,546.238 1590.73,463.187 1593.03,496.092 1595.34,429.772 1597.65,370.738 1599.96,433.047 1602.26,531.35 1604.57,405.161 1606.88,378.846 1609.19,357.41 1611.5,342.159 1613.8,432.768 1616.11,412.261 1618.42,550.587 1620.73,516.092 1623.04,586.074 1625.34,625.031 1627.65,599.263 1629.96,602.958 1632.27,482.637 1634.58,340.213 1636.88,499.718 1639.19,540.061 1641.5,357.116 1643.81,441.548 1646.12,329.865 1648.42,612.016 1650.73,480.493 1653.04,501.392 1655.35,457.479 1657.65,620.872 1659.96,547.031 1662.27,529.981 1664.58,587.925 1666.89,590.128 1669.19,468.637 1671.5,550.147 1673.81,482.231 1676.12,556.413 1678.43,507.952 1680.73,363.275 1683.04,456.981 1685.35,488.606 1687.66,579.849 1689.97,412.266 1692.27,460.863 1694.58,492.549 1696.89,466.417 1699.2,225.099 1701.51,502.262 1703.81,585.294 1706.12,361.011 1708.43,393.948 1710.74,301.383 1713.04,485.877 1715.35,493.886 1717.66,456.272 1719.97,393.057 1722.28,481.865 1724.58,516.353 1726.89,453.172 1729.2,359.225 1731.51,271.502 1733.82,516.177 1736.12,399.337 1738.43,504.673 1740.74,361.632 1743.05,432.289 1745.36,580.105 1747.66,531.934 1749.97,352.575 1752.28,565.417 1754.59,551.402 1756.9,361.599 1759.2,388.645 1761.51,525.033 1763.82,383.666 1766.13,481.488 1768.43,459.274 1770.74,556.262 1773.05,333.909 1775.36,459.424 1777.67,531.344 1779.97,406.965 1782.28,410.165 1784.59,433.707 1786.9,520.498 1789.21,494.648 1791.51,495.409 1793.82,672.603 1796.13,536.842 1798.44,636.833 1800.75,297.572 1803.05,239.742 1805.36,450.205 1807.67,602.848 1809.98,396.904 1812.28,464.371 1814.59,383.935 1816.9,453.99 1819.21,516.418 1821.52,370.927 1823.82,536.247 1826.13,476.494 1828.44,463.316 1830.75,221.154 1833.06,530.488 1835.36,498.149 1837.67,780.586 1839.98,336.39 1842.29,528.81 1844.6,442.746 1846.9,396.567 1849.21,420.565 1851.52,534.645 1853.83,480.026 1856.14,445.118 1858.44,425.018 1860.75,574.213 1863.06,528.964 1865.37,702.134 1867.67,475.911 1869.98,449.707 1872.29,483.91 1874.6,471.808 1876.91,357.001 1879.21,622.591 1881.52,458.24 1883.83,411.554 1886.14,327.037 1888.45,649.794 1890.75,607.418 1893.06,332.037 1895.37,417.233 1897.68,464.984 1899.99,644.712 1902.29,438.64 1904.6,590.972 1906.91,302.99 1909.22,508.798 1911.53,459.777 1913.83,346.632 1916.14,585.892 1918.45,431.386 1920.76,530.038 1923.06,476.188 1925.37,454.504 1927.68,498.86 1929.99,550.159 1932.3,395.649 1934.6,336.074 1936.91,582.687 1939.22,679.702 1941.53,241.723 1943.84,356.665 1946.14,655.142 1948.45,564.067 1950.76,331.723 1953.07,477.377 1955.38,337.912 1957.68,426.455 1959.99,460.286 1962.3,499.923 1964.61,284.862 1966.91,548.893 1969.22,427.518 1971.53,393.844 1973.84,301.826 1976.15,376.117 1978.45,336.468 1980.76,492.316 1983.07,502.594 1985.38,608.718 1987.69,624.79 1989.99,492.125 1992.3,375.203 1994.61,524.851 1996.92,447.604 1999.23,392.222 2001.53,508.765 2003.84,544.686 2006.15,251.489 2008.46,292.899 2010.77,376.445 2013.07,266.021 2015.38,369.586 2017.69,450.395 2020,490.611 2022.3,503.798 2024.61,583.637 2026.92,574.248 2029.23,243.86 2031.54,551.874 2033.84,346.145 2036.15,591.639 2038.46,550.098 2040.77,549.888 2043.08,321.888 2045.38,412.692 2047.69,501.169 2050,391.028 2052.31,414.148 2054.62,379.034 2056.92,509.608 2059.23,556.931 2061.54,346.407 2063.85,443.583 2066.16,609.659 2068.46,242.822 2070.77,635.088 2073.08,380.008 2075.39,336.928 2077.69,573.613 2080,328.72 2082.31,425.613 2084.62,493.326 2086.93,601.351 2089.23,525.813 2091.54,428.608 2093.85,369.147 2096.16,498.549 2098.47,388.58 2100.77,566.2 2103.08,500.888 2105.39,521.887 2107.7,388.632 2110.01,520.975 2112.31,540.936 2114.62,515.397 2116.93,672.513 2119.24,417.527 2121.55,484.842 2123.85,445.251 2126.16,500.81 2128.47,321.337 2130.78,439.598 2133.08,503.454 2135.39,518.649 2137.7,547.952 2140.01,287.062 2142.32,476.679 2144.62,603.407 2146.93,261.334 2149.24,605.589 2151.55,441.941 2153.86,619.088 2156.16,566.927 2158.47,546.592 2160.78,434.61 2163.09,416.436 2165.4,557.405 2167.7,622.843 2170.01,360.818 2172.32,561.729 2174.63,289.266 2176.93,387.527 2179.24,562.519 2181.55,475.455 2183.86,399.124 2186.17,274.46 2188.47,437.772 2190.78,485.066 2193.09,502.339 2195.4,439.669 2197.71,374.807 2200.01,429.243 2202.32,456.575 2204.63,373.053 2206.94,496.513 2209.25,478.075 2211.55,432.291 2213.86,487.059 2216.17,533.598 2218.48,358.117 2220.79,406.099 2223.09,485.553 2225.4,560.222 2227.71,596.902 2230.02,446.764 2232.32,408.413 2234.63,528.217 2236.94,373.924 2239.25,600.768 2241.56,552.671 2243.86,322.958 2246.17,425.451 2248.48,566.043 2250.79,386.856 2253.1,352.942 2255.4,476.286 2257.71,511.532 2260.02,617.143 2262.33,387.18 2264.64,436.105 2266.94,370.943 2269.25,584.456 2271.56,382.854 2273.87,425.415 2276.18,553.9 2278.48,397.665 2280.79,468.174 2283.1,418.665 2285.41,477.961 2287.71,353.619 2290.02,326.701 2292.33,601.854 2294.64,486.575 2296.95,515.309 2299.25,514.612 2301.56,303.195 2303.87,403.657 2306.18,387.477 2308.49,396.156 2310.79,403.32 2313.1,475.918 2315.41,561.053 2317.72,580.688 2320.03,425.438 2322.33,266.621 2324.64,432.81 2326.95,719.077 2329.26,383.26 2331.56,561.086 2333.87,596.718 2336.18,397.676 2338.49,385.094 2340.8,542.155 2343.1,526.7 2345.41,562.207 2347.72,466.301 2350.03,419.853 2352.34,791.081 2354.64,586.792 2356.95,505.805 2359.26,593.798 2361.57,423.142 2363.88,590.517 2366.18,525.248 2368.49,585.757 2370.8,599.685 2373.11,510.376 2375.42,499.4 2377.72,543.151 2380.03,324.865 2382.34,538.204 2384.65,465.976 2386.95,602.336 2389.26,360.428 2391.57,484.613 2393.88,400.408 2396.19,673.828 2398.49,500.201 2400.8,532.991 2403.11,378.075 2405.42,525.684 2407.73,413.026 2410.03,404.954 2412.34,273.634 2414.65,555.14 2416.96,522.991 2419.27,536.272 2421.57,435.947 2423.88,454.579 2426.19,618.991 2428.5,565.814 2430.81,488.643 2433.11,456.084 2435.42,495.738 2437.73,442.86 2440.04,372.921 2442.34,421.007 2444.65,403.747 2446.96,495.35 2449.27,386.247 2451.58,503.304 2453.88,399.067 2456.19,656.959 2458.5,432.775 2460.81,531.525 2463.12,540.087 2465.42,313.449 2467.73,353.152 2470.04,269.618 2472.35,456.339 2474.66,292.408 2476.96,526.677 2479.27,260.656 2481.58,353.952 2483.89,511 2486.2,542.329 2488.5,517.839 2490.81,584.708 2493.12,356.699 2495.43,441.265 2497.73,497.851 2500.04,509.236 2502.35,372.064 2504.66,525.992 2506.97,387.772 2509.27,530.998 2511.58,403.242 2513.89,399.595 2516.2,622.266 2518.51,323.179 2520.81,489.328 2523.12,649.97 2525.43,310.485 2527.74,350.05 2530.05,488.649 2532.35,470.769 2534.66,650.349 2536.97,481.319 2539.28,442.602 2541.58,401.661 2543.89,482.274 2546.2,392.214 2548.51,418.122 2550.82,412.249 2553.12,534.886 2555.43,489.663 2557.74,497.404 2560.05,520.718 2562.36,491.062 2564.66,490.817 2566.97,329.052 2569.28,628.542 2571.59,578.224 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -2.09507  -4.13277   -3.72989   -3.5299    …  -4.87684  -5.2806    -3.40926
  0.86625  -0.507056  -0.815599  -0.590141     -1.28019   0.788698  -0.368203
  1.34218   3.35198    3.10469    4.75126       5.5581    6.01348    6.14481

[:, :, 2] =
 -1.4138    -5.31763   -4.88896   -4.88896   …  -5.54415  -5.64828  -5.64828
 -0.472787   0.584845  -0.268322  -0.268322      4.1504    2.28665   2.28665
  2.59184    4.74196    5.4785     5.4785        3.97829   2.80835   2.80835

[:, :, 3] =
 -3.39624   -5.76515   -5.76515   -5.37002  …  -5.30799   -5.23337   -4.54228
 -0.825952   0.981376   0.981376  -0.34207      0.441901  -0.157378  -1.87795
  3.77926    4.28256    4.28256    3.68458      4.43355    4.61693    3.87673

[:, :, 4] =
 -2.07031   -1.29763   -3.75908   …  -6.13753   -6.88126   -7.85216
 -0.256436   0.143821   0.399524      0.988496   0.469718   0.537806
  2.65156    4.14899    4.59401       3.72233    5.81955    5.46266</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.99905    0.99928
 -0.0142007  0.985088
  4.9758     1.00971</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.71 seconds
Compute duration  = 2.71 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -4.9755    1.0204    0.0184   3062.9286   4974.6737    1.0005   ⋯
        x[2]    0.0068    0.9963    0.0166   3580.3546   5560.0055    1.0002   ⋯
        x[3]    5.0156    1.0021    0.0174   3318.3235   5567.3557    1.0006   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -6.9554   -5.6687   -4.9825   -4.2753   -2.9758
        x[2]   -1.9435   -0.6690    0.0007    0.6680    1.9918
        x[3]    3.0696    4.3323    5.0149    5.6871    6.9940</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.86 seconds
Compute duration  = 1.86 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.5017    0.1870    0.0027   4660.9590   5843.2006    1.0000   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1494    0.3659    0.5017    0.6408    0.8568</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.14 seconds
Compute duration  = 0.14 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

           x    0.8247    0.0000    0.0000        NaN        NaN       NaN     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.8247    0.8247    0.8247    0.8247    0.8247</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(-1.075261367924802, "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with -1.075261367924802:
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/gGoCk/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/gGoCk/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/gGoCk/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/gGoCk/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/gGoCk/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/Jf0cM/src/compiler.jl:584 [inlined]
  [7] demo
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:593 [inlined]
  [8] _evaluate!!
    @ ~/.julia/packages/DynamicPPL/Jf0cM/src/model.jl:914 [inlined]
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, context::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/Jf0cM/src/model.jl:903
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/Jf0cM/src/model.jl:833 [inlined]
 [11] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/Jf0cM/src/values_as_in_model.jl:196 [inlined]
 [12] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/Jf0cM/src/values_as_in_model.jl:195 [inlined]
 [13] getparams(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64})
    @ Turing.Inference ~/.julia/packages/Turing/nwmUC/src/mcmc/Inference.jl:383
 [14] Turing.Inference.Transition(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, t::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/nwmUC/src/mcmc/Inference.jl:258
 [15] transition_to_turing
    @ ~/.julia/packages/Turing/nwmUC/src/mcmc/abstractmcmc.jl:12 [inlined]
 [16] transition_to_turing(f::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, transition::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/nwmUC/src/mcmc/abstractmcmc.jl:17
 [17] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}; initial_state::Nothing, initial_params::Nothing, kwargs::@Kwargs{})
    @ Turing.Inference ~/.julia/packages/Turing/nwmUC/src/mcmc/abstractmcmc.jl:147
 [18] macro expansion
    @ ~/.julia/packages/AbstractMCMC/FSyVk/src/sample.jl:0 [inlined]
 [19] macro expansion
    @ ~/.julia/packages/AbstractMCMC/FSyVk/src/logging.jl:16 [inlined]
 [20] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, num_warmup::Int64, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/FSyVk/src/sample.jl:142
 [21] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/Jf0cM/src/sampler.jl:107
 [22] sample
    @ ~/.julia/packages/DynamicPPL/Jf0cM/src/sampler.jl:97 [inlined]
 [23] #sample#4
    @ ~/.julia/packages/Turing/nwmUC/src/mcmc/Inference.jl:305 [inlined]
 [24] sample
    @ ~/.julia/packages/Turing/nwmUC/src/mcmc/Inference.jl:296 [inlined]
 [25] #sample#3
    @ ~/.julia/packages/Turing/nwmUC/src/mcmc/Inference.jl:293 [inlined]
 [26] top-level scope
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:595</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.94 seconds
Compute duration  = 1.94 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.9727    0.8362    0.1354    72.3628        NaN    1.0338     ⋯
           x   -0.0244    0.8656    0.0454   316.7488   437.8598    1.0007     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.0910    0.3916    0.7347    1.2684    3.3091
           x   -1.8883   -0.4979   -0.0202    0.3214    1.9661</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 3.71 seconds
Compute duration  = 3.71 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8733    0.5696    0.0299   317.1202   237.5795    1.0009     ⋯
           x    0.0734    1.1307    0.0673   412.0794   230.1645    0.9999     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1371    0.4090    0.7529    1.2417    2.2221
           x   -2.2554   -0.4021    0.0116    0.4964    3.1690</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>