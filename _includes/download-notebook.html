<script>
document.addEventListener('DOMContentLoaded', function() {
  // Only add button if we're on a tutorial page
  const path = window.location.pathname;
  if (path.includes('/tutorials/') || path.includes('/usage/')) {
    // Extract the notebook name from the URL
    const pathParts = path.split('/');
    const section = pathParts[pathParts.length - 2];

    // Create download button
    const downloadBtn = document.createElement('a');
    downloadBtn.className = 'btn btn-primary download-notebook-btn';
    downloadBtn.innerHTML = '<i class="bi bi-download"></i> Download as Notebook';

    // Generate GitHub raw URL for the notebook
    const baseUrl = 'https://raw.githubusercontent.com/TuringLang/docs/main';
    const notebookPath = path.replace('.html', '.ipynb');
    downloadBtn.href = baseUrl + notebookPath;
    downloadBtn.download = section + '.ipynb';

    // Insert button after title or in TOC area
    const tocTitle = document.querySelector('.toc-title');
    if (tocTitle) {
      tocTitle.parentNode.insertBefore(downloadBtn, tocTitle.nextSibling);
    } else {
      const articleHeader = document.querySelector('header.quarto-title-block');
      if (articleHeader) {
        articleHeader.appendChild(downloadBtn);
      }
    }
  }
});
</script>

<style>
.download-notebook-btn {
  display: inline-block;
  margin: 1rem 0;
  padding: 0.5rem 1rem;
  background-color: var(--bs-primary);
  color: white;
  text-decoration: none;
  border-radius: 0.25rem;
  font-size: 0.9rem;
}

.download-notebook-btn:hover {
  background-color: var(--bs-primary-dark);
  color: white;
  text-decoration: none;
}

.download-notebook-btn i {
  margin-right: 0.5rem;
}
</style>