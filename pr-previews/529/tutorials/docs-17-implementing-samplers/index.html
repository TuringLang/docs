<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../tutorials/docs-07-for-developers-variational-inference/index.html" rel="prev">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/docs-00-getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/00-introduction/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.34" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.34</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.34">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Users</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-00-getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-12-using-turing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Core Functionality</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Usage Tips</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-10-using-turing-autodiff/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-custom-distribution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Custom Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-modifying-logprob/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modifying the Log Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-generated-quantities/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generated Quantities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-13-using-turing-performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-15-using-turing-sampler-viz/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-11-using-turing-dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-16-using-turing-external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/00-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction: Coin Flipping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/01-gaussian-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/02-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/03-bayesian-neural-network/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/04-hidden-markov-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/05-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/06-infinite-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/07-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/08-multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/09-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/10-bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/11-probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/13-seasonal-time-series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/15-gaussian-processes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Gaussian Processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/12-gplvm/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Contributing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-01-contributing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to Contribute</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">DynamicPPL in Depth</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/dev-model-manual/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manually Defining a Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-05-for-developers-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/14-minituring/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/16-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Inference (note: outdated)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-06-for-developers-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-18.223212287809858</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-18.223212287809858</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([-0.26031894521449445, 0.6167290221291514, -0.10948051397204532]), MALAState{Vector{Float64}}([-0.26031894521449445, 0.6167290221291514, -0.10948051397204532]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -3.01605   -4.32656   -6.1215    -6.45639   …  -4.81264   -7.51122  -4.83642
 -0.521259  -0.732068   0.556922  -0.501027     -0.876444  -1.92124  -1.42814
  1.96445    4.13767    6.02566    6.01003       4.00892    4.18947   5.58618</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.99239    0.992116
 -0.0104711  0.995204
  4.99569    1.01017</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip840">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip840)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip841">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip840)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip842">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1666.43 2640.76,1666.43 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1425.47 2640.76,1425.47 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1184.52 2640.76,1184.52 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,943.568 2640.76,943.568 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,702.615 2640.76,702.615 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,461.662 2640.76,461.662 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,220.709 2640.76,220.709 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip840)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1666.43 215.714,1666.43 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1425.47 215.714,1425.47 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1184.52 215.714,1184.52 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,943.568 215.714,943.568 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,702.615 215.714,702.615 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,461.662 215.714,461.662 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,220.709 215.714,220.709 "></polyline>
<path clip-path="url(#clip840)" d="M50.5475 1666.88 L80.2233 1666.88 L80.2233 1670.81 L50.5475 1670.81 L50.5475 1666.88 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M89.1352 1649.15 L111.357 1649.15 L111.357 1651.14 L98.8111 1683.71 L93.9269 1683.71 L105.732 1653.08 L89.1352 1653.08 L89.1352 1649.15 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M120.478 1677.83 L125.362 1677.83 L125.362 1683.71 L120.478 1683.71 L120.478 1677.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M135.593 1649.15 L153.95 1649.15 L153.95 1653.08 L139.876 1653.08 L139.876 1661.55 Q140.894 1661.21 141.913 1661.05 Q142.931 1660.86 143.95 1660.86 Q149.737 1660.86 153.116 1664.03 Q156.496 1667.2 156.496 1672.62 Q156.496 1678.2 153.024 1681.3 Q149.552 1684.38 143.232 1684.38 Q141.056 1684.38 138.788 1684.01 Q136.542 1683.64 134.135 1682.9 L134.135 1678.2 Q136.218 1679.33 138.441 1679.89 Q140.663 1680.44 143.14 1680.44 Q147.144 1680.44 149.482 1678.34 Q151.82 1676.23 151.82 1672.62 Q151.82 1669.01 149.482 1666.9 Q147.144 1664.8 143.14 1664.8 Q141.265 1664.8 139.39 1665.21 Q137.538 1665.63 135.593 1666.51 L135.593 1649.15 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M49.5521 1425.93 L79.2279 1425.93 L79.2279 1429.86 L49.5521 1429.86 L49.5521 1425.93 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M89.3667 1408.19 L107.723 1408.19 L107.723 1412.13 L93.6491 1412.13 L93.6491 1420.6 Q94.6676 1420.25 95.6861 1420.09 Q96.7047 1419.91 97.7232 1419.91 Q103.51 1419.91 106.89 1423.08 Q110.269 1426.25 110.269 1431.67 Q110.269 1437.24 106.797 1440.35 Q103.325 1443.43 97.0056 1443.43 Q94.8297 1443.43 92.5612 1443.06 Q90.3158 1442.68 87.9084 1441.94 L87.9084 1437.24 Q89.9917 1438.38 92.2139 1438.93 Q94.4361 1439.49 96.913 1439.49 Q100.918 1439.49 103.256 1437.38 Q105.593 1435.28 105.593 1431.67 Q105.593 1428.06 103.256 1425.95 Q100.918 1423.84 96.913 1423.84 Q95.038 1423.84 93.163 1424.26 Q91.3112 1424.68 89.3667 1425.56 L89.3667 1408.19 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M119.482 1436.87 L124.367 1436.87 L124.367 1442.75 L119.482 1442.75 L119.482 1436.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M144.552 1411.27 Q140.941 1411.27 139.112 1414.84 Q137.306 1418.38 137.306 1425.51 Q137.306 1432.62 139.112 1436.18 Q140.941 1439.72 144.552 1439.72 Q148.186 1439.72 149.991 1436.18 Q151.82 1432.62 151.82 1425.51 Q151.82 1418.38 149.991 1414.84 Q148.186 1411.27 144.552 1411.27 M144.552 1407.57 Q150.362 1407.57 153.417 1412.18 Q156.496 1416.76 156.496 1425.51 Q156.496 1434.24 153.417 1438.84 Q150.362 1443.43 144.552 1443.43 Q138.741 1443.43 135.663 1438.84 Q132.607 1434.24 132.607 1425.51 Q132.607 1416.76 135.663 1412.18 Q138.741 1407.57 144.552 1407.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M50.5475 1184.97 L80.2233 1184.97 L80.2233 1188.91 L50.5475 1188.91 L50.5475 1184.97 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M94.3436 1197.87 L110.663 1197.87 L110.663 1201.8 L88.7186 1201.8 L88.7186 1197.87 Q91.3806 1195.11 95.9639 1190.48 Q100.57 1185.83 101.751 1184.49 Q103.996 1181.96 104.876 1180.23 Q105.779 1178.47 105.779 1176.78 Q105.779 1174.02 103.834 1172.29 Q101.913 1170.55 98.8111 1170.55 Q96.6121 1170.55 94.1584 1171.32 Q91.7278 1172.08 88.9501 1173.63 L88.9501 1168.91 Q91.7741 1167.77 94.2278 1167.19 Q96.6815 1166.62 98.7185 1166.62 Q104.089 1166.62 107.283 1169.3 Q110.478 1171.99 110.478 1176.48 Q110.478 1178.61 109.668 1180.53 Q108.881 1182.43 106.774 1185.02 Q106.195 1185.69 103.094 1188.91 Q99.9917 1192.1 94.3436 1197.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M120.478 1195.92 L125.362 1195.92 L125.362 1201.8 L120.478 1201.8 L120.478 1195.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M135.593 1167.24 L153.95 1167.24 L153.95 1171.18 L139.876 1171.18 L139.876 1179.65 Q140.894 1179.3 141.913 1179.14 Q142.931 1178.95 143.95 1178.95 Q149.737 1178.95 153.116 1182.13 Q156.496 1185.3 156.496 1190.71 Q156.496 1196.29 153.024 1199.39 Q149.552 1202.47 143.232 1202.47 Q141.056 1202.47 138.788 1202.1 Q136.542 1201.73 134.135 1200.99 L134.135 1196.29 Q136.218 1197.43 138.441 1197.98 Q140.663 1198.54 143.14 1198.54 Q147.144 1198.54 149.482 1196.43 Q151.82 1194.32 151.82 1190.71 Q151.82 1187.1 149.482 1185 Q147.144 1182.89 143.14 1182.89 Q141.265 1182.89 139.39 1183.31 Q137.538 1183.72 135.593 1184.6 L135.593 1167.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M99.3204 929.367 Q95.7093 929.367 93.8806 932.932 Q92.075 936.473 92.075 943.603 Q92.075 950.709 93.8806 954.274 Q95.7093 957.816 99.3204 957.816 Q102.955 957.816 104.76 954.274 Q106.589 950.709 106.589 943.603 Q106.589 936.473 104.76 932.932 Q102.955 929.367 99.3204 929.367 M99.3204 925.663 Q105.131 925.663 108.186 930.269 Q111.265 934.853 111.265 943.603 Q111.265 952.33 108.186 956.936 Q105.131 961.519 99.3204 961.519 Q93.5102 961.519 90.4315 956.936 Q87.376 952.33 87.376 943.603 Q87.376 934.853 90.4315 930.269 Q93.5102 925.663 99.3204 925.663 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M119.482 954.968 L124.367 954.968 L124.367 960.848 L119.482 960.848 L119.482 954.968 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M144.552 929.367 Q140.941 929.367 139.112 932.932 Q137.306 936.473 137.306 943.603 Q137.306 950.709 139.112 954.274 Q140.941 957.816 144.552 957.816 Q148.186 957.816 149.991 954.274 Q151.82 950.709 151.82 943.603 Q151.82 936.473 149.991 932.932 Q148.186 929.367 144.552 929.367 M144.552 925.663 Q150.362 925.663 153.417 930.269 Q156.496 934.853 156.496 943.603 Q156.496 952.33 153.417 956.936 Q150.362 961.519 144.552 961.519 Q138.741 961.519 135.663 956.936 Q132.607 952.33 132.607 943.603 Q132.607 934.853 135.663 930.269 Q138.741 925.663 144.552 925.663 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M94.3436 715.96 L110.663 715.96 L110.663 719.895 L88.7186 719.895 L88.7186 715.96 Q91.3806 713.205 95.9639 708.576 Q100.57 703.923 101.751 702.58 Q103.996 700.057 104.876 698.321 Q105.779 696.562 105.779 694.872 Q105.779 692.117 103.834 690.381 Q101.913 688.645 98.8111 688.645 Q96.6121 688.645 94.1584 689.409 Q91.7278 690.173 88.9501 691.724 L88.9501 687.002 Q91.7741 685.867 94.2278 685.289 Q96.6815 684.71 98.7185 684.71 Q104.089 684.71 107.283 687.395 Q110.478 690.08 110.478 694.571 Q110.478 696.701 109.668 698.622 Q108.881 700.52 106.774 703.113 Q106.195 703.784 103.094 707.001 Q99.9917 710.196 94.3436 715.96 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M120.478 714.015 L125.362 714.015 L125.362 719.895 L120.478 719.895 L120.478 714.015 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M135.593 685.335 L153.95 685.335 L153.95 689.27 L139.876 689.27 L139.876 697.742 Q140.894 697.395 141.913 697.233 Q142.931 697.048 143.95 697.048 Q149.737 697.048 153.116 700.219 Q156.496 703.39 156.496 708.807 Q156.496 714.386 153.024 717.488 Q149.552 720.566 143.232 720.566 Q141.056 720.566 138.788 720.196 Q136.542 719.825 134.135 719.085 L134.135 714.386 Q136.218 715.52 138.441 716.075 Q140.663 716.631 143.14 716.631 Q147.144 716.631 149.482 714.525 Q151.82 712.418 151.82 708.807 Q151.82 705.196 149.482 703.089 Q147.144 700.983 143.14 700.983 Q141.265 700.983 139.39 701.4 Q137.538 701.816 135.593 702.696 L135.593 685.335 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M89.3667 444.382 L107.723 444.382 L107.723 448.317 L93.6491 448.317 L93.6491 456.789 Q94.6676 456.442 95.6861 456.28 Q96.7047 456.095 97.7232 456.095 Q103.51 456.095 106.89 459.266 Q110.269 462.437 110.269 467.854 Q110.269 473.433 106.797 476.534 Q103.325 479.613 97.0056 479.613 Q94.8297 479.613 92.5612 479.243 Q90.3158 478.872 87.9084 478.132 L87.9084 473.433 Q89.9917 474.567 92.2139 475.122 Q94.4361 475.678 96.913 475.678 Q100.918 475.678 103.256 473.571 Q105.593 471.465 105.593 467.854 Q105.593 464.243 103.256 462.136 Q100.918 460.03 96.913 460.03 Q95.038 460.03 93.163 460.447 Q91.3112 460.863 89.3667 461.743 L89.3667 444.382 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M119.482 473.062 L124.367 473.062 L124.367 478.942 L119.482 478.942 L119.482 473.062 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M144.552 447.461 Q140.941 447.461 139.112 451.025 Q137.306 454.567 137.306 461.697 Q137.306 468.803 139.112 472.368 Q140.941 475.909 144.552 475.909 Q148.186 475.909 149.991 472.368 Q151.82 468.803 151.82 461.697 Q151.82 454.567 149.991 451.025 Q148.186 447.461 144.552 447.461 M144.552 443.757 Q150.362 443.757 153.417 448.363 Q156.496 452.947 156.496 461.697 Q156.496 470.423 153.417 475.03 Q150.362 479.613 144.552 479.613 Q138.741 479.613 135.663 475.03 Q132.607 470.423 132.607 461.697 Q132.607 452.947 135.663 448.363 Q138.741 443.757 144.552 443.757 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M89.1352 203.429 L111.357 203.429 L111.357 205.419 L98.8111 237.989 L93.9269 237.989 L105.732 207.364 L89.1352 207.364 L89.1352 203.429 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M120.478 232.109 L125.362 232.109 L125.362 237.989 L120.478 237.989 L120.478 232.109 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M135.593 203.429 L153.95 203.429 L153.95 207.364 L139.876 207.364 L139.876 215.836 Q140.894 215.489 141.913 215.327 Q142.931 215.142 143.95 215.142 Q149.737 215.142 153.116 218.313 Q156.496 221.484 156.496 226.901 Q156.496 232.479 153.024 235.581 Q149.552 238.66 143.232 238.66 Q141.056 238.66 138.788 238.29 Q136.542 237.919 134.135 237.179 L134.135 232.479 Q136.218 233.614 138.441 234.169 Q140.663 234.725 143.14 234.725 Q147.144 234.725 149.482 232.618 Q151.82 230.512 151.82 226.901 Q151.82 223.29 149.482 221.183 Q147.144 219.077 143.14 219.077 Q141.265 219.077 139.39 219.493 Q137.538 219.91 135.593 220.79 L135.593 203.429 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip842)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1234.26 268.292,1473.67 270.6,1564.39 272.908,1510.15 275.216,1436.08 277.524,1391.26 279.832,1376.87 282.139,1343.47 284.447,1518.98 286.755,1403.15 289.063,1313.27 291.371,1590.96 293.679,1485.87 295.987,1442.84 298.295,1407.56 300.603,1498.93 302.911,1349.69 305.219,1433.97 307.527,1272.54 309.834,1319.62 312.142,1558.86 314.45,1338.41 316.758,1500.88 319.066,1400.07 321.374,1288.59 323.682,1537.93 325.99,1608.19 328.298,1495.34 330.606,1315.68 332.914,1586.13 335.221,1545.34 337.529,1512.84 339.837,1385.56 342.145,1567.28 344.453,1432.39 346.761,1474.91 349.069,1456.81 351.377,1447.68 353.685,1314.21 355.993,1601.59 358.301,1435.27 360.608,1371.37 362.916,1375.73 365.224,1334.56 367.532,1372.46 369.84,1486.2 372.148,1288.58 374.456,1392.46 376.764,1570.44 379.072,1540.26 381.38,1504.66 383.688,1375.32 385.996,1644.89 388.303,1422.58 390.611,1367.2 392.919,1365.58 395.227,1380.22 397.535,1358.24 399.843,1489.49 402.151,1395.23 404.459,1377.57 406.767,1489.94 409.075,1532.82 411.383,1436.11 413.69,1608.2 415.998,1290.91 418.306,1304.89 420.614,1492.21 422.922,1239 425.23,1414.56 427.538,1609.07 429.846,1356.37 432.154,1568.11 434.462,1431.94 436.77,1357.91 439.077,1506.71 441.385,1269.7 443.693,1415.09 446.001,1432.76 448.309,1386.9 450.617,1313.88 452.925,1404.69 455.233,1399.74 457.541,1521.98 459.849,1393.61 462.157,1365.63 464.465,1388.45 466.772,1488.93 469.08,1551.37 471.388,1492.74 473.696,1345.21 476.004,1352.31 478.312,1271.54 480.62,1430.97 482.928,1419.89 485.236,1533.15 487.544,1401.6 489.852,1349.05 492.159,1480.05 494.467,1505 496.775,1406.82 499.083,1321.4 501.391,1503.97 503.699,1684.91 506.007,1451.68 508.315,1374.45 510.623,1506.89 512.931,1337.49 515.239,1473.9 517.546,1395.36 519.854,1374.86 522.162,1363.25 524.47,1326.45 526.778,1353.61 529.086,1448.08 531.394,1299.38 533.702,1183.16 536.01,1287.63 538.318,1441.36 540.626,1497.11 542.933,1357.37 545.241,1493.25 547.549,1317.22 549.857,1346.78 552.165,1373.98 554.473,1343.81 556.781,1395.75 559.089,1393.26 561.397,1339.25 563.705,1384.3 566.013,1407.63 568.321,1647.19 570.628,1495.94 572.936,1373.31 575.244,1453.15 577.552,1536.07 579.86,1439.21 582.168,1403.84 584.476,1545.01 586.784,1398.31 589.092,1294.95 591.4,1392.05 593.708,1425.32 596.015,1535.62 598.323,1324.87 600.631,1574.39 602.939,1324.61 605.247,1460.18 607.555,1511.03 609.863,1428.41 612.171,1365.83 614.479,1619.31 616.787,1463.85 619.095,1398.63 621.402,1382.49 623.71,1357.58 626.018,1483.01 628.326,1265.96 630.634,1581.14 632.942,1487.66 635.25,1579.49 637.558,1390.58 639.866,1570.97 642.174,1426.34 644.482,1411.43 646.79,1444.33 649.097,1416.92 651.405,1512.9 653.713,1233.25 656.021,1408.42 658.329,1252.74 660.637,1420.81 662.945,1238.46 665.253,1334.31 667.561,1531.3 669.869,1217.92 672.177,1333.43 674.484,1398.08 676.792,1403.39 679.1,1384.34 681.408,1432.74 683.716,1474.62 686.024,1551.11 688.332,1491.92 690.64,1303.86 692.948,1410.32 695.256,1393.1 697.564,1500.56 699.871,1460.93 702.179,1333.76 704.487,1635.65 706.795,1410.43 709.103,1513.05 711.411,1365.78 713.719,1394.92 716.027,1367.18 718.335,1413.2 720.643,1154.64 722.951,1472.72 725.259,1401.17 727.566,1537.99 729.874,1457.86 732.182,1443.3 734.49,1350.31 736.798,1417.04 739.106,1437.04 741.414,1378.92 743.722,1376.73 746.03,1273 748.338,1466.52 750.646,1407.59 752.953,1562.26 755.261,1352.23 757.569,1417.35 759.877,1383.43 762.185,1571.25 764.493,1485.25 766.801,1461.87 769.109,1389.76 771.417,1402.88 773.725,1209.97 776.033,1478.71 778.34,1499.6 780.648,1444.87 782.956,1304 785.264,1374.58 787.572,1428.89 789.88,1469 792.188,1458.11 794.496,1643.63 796.804,1514.67 799.112,1505.47 801.42,1326.23 803.728,1460.37 806.035,1396.44 808.343,1493.78 810.651,1523.83 812.959,1430.96 815.267,1339.15 817.575,1385.61 819.883,1543.68 822.191,1279.37 824.499,1422.79 826.807,1377.51 829.115,1501.57 831.422,1416.77 833.73,1451.49 836.038,1480.98 838.346,1365.08 840.654,1467.22 842.962,1465.27 845.27,1499.79 847.578,1432.56 849.886,1418.16 852.194,1595.86 854.502,1448.73 856.809,1442.41 859.117,1325.31 861.425,1393.41 863.733,1457.33 866.041,1477.94 868.349,1412.23 870.657,1194.01 872.965,1474.16 875.273,1582.8 877.581,1278.75 879.889,1454.4 882.197,1506.34 884.504,1402.47 886.812,1421.19 889.12,1414.03 891.428,1437.02 893.736,1416.65 896.044,1423.39 898.352,1234.15 900.66,1247.24 902.968,1452.75 905.276,1449.36 907.584,1403.71 909.891,1456.87 912.199,1431.13 914.507,1303.37 916.815,1551.22 919.123,1407.28 921.431,1305.45 923.739,1440.28 926.047,1420.3 928.355,1441.57 930.663,1289.68 932.971,1553.56 935.278,1309.58 937.586,1266.35 939.894,1266.32 942.202,1324.1 944.51,1307.11 946.818,1402.64 949.126,1464.42 951.434,1548.33 953.742,1376.49 956.05,1415.08 958.358,1365.95 960.665,1514.36 962.973,1354.58 965.281,1258.22 967.589,1219.77 969.897,1308.41 972.205,1316.96 974.513,1426.26 976.821,1590.04 979.129,1562.26 981.437,1544.62 983.745,1529.54 986.053,1377.09 988.36,1371.52 990.668,1421.99 992.976,1460.41 995.284,1428.53 997.592,1419.45 999.9,1499.38 1002.21,1373.19 1004.52,1433.48 1006.82,1390.3 1009.13,1412.08 1011.44,1329.94 1013.75,1473.44 1016.06,1488.34 1018.36,1270.84 1020.67,1453.8 1022.98,1509.29 1025.29,1483.49 1027.59,1426.59 1029.9,1440.14 1032.21,1404.65 1034.52,1399.28 1036.83,1573.28 1039.13,1379 1041.44,1465.95 1043.75,1525.67 1046.06,1444.04 1048.37,1489.66 1050.67,1370.59 1052.98,1420.7 1055.29,1584.29 1057.6,1418.43 1059.91,1454.66 1062.21,1306.15 1064.52,1243.88 1066.83,1634.7 1069.14,1239.85 1071.45,1385.01 1073.75,1339.32 1076.06,1405.8 1078.37,1745 1080.68,1365.43 1082.98,1507.87 1085.29,1610.57 1087.6,1462.42 1089.91,1236.53 1092.22,1617.13 1094.52,1309.15 1096.83,1393.76 1099.14,1328.37 1101.45,1397.15 1103.76,1528.25 1106.06,1318.22 1108.37,1369.98 1110.68,1388.03 1112.99,1604.57 1115.3,1354.23 1117.6,1450.5 1119.91,1423.19 1122.22,1481.84 1124.53,1349.91 1126.84,1339.41 1129.14,1406.29 1131.45,1250.24 1133.76,1427.04 1136.07,1553.88 1138.37,1386.63 1140.68,1319.11 1142.99,1443.74 1145.3,1411 1147.61,1344.85 1149.91,1360.67 1152.22,1388.79 1154.53,1359.03 1156.84,1588.56 1159.15,1293.58 1161.45,1348.13 1163.76,1361.69 1166.07,1514.24 1168.38,1411.16 1170.69,1504.91 1172.99,1489.74 1175.3,1499.51 1177.61,1363.79 1179.92,1509.9 1182.23,1528.38 1184.53,1513.43 1186.84,1321.46 1189.15,1337.66 1191.46,1360.19 1193.76,1362.31 1196.07,1511.33 1198.38,1306.93 1200.69,1289.99 1203,1357.06 1205.3,1414.37 1207.61,1536.08 1209.92,1450.5 1212.23,1581.41 1214.54,1538.57 1216.84,1342.62 1219.15,1382.43 1221.46,1435.61 1223.77,1551.14 1226.08,1494.4 1228.38,1429.91 1230.69,1464.45 1233,1436.67 1235.31,1515.46 1237.61,1515.71 1239.92,1456.82 1242.23,1407.84 1244.54,1484.79 1246.85,1618.33 1249.15,1475.65 1251.46,1549.39 1253.77,1564.07 1256.08,1427.39 1258.39,1309.37 1260.69,1489.63 1263,1469.41 1265.31,1453.4 1267.62,1543.32 1269.93,1394.32 1272.23,1442.61 1274.54,1278.66 1276.85,1271.51 1279.16,1405.99 1281.47,1366.65 1283.77,1322.93 1286.08,1445.27 1288.39,1334.99 1290.7,1361.88 1293,1547.69 1295.31,1267.22 1297.62,1503.21 1299.93,1675.38 1302.24,1316.95 1304.54,1557.65 1306.85,1266.97 1309.16,1278.41 1311.47,1519.03 1313.78,1529.88 1316.08,1307.83 1318.39,1472.89 1320.7,1679.16 1323.01,1499.74 1325.32,1455.42 1327.62,1464.71 1329.93,1563.17 1332.24,1356.91 1334.55,1537.93 1336.86,1459.88 1339.16,1377.45 1341.47,1493.38 1343.78,1370.26 1346.09,1331.55 1348.39,1502.63 1350.7,1317.66 1353.01,1391.62 1355.32,1439.85 1357.63,1606.41 1359.93,1564.11 1362.24,1356.86 1364.55,1437.77 1366.86,1267.89 1369.17,1578.76 1371.47,1510.7 1373.78,1556.14 1376.09,1402.77 1378.4,1278.55 1380.71,1510.87 1383.01,1513.31 1385.32,1407.15 1387.63,1221.14 1389.94,1324.14 1392.24,1491.19 1394.55,1345.61 1396.86,1431.21 1399.17,1449.71 1401.48,1452.39 1403.78,1576.17 1406.09,1429.72 1408.4,1379.39 1410.71,1369.85 1413.02,1600.02 1415.32,1367.94 1417.63,1562.51 1419.94,1420.67 1422.25,1409.24 1424.56,1336.61 1426.86,1512.39 1429.17,1368.5 1431.48,1553.12 1433.79,1360.38 1436.1,1442.35 1438.4,1596.6 1440.71,1444.75 1443.02,1350.21 1445.33,1589.84 1447.63,1404.87 1449.94,1481.73 1452.25,1470.42 1454.56,1751.15 1456.87,1440.3 1459.17,1350.34 1461.48,1327.03 1463.79,1461.79 1466.1,1348.1 1468.41,1519.23 1470.71,1409.29 1473.02,1526.88 1475.33,1315.93 1477.64,1334.73 1479.95,1554.04 1482.25,1419.06 1484.56,1276.64 1486.87,1501.91 1489.18,1391.2 1491.49,1374.44 1493.79,1506.12 1496.1,1407.48 1498.41,1366.34 1500.72,1346.57 1503.02,1526.98 1505.33,1416.17 1507.64,1351.02 1509.95,1398.97 1512.26,1452.06 1514.56,1293.83 1516.87,1517.35 1519.18,1348.25 1521.49,1333.39 1523.8,1414.57 1526.1,1463.48 1528.41,1583.16 1530.72,1504.18 1533.03,1460.44 1535.34,1403.4 1537.64,1403.23 1539.95,1491.63 1542.26,1551.25 1544.57,1397.06 1546.88,1349.06 1549.18,1488.13 1551.49,1354.95 1553.8,1481.23 1556.11,1260.86 1558.41,1394.34 1560.72,1483.41 1563.03,1467.07 1565.34,1576.19 1567.65,1345.44 1569.95,1395.07 1572.26,1494.26 1574.57,1443.74 1576.88,1371.35 1579.19,1335.97 1581.49,1652.12 1583.8,1440.94 1586.11,1346.33 1588.42,1512 1590.73,1501.4 1593.03,1480.33 1595.34,1338.91 1597.65,1439.08 1599.96,1454.66 1602.26,1272.74 1604.57,1483.03 1606.88,1360.03 1609.19,1423.84 1611.5,1388.39 1613.8,1340.57 1616.11,1313.34 1618.42,1295.53 1620.73,1367.98 1623.04,1298.54 1625.34,1464.4 1627.65,1490.96 1629.96,1524.94 1632.27,1263.36 1634.58,1331.06 1636.88,1422.5 1639.19,1510.52 1641.5,1484.85 1643.81,1324.79 1646.12,1450.44 1648.42,1313.97 1650.73,1409.08 1653.04,1318.58 1655.35,1573.28 1657.65,1451.48 1659.96,1345.77 1662.27,1344.55 1664.58,1543.77 1666.89,1310.03 1669.19,1478.89 1671.5,1339.15 1673.81,1368.22 1676.12,1361.59 1678.43,1631.56 1680.73,1417.83 1683.04,1358.94 1685.35,1354.09 1687.66,1289.23 1689.97,1146.85 1692.27,1502.84 1694.58,1219.05 1696.89,1532.85 1699.2,1390.87 1701.51,1336.93 1703.81,1375.35 1706.12,1484.95 1708.43,1479.52 1710.74,1626.16 1713.04,1515.64 1715.35,1413.03 1717.66,1418.94 1719.97,1494.4 1722.28,1602.17 1724.58,1391.52 1726.89,1418.97 1729.2,1335.45 1731.51,1409.68 1733.82,1608.82 1736.12,1494.81 1738.43,1498.79 1740.74,1642.77 1743.05,1486.61 1745.36,1445.53 1747.66,1370.57 1749.97,1428.41 1752.28,1389.31 1754.59,1243.56 1756.9,1461.94 1759.2,1309.79 1761.51,1446.23 1763.82,1376.09 1766.13,1613.33 1768.43,1595.85 1770.74,1314.52 1773.05,1531.66 1775.36,1356.91 1777.67,1586.16 1779.97,1405.08 1782.28,1396.84 1784.59,1403.05 1786.9,1421.86 1789.21,1465.99 1791.51,1323.79 1793.82,1496.3 1796.13,1321.36 1798.44,1576.68 1800.75,1459.5 1803.05,1574.04 1805.36,1514.91 1807.67,1457.83 1809.98,1274.71 1812.28,1422.57 1814.59,1483.78 1816.9,1567.45 1819.21,1366.44 1821.52,1453.44 1823.82,1416.88 1826.13,1381.38 1828.44,1406.47 1830.75,1340.66 1833.06,1422.06 1835.36,1387.97 1837.67,1256.71 1839.98,1478.15 1842.29,1503.25 1844.6,1483.75 1846.9,1328.26 1849.21,1324.14 1851.52,1264.61 1853.83,1651.26 1856.14,1429.27 1858.44,1561.23 1860.75,1462.46 1863.06,1396.42 1865.37,1455.45 1867.67,1452.47 1869.98,1388.45 1872.29,1369.04 1874.6,1528.05 1876.91,1525.22 1879.21,1514.27 1881.52,1286.83 1883.83,1312.01 1886.14,1273.3 1888.45,1541.05 1890.75,1264.17 1893.06,1507.93 1895.37,1653.64 1897.68,1507.77 1899.99,1338.07 1902.29,1340.1 1904.6,1433.85 1906.91,1249.48 1909.22,1543.18 1911.53,1362.3 1913.83,1456.81 1916.14,1440.3 1918.45,1413.5 1920.76,1387.21 1923.06,1286.46 1925.37,1431.56 1927.68,1440.1 1929.99,1495.83 1932.3,1332.76 1934.6,1375.58 1936.91,1335.35 1939.22,1502.32 1941.53,1419.5 1943.84,1193.2 1946.14,1465.47 1948.45,1560.22 1950.76,1339.33 1953.07,1264.93 1955.38,1387.59 1957.68,1398.79 1959.99,1293.81 1962.3,1532.6 1964.61,1473.31 1966.91,1281.31 1969.22,1428.94 1971.53,1439.45 1973.84,1402.23 1976.15,1510.52 1978.45,1454.52 1980.76,1543.03 1983.07,1578.47 1985.38,1626.62 1987.69,1355.35 1989.99,1291.69 1992.3,1472.32 1994.61,1451.57 1996.92,1443.07 1999.23,1394.79 2001.53,1425.75 2003.84,1474.16 2006.15,1310.68 2008.46,1349.64 2010.77,1326.92 2013.07,1318.77 2015.38,1398.92 2017.69,1446.17 2020,1446.23 2022.3,1556.5 2024.61,1472.64 2026.92,1317.61 2029.23,1441.24 2031.54,1568.45 2033.84,1358.1 2036.15,1582.19 2038.46,1394.8 2040.77,1475.26 2043.08,1458.74 2045.38,1375.57 2047.69,1471.24 2050,1385.87 2052.31,1369.72 2054.62,1407.94 2056.92,1265.69 2059.23,1484.46 2061.54,1372.34 2063.85,1510.52 2066.16,1392.39 2068.46,1520.73 2070.77,1408.68 2073.08,1461.55 2075.39,1409.72 2077.69,1534.64 2080,1303.02 2082.31,1328.71 2084.62,1598.48 2086.93,1346.49 2089.23,1439.34 2091.54,1471.35 2093.85,1465.35 2096.16,1648.23 2098.47,1209.31 2100.77,1371.68 2103.08,1520.32 2105.39,1409.37 2107.7,1395.88 2110.01,1437.64 2112.31,1512.19 2114.62,1519.86 2116.93,1488.17 2119.24,1520.49 2121.55,1435.53 2123.85,1406.15 2126.16,1579.55 2128.47,1290.19 2130.78,1400.61 2133.08,1443.17 2135.39,1351.75 2137.7,1575.26 2140.01,1304.5 2142.32,1349.4 2144.62,1544.24 2146.93,1398.58 2149.24,1262.14 2151.55,1363.63 2153.86,1539.55 2156.16,1320.84 2158.47,1417.04 2160.78,1417.5 2163.09,1436.11 2165.4,1356.37 2167.7,1190.93 2170.01,1482.91 2172.32,1361.95 2174.63,1396.14 2176.93,1503.36 2179.24,1312.3 2181.55,1457.64 2183.86,1399.6 2186.17,1354.23 2188.47,1357.54 2190.78,1397.5 2193.09,1455.24 2195.4,1409.96 2197.71,1520.05 2200.01,1469.07 2202.32,1390.35 2204.63,1633.79 2206.94,1353.35 2209.25,1304.71 2211.55,1583.44 2213.86,1574.04 2216.17,1316.74 2218.48,1525.2 2220.79,1466.28 2223.09,1392.04 2225.4,1530.8 2227.71,1492.93 2230.02,1457.4 2232.32,1522.58 2234.63,1515.4 2236.94,1382.95 2239.25,1381.96 2241.56,1513.33 2243.86,1402.14 2246.17,1414.57 2248.48,1469.6 2250.79,1592.42 2253.1,1539.6 2255.4,1313.3 2257.71,1557.04 2260.02,1481.8 2262.33,1266.63 2264.64,1575.63 2266.94,1293.54 2269.25,1402.96 2271.56,1433.75 2273.87,1406.27 2276.18,1471.81 2278.48,1397.29 2280.79,1400.58 2283.1,1508.5 2285.41,1286.17 2287.71,1436.74 2290.02,1477.91 2292.33,1564.88 2294.64,1432.76 2296.95,1404.96 2299.25,1591.35 2301.56,1294.81 2303.87,1409.84 2306.18,1378.89 2308.49,1457.78 2310.79,1379.35 2313.1,1511.49 2315.41,1394.46 2317.72,1516.18 2320.03,1389.08 2322.33,1419.68 2324.64,1160.57 2326.95,1424.89 2329.26,1441.32 2331.56,1323.97 2333.87,1380.7 2336.18,1304.98 2338.49,1427.48 2340.8,1364.38 2343.1,1254.54 2345.41,1420.55 2347.72,1398.62 2350.03,1602.96 2352.34,1471.89 2354.64,1390.5 2356.95,1345.85 2359.26,1600.78 2361.57,1483.32 2363.88,1363.23 2366.18,1323.96 2368.49,1397.86 2370.8,1375.23 2373.11,1324.31 2375.42,1321.68 2377.72,1438.33 2380.03,1393.24 2382.34,1366.98 2384.65,1341.79 2386.95,1334.09 2389.26,1413.84 2391.57,1390.36 2393.88,1401.97 2396.19,1507.38 2398.49,1277.89 2400.8,1415.67 2403.11,1473.52 2405.42,1367.65 2407.73,1472.07 2410.03,1446.62 2412.34,1619.84 2414.65,1513.15 2416.96,1555.22 2419.27,1293.62 2421.57,1543.65 2423.88,1439.7 2426.19,1451.18 2428.5,1582.27 2430.81,1351.22 2433.11,1442 2435.42,1314.12 2437.73,1628.92 2440.04,1277.33 2442.34,1458.04 2444.65,1071.99 2446.96,1367.51 2449.27,1642.26 2451.58,1419.26 2453.88,1448.94 2456.19,1477.52 2458.5,1496.16 2460.81,1459.21 2463.12,1393.25 2465.42,1471.5 2467.73,1446.57 2470.04,1446.26 2472.35,1240.08 2474.66,1425.74 2476.96,1323.03 2479.27,1464.48 2481.58,1401.85 2483.89,1409.62 2486.2,1362.16 2488.5,1398.79 2490.81,1516.67 2493.12,1458.32 2495.43,1375.11 2497.73,1244.35 2500.04,1399.93 2502.35,1346.14 2504.66,1369.48 2506.97,1406.43 2509.27,1478.48 2511.58,1299.02 2513.89,1364.86 2516.2,1454.48 2518.51,1478.69 2520.81,1429.98 2523.12,1288.4 2525.43,1382.05 2527.74,1432.24 2530.05,1400.11 2532.35,1565.33 2534.66,1542.95 2536.97,1416.93 2539.28,1372.46 2541.58,1342.17 2543.89,1563.26 2546.2,1409.44 2548.51,1409.95 2550.82,1445.16 2553.12,1571.08 2555.43,1291.58 2557.74,1471.23 2560.05,1509.19 2562.36,1389.69 2564.66,1454.08 2566.97,1259.16 2569.28,1514.07 2571.59,1432.82 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,993.808 268.292,838.708 270.6,1012.96 272.908,956.832 275.216,953.968 277.524,918.472 279.832,964.826 282.139,786.48 284.447,990.945 286.755,835.842 289.063,758.39 291.371,943.629 293.679,879.83 295.987,1081.39 298.295,803.48 300.603,934.473 302.911,1010.34 305.219,798.516 307.527,1067.74 309.834,1058.46 312.142,1054.01 314.45,703.93 316.758,980.051 319.066,1025.12 321.374,788.538 323.682,1014.11 325.99,967.539 328.298,1011.74 330.606,868.407 332.914,968.132 335.221,934.624 337.529,893.953 339.837,882.537 342.145,870.813 344.453,905.48 346.761,923.625 349.069,862.774 351.377,852.015 353.685,1006.71 355.993,999.343 358.301,885.253 360.608,894.267 362.916,945.032 365.224,866.934 367.532,1010.57 369.84,964.827 372.148,899.142 374.456,908.46 376.764,972.518 379.072,901.769 381.38,925.9 383.688,1030.7 385.996,957.53 388.303,890.142 390.611,740.024 392.919,837.992 395.227,711.923 397.535,1020.72 399.843,981.252 402.151,950.526 404.459,878.266 406.767,979.131 409.075,1102.28 411.383,984.535 413.69,940.549 415.998,866.407 418.306,1061.23 420.614,957.773 422.922,816.49 425.23,889.527 427.538,968.35 429.846,929.479 432.154,907.454 434.462,976.01 436.77,931.793 439.077,820.111 441.385,1022.29 443.693,946.033 446.001,903.433 448.309,915.049 450.617,975.161 452.925,1000.96 455.233,923.583 457.541,792.675 459.849,877.179 462.157,883.086 464.465,1015.24 466.772,1007.52 469.08,1102.07 471.388,843.76 473.696,876.392 476.004,1117.95 478.312,998.946 480.62,1043.11 482.928,992.574 485.236,844.38 487.544,946.615 489.852,986.06 492.159,803.157 494.467,856.429 496.775,976.037 499.083,1038 501.391,1039.05 503.699,1018.27 506.007,918.637 508.315,1135.11 510.623,838.692 512.931,916.81 515.239,808.752 517.546,916.946 519.854,901.701 522.162,1099.23 524.47,1101.78 526.778,747.27 529.086,942.233 531.394,950.983 533.702,976.006 536.01,973.488 538.318,1063.47 540.626,972.121 542.933,1000.25 545.241,1083.14 547.549,863.221 549.857,875.529 552.165,1036.2 554.473,806.806 556.781,1107.92 559.089,813.732 561.397,999.566 563.705,688.992 566.013,966.058 568.321,1037.28 570.628,969.887 572.936,1028.65 575.244,830.754 577.552,866.189 579.86,1040.12 582.168,1013.37 584.476,1032.81 586.784,881.855 589.092,937.633 591.4,1015.94 593.708,824.442 596.015,1040.43 598.323,999.652 600.631,889.602 602.939,909.516 605.247,776.256 607.555,967.376 609.863,1040.6 612.171,1083.45 614.479,859.068 616.787,810.6 619.095,987.963 621.402,1115.33 623.71,913.483 626.018,896.756 628.326,895.888 630.634,767.303 632.942,1018.29 635.25,919.874 637.558,908.741 639.866,983.086 642.174,1023.83 644.482,942.708 646.79,1101.53 649.097,952.936 651.405,935.258 653.713,1023.71 656.021,878.082 658.329,1146.53 660.637,843.406 662.945,1176.67 665.253,764.112 667.561,1042.14 669.869,1080.3 672.177,967.553 674.484,816.256 676.792,1062.84 679.1,1034.91 681.408,946.481 683.716,1000.81 686.024,857.97 688.332,986.287 690.64,1084.96 692.948,836.008 695.256,1202.93 697.564,1060.02 699.871,903.344 702.179,1087.12 704.487,964.176 706.795,1007.71 709.103,940.912 711.411,905.69 713.719,861.1 716.027,916.297 718.335,1041.64 720.643,760.332 722.951,988.116 725.259,1047.25 727.566,988.889 729.874,969.29 732.182,914.749 734.49,849.869 736.798,836.746 739.106,827.807 741.414,759.192 743.722,922.611 746.03,856.596 748.338,978.025 750.646,840.756 752.953,954.227 755.261,835.934 757.569,1053.59 759.877,1032.75 762.185,956.403 764.493,1093.81 766.801,969.571 769.109,841.478 771.417,863.525 773.725,1064.25 776.033,865.34 778.34,823.325 780.648,1057.55 782.956,1084.28 785.264,866.722 787.572,729.541 789.88,1015.2 792.188,992.226 794.496,961.876 796.804,911.089 799.112,917.8 801.42,897.75 803.728,877.96 806.035,923.555 808.343,1047.93 810.651,952.201 812.959,1228.47 815.267,1057.14 817.575,1059.38 819.883,1059.04 822.191,793.76 824.499,1006.77 826.807,896.465 829.115,829.599 831.422,775.101 833.73,909.56 836.038,888.007 838.346,870.945 840.654,810.371 842.962,1059.72 845.27,986.604 847.578,971.032 849.886,1057.18 852.194,1110.8 854.502,893.46 856.809,893.913 859.117,990.037 861.425,968.206 863.733,995.641 866.041,920.17 868.349,1161.66 870.657,945.014 872.965,803.964 875.273,899.252 877.581,833.869 879.889,1077.45 882.197,932.735 884.504,927.471 886.812,954.193 889.12,888.248 891.428,965.103 893.736,917.612 896.044,1145.52 898.352,1067.99 900.66,916.325 902.968,1002.39 905.276,926.717 907.584,994.28 909.891,956.456 912.199,1185.68 914.507,980.785 916.815,794.659 919.123,973.732 921.431,985.568 923.739,1092.19 926.047,739.216 928.355,1108.13 930.663,1018.48 932.971,1074.42 935.278,1014.3 937.586,1126.44 939.894,1113.5 942.202,949.727 944.51,935.511 946.818,1117.85 949.126,1141.77 951.434,911.63 953.742,789.204 956.05,820.525 958.358,1008.76 960.665,938.045 962.973,996.514 965.281,1033.14 967.589,884.369 969.897,1019.7 972.205,963.856 974.513,955.739 976.821,868.565 979.129,867.873 981.437,925.075 983.745,1006 986.053,976.7 988.36,801.295 990.668,747.128 992.976,921.571 995.284,831.533 997.592,999.038 999.9,912.765 1002.21,841.351 1004.52,893.557 1006.82,787.72 1009.13,820.339 1011.44,1183.47 1013.75,967.647 1016.06,906.971 1018.36,1058.85 1020.67,958.028 1022.98,993.189 1025.29,847.783 1027.59,1038.38 1029.9,875.832 1032.21,900.067 1034.52,740.014 1036.83,1002.98 1039.13,890.307 1041.44,829.62 1043.75,1006.83 1046.06,1002.38 1048.37,802.514 1050.67,1034.38 1052.98,899.564 1055.29,955.635 1057.6,955.117 1059.91,937.131 1062.21,918.093 1064.52,794.354 1066.83,930.454 1069.14,812.934 1071.45,904.016 1073.75,790.156 1076.06,854.608 1078.37,896.026 1080.68,909.093 1082.98,917.604 1085.29,980.856 1087.6,984.681 1089.91,1091.12 1092.22,961.48 1094.52,921.954 1096.83,820.268 1099.14,981.859 1101.45,863.434 1103.76,928.586 1106.06,826.11 1108.37,957.672 1110.68,1034.77 1112.99,989.936 1115.3,879.377 1117.6,1064.02 1119.91,1026.86 1122.22,944.452 1124.53,1022.13 1126.84,896.953 1129.14,958.971 1131.45,848.048 1133.76,906.776 1136.07,881.743 1138.37,866.53 1140.68,930.21 1142.99,991.536 1145.3,1121.56 1147.61,821.982 1149.91,974.641 1152.22,773.813 1154.53,891.82 1156.84,1027.71 1159.15,830.988 1161.45,896.037 1163.76,895.774 1166.07,944.281 1168.38,895.006 1170.69,867.245 1172.99,853.346 1175.3,955.477 1177.61,960.518 1179.92,905.816 1182.23,990.024 1184.53,1003.66 1186.84,1097.17 1189.15,984.374 1191.46,905.183 1193.76,873.529 1196.07,959.817 1198.38,1008.02 1200.69,936.533 1203,962.02 1205.3,1083.58 1207.61,788.042 1209.92,938.369 1212.23,834.538 1214.54,751.412 1216.84,1074.02 1219.15,953.235 1221.46,979.45 1223.77,1022.99 1226.08,1002.07 1228.38,910.976 1230.69,908.688 1233,814.442 1235.31,863.953 1237.61,830.924 1239.92,905.11 1242.23,893.825 1244.54,934.53 1246.85,1020.7 1249.15,1007.41 1251.46,979.746 1253.77,1061.07 1256.08,996.319 1258.39,951.668 1260.69,886.017 1263,1022.6 1265.31,885.198 1267.62,1208.93 1269.93,974.962 1272.23,835.702 1274.54,1028.5 1276.85,1028.74 1279.16,888.014 1281.47,933.839 1283.77,890.041 1286.08,980.285 1288.39,898.084 1290.7,1107.57 1293,754.763 1295.31,975.014 1297.62,820.06 1299.93,766.556 1302.24,792.145 1304.54,730.459 1306.85,948.275 1309.16,902.873 1311.47,846.63 1313.78,966.435 1316.08,1091.11 1318.39,753.055 1320.7,940.073 1323.01,953.261 1325.32,751.219 1327.62,935.341 1329.93,987.35 1332.24,1002.91 1334.55,1028.23 1336.86,944.56 1339.16,1033.94 1341.47,1053.41 1343.78,1018.79 1346.09,935.755 1348.39,1035.56 1350.7,821.887 1353.01,935.124 1355.32,980.936 1357.63,761.405 1359.93,815.171 1362.24,963.378 1364.55,1042.08 1366.86,956.946 1369.17,924.694 1371.47,765.909 1373.78,1126.97 1376.09,960.401 1378.4,843.412 1380.71,972.362 1383.01,827.061 1385.32,906.991 1387.63,895.068 1389.94,957.455 1392.24,1007.41 1394.55,950.113 1396.86,993.543 1399.17,1013.93 1401.48,1141.54 1403.78,741.104 1406.09,857.191 1408.4,821.268 1410.71,1127.64 1413.02,1003.61 1415.32,1032.88 1417.63,1118.44 1419.94,894.174 1422.25,922.454 1424.56,973.807 1426.86,880.007 1429.17,866.449 1431.48,995.014 1433.79,809.558 1436.1,1000.39 1438.4,828.393 1440.71,990.615 1443.02,955.56 1445.33,962.269 1447.63,966.747 1449.94,873.916 1452.25,900.953 1454.56,809.957 1456.87,905.951 1459.17,1025.55 1461.48,827.343 1463.79,970.748 1466.1,958.019 1468.41,992.199 1470.71,931.273 1473.02,893.786 1475.33,995.018 1477.64,952.671 1479.95,944.064 1482.25,1002.28 1484.56,1026.56 1486.87,907.251 1489.18,822.669 1491.49,965.682 1493.79,990.616 1496.1,975.239 1498.41,771.891 1500.72,1064.22 1503.02,1257.97 1505.33,1154.54 1507.64,998.691 1509.95,837.804 1512.26,1038.28 1514.56,916.138 1516.87,1242.52 1519.18,943.912 1521.49,667.221 1523.8,965.864 1526.1,888.348 1528.41,1092.64 1530.72,1116.65 1533.03,758.355 1535.34,1101.95 1537.64,1017.71 1539.95,977.401 1542.26,989.762 1544.57,893.993 1546.88,1015.09 1549.18,872.601 1551.49,933.525 1553.8,882.868 1556.11,1050.79 1558.41,828.237 1560.72,1114.99 1563.03,677.872 1565.34,909.887 1567.65,942.537 1569.95,740.482 1572.26,935.968 1574.57,1051.05 1576.88,935.436 1579.19,945.203 1581.49,912.409 1583.8,1102.14 1586.11,1060.67 1588.42,952.408 1590.73,932.219 1593.03,1092.99 1595.34,906.587 1597.65,960.495 1599.96,1016.29 1602.26,1029.28 1604.57,862.765 1606.88,928.616 1609.19,964.979 1611.5,910.334 1613.8,959.445 1616.11,777.853 1618.42,959.021 1620.73,955.252 1623.04,853.274 1625.34,909.621 1627.65,895.248 1629.96,924.047 1632.27,796.443 1634.58,973.537 1636.88,878.14 1639.19,959.966 1641.5,1036.53 1643.81,1039.09 1646.12,997.585 1648.42,960.27 1650.73,822.392 1653.04,772.845 1655.35,1009.35 1657.65,899.896 1659.96,978.582 1662.27,868.92 1664.58,890.877 1666.89,1140.47 1669.19,1000.87 1671.5,1063.27 1673.81,921.995 1676.12,954.017 1678.43,877.044 1680.73,1031.45 1683.04,1074.85 1685.35,1040.84 1687.66,1066.41 1689.97,1008.24 1692.27,1116.13 1694.58,862.797 1696.89,858.984 1699.2,889.927 1701.51,890.061 1703.81,927.432 1706.12,965.445 1708.43,848.499 1710.74,771.044 1713.04,853.192 1715.35,895.442 1717.66,890.237 1719.97,940.249 1722.28,931.37 1724.58,1005.29 1726.89,1032.75 1729.2,1040.96 1731.51,1003.95 1733.82,1044.21 1736.12,900.409 1738.43,1013.75 1740.74,943.382 1743.05,1149.17 1745.36,1058.13 1747.66,1023.6 1749.97,1041 1752.28,709.228 1754.59,905.46 1756.9,956.03 1759.2,963.59 1761.51,1045.87 1763.82,957.307 1766.13,1093.58 1768.43,943.117 1770.74,1126.66 1773.05,830.516 1775.36,932.177 1777.67,624.832 1779.97,965.006 1782.28,876.451 1784.59,921.636 1786.9,931.916 1789.21,1100.94 1791.51,971.152 1793.82,1052.13 1796.13,1014.3 1798.44,960.929 1800.75,882.992 1803.05,911.236 1805.36,959.832 1807.67,856.207 1809.98,993.816 1812.28,994.164 1814.59,766.09 1816.9,885.496 1819.21,994.888 1821.52,857.536 1823.82,1091.98 1826.13,906.949 1828.44,1046.36 1830.75,906.012 1833.06,888.789 1835.36,847.347 1837.67,889.232 1839.98,945.816 1842.29,1044.58 1844.6,920.13 1846.9,996.689 1849.21,871.261 1851.52,1004.37 1853.83,899.252 1856.14,999.009 1858.44,956.538 1860.75,1051.28 1863.06,865.144 1865.37,955.23 1867.67,1048.38 1869.98,833.067 1872.29,940.973 1874.6,913.412 1876.91,801.865 1879.21,1009.35 1881.52,971.721 1883.83,887.241 1886.14,973.201 1888.45,932.389 1890.75,912.64 1893.06,993.902 1895.37,1068.8 1897.68,1029.86 1899.99,1131.5 1902.29,971.487 1904.6,973.886 1906.91,857.794 1909.22,849.889 1911.53,975.866 1913.83,985.495 1916.14,841.135 1918.45,785.42 1920.76,890.726 1923.06,959.6 1925.37,1003.54 1927.68,953.404 1929.99,1056.88 1932.3,971.601 1934.6,997.838 1936.91,924.282 1939.22,873.823 1941.53,922.202 1943.84,882.068 1946.14,925.292 1948.45,927.703 1950.76,1046.27 1953.07,995.08 1955.38,960.197 1957.68,1001.84 1959.99,729.288 1962.3,929.584 1964.61,815.945 1966.91,842.211 1969.22,861.857 1971.53,835.47 1973.84,852.581 1976.15,863.365 1978.45,990.041 1980.76,964.598 1983.07,995.996 1985.38,881.646 1987.69,1015.72 1989.99,971.065 1992.3,984.151 1994.61,935.355 1996.92,825.779 1999.23,904.029 2001.53,1024.49 2003.84,864.618 2006.15,877.823 2008.46,954.753 2010.77,864.252 2013.07,1046.64 2015.38,1150.89 2017.69,1082.02 2020,1030.27 2022.3,966.395 2024.61,906.818 2026.92,982.203 2029.23,992.915 2031.54,1063.12 2033.84,1018.4 2036.15,879.201 2038.46,1057.2 2040.77,985.449 2043.08,961.64 2045.38,977.289 2047.69,1099.06 2050,937.619 2052.31,995.985 2054.62,1064.19 2056.92,1003.8 2059.23,900.124 2061.54,844.436 2063.85,817.904 2066.16,802.821 2068.46,1091.18 2070.77,943.081 2073.08,876.69 2075.39,941.275 2077.69,789.523 2080,923.782 2082.31,941.135 2084.62,1044.78 2086.93,978.113 2089.23,1073.1 2091.54,815.109 2093.85,988.736 2096.16,741.574 2098.47,723.423 2100.77,884.502 2103.08,923.543 2105.39,1035.33 2107.7,853.481 2110.01,1010.68 2112.31,1130.72 2114.62,973.157 2116.93,1075.32 2119.24,863.64 2121.55,923.594 2123.85,957.307 2126.16,841.107 2128.47,1198.11 2130.78,739.169 2133.08,926.731 2135.39,892.791 2137.7,1012.98 2140.01,1212.01 2142.32,847.874 2144.62,984.914 2146.93,1030.85 2149.24,864.017 2151.55,1074.61 2153.86,934.986 2156.16,988.948 2158.47,865.131 2160.78,909.248 2163.09,986.245 2165.4,861.617 2167.7,905.105 2170.01,874.76 2172.32,838.999 2174.63,717.479 2176.93,839.024 2179.24,1024.2 2181.55,932.838 2183.86,953.586 2186.17,981.786 2188.47,804.831 2190.78,991.086 2193.09,967.143 2195.4,968.177 2197.71,897.814 2200.01,869.868 2202.32,783.941 2204.63,1035.46 2206.94,1098.97 2209.25,908.819 2211.55,872.231 2213.86,868.917 2216.17,834.397 2218.48,836.979 2220.79,982.617 2223.09,877.054 2225.4,930.205 2227.71,928.7 2230.02,1031.94 2232.32,941.616 2234.63,877.223 2236.94,969.481 2239.25,878.337 2241.56,885.629 2243.86,934.875 2246.17,904.48 2248.48,843.736 2250.79,1038.67 2253.1,861.118 2255.4,930.833 2257.71,861.707 2260.02,926.054 2262.33,910.366 2264.64,1033.43 2266.94,857.863 2269.25,1151.32 2271.56,1051.53 2273.87,843.453 2276.18,874.965 2278.48,873.484 2280.79,927.267 2283.1,801.012 2285.41,958.812 2287.71,839.868 2290.02,888.727 2292.33,1029.13 2294.64,1118.47 2296.95,1021.54 2299.25,1003.72 2301.56,903.55 2303.87,1001.93 2306.18,916.835 2308.49,899.945 2310.79,797.899 2313.1,939.274 2315.41,892.877 2317.72,914.67 2320.03,857.948 2322.33,845.669 2324.64,1145.65 2326.95,915.132 2329.26,945.376 2331.56,944.187 2333.87,974.905 2336.18,823.485 2338.49,776.212 2340.8,765.001 2343.1,1095.97 2345.41,951.524 2347.72,862.036 2350.03,1103.38 2352.34,1005.57 2354.64,1103.36 2356.95,971.292 2359.26,837.016 2361.57,792.238 2363.88,913.336 2366.18,1066.1 2368.49,865.076 2370.8,965.461 2373.11,828.647 2375.42,779.023 2377.72,863.2 2380.03,845.938 2382.34,901.426 2384.65,917.062 2386.95,823.87 2389.26,907.509 2391.57,822.942 2393.88,889.03 2396.19,825.343 2398.49,1014.04 2400.8,938.471 2403.11,985.645 2405.42,945.143 2407.73,1162.73 2410.03,999.776 2412.34,883.366 2414.65,841.144 2416.96,742.613 2419.27,844.619 2421.57,1071.79 2423.88,934.266 2426.19,810.62 2428.5,775.935 2430.81,1008.42 2433.11,1035.83 2435.42,996.952 2437.73,972.99 2440.04,812.438 2442.34,1056.71 2444.65,812.954 2446.96,842.334 2449.27,906.099 2451.58,1041.26 2453.88,1049.71 2456.19,946.215 2458.5,979.939 2460.81,978.579 2463.12,728.166 2465.42,953.591 2467.73,1052.51 2470.04,863.436 2472.35,800.427 2474.66,1036.08 2476.96,1067.18 2479.27,888.432 2481.58,892.25 2483.89,964.491 2486.2,970.566 2488.5,864.814 2490.81,749.518 2493.12,1103.89 2495.43,849.029 2497.73,1094.53 2500.04,909.589 2502.35,896.205 2504.66,1000.33 2506.97,834.519 2509.27,937.8 2511.58,1045.73 2513.89,813.863 2516.2,982.754 2518.51,938.529 2520.81,1198.61 2523.12,974.269 2525.43,859.835 2527.74,1026.46 2530.05,1141.81 2532.35,961.71 2534.66,941.328 2536.97,1015.58 2539.28,1001.57 2541.58,1031.99 2543.89,950.337 2546.2,878.262 2548.51,914.642 2550.82,973.857 2553.12,1056.99 2555.43,1057.26 2557.74,1120.4 2560.05,1017.19 2562.36,975.634 2564.66,894.406 2566.97,943.528 2569.28,914.97 2571.59,1027.39 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,754.232 268.292,375.928 270.6,601.72 272.908,409.845 275.216,423.89 277.524,419.897 279.832,526.703 282.139,400.511 284.447,437.103 286.755,582.834 289.063,643.371 291.371,476.283 293.679,650.604 295.987,467.087 298.295,408.994 300.603,562.308 302.911,381.321 305.219,628.81 307.527,576.675 309.834,497.396 312.142,504.503 314.45,398.262 316.758,302.751 319.066,540.471 321.374,399.226 323.682,340.635 325.99,427.164 328.298,344.114 330.606,346.99 332.914,421.329 335.221,418.568 337.529,504.83 339.837,458.046 342.145,449.801 344.453,430.451 346.761,688.678 349.069,471.275 351.377,431.098 353.685,498.199 355.993,437.335 358.301,366 360.608,450.141 362.916,356.652 365.224,452.727 367.532,378.102 369.84,385.684 372.148,342.197 374.456,453.022 376.764,498.785 379.072,502.838 381.38,388.162 383.688,381.114 385.996,232.294 388.303,459.355 390.611,270.839 392.919,512.615 395.227,341.3 397.535,366.002 399.843,385.049 402.151,516.347 404.459,378.284 406.767,560.517 409.075,591.972 411.383,350.817 413.69,658.587 415.998,520.411 418.306,610.243 420.614,371.713 422.922,438.699 425.23,470.096 427.538,388.969 429.846,457.228 432.154,389.991 434.462,541.565 436.77,263.835 439.077,529.129 441.385,495.265 443.693,496.532 446.001,482.797 448.309,636.529 450.617,466.599 452.925,574.484 455.233,304.173 457.541,569.715 459.849,500.85 462.157,470.195 464.465,378.411 466.772,523.042 469.08,380.061 471.388,505.529 473.696,527.803 476.004,503.454 478.312,359.495 480.62,508.602 482.928,412.24 485.236,351.463 487.544,402.081 489.852,389.385 492.159,446.346 494.467,501.99 496.775,528.637 499.083,589.552 501.391,559.762 503.699,344.437 506.007,558.391 508.315,587.684 510.623,519.994 512.931,392.428 515.239,432.954 517.546,469.398 519.854,439.81 522.162,523.144 524.47,337.096 526.778,402.15 529.086,506.332 531.394,411.925 533.702,512.268 536.01,441.956 538.318,531.866 540.626,573.349 542.933,476.375 545.241,415.966 547.549,468.344 549.857,585.143 552.165,420.292 554.473,339.433 556.781,466.106 559.089,371.934 561.397,460.302 563.705,446.923 566.013,462.819 568.321,287.813 570.628,379.739 572.936,410.594 575.244,549.446 577.552,424.376 579.86,624.403 582.168,372.044 584.476,361.262 586.784,311.059 589.092,601.625 591.4,385.245 593.708,470.911 596.015,541.762 598.323,470.94 600.631,489.048 602.939,421.361 605.247,371.06 607.555,629.701 609.863,386.072 612.171,333.313 614.479,294.355 616.787,279.488 619.095,393.381 621.402,522.414 623.71,648.806 626.018,489.702 628.326,503.698 630.634,301.771 632.942,475.338 635.25,536.285 637.558,362.922 639.866,526.36 642.174,594.424 644.482,468.364 646.79,489.541 649.097,387.032 651.405,360.136 653.713,485.352 656.021,540.959 658.329,500.127 660.637,389.205 662.945,703.957 665.253,473.038 667.561,328.887 669.869,460.891 672.177,558.461 674.484,395.841 676.792,473.952 679.1,486.589 681.408,578.628 683.716,511.179 686.024,576.914 688.332,345.867 690.64,406.697 692.948,499.779 695.256,410.207 697.564,798.564 699.871,622.097 702.179,431.894 704.487,420.28 706.795,418.495 709.103,560.243 711.411,479.416 713.719,578.435 716.027,458.072 718.335,472.559 720.643,529.073 722.951,357.259 725.259,534.28 727.566,480.309 729.874,323.29 732.182,499.409 734.49,554.9 736.798,503.197 739.106,451.573 741.414,322.436 743.722,216.873 746.03,546.536 748.338,423.225 750.646,590.545 752.953,432.562 755.261,661.824 757.569,534.212 759.877,582.447 762.185,570.967 764.493,665.941 766.801,440.339 769.109,509.067 771.417,538.367 773.725,379.063 776.033,430.018 778.34,577.81 780.648,514.294 782.956,313.66 785.264,484.532 787.572,464.4 789.88,420.554 792.188,447.057 794.496,449.387 796.804,453.101 799.112,413.328 801.42,484.898 803.728,434.457 806.035,453.375 808.343,733.744 810.651,541.238 812.959,370.23 815.267,426.301 817.575,291.458 819.883,415.467 822.191,428.804 824.499,568.437 826.807,640.397 829.115,438.807 831.422,622.938 833.73,362.942 836.038,536.131 838.346,425.388 840.654,353.784 842.962,380.43 845.27,544.348 847.578,303.996 849.886,504.625 852.194,418.508 854.502,561.803 856.809,537.876 859.117,474.976 861.425,369.514 863.733,476.901 866.041,526.629 868.349,620.557 870.657,515.72 872.965,513.558 875.273,554.617 877.581,238.848 879.889,371.185 882.197,562.858 884.504,492.568 886.812,438.387 889.12,438.559 891.428,515.02 893.736,516.024 896.044,499.648 898.352,516.599 900.66,403.979 902.968,573.422 905.276,575.555 907.584,501.014 909.891,574.327 912.199,457.375 914.507,526.783 916.815,566.837 919.123,429.012 921.431,464.405 923.739,356.519 926.047,342.195 928.355,333.033 930.663,377.822 932.971,470.842 935.278,498.629 937.586,428.206 939.894,594.284 942.202,489.131 944.51,391.395 946.818,499.187 949.126,551.301 951.434,254.006 953.742,444.019 956.05,468.04 958.358,306.948 960.665,426.639 962.973,506.358 965.281,469.881 967.589,400.563 969.897,406.123 972.205,544.929 974.513,441.054 976.821,300.085 979.129,354.551 981.437,407.57 983.745,563.164 986.053,498.53 988.36,472.302 990.668,408.352 992.976,423.654 995.284,476.742 997.592,508.542 999.9,527.253 1002.21,456.443 1004.52,385.504 1006.82,596.6 1009.13,600.779 1011.44,375.94 1013.75,499.159 1016.06,682.92 1018.36,635.313 1020.67,487.571 1022.98,514.651 1025.29,575.42 1027.59,342.612 1029.9,240.626 1032.21,358.886 1034.52,516.558 1036.83,408.064 1039.13,529.322 1041.44,337.563 1043.75,529.83 1046.06,508.488 1048.37,351.233 1050.67,360.855 1052.98,499.403 1055.29,481.679 1057.6,369.102 1059.91,603.22 1062.21,471.258 1064.52,277.569 1066.83,455.933 1069.14,519.914 1071.45,357.123 1073.75,524.777 1076.06,432.554 1078.37,410.413 1080.68,360.972 1082.98,498.574 1085.29,361.081 1087.6,670.316 1089.91,478.721 1092.22,446.89 1094.52,500.864 1096.83,394.513 1099.14,607.296 1101.45,505.72 1103.76,378.638 1106.06,372.734 1108.37,481.357 1110.68,388.966 1112.99,350.999 1115.3,350.345 1117.6,306.029 1119.91,355.476 1122.22,541.592 1124.53,554.919 1126.84,613.084 1129.14,422.764 1131.45,487.053 1133.76,475.484 1136.07,555.365 1138.37,534.608 1140.68,640.455 1142.99,514.051 1145.3,762.527 1147.61,443.132 1149.91,657.214 1152.22,468.595 1154.53,338.007 1156.84,577.056 1159.15,520.953 1161.45,589.467 1163.76,501.897 1166.07,453.626 1168.38,544.255 1170.69,421.717 1172.99,677.976 1175.3,353.504 1177.61,481.118 1179.92,514.118 1182.23,557.63 1184.53,421.03 1186.84,385.416 1189.15,301.784 1191.46,276.633 1193.76,525.696 1196.07,348.545 1198.38,439.288 1200.69,341.48 1203,442.197 1205.3,511.079 1207.61,372.927 1209.92,581.049 1212.23,570.714 1214.54,545.49 1216.84,378.18 1219.15,522.306 1221.46,430.815 1223.77,371.24 1226.08,400.897 1228.38,481.245 1230.69,394.497 1233,493.665 1235.31,495.807 1237.61,449.283 1239.92,384.601 1242.23,384.471 1244.54,421.433 1246.85,330.681 1249.15,509.957 1251.46,510.185 1253.77,474.138 1256.08,685.624 1258.39,437.141 1260.69,808.346 1263,433.631 1265.31,495.447 1267.62,412.307 1269.93,325.132 1272.23,488.802 1274.54,619.199 1276.85,530.817 1279.16,437.003 1281.47,507.532 1283.77,358.022 1286.08,562.826 1288.39,503.423 1290.7,587.788 1293,351.217 1295.31,457.336 1297.62,406.621 1299.93,382.285 1302.24,258.356 1304.54,573.678 1306.85,453.078 1309.16,402.829 1311.47,583.443 1313.78,479.07 1316.08,662.155 1318.39,416.619 1320.7,332.027 1323.01,442.76 1325.32,440.888 1327.62,419.139 1329.93,447.786 1332.24,381.913 1334.55,609.661 1336.86,375.986 1339.16,585.866 1341.47,415.027 1343.78,506.477 1346.09,477.512 1348.39,560.069 1350.7,490.432 1353.01,495.915 1355.32,439.323 1357.63,427.785 1359.93,422.739 1362.24,392.861 1364.55,284.489 1366.86,409.567 1369.17,588.381 1371.47,371.559 1373.78,348.537 1376.09,539.692 1378.4,483.023 1380.71,491.57 1383.01,525.434 1385.32,503.709 1387.63,602.749 1389.94,444.568 1392.24,403.641 1394.55,352.589 1396.86,356.077 1399.17,474.2 1401.48,491.169 1403.78,467.023 1406.09,636.775 1408.4,242.888 1410.71,493.111 1413.02,532.122 1415.32,383.517 1417.63,417.045 1419.94,699.709 1422.25,319.592 1424.56,318.097 1426.86,498.299 1429.17,352.991 1431.48,575.73 1433.79,424.294 1436.1,532.763 1438.4,433.969 1440.71,430.586 1443.02,332.282 1445.33,446.816 1447.63,584.175 1449.94,543.204 1452.25,546.392 1454.56,343.644 1456.87,345.707 1459.17,457.113 1461.48,515.472 1463.79,466.41 1466.1,275.69 1468.41,302.034 1470.71,272.668 1473.02,721.307 1475.33,356.401 1477.64,623.205 1479.95,370.787 1482.25,445.295 1484.56,436.416 1486.87,361.356 1489.18,339.599 1491.49,425.687 1493.79,418.98 1496.1,436.779 1498.41,238.58 1500.72,516.399 1503.02,460.367 1505.33,392.576 1507.64,439.548 1509.95,465.862 1512.26,486.406 1514.56,522.4 1516.87,503.517 1519.18,515.864 1521.49,465.46 1523.8,453.764 1526.1,477.73 1528.41,338.823 1530.72,582.678 1533.03,473.332 1535.34,569.2 1537.64,652.425 1539.95,489.715 1542.26,424.035 1544.57,454.563 1546.88,310.83 1549.18,427.489 1551.49,432.416 1553.8,469.476 1556.11,334.303 1558.41,547.983 1560.72,328.818 1563.03,533.479 1565.34,522.013 1567.65,617.346 1569.95,340.843 1572.26,343.698 1574.57,430.286 1576.88,604.875 1579.19,382.778 1581.49,273.058 1583.8,411.416 1586.11,392.558 1588.42,615.702 1590.73,478.263 1593.03,436.543 1595.34,430.725 1597.65,361.725 1599.96,654.938 1602.26,470.205 1604.57,451.812 1606.88,471.291 1609.19,276.268 1611.5,480.062 1613.8,517.496 1616.11,278.492 1618.42,481.277 1620.73,622.803 1623.04,436.883 1625.34,475.933 1627.65,497.367 1629.96,299.55 1632.27,210.802 1634.58,393.418 1636.88,546.262 1639.19,381.612 1641.5,432.7 1643.81,411.082 1646.12,549.176 1648.42,341.457 1650.73,395.724 1653.04,412.776 1655.35,408.947 1657.65,432.945 1659.96,477.247 1662.27,482.084 1664.58,440.737 1666.89,416.554 1669.19,463.244 1671.5,333.265 1673.81,402.596 1676.12,409.386 1678.43,314.129 1680.73,518.881 1683.04,418.486 1685.35,625.512 1687.66,442.069 1689.97,431.943 1692.27,376.018 1694.58,333.248 1696.89,221.618 1699.2,470.631 1701.51,430.475 1703.81,496.373 1706.12,477.546 1708.43,562.852 1710.74,547.413 1713.04,572.05 1715.35,509.136 1717.66,482.159 1719.97,531.43 1722.28,379.041 1724.58,530.854 1726.89,593.739 1729.2,490.05 1731.51,496.773 1733.82,474.563 1736.12,526.889 1738.43,417.582 1740.74,304.371 1743.05,458.434 1745.36,541.192 1747.66,233.51 1749.97,486.899 1752.28,608.017 1754.59,482.365 1756.9,677.848 1759.2,360.736 1761.51,530.047 1763.82,452.503 1766.13,397.178 1768.43,478.772 1770.74,391.821 1773.05,461.365 1775.36,497.747 1777.67,527.829 1779.97,360.196 1782.28,544.889 1784.59,521.026 1786.9,331.274 1789.21,328.581 1791.51,410.945 1793.82,516.606 1796.13,476.179 1798.44,380.841 1800.75,468.86 1803.05,522.297 1805.36,495.587 1807.67,528.533 1809.98,549.967 1812.28,440.315 1814.59,451.53 1816.9,652.455 1819.21,360.926 1821.52,529.551 1823.82,227.159 1826.13,185.417 1828.44,538.967 1830.75,520.765 1833.06,614.791 1835.36,462.856 1837.67,526.816 1839.98,535.633 1842.29,592.345 1844.6,406.717 1846.9,362.566 1849.21,644.976 1851.52,604.248 1853.83,725.291 1856.14,517.844 1858.44,407.054 1860.75,469.428 1863.06,472.62 1865.37,546.45 1867.67,674.685 1869.98,383.379 1872.29,679.039 1874.6,385.943 1876.91,339.799 1879.21,397.901 1881.52,434.355 1883.83,342.298 1886.14,376.149 1888.45,492.65 1890.75,412.014 1893.06,633.666 1895.37,415.992 1897.68,421.496 1899.99,477.596 1902.29,439.616 1904.6,625.636 1906.91,446.159 1909.22,428.327 1911.53,535.81 1913.83,414.102 1916.14,412.205 1918.45,500.409 1920.76,523.386 1923.06,522.148 1925.37,414.99 1927.68,562.512 1929.99,448.45 1932.3,521.481 1934.6,488.802 1936.91,312.054 1939.22,96.8724 1941.53,501.102 1943.84,590.353 1946.14,440.789 1948.45,460.069 1950.76,481.225 1953.07,449.008 1955.38,560.989 1957.68,617.945 1959.99,389.09 1962.3,366.608 1964.61,456.892 1966.91,391.977 1969.22,389.251 1971.53,312.488 1973.84,680.612 1976.15,509.67 1978.45,552.164 1980.76,563.129 1983.07,374.198 1985.38,349.66 1987.69,449.253 1989.99,593.123 1992.3,533.162 1994.61,517.098 1996.92,404.392 1999.23,786.107 2001.53,536.845 2003.84,394.674 2006.15,621.355 2008.46,316.471 2010.77,435.524 2013.07,438.969 2015.38,380.346 2017.69,508.133 2020,525.803 2022.3,537.309 2024.61,564.669 2026.92,467.715 2029.23,557.27 2031.54,453.864 2033.84,477.504 2036.15,245.509 2038.46,459.306 2040.77,508.893 2043.08,376.781 2045.38,412.986 2047.69,325.904 2050,574.539 2052.31,487.329 2054.62,375.249 2056.92,547.339 2059.23,433.493 2061.54,502.803 2063.85,367.506 2066.16,414.814 2068.46,279.793 2070.77,521.907 2073.08,389.196 2075.39,505.352 2077.69,643.944 2080,477.918 2082.31,498.485 2084.62,371.705 2086.93,609.632 2089.23,459.575 2091.54,549.672 2093.85,368.507 2096.16,539.322 2098.47,573.439 2100.77,405.548 2103.08,560.295 2105.39,425.798 2107.7,441.899 2110.01,510.651 2112.31,409.964 2114.62,558.721 2116.93,389.474 2119.24,378.215 2121.55,469.269 2123.85,548.936 2126.16,496.037 2128.47,519.334 2130.78,469.413 2133.08,396.115 2135.39,527.686 2137.7,368.053 2140.01,469.922 2142.32,553.177 2144.62,501.394 2146.93,524.214 2149.24,434.896 2151.55,301.894 2153.86,499.551 2156.16,547.28 2158.47,399.722 2160.78,409.439 2163.09,580.913 2165.4,502.41 2167.7,486.589 2170.01,436.635 2172.32,561.4 2174.63,562.47 2176.93,425.311 2179.24,575.233 2181.55,313.55 2183.86,412.041 2186.17,647.38 2188.47,461.75 2190.78,580.206 2193.09,375.346 2195.4,486.83 2197.71,412.155 2200.01,376.304 2202.32,602.245 2204.63,436.04 2206.94,394.042 2209.25,671.86 2211.55,307.485 2213.86,536.006 2216.17,328.276 2218.48,581.66 2220.79,593.811 2223.09,505.681 2225.4,598.379 2227.71,359.752 2230.02,380.426 2232.32,535.315 2234.63,501.436 2236.94,689.88 2239.25,223.611 2241.56,333.347 2243.86,478.829 2246.17,643.373 2248.48,515.19 2250.79,248.679 2253.1,413.184 2255.4,636.315 2257.71,299.033 2260.02,384.931 2262.33,365.403 2264.64,229.882 2266.94,530.114 2269.25,391.787 2271.56,340.816 2273.87,437.09 2276.18,486.787 2278.48,592.721 2280.79,393.91 2283.1,371.419 2285.41,474.454 2287.71,378.86 2290.02,624.253 2292.33,444.669 2294.64,544.357 2296.95,540.565 2299.25,328.438 2301.56,539.356 2303.87,488.867 2306.18,459.019 2308.49,491.983 2310.79,424.489 2313.1,653.291 2315.41,368.933 2317.72,561.085 2320.03,458.672 2322.33,281.921 2324.64,602.733 2326.95,502.783 2329.26,567.399 2331.56,610.528 2333.87,365.854 2336.18,649.165 2338.49,227.532 2340.8,312.958 2343.1,425.498 2345.41,530.073 2347.72,505.893 2350.03,328.777 2352.34,378.435 2354.64,453.249 2356.95,530.28 2359.26,527.065 2361.57,725.43 2363.88,369.676 2366.18,502.47 2368.49,488.971 2370.8,467.075 2373.11,558.189 2375.42,485.254 2377.72,476.971 2380.03,652.646 2382.34,513.89 2384.65,455.234 2386.95,368.694 2389.26,407.858 2391.57,461.528 2393.88,407.44 2396.19,489.359 2398.49,346.102 2400.8,273.738 2403.11,436.85 2405.42,581.146 2407.73,477.206 2410.03,435.458 2412.34,503.515 2414.65,331.224 2416.96,507.526 2419.27,592.327 2421.57,483.95 2423.88,480.992 2426.19,423.567 2428.5,319.444 2430.81,394.946 2433.11,367.716 2435.42,515.056 2437.73,435.879 2440.04,382.807 2442.34,492.63 2444.65,390.182 2446.96,279.092 2449.27,486.082 2451.58,485.913 2453.88,486.091 2456.19,337.449 2458.5,243.885 2460.81,399.753 2463.12,387.756 2465.42,583.945 2467.73,642.873 2470.04,314.209 2472.35,448.864 2474.66,394.866 2476.96,376.834 2479.27,592.956 2481.58,636.845 2483.89,479.538 2486.2,426.272 2488.5,427.16 2490.81,541.549 2493.12,425.995 2495.43,409.622 2497.73,397.255 2500.04,406.299 2502.35,465.799 2504.66,451.151 2506.97,622.547 2509.27,444.628 2511.58,480.665 2513.89,646.148 2516.2,474.948 2518.51,626.342 2520.81,473.179 2523.12,203.466 2525.43,418.46 2527.74,494.89 2530.05,484.635 2532.35,346.773 2534.66,448.956 2536.97,561.434 2539.28,470.891 2541.58,626.453 2543.89,500.85 2546.2,474.787 2548.51,532.923 2550.82,425.396 2553.12,434.876 2555.43,684.532 2557.74,391.032 2560.05,376.138 2562.36,555.309 2564.66,503.047 2566.97,459.999 2569.28,444.483 2571.59,415.288 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -3.48618  -5.66018  -6.31849  -6.16103  …  -2.92955   -2.56659   -4.72418
  1.12129   1.06448  -1.17417   1.16893      0.544423  -0.372724  -0.0202177
  1.48779   3.43389   3.00565   1.97854      6.86114    4.85113    4.60697

[:, :, 2] =
 0.209763  -1.96794  -3.98182  -4.79227  …  -5.02114  -5.771    -4.33916
 0.516662  -1.52901  -2.67564  -1.52003      1.74238  -1.47483  -1.86676
 1.52943    2.935     3.71334   5.41937      4.12456   4.28464   4.09806

[:, :, 3] =
 -2.58164   -3.89495   -3.83318   -3.15266  …  -4.06689   -4.54254   -5.06992
 -0.533912  -0.579298   0.462948   2.75696     -0.817647   0.429506   1.04328
  1.60262    1.46091    1.16747    4.29109      6.23895    4.47139    4.12751

[:, :, 4] =
 -4.23898   -3.22155  -5.67852   -6.15422   …  -5.21894  -4.86368   -4.65226
  0.335117   1.16867   0.457564  -0.418685      1.50884   0.975302   1.62903
  0.977589   3.31465   3.03654    3.65036       5.25019   4.96664    6.49457</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -5.02014     1.0057
  0.00639232  1.005
  4.99385     1.00515</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.5 seconds
Compute duration  = 2.5 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -4.9938    0.9993    0.0173   3344.3975   4923.1598    1.0000   ⋯
        x[2]    0.0013    1.0096    0.0180   3156.5649   5199.8120    0.9999   ⋯
        x[3]    5.0298    0.9974    0.0175   3266.2874   5268.1747    1.0003   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -6.9274   -5.6781   -5.0037   -4.3294   -2.9778
        x[2]   -1.9907   -0.6613    0.0089    0.6798    1.9667
        x[3]    3.0877    4.3565    5.0302    5.7111    6.9821</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.46 seconds
Compute duration  = 1.46 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.4969    0.1883    0.0028   4518.9512   5694.0982    1.0000   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1476    0.3557    0.4946    0.6411    0.8497</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.24 seconds
Compute duration  = 0.24 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

           x    0.4680    0.1816    0.0259    42.9580        NaN    1.0490     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.2058    0.3044    0.4742    0.6122    0.7941</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}(-0.0921707298716482,1.0,0.0), "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}(-0.0921707298716482,1.0,0.0):
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/nmUhn/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/compiler.jl:579 [inlined]
  [7] demo(__model__::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, __varinfo__::DynamicPPL.ThreadSafeVarInfo{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}}, ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Base.RefValue{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, __context__::DynamicPPL.DefaultContext)
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:593
  [8] _evaluate!!
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:973 [inlined]
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}}, ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, context::DynamicPPL.DefaultContext)
    @ DynamicPPL ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:962
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:892 [inlined]
 [11] logdensity
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/logdensityfunction.jl:140 [inlined]
 [12] Fix1
    @ ./operators.jl:1118 [inlined]
 [13] vector_mode_dual_eval!(f::Base.Fix1{typeof(LogDensityProblems.logdensity), LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}}, cfg::ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}, x::Vector{Float64})
    @ ForwardDiff ~/.julia/packages/ForwardDiff/PcZ48/src/apiutils.jl:24
 [14] vector_mode_gradient!(result::DiffResults.MutableDiffResult{1, Float64, Tuple{Vector{Float64}}}, f::Base.Fix1{typeof(LogDensityProblems.logdensity), LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}}, x::Vector{Float64}, cfg::ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}})
    @ ForwardDiff ~/.julia/packages/ForwardDiff/PcZ48/src/gradient.jl:96
 [15] gradient!
    @ ~/.julia/packages/ForwardDiff/PcZ48/src/gradient.jl:37 [inlined]
 [16] gradient!
    @ ~/.julia/packages/ForwardDiff/PcZ48/src/gradient.jl:35 [inlined]
 [17] logdensity_and_gradient
    @ ~/.julia/packages/LogDensityProblemsAD/rBlLq/ext/LogDensityProblemsADForwardDiffExt.jl:118 [inlined]
 [18] leapfrog_step(model::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, x::Vector{Float64}, p::Vector{Float64}, ϵ::Int64, M::UniformScaling{Bool})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:369
 [19] step(rng::TaskLocalRNG, model_wrapper::AbstractMCMC.LogDensityModel{LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}}, sampler::MALA{Int64, UniformScaling{Bool}}, state::MALAState{Vector{Float64}}; kwargs::@Kwargs{})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:334
 [20] step
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:316 [inlined]
 [21] #step#107
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:155 [inlined]
 [22] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, state::Turing.Inference.TuringState{MALAState{Vector{Float64}}, LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:144
 [23] macro expansion
    @ ~/.julia/packages/AbstractMCMC/YrmkI/src/sample.jl:176 [inlined]
 [24] macro expansion
    @ ~/.julia/packages/AbstractMCMC/YrmkI/src/logging.jl:16 [inlined]
 [25] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/YrmkI/src/sample.jl:120
 [26] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/MjWTB/src/sampler.jl:93
 [27] sample
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/sampler.jl:83 [inlined]
 [28] #sample#4
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:276 [inlined]
 [29] sample
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:267 [inlined]
 [30] #sample#3
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:264 [inlined]
 [31] top-level scope
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:595</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.54 seconds
Compute duration  = 0.54 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    7.4010    0.0000       NaN        NaN        NaN       NaN     ⋯
           x    1.1084    0.0000       NaN        NaN        NaN       NaN     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    7.4010    7.4010    7.4010    7.4010    7.4010
           x    1.1084    1.1084    1.1084    1.1084    1.1084</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.91 seconds
Compute duration  = 2.91 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8526    0.5810    0.0380   206.5096   222.7394    1.0074     ⋯
           x    0.0651    0.9773    0.0865   192.5317    54.2564    1.0093     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1431    0.3988    0.7331    1.1545    2.4433
           x   -1.8285   -0.3727    0.0224    0.4541    2.4801</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>