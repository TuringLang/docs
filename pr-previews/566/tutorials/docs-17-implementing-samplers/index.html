<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.1">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../tutorials/docs-07-for-developers-variational-inference/index.html" rel="prev">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2bb0ec5e928ee8c40b12725cb7836c35.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-31d8df3fb4b3ebd213a509f950828e75.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-5a965d03c83b9a52a3a52c83f34fadca.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-03f81fcb35c69179f531195cac5ac726.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/docs-00-getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/00-introduction/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.35" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.35</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.35">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Users</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-00-getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-12-using-turing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Core Functionality</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Usage Tips</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-10-using-turing-autodiff/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-custom-distribution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Custom Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-probability-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Querying Model Probabilities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-modifying-logprob/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modifying the Log Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-generated-quantities/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generated Quantities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-13-using-turing-performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-15-using-turing-sampler-viz/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-11-using-turing-dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-16-using-turing-external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/00-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction: Coin Flipping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/01-gaussian-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/02-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/03-bayesian-neural-network/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/04-hidden-markov-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/05-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/06-infinite-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/07-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/08-multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/09-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/10-bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/11-probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/13-seasonal-time-series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/15-gaussian-processes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Gaussian Processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/12-gplvm/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Contributing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-01-contributing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to Contribute</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">DynamicPPL in Depth</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/dev-model-manual/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manually Defining a Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-05-for-developers-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/14-minituring/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/16-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Inference (note: outdated)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-06-for-developers-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-33.788081732949045</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-33.788081732949045</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([0.0, 0.0, 0.0]), MALAState{Vector{Float64}}([0.0, 0.0, 0.0]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -1.64304   -2.48843   -3.823     -4.5847   …  -5.2249   -3.94493   -4.67441
 -0.750586  -0.462922   0.324566  -1.00771      0.87075  -0.872139   0.825035
  2.08136    4.00633    2.80497    2.73937      4.3929    5.83291    6.72137</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -5.02145    0.981041
 -0.0051146  1.00566
  5.00184    0.993848</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip140">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip140)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip141">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip140)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip142">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1699.65 2640.76,1699.65 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1455.04 2640.76,1455.04 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1210.43 2640.76,1210.43 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,965.817 2640.76,965.817 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,721.207 2640.76,721.207 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,476.597 2640.76,476.597 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,231.987 2640.76,231.987 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip140)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1699.65 215.714,1699.65 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1455.04 215.714,1455.04 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1210.43 215.714,1210.43 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,965.817 215.714,965.817 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,721.207 215.714,721.207 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,476.597 215.714,476.597 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,231.987 215.714,231.987 "></polyline>
<path clip-path="url(#clip140)" d="M50.5475 1700.1 L80.2233 1700.1 L80.2233 1704.03 L50.5475 1704.03 L50.5475 1700.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M89.1352 1682.37 L111.357 1682.37 L111.357 1684.36 L98.8111 1716.93 L93.9269 1716.93 L105.732 1686.3 L89.1352 1686.3 L89.1352 1682.37 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M120.478 1711.05 L125.362 1711.05 L125.362 1716.93 L120.478 1716.93 L120.478 1711.05 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M135.593 1682.37 L153.95 1682.37 L153.95 1686.3 L139.876 1686.3 L139.876 1694.77 Q140.894 1694.43 141.913 1694.27 Q142.931 1694.08 143.95 1694.08 Q149.737 1694.08 153.116 1697.25 Q156.496 1700.42 156.496 1705.84 Q156.496 1711.42 153.024 1714.52 Q149.552 1717.6 143.232 1717.6 Q141.056 1717.6 138.788 1717.23 Q136.542 1716.86 134.135 1716.12 L134.135 1711.42 Q136.218 1712.55 138.441 1713.11 Q140.663 1713.66 143.14 1713.66 Q147.144 1713.66 149.482 1711.56 Q151.82 1709.45 151.82 1705.84 Q151.82 1702.23 149.482 1700.12 Q147.144 1698.02 143.14 1698.02 Q141.265 1698.02 139.39 1698.43 Q137.538 1698.85 135.593 1699.73 L135.593 1682.37 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M49.5521 1455.49 L79.2279 1455.49 L79.2279 1459.42 L49.5521 1459.42 L49.5521 1455.49 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M89.3667 1437.76 L107.723 1437.76 L107.723 1441.69 L93.6491 1441.69 L93.6491 1450.16 Q94.6676 1449.82 95.6861 1449.66 Q96.7047 1449.47 97.7232 1449.47 Q103.51 1449.47 106.89 1452.64 Q110.269 1455.81 110.269 1461.23 Q110.269 1466.81 106.797 1469.91 Q103.325 1472.99 97.0056 1472.99 Q94.8297 1472.99 92.5612 1472.62 Q90.3158 1472.25 87.9084 1471.51 L87.9084 1466.81 Q89.9917 1467.94 92.2139 1468.5 Q94.4361 1469.05 96.913 1469.05 Q100.918 1469.05 103.256 1466.95 Q105.593 1464.84 105.593 1461.23 Q105.593 1457.62 103.256 1455.51 Q100.918 1453.41 96.913 1453.41 Q95.038 1453.41 93.163 1453.82 Q91.3112 1454.24 89.3667 1455.12 L89.3667 1437.76 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M119.482 1466.44 L124.367 1466.44 L124.367 1472.32 L119.482 1472.32 L119.482 1466.44 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M144.552 1440.84 Q140.941 1440.84 139.112 1444.4 Q137.306 1447.94 137.306 1455.07 Q137.306 1462.18 139.112 1465.74 Q140.941 1469.28 144.552 1469.28 Q148.186 1469.28 149.991 1465.74 Q151.82 1462.18 151.82 1455.07 Q151.82 1447.94 149.991 1444.4 Q148.186 1440.84 144.552 1440.84 M144.552 1437.13 Q150.362 1437.13 153.417 1441.74 Q156.496 1446.32 156.496 1455.07 Q156.496 1463.8 153.417 1468.4 Q150.362 1472.99 144.552 1472.99 Q138.741 1472.99 135.663 1468.4 Q132.607 1463.8 132.607 1455.07 Q132.607 1446.32 135.663 1441.74 Q138.741 1437.13 144.552 1437.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M50.5475 1210.88 L80.2233 1210.88 L80.2233 1214.81 L50.5475 1214.81 L50.5475 1210.88 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M94.3436 1223.77 L110.663 1223.77 L110.663 1227.71 L88.7186 1227.71 L88.7186 1223.77 Q91.3806 1221.02 95.9639 1216.39 Q100.57 1211.73 101.751 1210.39 Q103.996 1207.87 104.876 1206.13 Q105.779 1204.37 105.779 1202.68 Q105.779 1199.93 103.834 1198.19 Q101.913 1196.46 98.8111 1196.46 Q96.6121 1196.46 94.1584 1197.22 Q91.7278 1197.98 88.9501 1199.54 L88.9501 1194.81 Q91.7741 1193.68 94.2278 1193.1 Q96.6815 1192.52 98.7185 1192.52 Q104.089 1192.52 107.283 1195.21 Q110.478 1197.89 110.478 1202.38 Q110.478 1204.51 109.668 1206.43 Q108.881 1208.33 106.774 1210.92 Q106.195 1211.6 103.094 1214.81 Q99.9917 1218.01 94.3436 1223.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M120.478 1221.83 L125.362 1221.83 L125.362 1227.71 L120.478 1227.71 L120.478 1221.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M135.593 1193.15 L153.95 1193.15 L153.95 1197.08 L139.876 1197.08 L139.876 1205.55 Q140.894 1205.21 141.913 1205.05 Q142.931 1204.86 143.95 1204.86 Q149.737 1204.86 153.116 1208.03 Q156.496 1211.2 156.496 1216.62 Q156.496 1222.2 153.024 1225.3 Q149.552 1228.38 143.232 1228.38 Q141.056 1228.38 138.788 1228.01 Q136.542 1227.64 134.135 1226.9 L134.135 1222.2 Q136.218 1223.33 138.441 1223.89 Q140.663 1224.44 143.14 1224.44 Q147.144 1224.44 149.482 1222.34 Q151.82 1220.23 151.82 1216.62 Q151.82 1213.01 149.482 1210.9 Q147.144 1208.79 143.14 1208.79 Q141.265 1208.79 139.39 1209.21 Q137.538 1209.63 135.593 1210.51 L135.593 1193.15 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M99.3204 951.616 Q95.7093 951.616 93.8806 955.18 Q92.075 958.722 92.075 965.852 Q92.075 972.958 93.8806 976.523 Q95.7093 980.064 99.3204 980.064 Q102.955 980.064 104.76 976.523 Q106.589 972.958 106.589 965.852 Q106.589 958.722 104.76 955.18 Q102.955 951.616 99.3204 951.616 M99.3204 947.912 Q105.131 947.912 108.186 952.518 Q111.265 957.102 111.265 965.852 Q111.265 974.578 108.186 979.185 Q105.131 983.768 99.3204 983.768 Q93.5102 983.768 90.4315 979.185 Q87.376 974.578 87.376 965.852 Q87.376 957.102 90.4315 952.518 Q93.5102 947.912 99.3204 947.912 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M119.482 977.217 L124.367 977.217 L124.367 983.097 L119.482 983.097 L119.482 977.217 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M144.552 951.616 Q140.941 951.616 139.112 955.18 Q137.306 958.722 137.306 965.852 Q137.306 972.958 139.112 976.523 Q140.941 980.064 144.552 980.064 Q148.186 980.064 149.991 976.523 Q151.82 972.958 151.82 965.852 Q151.82 958.722 149.991 955.18 Q148.186 951.616 144.552 951.616 M144.552 947.912 Q150.362 947.912 153.417 952.518 Q156.496 957.102 156.496 965.852 Q156.496 974.578 153.417 979.185 Q150.362 983.768 144.552 983.768 Q138.741 983.768 135.663 979.185 Q132.607 974.578 132.607 965.852 Q132.607 957.102 135.663 952.518 Q138.741 947.912 144.552 947.912 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M94.3436 734.552 L110.663 734.552 L110.663 738.487 L88.7186 738.487 L88.7186 734.552 Q91.3806 731.797 95.9639 727.167 Q100.57 722.515 101.751 721.172 Q103.996 718.649 104.876 716.913 Q105.779 715.154 105.779 713.464 Q105.779 710.709 103.834 708.973 Q101.913 707.237 98.8111 707.237 Q96.6121 707.237 94.1584 708.001 Q91.7278 708.765 88.9501 710.316 L88.9501 705.594 Q91.7741 704.459 94.2278 703.881 Q96.6815 703.302 98.7185 703.302 Q104.089 703.302 107.283 705.987 Q110.478 708.672 110.478 713.163 Q110.478 715.293 109.668 717.214 Q108.881 719.112 106.774 721.705 Q106.195 722.376 103.094 725.593 Q99.9917 728.788 94.3436 734.552 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M120.478 732.607 L125.362 732.607 L125.362 738.487 L120.478 738.487 L120.478 732.607 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M135.593 703.927 L153.95 703.927 L153.95 707.862 L139.876 707.862 L139.876 716.334 Q140.894 715.987 141.913 715.825 Q142.931 715.64 143.95 715.64 Q149.737 715.64 153.116 718.811 Q156.496 721.982 156.496 727.399 Q156.496 732.978 153.024 736.079 Q149.552 739.158 143.232 739.158 Q141.056 739.158 138.788 738.788 Q136.542 738.417 134.135 737.677 L134.135 732.978 Q136.218 734.112 138.441 734.667 Q140.663 735.223 143.14 735.223 Q147.144 735.223 149.482 733.117 Q151.82 731.01 151.82 727.399 Q151.82 723.788 149.482 721.681 Q147.144 719.575 143.14 719.575 Q141.265 719.575 139.39 719.992 Q137.538 720.408 135.593 721.288 L135.593 703.927 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M89.3667 459.317 L107.723 459.317 L107.723 463.252 L93.6491 463.252 L93.6491 471.724 Q94.6676 471.377 95.6861 471.215 Q96.7047 471.03 97.7232 471.03 Q103.51 471.03 106.89 474.201 Q110.269 477.372 110.269 482.789 Q110.269 488.368 106.797 491.469 Q103.325 494.548 97.0056 494.548 Q94.8297 494.548 92.5612 494.178 Q90.3158 493.807 87.9084 493.067 L87.9084 488.368 Q89.9917 489.502 92.2139 490.057 Q94.4361 490.613 96.913 490.613 Q100.918 490.613 103.256 488.506 Q105.593 486.4 105.593 482.789 Q105.593 479.178 103.256 477.071 Q100.918 474.965 96.913 474.965 Q95.038 474.965 93.163 475.382 Q91.3112 475.798 89.3667 476.678 L89.3667 459.317 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M119.482 487.997 L124.367 487.997 L124.367 493.877 L119.482 493.877 L119.482 487.997 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M144.552 462.395 Q140.941 462.395 139.112 465.96 Q137.306 469.502 137.306 476.632 Q137.306 483.738 139.112 487.303 Q140.941 490.844 144.552 490.844 Q148.186 490.844 149.991 487.303 Q151.82 483.738 151.82 476.632 Q151.82 469.502 149.991 465.96 Q148.186 462.395 144.552 462.395 M144.552 458.692 Q150.362 458.692 153.417 463.298 Q156.496 467.882 156.496 476.632 Q156.496 485.358 153.417 489.965 Q150.362 494.548 144.552 494.548 Q138.741 494.548 135.663 489.965 Q132.607 485.358 132.607 476.632 Q132.607 467.882 135.663 463.298 Q138.741 458.692 144.552 458.692 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M89.1352 214.707 L111.357 214.707 L111.357 216.698 L98.8111 249.267 L93.9269 249.267 L105.732 218.642 L89.1352 218.642 L89.1352 214.707 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M120.478 243.387 L125.362 243.387 L125.362 249.267 L120.478 249.267 L120.478 243.387 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M135.593 214.707 L153.95 214.707 L153.95 218.642 L139.876 218.642 L139.876 227.114 Q140.894 226.767 141.913 226.605 Q142.931 226.42 143.95 226.42 Q149.737 226.42 153.116 229.591 Q156.496 232.762 156.496 238.179 Q156.496 243.758 153.024 246.859 Q149.552 249.938 143.232 249.938 Q141.056 249.938 138.788 249.568 Q136.542 249.197 134.135 248.457 L134.135 243.758 Q136.218 244.892 138.441 245.447 Q140.663 246.003 143.14 246.003 Q147.144 246.003 149.482 243.896 Q151.82 241.79 151.82 238.179 Q151.82 234.568 149.482 232.461 Q147.144 230.355 143.14 230.355 Q141.265 230.355 139.39 230.772 Q137.538 231.188 135.593 232.068 L135.593 214.707 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip142)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1126.58 268.292,1529.31 270.6,1324.88 272.908,1578.18 275.216,1640.62 277.524,1503.12 279.832,1568.63 282.139,1484.97 284.447,1425.99 286.755,1457.41 289.063,1510.5 291.371,1605.86 293.679,1454.78 295.987,1575.67 298.295,1444.84 300.603,1429.64 302.911,1441.63 305.219,1278.83 307.527,1357.82 309.834,1317.52 312.142,1522.04 314.45,1381.52 316.758,1304.51 319.066,1366.16 321.374,1566.41 323.682,1401.76 325.99,1413.44 328.298,1512.65 330.606,1487.86 332.914,1481.11 335.221,1561.94 337.529,1361.57 339.837,1311.51 342.145,1419.15 344.453,1376.21 346.761,1336.94 349.069,1540.21 351.377,1621.65 353.685,1488.84 355.993,1446.58 358.301,1407.01 360.608,1362.52 362.916,1414.6 365.224,1390.88 367.532,1489.39 369.84,1284.49 372.148,1459.39 374.456,1414.12 376.764,1477.49 379.072,1486.98 381.38,1331.84 383.688,1417.99 385.996,1381.85 388.303,1577.22 390.611,1458.49 392.919,1559.32 395.227,1454.06 397.535,1351.18 399.843,1544.61 402.151,1557.8 404.459,1654.17 406.767,1361.52 409.075,1485.52 411.383,1310.36 413.69,1434.42 415.998,1427.69 418.306,1413.79 420.614,1390.09 422.922,1368.22 425.23,1543.24 427.538,1470.7 429.846,1363.03 432.154,1311.77 434.462,1516.92 436.77,1629.51 439.077,1428.39 441.385,1526.75 443.693,1469.6 446.001,1460.73 448.309,1375.17 450.617,1464.96 452.925,1406.81 455.233,1410.52 457.541,1574.7 459.849,1494.55 462.157,1460.42 464.465,1644.74 466.772,1373.15 469.08,1445.02 471.388,1479.07 473.696,1467.25 476.004,1458.13 478.312,1432.16 480.62,1515.9 482.928,1506 485.236,1555.26 487.544,1373.63 489.852,1464 492.159,1499.46 494.467,1370.64 496.775,1597.53 499.083,1407.39 501.391,1425.08 503.699,1308.36 506.007,1435.98 508.315,1454.19 510.623,1548.53 512.931,1454.16 515.239,1545.6 517.546,1495.56 519.854,1443.46 522.162,1392.74 524.47,1408.85 526.778,1336.16 529.086,1342.5 531.394,1346.24 533.702,1383.21 536.01,1482.06 538.318,1537.63 540.626,1301.61 542.933,1401.36 545.241,1488.57 547.549,1547.28 549.857,1509.47 552.165,1318.65 554.473,1533.05 556.781,1418.54 559.089,1443.43 561.397,1317.8 563.705,1402.76 566.013,1504.81 568.321,1500.72 570.628,1551.43 572.936,1528.22 575.244,1496.12 577.552,1491.87 579.86,1694.18 582.168,1520.33 584.476,1299.98 586.784,1509.49 589.092,1461.67 591.4,1466.21 593.708,1665.79 596.015,1502.03 598.323,1523.07 600.631,1534.01 602.939,1501.01 605.247,1368.99 607.555,1492.36 609.863,1536.41 612.171,1455.96 614.479,1374.33 616.787,1431.44 619.095,1581.87 621.402,1545.99 623.71,1512.61 626.018,1395.78 628.326,1495.97 630.634,1488.54 632.942,1390.86 635.25,1377.61 637.558,1674.59 639.866,1541.54 642.174,1469.71 644.482,1397.35 646.79,1229.02 649.097,1519.68 651.405,1349.27 653.713,1509.16 656.021,1566.2 658.329,1593.35 660.637,1486.93 662.945,1402.43 665.253,1563.07 667.561,1428.64 669.869,1470.25 672.177,1456.38 674.484,1513.82 676.792,1345.72 679.1,1520.33 681.408,1530.47 683.716,1528.31 686.024,1507.2 688.332,1564.35 690.64,1304.8 692.948,1416.29 695.256,1600.57 697.564,1372.18 699.871,1751.15 702.179,1381.25 704.487,1542.51 706.795,1525.01 709.103,1491.81 711.411,1484.35 713.719,1549.18 716.027,1365.34 718.335,1442.06 720.643,1470.22 722.951,1364.69 725.259,1372.54 727.566,1444.38 729.874,1572.3 732.182,1339.84 734.49,1371.79 736.798,1408.16 739.106,1475.24 741.414,1439.56 743.722,1603.52 746.03,1439.54 748.338,1391.19 750.646,1565.98 752.953,1407.06 755.261,1552.11 757.569,1482.79 759.877,1361.86 762.185,1329.73 764.493,1478.11 766.801,1612.08 769.109,1370 771.417,1452.11 773.725,1632.52 776.033,1497.47 778.34,1226.35 780.648,1424.8 782.956,1274.86 785.264,1486.54 787.572,1460.15 789.88,1432.42 792.188,1367.04 794.496,1443.47 796.804,1467.92 799.112,1488.21 801.42,1514.67 803.728,1432.41 806.035,1430.73 808.343,1454.49 810.651,1363.68 812.959,1423.32 815.267,1443.34 817.575,1548.22 819.883,1662.33 822.191,1299.03 824.499,1478.16 826.807,1540.91 829.115,1449.77 831.422,1493.06 833.73,1490.6 836.038,1224.13 838.346,1376.33 840.654,1489.28 842.962,1480.07 845.27,1548.46 847.578,1410.27 849.886,1568.42 852.194,1411.96 854.502,1656.02 856.809,1449.74 859.117,1425.92 861.425,1367.11 863.733,1356.96 866.041,1359.62 868.349,1529.7 870.657,1298.13 872.965,1416.62 875.273,1398.23 877.581,1432.51 879.889,1471.89 882.197,1436.36 884.504,1473.37 886.812,1410.08 889.12,1305.62 891.428,1519.9 893.736,1493.52 896.044,1552.91 898.352,1371.57 900.66,1369.64 902.968,1540.52 905.276,1454.66 907.584,1354.77 909.891,1607.21 912.199,1499.55 914.507,1387.95 916.815,1424.66 919.123,1489.69 921.431,1386.58 923.739,1208.19 926.047,1386.95 928.355,1390.21 930.663,1528.88 932.971,1418.24 935.278,1317.6 937.586,1482.64 939.894,1342.35 942.202,1341.3 944.51,1360.79 946.818,1473.08 949.126,1271.53 951.434,1436.75 953.742,1368.39 956.05,1323.38 958.358,1394.91 960.665,1588.64 962.973,1507.61 965.281,1457.97 967.589,1678.18 969.897,1430.33 972.205,1369.71 974.513,1404.51 976.821,1474.22 979.129,1243.22 981.437,1591.31 983.745,1293.71 986.053,1653.2 988.36,1442.92 990.668,1434.18 992.976,1423.7 995.284,1488.64 997.592,1473.25 999.9,1206.53 1002.21,1322.45 1004.52,1287.28 1006.82,1281.22 1009.13,1536.49 1011.44,1284.97 1013.75,1359.54 1016.06,1465.22 1018.36,1444.53 1020.67,1615.22 1022.98,1364.09 1025.29,1535.48 1027.59,1586.93 1029.9,1623.73 1032.21,1499.3 1034.52,1546.27 1036.83,1367.74 1039.13,1434.53 1041.44,1593.45 1043.75,1579.62 1046.06,1429.32 1048.37,1428.41 1050.67,1400.76 1052.98,1542.33 1055.29,1473.02 1057.6,1614.46 1059.91,1585.14 1062.21,1456.95 1064.52,1506.49 1066.83,1451.93 1069.14,1420.68 1071.45,1542.59 1073.75,1565.13 1076.06,1521.2 1078.37,1442.62 1080.68,1353.56 1082.98,1503.77 1085.29,1189.4 1087.6,1358.69 1089.91,1533.36 1092.22,1494.67 1094.52,1449.49 1096.83,1437.47 1099.14,1541.39 1101.45,1484.33 1103.76,1406.5 1106.06,1450.66 1108.37,1456.7 1110.68,1485.06 1112.99,1268.96 1115.3,1383.67 1117.6,1516.57 1119.91,1441.66 1122.22,1540.35 1124.53,1408.21 1126.84,1377.36 1129.14,1424.59 1131.45,1548.27 1133.76,1478.43 1136.07,1491.31 1138.37,1435.75 1140.68,1484.71 1142.99,1531.3 1145.3,1527.36 1147.61,1574.01 1149.91,1384.17 1152.22,1596.62 1154.53,1524.14 1156.84,1360.05 1159.15,1559.89 1161.45,1439.98 1163.76,1484.22 1166.07,1503.01 1168.38,1390.6 1170.69,1470.13 1172.99,1433.08 1175.3,1545.13 1177.61,1441.52 1179.92,1578.02 1182.23,1522.36 1184.53,1317.02 1186.84,1482.79 1189.15,1383.42 1191.46,1542.34 1193.76,1436.76 1196.07,1571.98 1198.38,1466.98 1200.69,1582.42 1203,1449.97 1205.3,1466.16 1207.61,1462.89 1209.92,1472.64 1212.23,1531.58 1214.54,1468.36 1216.84,1313.04 1219.15,1515.53 1221.46,1450.79 1223.77,1504.23 1226.08,1438.76 1228.38,1384.2 1230.69,1509.98 1233,1602.25 1235.31,1424.88 1237.61,1292.6 1239.92,1591.88 1242.23,1638.67 1244.54,1420.79 1246.85,1665.71 1249.15,1329 1251.46,1322.86 1253.77,1470.15 1256.08,1285.46 1258.39,1443.92 1260.69,1629.34 1263,1513.97 1265.31,1546.89 1267.62,1411.09 1269.93,1362.88 1272.23,1511.71 1274.54,1733.71 1276.85,1491.51 1279.16,1561.19 1281.47,1468.91 1283.77,1332.28 1286.08,1421.72 1288.39,1602.04 1290.7,1572.32 1293,1563.63 1295.31,1375.04 1297.62,1488.92 1299.93,1424.68 1302.24,1448.24 1304.54,1367.93 1306.85,1456.4 1309.16,1303.76 1311.47,1412.83 1313.78,1469.03 1316.08,1356.34 1318.39,1289.64 1320.7,1516.97 1323.01,1496.83 1325.32,1582.98 1327.62,1440.84 1329.93,1604.32 1332.24,1422.91 1334.55,1263.1 1336.86,1673.03 1339.16,1467.07 1341.47,1497.07 1343.78,1525.65 1346.09,1580.97 1348.39,1461.22 1350.7,1415.76 1353.01,1484.22 1355.32,1424.67 1357.63,1421.34 1359.93,1415.87 1362.24,1382.71 1364.55,1658.51 1366.86,1455.05 1369.17,1330.94 1371.47,1371.99 1373.78,1339.18 1376.09,1390.28 1378.4,1389.52 1380.71,1515.48 1383.01,1464.35 1385.32,1393.6 1387.63,1538.51 1389.94,1410.35 1392.24,1337.06 1394.55,1354.6 1396.86,1478.04 1399.17,1432.58 1401.48,1273.59 1403.78,1473.87 1406.09,1443.2 1408.4,1533.56 1410.71,1544.1 1413.02,1694.31 1415.32,1485.57 1417.63,1351.04 1419.94,1443.15 1422.25,1485.71 1424.56,1404.53 1426.86,1395.76 1429.17,1489.54 1431.48,1456.35 1433.79,1344.57 1436.1,1512.62 1438.4,1415.9 1440.71,1495.02 1443.02,1356.35 1445.33,1621.82 1447.63,1496.94 1449.94,1548.86 1452.25,1423.42 1454.56,1537.72 1456.87,1675 1459.17,1449.48 1461.48,1290.55 1463.79,1388.29 1466.1,1457.69 1468.41,1503.71 1470.71,1476.98 1473.02,1347.45 1475.33,1484.33 1477.64,1438.3 1479.95,1612.97 1482.25,1530.59 1484.56,1370.89 1486.87,1496.24 1489.18,1299.34 1491.49,1303 1493.79,1391.6 1496.1,1502.92 1498.41,1548.45 1500.72,1367.86 1503.02,1461.87 1505.33,1358.33 1507.64,1344.26 1509.95,1330.07 1512.26,1378.57 1514.56,1280.9 1516.87,1398 1519.18,1526.81 1521.49,1302.96 1523.8,1482.11 1526.1,1482.09 1528.41,1488.37 1530.72,1570.22 1533.03,1471.53 1535.34,1480.21 1537.64,1428.84 1539.95,1478.16 1542.26,1434.51 1544.57,1506.02 1546.88,1590.51 1549.18,1430.09 1551.49,1330.86 1553.8,1346.14 1556.11,1454.96 1558.41,1399.86 1560.72,1276.72 1563.03,1567.32 1565.34,1421.02 1567.65,1382.84 1569.95,1443.51 1572.26,1476.91 1574.57,1489.84 1576.88,1601.11 1579.19,1606.32 1581.49,1481.54 1583.8,1488.33 1586.11,1350.54 1588.42,1432.82 1590.73,1507.92 1593.03,1401.03 1595.34,1526.85 1597.65,1535.64 1599.96,1266.87 1602.26,1462.47 1604.57,1351.97 1606.88,1495.29 1609.19,1245.06 1611.5,1300.57 1613.8,1321.85 1616.11,1394.42 1618.42,1385.87 1620.73,1418.79 1623.04,1502.47 1625.34,1429.14 1627.65,1263.95 1629.96,1313.59 1632.27,1442.85 1634.58,1506.32 1636.88,1399.7 1639.19,1345.53 1641.5,1418.23 1643.81,1252.25 1646.12,1525.58 1648.42,1510.94 1650.73,1385.91 1653.04,1505.66 1655.35,1519.61 1657.65,1437.08 1659.96,1363.66 1662.27,1384.96 1664.58,1353.25 1666.89,1463.24 1669.19,1477.3 1671.5,1425.33 1673.81,1326.32 1676.12,1542.9 1678.43,1413.19 1680.73,1508.33 1683.04,1501.18 1685.35,1391.56 1687.66,1400.92 1689.97,1536.95 1692.27,1425 1694.58,1635.33 1696.89,1512.83 1699.2,1413.07 1701.51,1517.1 1703.81,1371.35 1706.12,1605.09 1708.43,1423.82 1710.74,1406.44 1713.04,1262.79 1715.35,1611.51 1717.66,1343.32 1719.97,1465.72 1722.28,1496.52 1724.58,1393.7 1726.89,1216.27 1729.2,1412.28 1731.51,1419.56 1733.82,1423.3 1736.12,1399.73 1738.43,1340.64 1740.74,1467.32 1743.05,1357.63 1745.36,1437.44 1747.66,1451.82 1749.97,1445.33 1752.28,1482.18 1754.59,1353.28 1756.9,1507.55 1759.2,1388.2 1761.51,1396.67 1763.82,1495.7 1766.13,1528.66 1768.43,1517.73 1770.74,1359.39 1773.05,1457.98 1775.36,1539.42 1777.67,1267.65 1779.97,1467.47 1782.28,1256.59 1784.59,1436.94 1786.9,1365.53 1789.21,1489.01 1791.51,1400.68 1793.82,1512.69 1796.13,1312.56 1798.44,1474.61 1800.75,1425.29 1803.05,1394.95 1805.36,1272.2 1807.67,1465.21 1809.98,1539.24 1812.28,1397.46 1814.59,1373.61 1816.9,1364.78 1819.21,1506.59 1821.52,1425.57 1823.82,1205.64 1826.13,1425.99 1828.44,1402.75 1830.75,1559.28 1833.06,1467.56 1835.36,1459.37 1837.67,1563.65 1839.98,1592.15 1842.29,1429.27 1844.6,1412.21 1846.9,1529.67 1849.21,1440.94 1851.52,1231.84 1853.83,1539.75 1856.14,1564.24 1858.44,1443.26 1860.75,1344.84 1863.06,1481.66 1865.37,1595.48 1867.67,1569 1869.98,1421.82 1872.29,1527.94 1874.6,1508.65 1876.91,1703.64 1879.21,1431.37 1881.52,1345.05 1883.83,1432.08 1886.14,1535.39 1888.45,1645.46 1890.75,1522.11 1893.06,1377.12 1895.37,1508.22 1897.68,1312.32 1899.99,1400.18 1902.29,1633.65 1904.6,1514.3 1906.91,1491.22 1909.22,1402.71 1911.53,1391.68 1913.83,1441.43 1916.14,1310.44 1918.45,1436.03 1920.76,1448.73 1923.06,1435.66 1925.37,1597.87 1927.68,1311.15 1929.99,1420.12 1932.3,1328.7 1934.6,1318.06 1936.91,1567.47 1939.22,1524.05 1941.53,1537.98 1943.84,1532.82 1946.14,1417.62 1948.45,1397.13 1950.76,1404.23 1953.07,1416.13 1955.38,1524.22 1957.68,1532.11 1959.99,1495.41 1962.3,1532.86 1964.61,1437.53 1966.91,1445.47 1969.22,1472.77 1971.53,1349.49 1973.84,1318.44 1976.15,1348.16 1978.45,1323 1980.76,1528.6 1983.07,1500.22 1985.38,1520.32 1987.69,1302.29 1989.99,1442.46 1992.3,1559.7 1994.61,1459.07 1996.92,1488.97 1999.23,1576.86 2001.53,1516.42 2003.84,1426.57 2006.15,1425.45 2008.46,1334.89 2010.77,1434.97 2013.07,1429.47 2015.38,1482.42 2017.69,1346.37 2020,1482.94 2022.3,1512.55 2024.61,1404.84 2026.92,1474.68 2029.23,1478.74 2031.54,1227.05 2033.84,1477.78 2036.15,1423.77 2038.46,1440.14 2040.77,1540.56 2043.08,1412.99 2045.38,1432.68 2047.69,1588.02 2050,1500.97 2052.31,1373.17 2054.62,1545.26 2056.92,1455.44 2059.23,1267.73 2061.54,1370.14 2063.85,1478.88 2066.16,1378.08 2068.46,1400.06 2070.77,1427.02 2073.08,1358.12 2075.39,1631.01 2077.69,1461.77 2080,1466.45 2082.31,1526.27 2084.62,1425.52 2086.93,1521.56 2089.23,1281.41 2091.54,1309.47 2093.85,1423.96 2096.16,1369.77 2098.47,1543.96 2100.77,1462.53 2103.08,1279.97 2105.39,1516.45 2107.7,1596.79 2110.01,1437.53 2112.31,1493.37 2114.62,1478.13 2116.93,1469.72 2119.24,1426.03 2121.55,1570.27 2123.85,1421.1 2126.16,1413.3 2128.47,1402.98 2130.78,1410.61 2133.08,1531.63 2135.39,1489.88 2137.7,1353.83 2140.01,1375.95 2142.32,1317.67 2144.62,1606.86 2146.93,1357.34 2149.24,1463.53 2151.55,1185.25 2153.86,1517.32 2156.16,1439.6 2158.47,1385.47 2160.78,1314.56 2163.09,1541.02 2165.4,1650.46 2167.7,1338.04 2170.01,1291.96 2172.32,1618.98 2174.63,1438.59 2176.93,1380.89 2179.24,1541.01 2181.55,1339.64 2183.86,1342.53 2186.17,1560.59 2188.47,1329.78 2190.78,1524.86 2193.09,1540.76 2195.4,1457.64 2197.71,1362.48 2200.01,1509.87 2202.32,1409.85 2204.63,1553.26 2206.94,1326.56 2209.25,1421.86 2211.55,1399.96 2213.86,1559.4 2216.17,1457.29 2218.48,1503.92 2220.79,1418.66 2223.09,1374.32 2225.4,1478.91 2227.71,1413.06 2230.02,1394.1 2232.32,1411.29 2234.63,1556.57 2236.94,1433.43 2239.25,1468.35 2241.56,1452.61 2243.86,1431.97 2246.17,1434.36 2248.48,1362.88 2250.79,1389.2 2253.1,1509.52 2255.4,1446.23 2257.71,1406.37 2260.02,1374.24 2262.33,1455.25 2264.64,1618.09 2266.94,1469.52 2269.25,1464.88 2271.56,1578.36 2273.87,1377.55 2276.18,1432.51 2278.48,1268.93 2280.79,1468.35 2283.1,1384.57 2285.41,1400.73 2287.71,1318.92 2290.02,1474.88 2292.33,1384.78 2294.64,1371.34 2296.95,1384.55 2299.25,1461.95 2301.56,1403.74 2303.87,1478.22 2306.18,1446.1 2308.49,1411.41 2310.79,1367.83 2313.1,1632.25 2315.41,1413.59 2317.72,1267.18 2320.03,1415.97 2322.33,1627.66 2324.64,1546.17 2326.95,1558.07 2329.26,1504.14 2331.56,1544.62 2333.87,1500.05 2336.18,1461.86 2338.49,1473.86 2340.8,1479.8 2343.1,1443.72 2345.41,1720.11 2347.72,1521.24 2350.03,1697.45 2352.34,1591.91 2354.64,1474.87 2356.95,1610.44 2359.26,1485.63 2361.57,1366.04 2363.88,1429.19 2366.18,1462.79 2368.49,1461.06 2370.8,1735.32 2373.11,1432.45 2375.42,1587.42 2377.72,1492.96 2380.03,1410.31 2382.34,1497.76 2384.65,1461.34 2386.95,1386.16 2389.26,1605.7 2391.57,1424.3 2393.88,1669.06 2396.19,1526.3 2398.49,1585.04 2400.8,1327.63 2403.11,1556.61 2405.42,1415.72 2407.73,1467.82 2410.03,1431.07 2412.34,1393.35 2414.65,1562.38 2416.96,1512.74 2419.27,1518.34 2421.57,1416.9 2423.88,1345.55 2426.19,1316.9 2428.5,1473.27 2430.81,1564.3 2433.11,1560.86 2435.42,1459.59 2437.73,1341.62 2440.04,1390.87 2442.34,1402.06 2444.65,1638.68 2446.96,1372.28 2449.27,1588.68 2451.58,1418.92 2453.88,1352.15 2456.19,1428.13 2458.5,1471.07 2460.81,1529.23 2463.12,1496.51 2465.42,1226.79 2467.73,1451.69 2470.04,1477.17 2472.35,1391.94 2474.66,1471.09 2476.96,1501.6 2479.27,1359.16 2481.58,1403.02 2483.89,1584.62 2486.2,1383.84 2488.5,1270.72 2490.81,1276.43 2493.12,1538.6 2495.43,1439.23 2497.73,1546.87 2500.04,1260.05 2502.35,1539.84 2504.66,1443.8 2506.97,1482.97 2509.27,1557.16 2511.58,1455.43 2513.89,1363.31 2516.2,1559.27 2518.51,1513.61 2520.81,1477.14 2523.12,1349.95 2525.43,1528.96 2527.74,1524.9 2530.05,1515.35 2532.35,1519.34 2534.66,1571.1 2536.97,1403.9 2539.28,1509.44 2541.58,1459.24 2543.89,1276.86 2546.2,1516.86 2548.51,1614.81 2550.82,1654.5 2553.12,1514.6 2555.43,1411.22 2557.74,1413.63 2560.05,1434.44 2562.36,1430.68 2564.66,1645.17 2566.97,1399.69 2569.28,1580.67 2571.59,1637.26 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1039.26 268.292,1004.66 270.6,968.161 272.908,1031.71 275.216,929.341 277.524,922.799 279.832,927.916 282.139,980.031 284.447,994.913 286.755,1054.53 289.063,1034.58 291.371,975.353 293.679,1150.72 295.987,792.699 298.295,913.002 300.603,932.921 302.911,959.767 305.219,842.286 307.527,933.742 309.834,929.949 312.142,924.221 314.45,1012.72 316.758,1028.01 319.066,882.786 321.374,949.661 323.682,1146.21 325.99,701.462 328.298,778.018 330.606,1025.47 332.914,1008.13 335.221,918.978 337.529,908.579 339.837,927.789 342.145,1075.23 344.453,1076.03 346.761,1042.34 349.069,1072 351.377,1175.42 353.685,935.879 355.993,890.079 358.301,792.786 360.608,903.375 362.916,1105.73 365.224,1000.21 367.532,1140.55 369.84,1048.54 372.148,1013 374.456,915.236 376.764,1057.07 379.072,853.051 381.38,923.487 383.688,1001.92 385.996,1059.49 388.303,1133.83 390.611,1097.62 392.919,998.759 395.227,1121.71 397.535,1031.99 399.843,1087.07 402.151,893.335 404.459,953.554 406.767,1024.7 409.075,1070.94 411.383,1018.17 413.69,912.012 415.998,906.768 418.306,1048.88 420.614,1126.21 422.922,952.844 425.23,965.563 427.538,1019.72 429.846,1016.99 432.154,991.512 434.462,998.893 436.77,1086.41 439.077,965.043 441.385,986.031 443.693,1011.12 446.001,994.923 448.309,1010.92 450.617,984.329 452.925,865.599 455.233,1025.95 457.541,969.748 459.849,1012.76 462.157,965.66 464.465,1189.71 466.772,732.03 469.08,1243.59 471.388,1128.54 473.696,928.489 476.004,839.539 478.312,831.041 480.62,784.549 482.928,975.06 485.236,847.681 487.544,1126.85 489.852,1044.34 492.159,1027.45 494.467,854.282 496.775,893.036 499.083,965.016 501.391,1071.85 503.699,1033.63 506.007,1020.47 508.315,813.24 510.623,1003.94 512.931,956.694 515.239,1081.09 517.546,1021.78 519.854,1043.63 522.162,1066.08 524.47,874.987 526.778,991.936 529.086,889.309 531.394,858.832 533.702,892.637 536.01,1128.8 538.318,1010.41 540.626,744.057 542.933,1003.08 545.241,771.23 547.549,973.724 549.857,853.031 552.165,899.954 554.473,921.897 556.781,1059.83 559.089,901.986 561.397,680.176 563.705,1127.93 566.013,1142.99 568.321,1055.96 570.628,990.156 572.936,921.935 575.244,1007.39 577.552,827.311 579.86,968.318 582.168,1009.68 584.476,922.406 586.784,868.118 589.092,895.553 591.4,958.803 593.708,899.641 596.015,1100.47 598.323,1060.62 600.631,1024.95 602.939,1010.2 605.247,1005.98 607.555,972.689 609.863,880.303 612.171,1061.63 614.479,1042.47 616.787,1070.22 619.095,914.106 621.402,984.861 623.71,834.601 626.018,761.895 628.326,909.305 630.634,1009.81 632.942,886.746 635.25,1125.63 637.558,1047.97 639.866,1175.03 642.174,828.55 644.482,1007.81 646.79,1023.72 649.097,805.574 651.405,1139.28 653.713,895.005 656.021,940.329 658.329,917.327 660.637,1031.19 662.945,975.828 665.253,910.798 667.561,923.769 669.869,1096.15 672.177,925.932 674.484,964.489 676.792,830.575 679.1,1050.37 681.408,952.918 683.716,933.131 686.024,995.783 688.332,907.142 690.64,942.437 692.948,887.541 695.256,820 697.564,1130.25 699.871,940.216 702.179,971.584 704.487,891.78 706.795,954.496 709.103,833.271 711.411,937.394 713.719,1200.08 716.027,774.806 718.335,1017.15 720.643,745.928 722.951,943.926 725.259,848.018 727.566,1155.57 729.874,868.058 732.182,859.083 734.49,1035.08 736.798,870.831 739.106,973.972 741.414,899.795 743.722,1076.7 746.03,930.478 748.338,940.127 750.646,1112.5 752.953,922.595 755.261,959.477 757.569,807.67 759.877,908.575 762.185,1026.72 764.493,988.537 766.801,1033.8 769.109,847.907 771.417,930.4 773.725,950.446 776.033,1070.66 778.34,822.729 780.648,931.822 782.956,956.415 785.264,829.107 787.572,1044.27 789.88,1078.89 792.188,1100.37 794.496,908.173 796.804,897.813 799.112,991.394 801.42,920.538 803.728,1010.84 806.035,809.372 808.343,877.45 810.651,982.954 812.959,978.707 815.267,1006.04 817.575,1054.45 819.883,890.371 822.191,807.894 824.499,964.74 826.807,949.423 829.115,1035.28 831.422,848.364 833.73,857.969 836.038,1127.49 838.346,921.722 840.654,800.091 842.962,910.268 845.27,902.151 847.578,1061.02 849.886,785.102 852.194,843.112 854.502,980.486 856.809,1163.03 859.117,1139.14 861.425,1093.61 863.733,972.006 866.041,917.672 868.349,834.95 870.657,873.631 872.965,941.7 875.273,1243.2 877.581,938.553 879.889,849.629 882.197,970.293 884.504,1126.14 886.812,968.971 889.12,944.857 891.428,836.244 893.736,911.913 896.044,846.536 898.352,898.121 900.66,1050.56 902.968,1012.63 905.276,920.964 907.584,1072.43 909.891,1004.37 912.199,1015.34 914.507,881.13 916.815,923.522 919.123,1030.7 921.431,934.515 923.739,974.898 926.047,1083.39 928.355,1160.7 930.663,937.171 932.971,841.027 935.278,957.374 937.586,1015.29 939.894,1021.83 942.202,942.513 944.51,1046.85 946.818,892.181 949.126,769.719 951.434,1041.49 953.742,1039.36 956.05,990.658 958.358,888.091 960.665,814.831 962.973,858.933 965.281,972.38 967.589,918.291 969.897,895.453 972.205,1116.82 974.513,910.733 976.821,858.512 979.129,1062.78 981.437,963.732 983.745,1175.18 986.053,815.907 988.36,1118.5 990.668,821.926 992.976,814.469 995.284,948.47 997.592,1191.42 999.9,1043.75 1002.21,969.646 1004.52,1082.08 1006.82,899.839 1009.13,902.724 1011.44,1059.72 1013.75,1012.59 1016.06,1026.36 1018.36,920.157 1020.67,1182.7 1022.98,1018.4 1025.29,923.983 1027.59,989.671 1029.9,1019.56 1032.21,1104.29 1034.52,1005.77 1036.83,941.096 1039.13,1060.99 1041.44,1023.6 1043.75,1146.22 1046.06,1082.06 1048.37,794.648 1050.67,1064.79 1052.98,876.4 1055.29,1002.04 1057.6,916.323 1059.91,880.847 1062.21,992.244 1064.52,1032 1066.83,852.282 1069.14,996.371 1071.45,919.73 1073.75,906.488 1076.06,937.351 1078.37,995.178 1080.68,785.301 1082.98,1015.89 1085.29,955.705 1087.6,955.718 1089.91,1082.16 1092.22,983.024 1094.52,972.752 1096.83,975.72 1099.14,1219.96 1101.45,882.682 1103.76,911.369 1106.06,1047.67 1108.37,963.485 1110.68,985.423 1112.99,879.074 1115.3,1074.52 1117.6,1010.67 1119.91,1080.87 1122.22,962 1124.53,899.318 1126.84,1021.55 1129.14,919.301 1131.45,930.064 1133.76,925.662 1136.07,949.37 1138.37,910.923 1140.68,868.973 1142.99,1005.51 1145.3,1024.26 1147.61,953.313 1149.91,909.735 1152.22,1033.73 1154.53,941.471 1156.84,976.288 1159.15,957.835 1161.45,1184.5 1163.76,1053.47 1166.07,1031.09 1168.38,861.755 1170.69,986.441 1172.99,815.945 1175.3,949.373 1177.61,1008.94 1179.92,942.936 1182.23,976.336 1184.53,1070.27 1186.84,1030.02 1189.15,949.102 1191.46,1014.78 1193.76,1034.73 1196.07,798.882 1198.38,828.477 1200.69,1000.89 1203,882.566 1205.3,846.553 1207.61,991.768 1209.92,604.622 1212.23,901.033 1214.54,962.943 1216.84,909.597 1219.15,958.774 1221.46,906.833 1223.77,920.585 1226.08,1098.43 1228.38,936.381 1230.69,1088.93 1233,1050.65 1235.31,865.68 1237.61,1066.97 1239.92,1118.08 1242.23,1127.02 1244.54,870.822 1246.85,812.277 1249.15,894.371 1251.46,860.499 1253.77,829.257 1256.08,816.384 1258.39,1087.3 1260.69,826.851 1263,1050.08 1265.31,1038.93 1267.62,775.383 1269.93,915.009 1272.23,1097.41 1274.54,883.081 1276.85,967.261 1279.16,856.733 1281.47,906.697 1283.77,942.358 1286.08,802.673 1288.39,1007.75 1290.7,904.452 1293,916.604 1295.31,883.948 1297.62,885.577 1299.93,1024.4 1302.24,995.469 1304.54,823.495 1306.85,888.163 1309.16,1068.67 1311.47,905.647 1313.78,1075.39 1316.08,814.806 1318.39,976.874 1320.7,917.361 1323.01,1072.49 1325.32,805.662 1327.62,875.781 1329.93,746.699 1332.24,949.314 1334.55,816.94 1336.86,723.506 1339.16,916.495 1341.47,941.912 1343.78,904.242 1346.09,951.865 1348.39,931.184 1350.7,982.754 1353.01,969.406 1355.32,959.505 1357.63,776.922 1359.93,1042.02 1362.24,1043.97 1364.55,944.476 1366.86,894.126 1369.17,848.646 1371.47,901.603 1373.78,1103.28 1376.09,999.343 1378.4,813.016 1380.71,782.73 1383.01,970.098 1385.32,842.202 1387.63,1034.95 1389.94,933.571 1392.24,911.615 1394.55,945.504 1396.86,1007 1399.17,898.518 1401.48,1022.68 1403.78,940.091 1406.09,849.755 1408.4,1114.88 1410.71,1021.86 1413.02,890.798 1415.32,933.409 1417.63,1008.32 1419.94,1150.6 1422.25,955.861 1424.56,1054.76 1426.86,1175.7 1429.17,1046.99 1431.48,901.59 1433.79,1007.22 1436.1,1031.72 1438.4,1059.15 1440.71,891.791 1443.02,1198.15 1445.33,998.127 1447.63,950.609 1449.94,1103.08 1452.25,914.834 1454.56,917.118 1456.87,854.771 1459.17,788.283 1461.48,997.616 1463.79,996.768 1466.1,1053.76 1468.41,812.298 1470.71,882.629 1473.02,1011.47 1475.33,1127.87 1477.64,1068.45 1479.95,804.33 1482.25,849.996 1484.56,809.362 1486.87,994.768 1489.18,1069.5 1491.49,902.986 1493.79,928.254 1496.1,801.245 1498.41,982.701 1500.72,895.435 1503.02,986.613 1505.33,910.433 1507.64,1122.28 1509.95,1107.18 1512.26,1008.22 1514.56,887.962 1516.87,926.117 1519.18,1010.19 1521.49,782.082 1523.8,965.056 1526.1,898.301 1528.41,961.883 1530.72,1002.19 1533.03,1011.01 1535.34,1046.95 1537.64,725.825 1539.95,1048.75 1542.26,857.302 1544.57,965.839 1546.88,907.738 1549.18,918.859 1551.49,868.422 1553.8,859.465 1556.11,977.531 1558.41,941.321 1560.72,1047.03 1563.03,814.236 1565.34,1026.01 1567.65,967.429 1569.95,936.786 1572.26,918.822 1574.57,926.982 1576.88,859.95 1579.19,1016.59 1581.49,894.215 1583.8,963.858 1586.11,915.467 1588.42,992.441 1590.73,1047.47 1593.03,1118.58 1595.34,846.137 1597.65,1108.08 1599.96,787.055 1602.26,1101.8 1604.57,1073.34 1606.88,920.938 1609.19,1024.1 1611.5,871.311 1613.8,979.469 1616.11,930.967 1618.42,1134.8 1620.73,992.708 1623.04,1068.55 1625.34,871.819 1627.65,962.43 1629.96,885.07 1632.27,1027.49 1634.58,808.829 1636.88,893.279 1639.19,974.564 1641.5,885.937 1643.81,951.447 1646.12,1019.66 1648.42,1079.64 1650.73,1068.66 1653.04,858.644 1655.35,713.355 1657.65,842.859 1659.96,920.695 1662.27,1036.85 1664.58,956.061 1666.89,957.231 1669.19,1169.59 1671.5,1010.24 1673.81,942.253 1676.12,1254.73 1678.43,917.956 1680.73,954.904 1683.04,946.173 1685.35,917.596 1687.66,900.615 1689.97,948.13 1692.27,814.223 1694.58,967.432 1696.89,1050.76 1699.2,929.989 1701.51,901.016 1703.81,1113.64 1706.12,1199.96 1708.43,925.244 1710.74,980.467 1713.04,1064.22 1715.35,937.209 1717.66,918.232 1719.97,1018.93 1722.28,1033.92 1724.58,760.471 1726.89,1031.52 1729.2,1006.04 1731.51,788.331 1733.82,961.317 1736.12,903.552 1738.43,1075.3 1740.74,891.196 1743.05,802.87 1745.36,907.925 1747.66,929.443 1749.97,1039.49 1752.28,933.724 1754.59,1096.85 1756.9,814.439 1759.2,1063.54 1761.51,998.422 1763.82,990.896 1766.13,972.666 1768.43,815.787 1770.74,913.608 1773.05,1087.61 1775.36,1010.65 1777.67,1056.69 1779.97,1164.81 1782.28,961.423 1784.59,1115.54 1786.9,1102.96 1789.21,949.766 1791.51,897.244 1793.82,890.364 1796.13,861.117 1798.44,857.52 1800.75,1043.96 1803.05,1194.54 1805.36,1013.16 1807.67,1122.42 1809.98,942.598 1812.28,1026.77 1814.59,1022.8 1816.9,971.406 1819.21,892.827 1821.52,1109.36 1823.82,929.013 1826.13,1031.07 1828.44,819.902 1830.75,1115.96 1833.06,972.709 1835.36,977.864 1837.67,1000.23 1839.98,903.609 1842.29,948.813 1844.6,1076.58 1846.9,925.562 1849.21,918.827 1851.52,942.566 1853.83,993.378 1856.14,928.28 1858.44,1049.22 1860.75,954.05 1863.06,1014.57 1865.37,923.83 1867.67,954.553 1869.98,815.544 1872.29,985.961 1874.6,1043.71 1876.91,1004.67 1879.21,902.396 1881.52,1003.99 1883.83,951.392 1886.14,1054.49 1888.45,855.457 1890.75,906.937 1893.06,983.218 1895.37,950.658 1897.68,923.905 1899.99,938.16 1902.29,924.792 1904.6,985.185 1906.91,769.22 1909.22,911.538 1911.53,927.846 1913.83,830.857 1916.14,1042.85 1918.45,823.436 1920.76,1003.59 1923.06,824.095 1925.37,1041.05 1927.68,806.299 1929.99,954.281 1932.3,834.101 1934.6,1098.2 1936.91,1124.5 1939.22,987.799 1941.53,986.582 1943.84,761.262 1946.14,927.109 1948.45,1029.92 1950.76,949.609 1953.07,809.778 1955.38,1001.31 1957.68,1121.32 1959.99,1137.16 1962.3,938.968 1964.61,1097.63 1966.91,876.056 1969.22,924.887 1971.53,1008.53 1973.84,1006.56 1976.15,1013.25 1978.45,1014.42 1980.76,1002.6 1983.07,1163.95 1985.38,989.181 1987.69,1083.29 1989.99,1010.52 1992.3,989.991 1994.61,857.825 1996.92,1052.77 1999.23,981.743 2001.53,1036.08 2003.84,959.14 2006.15,890.477 2008.46,965.621 2010.77,1065.58 2013.07,932.35 2015.38,1096.13 2017.69,999.217 2020,934.006 2022.3,934.567 2024.61,1121.14 2026.92,1050.71 2029.23,907.012 2031.54,968.183 2033.84,1038.27 2036.15,904.508 2038.46,919.16 2040.77,891.849 2043.08,869.71 2045.38,999.139 2047.69,897.192 2050,876.757 2052.31,978.461 2054.62,1056.79 2056.92,912.286 2059.23,929.585 2061.54,965.085 2063.85,973.295 2066.16,985.015 2068.46,926.047 2070.77,949.897 2073.08,986.234 2075.39,878.369 2077.69,916.422 2080,859.061 2082.31,969.773 2084.62,991.996 2086.93,924.418 2089.23,946.686 2091.54,1027.99 2093.85,820.826 2096.16,1071.24 2098.47,976.194 2100.77,1007.38 2103.08,1021.78 2105.39,1041.26 2107.7,922.07 2110.01,1004.44 2112.31,1232.51 2114.62,965.374 2116.93,884.4 2119.24,908.174 2121.55,1064.24 2123.85,975.322 2126.16,990.076 2128.47,1093.35 2130.78,1044.11 2133.08,945.816 2135.39,899.218 2137.7,949.175 2140.01,910.061 2142.32,823.333 2144.62,1025.3 2146.93,982.025 2149.24,881.14 2151.55,1167.42 2153.86,867.175 2156.16,1007.59 2158.47,1211.13 2160.78,1018.91 2163.09,838.39 2165.4,873.728 2167.7,1125.07 2170.01,972.031 2172.32,1015.8 2174.63,926.503 2176.93,815.724 2179.24,1019.22 2181.55,988.295 2183.86,1081.85 2186.17,921.714 2188.47,829.383 2190.78,1068.07 2193.09,939.73 2195.4,896.932 2197.71,854.146 2200.01,1029.99 2202.32,849.191 2204.63,907.075 2206.94,927.766 2209.25,1005.71 2211.55,854.767 2213.86,1028.42 2216.17,985.659 2218.48,915.395 2220.79,986.433 2223.09,948.206 2225.4,971.336 2227.71,852.349 2230.02,999.306 2232.32,1002.46 2234.63,986.851 2236.94,937.096 2239.25,940.952 2241.56,1117.47 2243.86,1141.62 2246.17,963.984 2248.48,1115.87 2250.79,924.453 2253.1,1175.11 2255.4,940.604 2257.71,1101.54 2260.02,1022.34 2262.33,873.357 2264.64,1071.76 2266.94,956.013 2269.25,887.705 2271.56,905.181 2273.87,826.835 2276.18,915.11 2278.48,1003.78 2280.79,959.749 2283.1,1034.37 2285.41,940.763 2287.71,1048.36 2290.02,1027.33 2292.33,997.958 2294.64,901.961 2296.95,961.762 2299.25,770.961 2301.56,826.714 2303.87,995.955 2306.18,966.63 2308.49,907.037 2310.79,1002.51 2313.1,859.302 2315.41,1097.29 2317.72,1052.03 2320.03,991.887 2322.33,1000.18 2324.64,1223.27 2326.95,841.504 2329.26,773.487 2331.56,1075.83 2333.87,1058.96 2336.18,847.574 2338.49,1061.59 2340.8,848.582 2343.1,1021.79 2345.41,941.606 2347.72,1054.22 2350.03,985.972 2352.34,947.255 2354.64,934.672 2356.95,892.388 2359.26,943.467 2361.57,926.827 2363.88,1047.32 2366.18,921.794 2368.49,886.952 2370.8,876.151 2373.11,1027.89 2375.42,949.331 2377.72,1129.4 2380.03,942.349 2382.34,1067.89 2384.65,1051.74 2386.95,924.958 2389.26,1127.17 2391.57,1001.06 2393.88,851.361 2396.19,1133.43 2398.49,925.594 2400.8,944.912 2403.11,984.214 2405.42,898.303 2407.73,1013.8 2410.03,1048.24 2412.34,995.086 2414.65,1003.89 2416.96,834.925 2419.27,937.096 2421.57,915.546 2423.88,1059.56 2426.19,927.478 2428.5,1004.89 2430.81,883.832 2433.11,1050.83 2435.42,956.681 2437.73,921.505 2440.04,993.405 2442.34,896.845 2444.65,1045.9 2446.96,965.336 2449.27,1008.89 2451.58,941.945 2453.88,955.776 2456.19,939.051 2458.5,981.252 2460.81,996.361 2463.12,1076.38 2465.42,1065.5 2467.73,895.896 2470.04,861.304 2472.35,1084.58 2474.66,803.958 2476.96,905.87 2479.27,899.802 2481.58,983.571 2483.89,1085.66 2486.2,872.04 2488.5,1003.01 2490.81,901.869 2493.12,1093.63 2495.43,1032.22 2497.73,1175.52 2500.04,892.82 2502.35,1028.97 2504.66,987.983 2506.97,838.492 2509.27,1238.02 2511.58,908.732 2513.89,885.877 2516.2,1085.3 2518.51,894.265 2520.81,1067.42 2523.12,1084.61 2525.43,1061.85 2527.74,993.6 2530.05,1089.46 2532.35,916.743 2534.66,992.197 2536.97,804.103 2539.28,1158.04 2541.58,894.543 2543.89,1004.05 2546.2,1096.35 2548.51,898.8 2550.82,870.717 2553.12,1011.76 2555.43,1004.58 2557.74,1018.32 2560.05,973.473 2562.36,1122.13 2564.66,1103.09 2566.97,913.341 2569.28,871.345 2571.59,932.392 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,762.168 268.292,444.006 270.6,519.507 272.908,492.411 275.216,491.581 277.524,561.174 279.832,311.832 282.139,446.491 284.447,508.452 286.755,415.737 289.063,592.419 291.371,466.906 293.679,493.16 295.987,416.235 298.295,582.454 300.603,461.995 302.911,501.993 305.219,479.918 307.527,455.17 309.834,355.468 312.142,443.728 314.45,506.674 316.758,411.939 319.066,529.569 321.374,446.007 323.682,382.042 325.99,477.152 328.298,398.346 330.606,518.466 332.914,368.375 335.221,497.369 337.529,528.759 339.837,424.524 342.145,444.394 344.453,496.956 346.761,616.086 349.069,262.54 351.377,578.874 353.685,476.924 355.993,603.468 358.301,250.08 360.608,489.6 362.916,373.119 365.224,431.977 367.532,508.912 369.84,606.773 372.148,624.117 374.456,386.682 376.764,376.741 379.072,575.272 381.38,332.26 383.688,532.356 385.996,274.941 388.303,427.847 390.611,385.939 392.919,406.78 395.227,532.012 397.535,279.164 399.843,409.272 402.151,456.192 404.459,513.919 406.767,578.719 409.075,476.355 411.383,359.487 413.69,393.803 415.998,466.219 418.306,448.918 420.614,400.201 422.922,547.328 425.23,587.739 427.538,581.409 429.846,397.005 432.154,271.763 434.462,474.771 436.77,474.499 439.077,466.275 441.385,328.156 443.693,452.104 446.001,286.136 448.309,692.351 450.617,365.317 452.925,486.209 455.233,531.338 457.541,553.011 459.849,555.792 462.157,274.265 464.465,568.128 466.772,239.728 469.08,523.309 471.388,519.356 473.696,375.233 476.004,448.079 478.312,529.74 480.62,463.137 482.928,457.789 485.236,460.079 487.544,654.612 489.852,360.32 492.159,518.53 494.467,561 496.775,497.095 499.083,428.572 501.391,380.49 503.699,485.923 506.007,382.103 508.315,500.181 510.623,432.664 512.931,485.023 515.239,433.582 517.546,622.251 519.854,648.7 522.162,441.072 524.47,402.458 526.778,300.95 529.086,490.534 531.394,445.422 533.702,509.07 536.01,234.284 538.318,394.904 540.626,549.776 542.933,549.02 545.241,520.494 547.549,373.389 549.857,547.44 552.165,524.489 554.473,486.068 556.781,526.125 559.089,455.247 561.397,497.256 563.705,370.557 566.013,572.745 568.321,439.154 570.628,439.304 572.936,661.111 575.244,411.335 577.552,398.867 579.86,331.874 582.168,383.344 584.476,422.054 586.784,364.797 589.092,577.408 591.4,660.105 593.708,486.029 596.015,458.448 598.323,446.315 600.631,429.045 602.939,357.36 605.247,467.151 607.555,385.942 609.863,275.097 612.171,481.822 614.479,454.195 616.787,459.852 619.095,374.273 621.402,630.975 623.71,494.996 626.018,392.98 628.326,469.403 630.634,462.128 632.942,525.765 635.25,520.247 637.558,397.571 639.866,689.896 642.174,490.602 644.482,577.335 646.79,397.739 649.097,535.784 651.405,427.891 653.713,395.7 656.021,273.665 658.329,498.943 660.637,530.383 662.945,405.354 665.253,558.158 667.561,536.704 669.869,376.005 672.177,192.366 674.484,529.521 676.792,568.292 679.1,451.782 681.408,452.778 683.716,348.429 686.024,584.025 688.332,302.515 690.64,460.058 692.948,489.308 695.256,333.662 697.564,592.78 699.871,442.585 702.179,386.054 704.487,555.501 706.795,409.679 709.103,518.571 711.411,627.102 713.719,635.546 716.027,508.369 718.335,379.043 720.643,496.097 722.951,480.639 725.259,408.461 727.566,427.183 729.874,572.759 732.182,456.273 734.49,507.964 736.798,627.92 739.106,380.241 741.414,586.437 743.722,474.902 746.03,309.117 748.338,454.209 750.646,407.753 752.953,447.198 755.261,445.061 757.569,553.623 759.877,278.846 762.185,429.77 764.493,323.323 766.801,451.556 769.109,208.745 771.417,501.098 773.725,567.775 776.033,509.517 778.34,432.144 780.648,486.167 782.956,484.494 785.264,396.236 787.572,431.345 789.88,596.911 792.188,321.164 794.496,486.191 796.804,437.142 799.112,472.749 801.42,408.803 803.728,476.292 806.035,437.108 808.343,324.247 810.651,443.299 812.959,541.67 815.267,364.178 817.575,537.208 819.883,474.774 822.191,358.539 824.499,438.116 826.807,469.764 829.115,550.46 831.422,550.895 833.73,531.744 836.038,697.649 838.346,414.179 840.654,532.87 842.962,558.363 845.27,446.429 847.578,410.857 849.886,433.615 852.194,608.749 854.502,502.237 856.809,476.967 859.117,510.369 861.425,381.497 863.733,454.904 866.041,436.965 868.349,325.146 870.657,432.927 872.965,405.662 875.273,543.255 877.581,338.671 879.889,246.819 882.197,565.567 884.504,619.642 886.812,417.288 889.12,450.601 891.428,431.393 893.736,547.089 896.044,293.946 898.352,418.54 900.66,446.455 902.968,402.946 905.276,578.051 907.584,387.939 909.891,555.853 912.199,534.839 914.507,507.245 916.815,566.28 919.123,479.97 921.431,454.097 923.739,435.179 926.047,263.474 928.355,531.455 930.663,487.166 932.971,430.694 935.278,557.782 937.586,408.823 939.894,513.079 942.202,434.353 944.51,349.099 946.818,573.461 949.126,560.708 951.434,540.119 953.742,478.234 956.05,263.809 958.358,513.305 960.665,421.924 962.973,465.924 965.281,458.372 967.589,514.751 969.897,462.559 972.205,578.961 974.513,528.324 976.821,374.399 979.129,417.466 981.437,653.029 983.745,579.918 986.053,326.467 988.36,458.386 990.668,435.789 992.976,383.8 995.284,389.625 997.592,543.684 999.9,403.31 1002.21,488.177 1004.52,480.335 1006.82,629.093 1009.13,594.278 1011.44,510.731 1013.75,748.058 1016.06,586.599 1018.36,340.444 1020.67,391.375 1022.98,366.841 1025.29,432.354 1027.59,312.54 1029.9,484.837 1032.21,351.67 1034.52,423.958 1036.83,473.058 1039.13,639.556 1041.44,391.875 1043.75,245.381 1046.06,466.522 1048.37,405.351 1050.67,442.408 1052.98,387.704 1055.29,429.32 1057.6,545.829 1059.91,561.571 1062.21,634.019 1064.52,713.847 1066.83,573.487 1069.14,555.594 1071.45,368.308 1073.75,516.02 1076.06,313.697 1078.37,384.572 1080.68,414.983 1082.98,463.459 1085.29,344.923 1087.6,457.019 1089.91,520.365 1092.22,580.133 1094.52,561.408 1096.83,413.128 1099.14,417.454 1101.45,456.233 1103.76,567.979 1106.06,564.791 1108.37,403.512 1110.68,528.71 1112.99,312.385 1115.3,394.118 1117.6,417.453 1119.91,624.293 1122.22,523.719 1124.53,492.394 1126.84,411.196 1129.14,473.26 1131.45,501.548 1133.76,391.299 1136.07,444.189 1138.37,422.584 1140.68,544.435 1142.99,537.488 1145.3,573.626 1147.61,587.309 1149.91,437.986 1152.22,455.597 1154.53,346.824 1156.84,469.059 1159.15,543.247 1161.45,376.133 1163.76,430.359 1166.07,607.634 1168.38,345.067 1170.69,446.389 1172.99,544.367 1175.3,455.241 1177.61,461.477 1179.92,327.269 1182.23,393.108 1184.53,311.643 1186.84,697.384 1189.15,341.741 1191.46,476.959 1193.76,507.299 1196.07,443.988 1198.38,482.32 1200.69,664.983 1203,410.601 1205.3,595.005 1207.61,525.868 1209.92,645.231 1212.23,530.542 1214.54,423.541 1216.84,459.525 1219.15,396.217 1221.46,537.757 1223.77,513.782 1226.08,500.914 1228.38,578.539 1230.69,498.277 1233,644.782 1235.31,618.189 1237.61,517.269 1239.92,421.62 1242.23,437.303 1244.54,438.47 1246.85,568.861 1249.15,469.272 1251.46,533.411 1253.77,480.446 1256.08,596.878 1258.39,577.825 1260.69,382.171 1263,399.395 1265.31,460.958 1267.62,312.326 1269.93,594.623 1272.23,473.279 1274.54,509.369 1276.85,304.283 1279.16,348.495 1281.47,575.151 1283.77,330.225 1286.08,544.804 1288.39,387.738 1290.7,536.877 1293,554.061 1295.31,560.026 1297.62,587.455 1299.93,686.825 1302.24,338.091 1304.54,387.082 1306.85,477.706 1309.16,432.129 1311.47,528.994 1313.78,506.969 1316.08,538.467 1318.39,510.221 1320.7,463.154 1323.01,607.609 1325.32,404.532 1327.62,464.77 1329.93,469.74 1332.24,363.052 1334.55,505.636 1336.86,462.367 1339.16,444.657 1341.47,591.658 1343.78,356.473 1346.09,544.968 1348.39,370.701 1350.7,443.376 1353.01,284.798 1355.32,506.95 1357.63,247.017 1359.93,255.709 1362.24,515.614 1364.55,444.436 1366.86,363.454 1369.17,348.929 1371.47,419.003 1373.78,532.415 1376.09,399.772 1378.4,420.141 1380.71,543.052 1383.01,495.692 1385.32,444.86 1387.63,565.317 1389.94,437.264 1392.24,580.503 1394.55,480.617 1396.86,456.407 1399.17,492.595 1401.48,552.614 1403.78,578.405 1406.09,296.453 1408.4,320.706 1410.71,465.022 1413.02,364.457 1415.32,455.447 1417.63,460.548 1419.94,478.526 1422.25,487.25 1424.56,559.535 1426.86,429.815 1429.17,502.509 1431.48,548.839 1433.79,447.49 1436.1,462.165 1438.4,303.717 1440.71,455.08 1443.02,369.788 1445.33,407.825 1447.63,371.448 1449.94,566.653 1452.25,468.385 1454.56,438.713 1456.87,173.941 1459.17,467.876 1461.48,541.208 1463.79,528.75 1466.1,543.652 1468.41,510.177 1470.71,372.678 1473.02,383.059 1475.33,462.673 1477.64,532.487 1479.95,402.159 1482.25,485.138 1484.56,486.479 1486.87,430.454 1489.18,414.651 1491.49,575.174 1493.79,424.728 1496.1,478.974 1498.41,574.6 1500.72,399.095 1503.02,475.027 1505.33,439.285 1507.64,555.401 1509.95,554.209 1512.26,442.075 1514.56,512.948 1516.87,311.319 1519.18,473.989 1521.49,498.987 1523.8,362.086 1526.1,501.812 1528.41,577.012 1530.72,680.888 1533.03,502.532 1535.34,357.381 1537.64,573.267 1539.95,402.148 1542.26,433.684 1544.57,541.731 1546.88,241.568 1549.18,670.217 1551.49,497.056 1553.8,509.481 1556.11,339.003 1558.41,389.671 1560.72,473.714 1563.03,479.053 1565.34,333.987 1567.65,599.028 1569.95,449.644 1572.26,436.78 1574.57,379.724 1576.88,459.563 1579.19,399.716 1581.49,380.366 1583.8,410.34 1586.11,397.656 1588.42,463.916 1590.73,436.16 1593.03,708.258 1595.34,695.849 1597.65,445.001 1599.96,406.856 1602.26,571.93 1604.57,456.75 1606.88,498.704 1609.19,319.57 1611.5,579.067 1613.8,429.853 1616.11,445.856 1618.42,318.395 1620.73,451.92 1623.04,595.439 1625.34,423.036 1627.65,472.568 1629.96,259.039 1632.27,596.103 1634.58,469.117 1636.88,419.712 1639.19,512.076 1641.5,498.845 1643.81,631.197 1646.12,407.748 1648.42,435.344 1650.73,629.886 1653.04,520.408 1655.35,511.494 1657.65,601.141 1659.96,369.104 1662.27,389.141 1664.58,456.825 1666.89,637.078 1669.19,543.935 1671.5,380.061 1673.81,490.106 1676.12,429.337 1678.43,335.661 1680.73,487.156 1683.04,463.768 1685.35,460.47 1687.66,476.678 1689.97,357.272 1692.27,466.275 1694.58,569.645 1696.89,624.721 1699.2,476.696 1701.51,502.06 1703.81,478.435 1706.12,419.726 1708.43,498.933 1710.74,325.455 1713.04,334.772 1715.35,486.006 1717.66,539.876 1719.97,624.782 1722.28,388.064 1724.58,462.571 1726.89,479.187 1729.2,659.798 1731.51,490.028 1733.82,558.131 1736.12,576.945 1738.43,519.897 1740.74,560.929 1743.05,575.309 1745.36,429.531 1747.66,484.607 1749.97,589.516 1752.28,505.79 1754.59,648.57 1756.9,454.06 1759.2,408.181 1761.51,523.039 1763.82,409.77 1766.13,655.701 1768.43,605.394 1770.74,510.73 1773.05,474.411 1775.36,373.027 1777.67,454.803 1779.97,649.119 1782.28,485.229 1784.59,602.631 1786.9,480.938 1789.21,368.93 1791.51,619.18 1793.82,418.042 1796.13,349.415 1798.44,428.894 1800.75,460.586 1803.05,414.835 1805.36,568.424 1807.67,399.962 1809.98,474.062 1812.28,553.7 1814.59,509.01 1816.9,504.201 1819.21,749.355 1821.52,645.322 1823.82,399.465 1826.13,458.359 1828.44,703.536 1830.75,502.121 1833.06,600.81 1835.36,528.037 1837.67,566.006 1839.98,455.599 1842.29,625.157 1844.6,567.559 1846.9,715.857 1849.21,360.992 1851.52,482.74 1853.83,479.719 1856.14,647.067 1858.44,497.064 1860.75,487.684 1863.06,502.293 1865.37,492.458 1867.67,376.841 1869.98,286.661 1872.29,527.806 1874.6,542.84 1876.91,423.546 1879.21,512.594 1881.52,371.578 1883.83,604.728 1886.14,567.786 1888.45,549.097 1890.75,464.484 1893.06,413.653 1895.37,453.562 1897.68,572.578 1899.99,557.205 1902.29,554.535 1904.6,281.473 1906.91,560.636 1909.22,453.966 1911.53,524.697 1913.83,469.218 1916.14,490.268 1918.45,486.822 1920.76,379.191 1923.06,551.14 1925.37,512.474 1927.68,597.269 1929.99,455.309 1932.3,442.418 1934.6,394.073 1936.91,629.919 1939.22,395.993 1941.53,493.531 1943.84,521.531 1946.14,600.307 1948.45,450.226 1950.76,523.027 1953.07,355.351 1955.38,441.531 1957.68,560.653 1959.99,425.792 1962.3,440.276 1964.61,293.094 1966.91,535.867 1969.22,463.118 1971.53,460.337 1973.84,402.65 1976.15,386.23 1978.45,470.463 1980.76,500.018 1983.07,479.422 1985.38,462.697 1987.69,504.967 1989.99,368.161 1992.3,287.35 1994.61,594.015 1996.92,474.334 1999.23,193.648 2001.53,465.64 2003.84,481.531 2006.15,509.056 2008.46,521.604 2010.77,542.666 2013.07,341.186 2015.38,336.304 2017.69,437.494 2020,381.567 2022.3,404.043 2024.61,574.604 2026.92,496.262 2029.23,606.434 2031.54,486.914 2033.84,334.177 2036.15,675.709 2038.46,555.892 2040.77,390.935 2043.08,564.135 2045.38,326.592 2047.69,427.349 2050,609.031 2052.31,615.396 2054.62,464.089 2056.92,404.034 2059.23,531.438 2061.54,527.048 2063.85,499.024 2066.16,450.109 2068.46,600.339 2070.77,562.586 2073.08,408.85 2075.39,323.33 2077.69,670.466 2080,468.765 2082.31,449.84 2084.62,459.438 2086.93,299.375 2089.23,367.014 2091.54,407.951 2093.85,311.131 2096.16,395.271 2098.47,401.268 2100.77,293.358 2103.08,432.398 2105.39,564.781 2107.7,410.036 2110.01,507.741 2112.31,506.159 2114.62,430.516 2116.93,557.163 2119.24,458.998 2121.55,570.647 2123.85,389.452 2126.16,425.078 2128.47,466.719 2130.78,432.884 2133.08,535.686 2135.39,363.563 2137.7,470.457 2140.01,159.484 2142.32,401.446 2144.62,595.987 2146.93,469.545 2149.24,516.541 2151.55,670.355 2153.86,368.173 2156.16,443.924 2158.47,446.315 2160.78,554.615 2163.09,349.652 2165.4,320.803 2167.7,780.935 2170.01,377.838 2172.32,443.512 2174.63,529.794 2176.93,405.242 2179.24,439.186 2181.55,573.225 2183.86,423.23 2186.17,378.396 2188.47,450.309 2190.78,96.8724 2193.09,534.338 2195.4,574.452 2197.71,410.411 2200.01,422.488 2202.32,547.783 2204.63,315.667 2206.94,362.707 2209.25,420.425 2211.55,672.802 2213.86,601.198 2216.17,532.53 2218.48,411.602 2220.79,470.856 2223.09,491.731 2225.4,551.033 2227.71,359.123 2230.02,451.061 2232.32,539.939 2234.63,610.141 2236.94,480.669 2239.25,593.058 2241.56,463.834 2243.86,508.572 2246.17,367.869 2248.48,483.212 2250.79,346.419 2253.1,329.304 2255.4,523.307 2257.71,447.436 2260.02,327.452 2262.33,417.819 2264.64,468.777 2266.94,418.375 2269.25,555.177 2271.56,623.503 2273.87,467.71 2276.18,469.854 2278.48,470.567 2280.79,346.098 2283.1,390.308 2285.41,509.817 2287.71,591.15 2290.02,493.331 2292.33,496.887 2294.64,573.847 2296.95,312.618 2299.25,548.187 2301.56,362.715 2303.87,453.537 2306.18,549.563 2308.49,591.274 2310.79,507.302 2313.1,579.456 2315.41,318.722 2317.72,428.049 2320.03,468.745 2322.33,623.347 2324.64,578.299 2326.95,514.995 2329.26,365.37 2331.56,558.855 2333.87,432.149 2336.18,479.499 2338.49,400.822 2340.8,627.937 2343.1,436.545 2345.41,538.804 2347.72,283.389 2350.03,506.236 2352.34,365.525 2354.64,448.555 2356.95,596.012 2359.26,287.832 2361.57,573 2363.88,679.132 2366.18,305.546 2368.49,558.646 2370.8,426.202 2373.11,483.886 2375.42,488.161 2377.72,516.457 2380.03,571.905 2382.34,353.891 2384.65,598.283 2386.95,578.676 2389.26,468.412 2391.57,488.025 2393.88,328.452 2396.19,513.13 2398.49,390.721 2400.8,252.91 2403.11,466.56 2405.42,630.275 2407.73,546.374 2410.03,389.602 2412.34,666.184 2414.65,451.22 2416.96,387.574 2419.27,395.054 2421.57,642.505 2423.88,493.743 2426.19,470.711 2428.5,672.169 2430.81,315.219 2433.11,736.723 2435.42,422.535 2437.73,391.417 2440.04,752.542 2442.34,565.827 2444.65,439.31 2446.96,507.038 2449.27,625.88 2451.58,451.89 2453.88,437.258 2456.19,490.253 2458.5,486.769 2460.81,489.86 2463.12,458.506 2465.42,597.5 2467.73,339.126 2470.04,538.621 2472.35,481.673 2474.66,487.677 2476.96,465.326 2479.27,477.334 2481.58,480.963 2483.89,421.629 2486.2,563.654 2488.5,401.565 2490.81,455.684 2493.12,371.801 2495.43,530.169 2497.73,514.04 2500.04,623.747 2502.35,627.953 2504.66,363.673 2506.97,443.228 2509.27,473.256 2511.58,633.798 2513.89,497.597 2516.2,499.141 2518.51,464.014 2520.81,557.317 2523.12,582.536 2525.43,515.324 2527.74,579.518 2530.05,319.658 2532.35,432.507 2534.66,724.846 2536.97,430.424 2539.28,499.027 2541.58,466.267 2543.89,694.807 2546.2,436.267 2548.51,552.988 2550.82,529.11 2553.12,297.822 2555.43,633.201 2557.74,251.917 2560.05,234.839 2562.36,470.426 2564.66,522.307 2566.97,360.089 2569.28,473.105 2571.59,549.023 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -1.53491   -3.09557   -4.567     …  -4.76601   -6.35964   -5.36696
 -0.233141   0.574808   0.975736      0.399715  -0.685321  -0.0265414
  1.57006    2.96906    5.24414       3.89823    5.53033    4.79498

[:, :, 2] =
 -1.86349  -4.06372   -4.74831   -4.65467   …  -4.64692  -5.95933   -5.85395
  1.21581  -0.192519   0.479041  -0.186333      0.98217   0.284223   0.308224
  3.26233   4.5373     5.0093     4.62241       4.75427   3.35761    3.49704

[:, :, 3] =
 -2.39753   -2.2706    -3.52843   …  -3.40455   -2.83073   -3.06868
 -0.986264  -0.133635  -0.209601     -0.141891   0.142248   1.54782
  4.093      4.68683    4.79871       3.66917    4.7028     4.84705

[:, :, 4] =
 -2.33472   -3.29756   -3.16616   …  -4.59512    -6.60001   -3.74014
  0.227202   0.306782  -0.235901     -0.0867088  -0.757508   0.395693
  2.33782    1.97052    5.89077       2.64351     3.77665    4.11174</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -5.00941     0.997798
 -0.00469194  1.01306
  5.01391     0.994988</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.69 seconds
Compute duration  = 2.69 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -4.9537    1.0212    0.0182   3154.1342   5243.6934    1.0002   ⋯
        x[2]    0.0331    0.9993    0.0175   3250.0223   5355.4195    1.0003   ⋯
        x[3]    5.0214    1.0081    0.0173   3396.8297   4918.6758    1.0012   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -6.9284   -5.6315   -4.9585   -4.2718   -2.9254
        x[2]   -1.9645   -0.6436    0.0416    0.6990    1.9607
        x[3]    3.0160    4.3393    5.0186    5.6988    6.9948</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.56 seconds
Compute duration  = 1.56 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.5018    0.1928    0.0029   4154.6441   5167.6214    0.9999   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1418    0.3563    0.5022    0.6443    0.8619</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.14 seconds
Compute duration  = 0.14 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

           x    0.5244    0.1703    0.0213    48.8646        NaN    1.0372     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.2413    0.3955    0.5246    0.6591    0.7758</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(-0.3595496993539747, "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with -0.3595496993539747:
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/Qeo2J/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/Qeo2J/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/Qeo2J/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/Qeo2J/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/Qeo2J/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/ooLj8/src/compiler.jl:579 [inlined]
  [7] demo
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:593 [inlined]
  [8] _evaluate!!
    @ ~/.julia/packages/DynamicPPL/ooLj8/src/model.jl:975 [inlined]
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, context::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/ooLj8/src/model.jl:964
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/ooLj8/src/model.jl:894 [inlined]
 [11] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/ooLj8/src/values_as_in_model.jl:196 [inlined]
 [12] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/ooLj8/src/values_as_in_model.jl:195 [inlined]
 [13] getparams(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64})
    @ Turing.Inference ~/.julia/packages/Turing/bUZEC/src/mcmc/Inference.jl:383
 [14] Turing.Inference.Transition(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, t::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/bUZEC/src/mcmc/Inference.jl:258
 [15] transition_to_turing
    @ ~/.julia/packages/Turing/bUZEC/src/mcmc/abstractmcmc.jl:12 [inlined]
 [16] transition_to_turing(f::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, transition::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/bUZEC/src/mcmc/abstractmcmc.jl:17
 [17] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}; initial_state::Nothing, initial_params::Nothing, kwargs::@Kwargs{})
    @ Turing.Inference ~/.julia/packages/Turing/bUZEC/src/mcmc/abstractmcmc.jl:147
 [18] macro expansion
    @ ~/.julia/packages/AbstractMCMC/FSyVk/src/sample.jl:0 [inlined]
 [19] macro expansion
    @ ~/.julia/packages/AbstractMCMC/FSyVk/src/logging.jl:16 [inlined]
 [20] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, num_warmup::Int64, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/FSyVk/src/sample.jl:142
 [21] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/ooLj8/src/sampler.jl:93
 [22] sample
    @ ~/.julia/packages/DynamicPPL/ooLj8/src/sampler.jl:83 [inlined]
 [23] #sample#4
    @ ~/.julia/packages/Turing/bUZEC/src/mcmc/Inference.jl:305 [inlined]
 [24] sample
    @ ~/.julia/packages/Turing/bUZEC/src/mcmc/Inference.jl:296 [inlined]
 [25] #sample#3
    @ ~/.julia/packages/Turing/bUZEC/src/mcmc/Inference.jl:293 [inlined]
 [26] top-level scope
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:595</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.75 seconds
Compute duration  = 1.75 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8684    0.5199    0.0205   415.5106   252.6397    1.0046     ⋯
           x    0.0299    0.9311    0.0369   747.2956   581.5201    1.0015     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1348    0.4562    0.7851    1.1832    2.1455
           x   -1.8458   -0.4398   -0.0020    0.4426    2.1677</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 3.64 seconds
Compute duration  = 3.64 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8722    0.5734    0.0219   486.0593   229.8712    1.0034     ⋯
           x    0.0277    0.9854    0.0457   564.1056   536.3481    1.0005     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1301    0.4288    0.7460    1.2025    2.3183
           x   -1.9894   -0.3932   -0.0135    0.4726    2.2357</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>