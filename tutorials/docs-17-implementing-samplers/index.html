<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../tutorials/docs-07-for-developers-variational-inference/index.html" rel="prev">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/docs-00-getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/00-introduction/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.34" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.34</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.34">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Documentation</li><li class="breadcrumb-item"><a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html">Developers: Inference</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Documentation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Using Turing - Modelling Syntax and Interface</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-00-getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-14-using-turing-quick-start/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quick Start</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-12-using-turing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-09-using-turing-advanced/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced Usage</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-10-using-turing-autodiff/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-13-using-turing-performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-11-using-turing-dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-15-using-turing-sampler-viz/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-16-using-turing-external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Using Turing - Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/00-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Turing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/01-gaussian-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/02-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/03-bayesian-neural-network/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/04-hidden-markov-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/05-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/06-infinite-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/07-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/08-multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/09-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/10-bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/11-probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/13-seasonal-time-series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/15-gaussian-processes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Gaussian Processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/12-gplvm/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Developers: Contributing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-01-contributing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to Contribute</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Developers: PPL</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-05-for-developers-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/14-minituring/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/16-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-06-for-developers-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers: Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Documentation</li><li class="breadcrumb-item"><a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html">Developers: Inference</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-26.917884670860527</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-26.917884670860527</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([0.0, 0.0, 0.0]), MALAState{Vector{Float64}}([0.0, 0.0, 0.0]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -2.73213   -2.8136   -2.62251   -3.41246  …  -3.99401   -3.63465  -3.23661
  0.523961   1.14793  -0.549398  -2.32561      0.705456   1.84818   1.10354
  2.34229    4.57103   4.10515    4.34826      5.48765    4.16679   4.59057</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.97088     0.989331
  0.00606391  1.02081
  5.00209     1.00438</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip400">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip400)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip401">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip400)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip402">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1648.9 2640.76,1648.9 "></polyline>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1401.14 2640.76,1401.14 "></polyline>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1153.38 2640.76,1153.38 "></polyline>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,905.616 2640.76,905.616 "></polyline>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,657.856 2640.76,657.856 "></polyline>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,410.096 2640.76,410.096 "></polyline>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,162.336 2640.76,162.336 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip400)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1648.9 215.714,1648.9 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1401.14 215.714,1401.14 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1153.38 215.714,1153.38 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,905.616 215.714,905.616 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,657.856 215.714,657.856 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,410.096 215.714,410.096 "></polyline>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,162.336 215.714,162.336 "></polyline>
<path clip-path="url(#clip400)" d="M50.5475 1649.35 L80.2233 1649.35 L80.2233 1653.28 L50.5475 1653.28 L50.5475 1649.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M89.1352 1631.62 L111.357 1631.62 L111.357 1633.61 L98.8111 1666.18 L93.9269 1666.18 L105.732 1635.55 L89.1352 1635.55 L89.1352 1631.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M120.478 1660.3 L125.362 1660.3 L125.362 1666.18 L120.478 1666.18 L120.478 1660.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M135.593 1631.62 L153.95 1631.62 L153.95 1635.55 L139.876 1635.55 L139.876 1644.02 Q140.894 1643.68 141.913 1643.51 Q142.931 1643.33 143.95 1643.33 Q149.737 1643.33 153.116 1646.5 Q156.496 1649.67 156.496 1655.09 Q156.496 1660.67 153.024 1663.77 Q149.552 1666.85 143.232 1666.85 Q141.056 1666.85 138.788 1666.48 Q136.542 1666.11 134.135 1665.36 L134.135 1660.67 Q136.218 1661.8 138.441 1662.36 Q140.663 1662.91 143.14 1662.91 Q147.144 1662.91 149.482 1660.8 Q151.82 1658.7 151.82 1655.09 Q151.82 1651.48 149.482 1649.37 Q147.144 1647.26 143.14 1647.26 Q141.265 1647.26 139.39 1647.68 Q137.538 1648.1 135.593 1648.98 L135.593 1631.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M49.5521 1401.59 L79.2279 1401.59 L79.2279 1405.52 L49.5521 1405.52 L49.5521 1401.59 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M89.3667 1383.86 L107.723 1383.86 L107.723 1387.79 L93.6491 1387.79 L93.6491 1396.26 Q94.6676 1395.92 95.6861 1395.75 Q96.7047 1395.57 97.7232 1395.57 Q103.51 1395.57 106.89 1398.74 Q110.269 1401.91 110.269 1407.33 Q110.269 1412.91 106.797 1416.01 Q103.325 1419.09 97.0056 1419.09 Q94.8297 1419.09 92.5612 1418.72 Q90.3158 1418.35 87.9084 1417.61 L87.9084 1412.91 Q89.9917 1414.04 92.2139 1414.6 Q94.4361 1415.15 96.913 1415.15 Q100.918 1415.15 103.256 1413.04 Q105.593 1410.94 105.593 1407.33 Q105.593 1403.72 103.256 1401.61 Q100.918 1399.5 96.913 1399.5 Q95.038 1399.5 93.163 1399.92 Q91.3112 1400.34 89.3667 1401.22 L89.3667 1383.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M119.482 1412.54 L124.367 1412.54 L124.367 1418.42 L119.482 1418.42 L119.482 1412.54 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M144.552 1386.93 Q140.941 1386.93 139.112 1390.5 Q137.306 1394.04 137.306 1401.17 Q137.306 1408.28 139.112 1411.84 Q140.941 1415.38 144.552 1415.38 Q148.186 1415.38 149.991 1411.84 Q151.82 1408.28 151.82 1401.17 Q151.82 1394.04 149.991 1390.5 Q148.186 1386.93 144.552 1386.93 M144.552 1383.23 Q150.362 1383.23 153.417 1387.84 Q156.496 1392.42 156.496 1401.17 Q156.496 1409.9 153.417 1414.5 Q150.362 1419.09 144.552 1419.09 Q138.741 1419.09 135.663 1414.5 Q132.607 1409.9 132.607 1401.17 Q132.607 1392.42 135.663 1387.84 Q138.741 1383.23 144.552 1383.23 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M50.5475 1153.83 L80.2233 1153.83 L80.2233 1157.76 L50.5475 1157.76 L50.5475 1153.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M94.3436 1166.72 L110.663 1166.72 L110.663 1170.66 L88.7186 1170.66 L88.7186 1166.72 Q91.3806 1163.97 95.9639 1159.34 Q100.57 1154.68 101.751 1153.34 Q103.996 1150.82 104.876 1149.08 Q105.779 1147.32 105.779 1145.63 Q105.779 1142.88 103.834 1141.14 Q101.913 1139.41 98.8111 1139.41 Q96.6121 1139.41 94.1584 1140.17 Q91.7278 1140.93 88.9501 1142.48 L88.9501 1137.76 Q91.7741 1136.63 94.2278 1136.05 Q96.6815 1135.47 98.7185 1135.47 Q104.089 1135.47 107.283 1138.16 Q110.478 1140.84 110.478 1145.33 Q110.478 1147.46 109.668 1149.38 Q108.881 1151.28 106.774 1153.87 Q106.195 1154.54 103.094 1157.76 Q99.9917 1160.96 94.3436 1166.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M120.478 1164.78 L125.362 1164.78 L125.362 1170.66 L120.478 1170.66 L120.478 1164.78 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M135.593 1136.1 L153.95 1136.1 L153.95 1140.03 L139.876 1140.03 L139.876 1148.5 Q140.894 1148.16 141.913 1147.99 Q142.931 1147.81 143.95 1147.81 Q149.737 1147.81 153.116 1150.98 Q156.496 1154.15 156.496 1159.57 Q156.496 1165.15 153.024 1168.25 Q149.552 1171.33 143.232 1171.33 Q141.056 1171.33 138.788 1170.96 Q136.542 1170.59 134.135 1169.85 L134.135 1165.15 Q136.218 1166.28 138.441 1166.84 Q140.663 1167.39 143.14 1167.39 Q147.144 1167.39 149.482 1165.29 Q151.82 1163.18 151.82 1159.57 Q151.82 1155.96 149.482 1153.85 Q147.144 1151.74 143.14 1151.74 Q141.265 1151.74 139.39 1152.16 Q137.538 1152.58 135.593 1153.46 L135.593 1136.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M99.3204 891.414 Q95.7093 891.414 93.8806 894.979 Q92.075 898.521 92.075 905.65 Q92.075 912.757 93.8806 916.322 Q95.7093 919.863 99.3204 919.863 Q102.955 919.863 104.76 916.322 Q106.589 912.757 106.589 905.65 Q106.589 898.521 104.76 894.979 Q102.955 891.414 99.3204 891.414 M99.3204 887.711 Q105.131 887.711 108.186 892.317 Q111.265 896.9 111.265 905.65 Q111.265 914.377 108.186 918.984 Q105.131 923.567 99.3204 923.567 Q93.5102 923.567 90.4315 918.984 Q87.376 914.377 87.376 905.65 Q87.376 896.9 90.4315 892.317 Q93.5102 887.711 99.3204 887.711 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M119.482 917.016 L124.367 917.016 L124.367 922.896 L119.482 922.896 L119.482 917.016 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M144.552 891.414 Q140.941 891.414 139.112 894.979 Q137.306 898.521 137.306 905.65 Q137.306 912.757 139.112 916.322 Q140.941 919.863 144.552 919.863 Q148.186 919.863 149.991 916.322 Q151.82 912.757 151.82 905.65 Q151.82 898.521 149.991 894.979 Q148.186 891.414 144.552 891.414 M144.552 887.711 Q150.362 887.711 153.417 892.317 Q156.496 896.9 156.496 905.65 Q156.496 914.377 153.417 918.984 Q150.362 923.567 144.552 923.567 Q138.741 923.567 135.663 918.984 Q132.607 914.377 132.607 905.65 Q132.607 896.9 135.663 892.317 Q138.741 887.711 144.552 887.711 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M94.3436 671.201 L110.663 671.201 L110.663 675.136 L88.7186 675.136 L88.7186 671.201 Q91.3806 668.446 95.9639 663.816 Q100.57 659.164 101.751 657.821 Q103.996 655.298 104.876 653.562 Q105.779 651.802 105.779 650.113 Q105.779 647.358 103.834 645.622 Q101.913 643.886 98.8111 643.886 Q96.6121 643.886 94.1584 644.65 Q91.7278 645.414 88.9501 646.965 L88.9501 642.242 Q91.7741 641.108 94.2278 640.529 Q96.6815 639.951 98.7185 639.951 Q104.089 639.951 107.283 642.636 Q110.478 645.321 110.478 649.812 Q110.478 651.941 109.668 653.863 Q108.881 655.761 106.774 658.353 Q106.195 659.025 103.094 662.242 Q99.9917 665.437 94.3436 671.201 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M120.478 669.256 L125.362 669.256 L125.362 675.136 L120.478 675.136 L120.478 669.256 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M135.593 640.576 L153.95 640.576 L153.95 644.511 L139.876 644.511 L139.876 652.983 Q140.894 652.636 141.913 652.474 Q142.931 652.289 143.95 652.289 Q149.737 652.289 153.116 655.46 Q156.496 658.631 156.496 664.048 Q156.496 669.626 153.024 672.728 Q149.552 675.807 143.232 675.807 Q141.056 675.807 138.788 675.437 Q136.542 675.066 134.135 674.325 L134.135 669.626 Q136.218 670.761 138.441 671.316 Q140.663 671.872 143.14 671.872 Q147.144 671.872 149.482 669.765 Q151.82 667.659 151.82 664.048 Q151.82 660.437 149.482 658.33 Q147.144 656.224 143.14 656.224 Q141.265 656.224 139.39 656.64 Q137.538 657.057 135.593 657.937 L135.593 640.576 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M89.3667 392.816 L107.723 392.816 L107.723 396.751 L93.6491 396.751 L93.6491 405.223 Q94.6676 404.876 95.6861 404.714 Q96.7047 404.529 97.7232 404.529 Q103.51 404.529 106.89 407.7 Q110.269 410.871 110.269 416.288 Q110.269 421.867 106.797 424.968 Q103.325 428.047 97.0056 428.047 Q94.8297 428.047 92.5612 427.677 Q90.3158 427.306 87.9084 426.566 L87.9084 421.867 Q89.9917 423.001 92.2139 423.556 Q94.4361 424.112 96.913 424.112 Q100.918 424.112 103.256 422.005 Q105.593 419.899 105.593 416.288 Q105.593 412.677 103.256 410.57 Q100.918 408.464 96.913 408.464 Q95.038 408.464 93.163 408.881 Q91.3112 409.297 89.3667 410.177 L89.3667 392.816 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M119.482 421.496 L124.367 421.496 L124.367 427.376 L119.482 427.376 L119.482 421.496 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M144.552 395.894 Q140.941 395.894 139.112 399.459 Q137.306 403.001 137.306 410.131 Q137.306 417.237 139.112 420.802 Q140.941 424.343 144.552 424.343 Q148.186 424.343 149.991 420.802 Q151.82 417.237 151.82 410.131 Q151.82 403.001 149.991 399.459 Q148.186 395.894 144.552 395.894 M144.552 392.191 Q150.362 392.191 153.417 396.797 Q156.496 401.381 156.496 410.131 Q156.496 418.857 153.417 423.464 Q150.362 428.047 144.552 428.047 Q138.741 428.047 135.663 423.464 Q132.607 418.857 132.607 410.131 Q132.607 401.381 135.663 396.797 Q138.741 392.191 144.552 392.191 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M89.1352 145.056 L111.357 145.056 L111.357 147.047 L98.8111 179.616 L93.9269 179.616 L105.732 148.991 L89.1352 148.991 L89.1352 145.056 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M120.478 173.736 L125.362 173.736 L125.362 179.616 L120.478 179.616 L120.478 173.736 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip400)" d="M135.593 145.056 L153.95 145.056 L153.95 148.991 L139.876 148.991 L139.876 157.463 Q140.894 157.116 141.913 156.954 Q142.931 156.769 143.95 156.769 Q149.737 156.769 153.116 159.94 Q156.496 163.111 156.496 168.528 Q156.496 174.107 153.024 177.209 Q149.552 180.287 143.232 180.287 Q141.056 180.287 138.788 179.917 Q136.542 179.546 134.135 178.806 L134.135 174.107 Q136.218 175.241 138.441 175.796 Q140.663 176.352 143.14 176.352 Q147.144 176.352 149.482 174.246 Q151.82 172.139 151.82 168.528 Q151.82 164.917 149.482 162.81 Q147.144 160.704 143.14 160.704 Q141.265 160.704 139.39 161.121 Q137.538 161.537 135.593 162.417 L135.593 145.056 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip402)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1176.38 268.292,1290.84 270.6,1421.53 272.908,1357.61 275.216,1536.52 277.524,1275.02 279.832,1491.38 282.139,1319.53 284.447,1402.26 286.755,1354.61 289.063,1367.47 291.371,1316.72 293.679,1645.14 295.987,1367.59 298.295,1444.34 300.603,1414.93 302.911,1367.29 305.219,1268.78 307.527,1489.87 309.834,1477.77 312.142,1387.74 314.45,1417.53 316.758,1312.75 319.066,1408.07 321.374,1572.34 323.682,1581.95 325.99,1577 328.298,1455.51 330.606,1332.85 332.914,1498.56 335.221,1425.17 337.529,1334.1 339.837,1467.95 342.145,1257.5 344.453,1260.17 346.761,1505.84 349.069,1343.37 351.377,1398.03 353.685,1375.81 355.993,1406.35 358.301,1268.15 360.608,1299.46 362.916,1398.94 365.224,1462.88 367.532,1401.86 369.84,1266.61 372.148,1339.12 374.456,1558.92 376.764,1353.65 379.072,1208.48 381.38,1447.84 383.688,1428.27 385.996,1259.6 388.303,1515.35 390.611,1409.21 392.919,1538.62 395.227,1680.56 397.535,1528.46 399.843,1318.38 402.151,1541.55 404.459,1372.2 406.767,1429.57 409.075,1581.5 411.383,1395.35 413.69,1371.12 415.998,1356.23 418.306,1457.16 420.614,1465.57 422.922,1323.06 425.23,1347.19 427.538,1244.95 429.846,1301.69 432.154,1281.6 434.462,1457.68 436.77,1463.61 439.077,1271.57 441.385,1414.79 443.693,1538.95 446.001,1265.25 448.309,1373.03 450.617,1320.66 452.925,1368.26 455.233,1458.51 457.541,1566.92 459.849,1341.51 462.157,1360.12 464.465,1381.05 466.772,1460.96 469.08,1608.44 471.388,1519.55 473.696,1448.07 476.004,1539.87 478.312,1287.41 480.62,1422.04 482.928,1321.14 485.236,1516.93 487.544,1362.79 489.852,1632.07 492.159,1173.99 494.467,1411.09 496.775,1523.22 499.083,1407.6 501.391,1419.97 503.699,1456.74 506.007,1355.54 508.315,1604.21 510.623,1390.27 512.931,1409.07 515.239,1513.35 517.546,1390.08 519.854,1377.95 522.162,1379.57 524.47,1424.57 526.778,1456.64 529.086,1330.93 531.394,1505.95 533.702,1389.99 536.01,1542.41 538.318,1482.89 540.626,1328.42 542.933,1449.31 545.241,1337.56 547.549,1461.01 549.857,1368.18 552.165,1319.21 554.473,1562.66 556.781,1480.45 559.089,1305.44 561.397,1458.21 563.705,1438.87 566.013,1423.43 568.321,1515.41 570.628,1278.07 572.936,1279.76 575.244,1368.46 577.552,1409.92 579.86,1355.94 582.168,1419.27 584.476,1399.65 586.784,1242.06 589.092,1238.7 591.4,1343.3 593.708,1347.97 596.015,1619.38 598.323,1416.75 600.631,1299.04 602.939,1317.76 605.247,1334.25 607.555,1360.13 609.863,1290.79 612.171,1276.45 614.479,1495.67 616.787,1188.14 619.095,1406.27 621.402,1549.7 623.71,1321.66 626.018,1293.32 628.326,1478.27 630.634,1381.8 632.942,1173.1 635.25,1311.89 637.558,1276.61 639.866,1485.92 642.174,1443.43 644.482,1320.22 646.79,1408.24 649.097,1291.56 651.405,1301.92 653.713,1442.16 656.021,1478.25 658.329,1391.97 660.637,1442.71 662.945,1376.55 665.253,1442.96 667.561,1360.1 669.869,1564.83 672.177,1305.36 674.484,1337.74 676.792,1405.99 679.1,1585.79 681.408,1619.98 683.716,1342.93 686.024,1495.54 688.332,1457.58 690.64,1507.9 692.948,1363.3 695.256,1353.84 697.564,1498.17 699.871,1416.21 702.179,1449.74 704.487,1376.78 706.795,1448.88 709.103,1525.96 711.411,1338.24 713.719,1414.58 716.027,1332.6 718.335,1341.9 720.643,1342.74 722.951,1450.88 725.259,1492.49 727.566,1512.77 729.874,1283.88 732.182,1541.39 734.49,1385.85 736.798,1294.18 739.106,1381.24 741.414,1260.83 743.722,1280.21 746.03,1388.99 748.338,1482.94 750.646,1492.38 752.953,1336.9 755.261,1436.01 757.569,1473.25 759.877,1513.01 762.185,1401.24 764.493,1371.03 766.801,1411.71 769.109,1387.4 771.417,1349.29 773.725,1389.99 776.033,1508.24 778.34,1465.48 780.648,1400.51 782.956,1557.3 785.264,1485.92 787.572,1311.97 789.88,1387.11 792.188,1273.44 794.496,1479.6 796.804,1413.93 799.112,1490.57 801.42,1559.57 803.728,1317.4 806.035,1272.66 808.343,1405.68 810.651,1398.44 812.959,1455.51 815.267,1578.63 817.575,1454.14 819.883,1423.08 822.191,1411.17 824.499,1500.59 826.807,1337.38 829.115,1381.64 831.422,1359.05 833.73,1337.92 836.038,1413.18 838.346,1440.3 840.654,1302.5 842.962,1318.96 845.27,1455.66 847.578,1233.39 849.886,1433.39 852.194,1426.49 854.502,1439.56 856.809,1301.15 859.117,1290.43 861.425,1417.77 863.733,1482.68 866.041,1399.02 868.349,1493.37 870.657,1429.84 872.965,1506.35 875.273,1684.46 877.581,1360.22 879.889,1415.22 882.197,1350.73 884.504,1606.18 886.812,1408.87 889.12,1360.36 891.428,1609.2 893.736,1418.14 896.044,1256.69 898.352,1434.8 900.66,1249.17 902.968,1383.52 905.276,1541.08 907.584,1429.41 909.891,1357.69 912.199,1214.88 914.507,1484.13 916.815,1537.9 919.123,1400.61 921.431,1377.1 923.739,1376.45 926.047,1589.3 928.355,1448.93 930.663,1470.59 932.971,1137.16 935.278,1515.62 937.586,1298.37 939.894,1467.36 942.202,1467.3 944.51,1479.2 946.818,1357.5 949.126,1237.76 951.434,1500.4 953.742,1255.02 956.05,1483.09 958.358,1621.63 960.665,1458.9 962.973,1369.08 965.281,1363.73 967.589,1355.86 969.897,1247.77 972.205,1420.61 974.513,1382.46 976.821,1463.66 979.129,1422.8 981.437,1162.11 983.745,1498.16 986.053,1311.37 988.36,1333.74 990.668,1309.89 992.976,1369.31 995.284,1341.17 997.592,1574.28 999.9,1452.73 1002.21,1287.43 1004.52,1274.29 1006.82,1405.76 1009.13,1436.17 1011.44,1364.67 1013.75,1397.3 1016.06,1418.94 1018.36,1338.05 1020.67,1338.86 1022.98,1443.39 1025.29,1340.41 1027.59,1452.84 1029.9,1470.11 1032.21,1458.79 1034.52,1385.46 1036.83,1515.09 1039.13,1196.58 1041.44,1270.21 1043.75,1367.29 1046.06,1444.69 1048.37,1370.62 1050.67,1341.53 1052.98,1459.62 1055.29,1220.12 1057.6,1320.55 1059.91,1466.43 1062.21,1424.11 1064.52,1336.31 1066.83,1471.63 1069.14,1423.83 1071.45,1419.6 1073.75,1599.34 1076.06,1309.9 1078.37,1501.09 1080.68,1621.92 1082.98,1476.41 1085.29,1547.55 1087.6,1420.69 1089.91,1369.74 1092.22,1203.14 1094.52,1350.9 1096.83,1421.07 1099.14,1268.33 1101.45,1400.96 1103.76,1431.2 1106.06,1331.54 1108.37,1469.49 1110.68,1454.22 1112.99,1479.53 1115.3,1315.01 1117.6,1363.64 1119.91,1204.13 1122.22,1275.05 1124.53,1413.69 1126.84,1546.19 1129.14,1383.83 1131.45,1261.38 1133.76,1427.23 1136.07,1343.09 1138.37,1258 1140.68,1336.02 1142.99,1256.5 1145.3,1419.32 1147.61,1445.81 1149.91,1673.47 1152.22,1497 1154.53,1377.49 1156.84,1549.28 1159.15,1478.33 1161.45,1355.44 1163.76,1319.71 1166.07,1387.52 1168.38,1406.66 1170.69,1346.39 1172.99,1336.96 1175.3,1533.71 1177.61,1447.24 1179.92,1345.69 1182.23,1399.01 1184.53,1325.28 1186.84,1324.54 1189.15,1237.05 1191.46,1384.64 1193.76,1375.78 1196.07,1241.1 1198.38,1474.36 1200.69,1255.03 1203,1358.05 1205.3,1404.99 1207.61,1349.78 1209.92,1377.35 1212.23,1556.74 1214.54,1284.07 1216.84,1483.65 1219.15,1348.95 1221.46,1457.65 1223.77,1225.46 1226.08,1332.77 1228.38,1431.65 1230.69,1376.07 1233,1460.8 1235.31,1257.82 1237.61,1284.44 1239.92,1460.23 1242.23,1310.89 1244.54,1198.4 1246.85,1465.02 1249.15,1467.19 1251.46,1550.89 1253.77,1337.39 1256.08,1511.18 1258.39,1494.28 1260.69,1404.58 1263,1533.62 1265.31,1419.76 1267.62,1330.92 1269.93,1412.22 1272.23,1199.15 1274.54,1305.47 1276.85,1528.84 1279.16,1492.61 1281.47,1531.01 1283.77,1483.95 1286.08,1200.15 1288.39,1323.08 1290.7,1346.73 1293,1495.29 1295.31,1364.66 1297.62,1184.87 1299.93,1523.28 1302.24,1392.39 1304.54,1365.39 1306.85,1369.24 1309.16,1312.95 1311.47,1359.11 1313.78,1412.05 1316.08,1445.82 1318.39,1366.15 1320.7,1498.04 1323.01,1309.49 1325.32,1317.86 1327.62,1409.37 1329.93,1450.77 1332.24,1521.73 1334.55,1360.58 1336.86,1318.96 1339.16,1203.91 1341.47,1296.91 1343.78,1595.42 1346.09,1366.38 1348.39,1380.93 1350.7,1280.26 1353.01,1460.31 1355.32,1342.59 1357.63,1251.09 1359.93,1227.34 1362.24,1437.08 1364.55,1323.21 1366.86,1302.58 1369.17,1415.54 1371.47,1208.57 1373.78,1310.74 1376.09,1476.6 1378.4,1354.11 1380.71,1345.12 1383.01,1399.68 1385.32,1366.38 1387.63,1361.79 1389.94,1271.38 1392.24,1277.2 1394.55,1390.06 1396.86,1431.47 1399.17,1328.62 1401.48,1411.11 1403.78,1382.69 1406.09,1388.98 1408.4,1499.01 1410.71,1236.59 1413.02,1299.21 1415.32,1390.78 1417.63,1306.24 1419.94,1438.14 1422.25,1459.59 1424.56,1691.16 1426.86,1244.85 1429.17,1423.73 1431.48,1547.09 1433.79,1298.73 1436.1,1421.65 1438.4,1306.97 1440.71,1328.76 1443.02,1545.32 1445.33,1378.29 1447.63,1519.36 1449.94,1407.22 1452.25,1427.31 1454.56,1476.29 1456.87,1312.92 1459.17,1395.05 1461.48,1490.33 1463.79,1415.9 1466.1,1424.35 1468.41,1351.43 1470.71,1256.18 1473.02,1469.55 1475.33,1351.23 1477.64,1402.6 1479.95,1338.12 1482.25,1323.81 1484.56,1353.57 1486.87,1424.1 1489.18,1302.58 1491.49,1422.88 1493.79,1372.81 1496.1,1391.71 1498.41,1282.83 1500.72,1315.97 1503.02,1428.83 1505.33,1423.69 1507.64,1315.4 1509.95,1507.56 1512.26,1342.63 1514.56,1437.71 1516.87,1447.02 1519.18,1271.89 1521.49,1291.86 1523.8,1298.15 1526.1,1443.92 1528.41,1372.05 1530.72,1397 1533.03,1480.62 1535.34,1434.38 1537.64,1542.61 1539.95,1530.44 1542.26,1479.33 1544.57,1352.85 1546.88,1247.39 1549.18,1308.37 1551.49,1130.56 1553.8,1516.48 1556.11,1450.87 1558.41,1477.56 1560.72,1297.75 1563.03,1374.33 1565.34,1450.52 1567.65,1328.55 1569.95,1407.21 1572.26,1396.68 1574.57,1500.94 1576.88,1379.77 1579.19,1487.79 1581.49,1593.96 1583.8,1431.16 1586.11,1379.74 1588.42,1303.34 1590.73,1295.81 1593.03,1474.77 1595.34,1495.14 1597.65,1408.8 1599.96,1388.37 1602.26,1270.89 1604.57,1521.91 1606.88,1527.78 1609.19,1608.1 1611.5,1352.02 1613.8,1349.99 1616.11,1338.46 1618.42,1465.97 1620.73,1472.46 1623.04,1425.63 1625.34,1432.8 1627.65,1477.53 1629.96,1416.36 1632.27,1343.76 1634.58,1359.89 1636.88,1288.6 1639.19,1347.93 1641.5,1306.2 1643.81,1294.72 1646.12,1294.09 1648.42,1332.92 1650.73,1399.02 1653.04,1275.79 1655.35,1290.5 1657.65,1348.87 1659.96,1422.27 1662.27,1275.8 1664.58,1347.93 1666.89,1406.68 1669.19,1256.47 1671.5,1457.98 1673.81,1232.16 1676.12,1395.88 1678.43,1286.75 1680.73,1531.11 1683.04,1417.17 1685.35,1423.96 1687.66,1245.67 1689.97,1285.79 1692.27,1466.59 1694.58,1541.99 1696.89,1384.65 1699.2,1503.32 1701.51,1347.6 1703.81,1335.91 1706.12,1260.45 1708.43,1408.08 1710.74,1384.14 1713.04,1309.17 1715.35,1374.7 1717.66,1503.23 1719.97,1362.41 1722.28,1306.11 1724.58,1513.3 1726.89,1192.21 1729.2,1345.25 1731.51,1474.93 1733.82,1587.18 1736.12,1293.93 1738.43,1276.72 1740.74,1364.68 1743.05,1616.97 1745.36,1481.44 1747.66,1357.19 1749.97,1343.69 1752.28,1490.99 1754.59,1456.42 1756.9,1349.71 1759.2,1268.57 1761.51,1665.01 1763.82,1489.75 1766.13,1616.73 1768.43,1419.47 1770.74,1365.78 1773.05,1465.38 1775.36,1247.19 1777.67,1419.05 1779.97,1612.5 1782.28,1373.78 1784.59,1369.42 1786.9,1213.49 1789.21,1307.68 1791.51,1280.25 1793.82,1488.56 1796.13,1301.41 1798.44,1533.16 1800.75,1507.97 1803.05,1373.08 1805.36,1498.46 1807.67,1365.91 1809.98,1513.03 1812.28,1324.39 1814.59,1465.13 1816.9,1306.65 1819.21,1444.71 1821.52,1299.31 1823.82,1396.92 1826.13,1372.94 1828.44,1309.98 1830.75,1256.39 1833.06,1378.29 1835.36,1304.12 1837.67,1387.11 1839.98,1387.65 1842.29,1617.28 1844.6,1418.27 1846.9,1428.04 1849.21,1230.74 1851.52,1519.38 1853.83,1655.64 1856.14,1378.12 1858.44,1308.68 1860.75,1287.43 1863.06,1317.92 1865.37,1422.76 1867.67,1294.83 1869.98,1496.85 1872.29,1232.4 1874.6,1401.12 1876.91,1326.07 1879.21,1517.74 1881.52,1450.01 1883.83,1523.84 1886.14,1377.48 1888.45,1448.3 1890.75,1362.81 1893.06,1338.67 1895.37,1330.26 1897.68,1396.14 1899.99,1379.99 1902.29,1394.98 1904.6,1350.04 1906.91,1366.21 1909.22,1592.54 1911.53,1445.35 1913.83,1315.62 1916.14,1450.18 1918.45,1338.26 1920.76,1485.84 1923.06,1344.04 1925.37,1315.76 1927.68,1329.08 1929.99,1538.12 1932.3,1336.14 1934.6,1253.88 1936.91,1395.66 1939.22,1481.32 1941.53,1598.48 1943.84,1397.71 1946.14,1357.9 1948.45,1488.97 1950.76,1599.15 1953.07,1363.14 1955.38,1346.02 1957.68,1485.97 1959.99,1544.88 1962.3,1421.7 1964.61,1394.1 1966.91,1418.69 1969.22,1267.13 1971.53,1515.51 1973.84,1483.49 1976.15,1119.46 1978.45,1354.86 1980.76,1508.77 1983.07,1472.42 1985.38,1571.88 1987.69,1394.65 1989.99,1249.43 1992.3,1239.37 1994.61,1524.25 1996.92,1490.22 1999.23,1450.07 2001.53,1427.51 2003.84,1306.68 2006.15,1600.57 2008.46,1421.16 2010.77,1378.74 2013.07,1254.92 2015.38,1415.56 2017.69,1314.29 2020,1182.75 2022.3,1361.74 2024.61,1507.93 2026.92,1402.64 2029.23,1268.63 2031.54,1268 2033.84,1412.13 2036.15,1383.03 2038.46,1421.11 2040.77,1388.88 2043.08,1473.22 2045.38,1468.78 2047.69,1439.15 2050,1404.84 2052.31,1372.98 2054.62,1351 2056.92,1329.85 2059.23,1386.54 2061.54,1416.8 2063.85,1326.12 2066.16,1363.99 2068.46,1262.58 2070.77,1449.48 2073.08,1580.21 2075.39,1555.99 2077.69,1235.96 2080,1451.86 2082.31,1366.27 2084.62,1317 2086.93,1369.54 2089.23,1437.36 2091.54,1404.09 2093.85,1261.95 2096.16,1336.51 2098.47,1503.5 2100.77,1412.61 2103.08,1275.7 2105.39,1354.1 2107.7,1445.33 2110.01,1500.74 2112.31,1434.9 2114.62,1275.66 2116.93,1512.69 2119.24,1591.72 2121.55,1445.45 2123.85,1376.84 2126.16,1391.25 2128.47,1185.9 2130.78,1493.32 2133.08,1539.04 2135.39,1401.18 2137.7,1485.51 2140.01,1284.32 2142.32,1514.22 2144.62,1601.97 2146.93,1579.74 2149.24,1423.96 2151.55,1422.24 2153.86,1503.91 2156.16,1488.89 2158.47,1312.97 2160.78,1440.22 2163.09,1376.82 2165.4,1269.38 2167.7,1295.29 2170.01,1642.66 2172.32,1479.72 2174.63,1751.15 2176.93,1361.55 2179.24,1360.61 2181.55,1274.13 2183.86,1496.6 2186.17,1443.77 2188.47,1454.84 2190.78,1440.17 2193.09,1240.6 2195.4,1280.51 2197.71,1380.42 2200.01,1242.12 2202.32,1479.85 2204.63,1473.17 2206.94,1460.61 2209.25,1441.57 2211.55,1630.77 2213.86,1340.17 2216.17,1401.66 2218.48,1441.64 2220.79,1242.79 2223.09,1575.28 2225.4,1351.59 2227.71,1520.2 2230.02,1520.2 2232.32,1443.05 2234.63,1413.63 2236.94,1326.77 2239.25,1464.69 2241.56,1548.02 2243.86,1287.55 2246.17,1466.76 2248.48,1465.84 2250.79,1241.09 2253.1,1386.36 2255.4,1159.6 2257.71,1437.76 2260.02,1356.59 2262.33,1516.5 2264.64,1414.63 2266.94,1316.57 2269.25,1293.76 2271.56,1258.23 2273.87,1273.56 2276.18,1462.38 2278.48,1116.7 2280.79,1481.28 2283.1,1437.21 2285.41,1358.56 2287.71,1299.69 2290.02,1450.45 2292.33,1300.11 2294.64,1475.41 2296.95,1401.66 2299.25,1420.11 2301.56,1444.44 2303.87,1520.68 2306.18,1408.25 2308.49,1465.9 2310.79,1515.68 2313.1,1509.09 2315.41,1580.58 2317.72,1343 2320.03,1524.85 2322.33,1287.63 2324.64,1344.05 2326.95,1437.58 2329.26,1190.7 2331.56,1241.88 2333.87,1579.6 2336.18,1469.8 2338.49,1295.52 2340.8,1355.29 2343.1,1408.05 2345.41,1294.79 2347.72,1422.7 2350.03,1324.89 2352.34,1352.01 2354.64,1330.05 2356.95,1380.27 2359.26,1330.82 2361.57,1508.85 2363.88,1345.48 2366.18,1516.61 2368.49,1277.66 2370.8,1376.4 2373.11,1448.79 2375.42,1313.61 2377.72,1305.81 2380.03,1248.58 2382.34,1408.74 2384.65,1608.97 2386.95,1321.67 2389.26,1258.9 2391.57,1420.53 2393.88,1374.94 2396.19,1511.72 2398.49,1512.26 2400.8,1426.98 2403.11,1352.17 2405.42,1370.38 2407.73,1366.96 2410.03,1314.09 2412.34,1395.57 2414.65,1312.36 2416.96,1268.56 2419.27,1356.5 2421.57,1508.52 2423.88,1525.62 2426.19,1284.16 2428.5,1209.54 2430.81,1379.16 2433.11,1488.87 2435.42,1520.39 2437.73,1326.12 2440.04,1365.22 2442.34,1371.56 2444.65,1427.72 2446.96,1411.81 2449.27,1449.43 2451.58,1388.06 2453.88,1385.32 2456.19,1493.76 2458.5,1377.92 2460.81,1539.24 2463.12,1290.44 2465.42,1329.19 2467.73,1389.14 2470.04,1158.59 2472.35,1376.62 2474.66,1364.97 2476.96,1328.49 2479.27,1281.65 2481.58,1381.82 2483.89,1491.38 2486.2,1445.34 2488.5,1312.85 2490.81,1555.08 2493.12,1251.68 2495.43,1295.71 2497.73,1383.18 2500.04,1338.73 2502.35,1530.71 2504.66,1370.13 2506.97,1403.6 2509.27,1345.16 2511.58,1352.51 2513.89,1446.31 2516.2,1309.65 2518.51,1339.38 2520.81,1490.31 2523.12,1516.92 2525.43,1323.86 2527.74,1421.99 2530.05,1287.65 2532.35,1523.61 2534.66,1470.44 2536.97,1311.92 2539.28,1449.58 2541.58,1333.93 2543.89,1438.48 2546.2,1490.09 2548.51,1314.81 2550.82,1350.73 2553.12,1373.58 2555.43,1387.43 2557.74,1578.57 2560.05,1395.09 2562.36,1469.76 2564.66,1468.59 2566.97,1355.49 2569.28,1428.37 2571.59,1346 "></polyline>
<polyline clip-path="url(#clip402)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,853.689 268.292,924.116 270.6,960.46 272.908,931.992 275.216,891.404 277.524,1083.96 279.832,871.879 282.139,896.305 284.447,760.474 286.755,1145.87 289.063,972.902 291.371,1016.17 293.679,961.009 295.987,845.148 298.295,800.806 300.603,799.97 302.911,1134.53 305.219,872.274 307.527,872.958 309.834,789.697 312.142,852.146 314.45,900.973 316.758,863.263 319.066,855.803 321.374,1003.29 323.682,1054.24 325.99,942.736 328.298,943.097 330.606,1015.52 332.914,812.498 335.221,984.913 337.529,757.765 339.837,1002.36 342.145,1015.57 344.453,985.202 346.761,854.592 349.069,834.218 351.377,845.882 353.685,811.35 355.993,1035.96 358.301,931.049 360.608,857.167 362.916,918.141 365.224,734.33 367.532,934.281 369.84,916.328 372.148,841.067 374.456,1025.66 376.764,861.682 379.072,941.179 381.38,784.778 383.688,789.664 385.996,984.258 388.303,938.368 390.611,785.083 392.919,866.428 395.227,941.864 397.535,1026.76 399.843,715.328 402.151,979.623 404.459,913.695 406.767,1094.49 409.075,867.12 411.383,851.252 413.69,863.258 415.998,786.854 418.306,909.409 420.614,711.926 422.922,1111.78 425.23,948.718 427.538,946.121 429.846,993.713 432.154,746.329 434.462,896.343 436.77,749.542 439.077,865.76 441.385,823.755 443.693,1133.25 446.001,990.317 448.309,840.962 450.617,946.416 452.925,1092.72 455.233,980.959 457.541,867.884 459.849,688.071 462.157,916.822 464.465,879.484 466.772,939.179 469.08,993.902 471.388,917.294 473.696,808.197 476.004,927.926 478.312,838.431 480.62,949.946 482.928,909.353 485.236,890.184 487.544,868.596 489.852,966.37 492.159,915.156 494.467,974.933 496.775,852.173 499.083,839.067 501.391,1014.65 503.699,904.466 506.007,840.229 508.315,992.904 510.623,852.552 512.931,737.244 515.239,992.563 517.546,997.353 519.854,1072.04 522.162,994.375 524.47,985.656 526.778,948.043 529.086,858.517 531.394,1070.03 533.702,775.238 536.01,923.888 538.318,1008.66 540.626,1026.86 542.933,852.435 545.241,936.05 547.549,860.876 549.857,967.846 552.165,1133.79 554.473,725.991 556.781,965.304 559.089,878.741 561.397,999.08 563.705,889.444 566.013,895.393 568.321,978.612 570.628,1006.7 572.936,965.722 575.244,923.63 577.552,940.027 579.86,1028.57 582.168,922.018 584.476,938.127 586.784,855.942 589.092,1064.94 591.4,907.039 593.708,891.289 596.015,921.024 598.323,895.117 600.631,754.207 602.939,932.268 605.247,757.007 607.555,914.979 609.863,982.13 612.171,1025.66 614.479,950.276 616.787,926.373 619.095,923.862 621.402,983.063 623.71,833.689 626.018,889.527 628.326,1122.72 630.634,986.311 632.942,816.436 635.25,989.813 637.558,719.382 639.866,957.122 642.174,887.944 644.482,840.723 646.79,959.505 649.097,973.4 651.405,960.114 653.713,747.562 656.021,744.409 658.329,648.509 660.637,1012.17 662.945,1030.83 665.253,959.698 667.561,1029.89 669.869,1057.24 672.177,899.727 674.484,1059.52 676.792,887.411 679.1,953.886 681.408,1006.92 683.716,970.693 686.024,851.963 688.332,861.287 690.64,690.455 692.948,986.214 695.256,755.267 697.564,934.202 699.871,849.088 702.179,991.129 704.487,824.618 706.795,865.62 709.103,903.62 711.411,970.284 713.719,1008.83 716.027,965.941 718.335,860.804 720.643,951.817 722.951,770.043 725.259,928.947 727.566,1015.97 729.874,905.096 732.182,940.198 734.49,922.909 736.798,912.16 739.106,1020.09 741.414,812.405 743.722,993.241 746.03,878.567 748.338,739.864 750.646,979.17 752.953,764.492 755.261,866.804 757.569,892.692 759.877,786.366 762.185,834.749 764.493,871.052 766.801,1165.21 769.109,879.095 771.417,959.717 773.725,878.851 776.033,890.167 778.34,896.902 780.648,870.086 782.956,1014.02 785.264,877.591 787.572,821.532 789.88,841.578 792.188,796.59 794.496,1082.82 796.804,788.908 799.112,954.749 801.42,1109.74 803.728,991.738 806.035,1205.57 808.343,903.23 810.651,692.277 812.959,1012.73 815.267,1048.62 817.575,1028.84 819.883,786.655 822.191,801.993 824.499,1016.14 826.807,877 829.115,756.397 831.422,1044.51 833.73,1038.98 836.038,943.396 838.346,1134.98 840.654,883.596 842.962,916.678 845.27,694.155 847.578,859.367 849.886,926.894 852.194,1009.36 854.502,985.267 856.809,793.395 859.117,842.787 861.425,855.295 863.733,758.012 866.041,910.325 868.349,988.368 870.657,906.901 872.965,707.944 875.273,768.227 877.581,857.685 879.889,878.598 882.197,990.162 884.504,938.029 886.812,813.213 889.12,914.881 891.428,1088.7 893.736,1002.42 896.044,1044.82 898.352,838.017 900.66,935.602 902.968,789.286 905.276,818.838 907.584,746.014 909.891,921.697 912.199,906.343 914.507,995.029 916.815,1015.93 919.123,789.799 921.431,884.5 923.739,723.861 926.047,979.66 928.355,886.057 930.663,938.047 932.971,805.655 935.278,852.538 937.586,1108.26 939.894,834.802 942.202,880.224 944.51,969.803 946.818,835.559 949.126,925.034 951.434,868.762 953.742,1043.58 956.05,845.632 958.358,1001.08 960.665,834.677 962.973,1090.98 965.281,855.752 967.589,854.073 969.897,1015.53 972.205,1052 974.513,970.436 976.821,909.177 979.129,808.155 981.437,848.016 983.745,752.723 986.053,914.768 988.36,742.172 990.668,795.372 992.976,737.355 995.284,777.091 997.592,861.937 999.9,1077.34 1002.21,938.101 1004.52,988.154 1006.82,877.965 1009.13,847.079 1011.44,841.544 1013.75,747.5 1016.06,806.612 1018.36,995.503 1020.67,943.002 1022.98,928.369 1025.29,909.325 1027.59,918.227 1029.9,825.343 1032.21,955.551 1034.52,1055.06 1036.83,996.627 1039.13,1028.83 1041.44,904.49 1043.75,961.346 1046.06,734.398 1048.37,928.881 1050.67,898.332 1052.98,850.642 1055.29,919.435 1057.6,906.189 1059.91,1029.24 1062.21,1058.77 1064.52,865.606 1066.83,891.629 1069.14,890.929 1071.45,956.811 1073.75,1128.25 1076.06,807.956 1078.37,952.338 1080.68,830.993 1082.98,990.044 1085.29,848.977 1087.6,1001.87 1089.91,933.763 1092.22,944.39 1094.52,1020.5 1096.83,755.104 1099.14,927.861 1101.45,1126.45 1103.76,869.955 1106.06,880.935 1108.37,941.493 1110.68,837.429 1112.99,921.709 1115.3,820.009 1117.6,949.788 1119.91,1038.41 1122.22,1071.94 1124.53,757.569 1126.84,695.062 1129.14,1158.97 1131.45,743.307 1133.76,761.537 1136.07,743.953 1138.37,877.281 1140.68,844.914 1142.99,1071.62 1145.3,949.758 1147.61,724.282 1149.91,897.889 1152.22,841.128 1154.53,865.509 1156.84,866.021 1159.15,845.882 1161.45,916.006 1163.76,970.363 1166.07,888.722 1168.38,850.763 1170.69,880.541 1172.99,1002.88 1175.3,944.056 1177.61,970.893 1179.92,871.241 1182.23,885.671 1184.53,1041.48 1186.84,792.125 1189.15,923.746 1191.46,983.281 1193.76,921.045 1196.07,895.146 1198.38,801.552 1200.69,874.141 1203,980.359 1205.3,851.213 1207.61,1012.7 1209.92,796.385 1212.23,943.323 1214.54,803.649 1216.84,853.209 1219.15,975.768 1221.46,724.697 1223.77,854.568 1226.08,760.766 1228.38,1049.11 1230.69,1124.89 1233,927.47 1235.31,1120.13 1237.61,945.218 1239.92,864.886 1242.23,880.333 1244.54,778.641 1246.85,861.263 1249.15,869.711 1251.46,1002.59 1253.77,612.965 1256.08,1029.06 1258.39,945.07 1260.69,820.372 1263,869.209 1265.31,780.516 1267.62,886.783 1269.93,834.084 1272.23,1043.71 1274.54,764.045 1276.85,932.668 1279.16,794.882 1281.47,832.512 1283.77,1095.78 1286.08,988.091 1288.39,950.093 1290.7,858.234 1293,826.849 1295.31,782.321 1297.62,1034.54 1299.93,934.634 1302.24,827.131 1304.54,1056.71 1306.85,796.983 1309.16,972 1311.47,1013.83 1313.78,870.757 1316.08,1035.67 1318.39,775.868 1320.7,1082.89 1323.01,791.487 1325.32,978.913 1327.62,828.391 1329.93,748.185 1332.24,779.803 1334.55,941.917 1336.86,892.08 1339.16,1045.2 1341.47,888.121 1343.78,1036.45 1346.09,742.977 1348.39,746.781 1350.7,913.702 1353.01,952.545 1355.32,817.436 1357.63,898.136 1359.93,831.66 1362.24,805.74 1364.55,923.683 1366.86,829.117 1369.17,932.327 1371.47,857.731 1373.78,840.239 1376.09,956.863 1378.4,987.477 1380.71,730.351 1383.01,845.657 1385.32,869.141 1387.63,782.261 1389.94,890.261 1392.24,968.697 1394.55,792.128 1396.86,922.659 1399.17,867.384 1401.48,890.326 1403.78,795.712 1406.09,1121.52 1408.4,958.974 1410.71,863.448 1413.02,913.945 1415.32,767.303 1417.63,785.082 1419.94,857.124 1422.25,768.154 1424.56,834.643 1426.86,962.162 1429.17,763.89 1431.48,924.149 1433.79,1099.14 1436.1,792.641 1438.4,977.445 1440.71,725.002 1443.02,945.836 1445.33,973.673 1447.63,994.141 1449.94,936.484 1452.25,896.576 1454.56,788.973 1456.87,1002.03 1459.17,884.429 1461.48,877.853 1463.79,734.787 1466.1,795.584 1468.41,1066.06 1470.71,923.727 1473.02,858.251 1475.33,1080.64 1477.64,929.289 1479.95,788.051 1482.25,859.599 1484.56,942.485 1486.87,873.969 1489.18,993.467 1491.49,995.48 1493.79,1064.84 1496.1,902.416 1498.41,925.281 1500.72,939.935 1503.02,822.501 1505.33,848.805 1507.64,1047.92 1509.95,914.888 1512.26,910.574 1514.56,879.499 1516.87,834.732 1519.18,822.025 1521.49,928.282 1523.8,1016.75 1526.1,1083.33 1528.41,1120.59 1530.72,827.495 1533.03,853.009 1535.34,991.374 1537.64,963.965 1539.95,845.643 1542.26,993.129 1544.57,782.697 1546.88,1008.92 1549.18,926.217 1551.49,921.743 1553.8,860.595 1556.11,956.161 1558.41,885.217 1560.72,993.541 1563.03,1028.7 1565.34,979.916 1567.65,1076.54 1569.95,997.055 1572.26,966.524 1574.57,849.938 1576.88,907.561 1579.19,899.174 1581.49,980.885 1583.8,1024.5 1586.11,924.496 1588.42,939.176 1590.73,1004.43 1593.03,992.065 1595.34,884.637 1597.65,901.994 1599.96,919.007 1602.26,852.733 1604.57,892.36 1606.88,767.181 1609.19,918.557 1611.5,1033.4 1613.8,874.939 1616.11,1159.93 1618.42,757.119 1620.73,887.1 1623.04,938.29 1625.34,969.824 1627.65,748.758 1629.96,812.801 1632.27,979.281 1634.58,1168.7 1636.88,822.249 1639.19,876.66 1641.5,936.734 1643.81,911.304 1646.12,808.108 1648.42,864.709 1650.73,953.01 1653.04,918.81 1655.35,1031.02 1657.65,1039.98 1659.96,987.179 1662.27,913.08 1664.58,878.041 1666.89,1015.07 1669.19,901.727 1671.5,990.401 1673.81,939.747 1676.12,839.405 1678.43,1129.72 1680.73,827.987 1683.04,1040.33 1685.35,879.795 1687.66,1033.32 1689.97,741.814 1692.27,840.211 1694.58,946.754 1696.89,824.733 1699.2,928.424 1701.51,891.944 1703.81,844.478 1706.12,959.548 1708.43,975.717 1710.74,831.69 1713.04,881.698 1715.35,768.924 1717.66,892.59 1719.97,674.173 1722.28,972.349 1724.58,909.877 1726.89,802.409 1729.2,908.197 1731.51,937.444 1733.82,825.414 1736.12,911.167 1738.43,870.71 1740.74,879.451 1743.05,930.91 1745.36,908.261 1747.66,811.603 1749.97,915.168 1752.28,1008.91 1754.59,1020.74 1756.9,1030.59 1759.2,983.399 1761.51,857.806 1763.82,1092.26 1766.13,768.524 1768.43,1015.57 1770.74,989.076 1773.05,777.896 1775.36,1076.93 1777.67,840.157 1779.97,1129.36 1782.28,843.659 1784.59,849.65 1786.9,1157.72 1789.21,826.978 1791.51,929.731 1793.82,787.775 1796.13,918.003 1798.44,856.309 1800.75,771.083 1803.05,859.581 1805.36,755.201 1807.67,956.755 1809.98,995.337 1812.28,962.886 1814.59,835.457 1816.9,791.007 1819.21,909.341 1821.52,777.782 1823.82,959.457 1826.13,959.854 1828.44,624.79 1830.75,1068.16 1833.06,789.928 1835.36,945.115 1837.67,825.983 1839.98,783.563 1842.29,820.572 1844.6,850.715 1846.9,927.512 1849.21,849.532 1851.52,754.138 1853.83,760.969 1856.14,1039.3 1858.44,900.126 1860.75,760.268 1863.06,867.368 1865.37,826.198 1867.67,761.619 1869.98,917.055 1872.29,917.354 1874.6,942.12 1876.91,778.303 1879.21,951.884 1881.52,925.139 1883.83,875.473 1886.14,698.35 1888.45,771.1 1890.75,958.336 1893.06,950.589 1895.37,827.702 1897.68,868.248 1899.99,1041.31 1902.29,828.037 1904.6,958.12 1906.91,942.481 1909.22,899.645 1911.53,782.1 1913.83,972.623 1916.14,852.6 1918.45,1049.86 1920.76,693.251 1923.06,821.902 1925.37,979.962 1927.68,936.865 1929.99,861.872 1932.3,1028.92 1934.6,908.47 1936.91,980.22 1939.22,889.349 1941.53,1079.52 1943.84,1117.1 1946.14,910.924 1948.45,995.808 1950.76,828.288 1953.07,982.501 1955.38,1143.34 1957.68,799.962 1959.99,899.562 1962.3,982.955 1964.61,979.849 1966.91,959.571 1969.22,952.645 1971.53,873.453 1973.84,959.792 1976.15,952.353 1978.45,940.144 1980.76,888.917 1983.07,889.303 1985.38,793.169 1987.69,928.581 1989.99,871.361 1992.3,805.628 1994.61,1073.63 1996.92,608.332 1999.23,1004.76 2001.53,1026.48 2003.84,873.24 2006.15,1088.54 2008.46,702.078 2010.77,622.035 2013.07,881.021 2015.38,840.47 2017.69,874.786 2020,820.899 2022.3,668.446 2024.61,893.725 2026.92,1065.58 2029.23,986.516 2031.54,1051.93 2033.84,815.518 2036.15,849.12 2038.46,1092.07 2040.77,892.342 2043.08,1005.44 2045.38,920.995 2047.69,818.736 2050,786.45 2052.31,969.435 2054.62,882.361 2056.92,791.811 2059.23,953.83 2061.54,843.901 2063.85,732.701 2066.16,856.399 2068.46,935.956 2070.77,857.947 2073.08,917.888 2075.39,917.566 2077.69,927.843 2080,963.258 2082.31,953.616 2084.62,870.881 2086.93,945.567 2089.23,856.669 2091.54,910.275 2093.85,825.668 2096.16,1013.3 2098.47,916.882 2100.77,766.79 2103.08,864.245 2105.39,840.605 2107.7,835.642 2110.01,954.644 2112.31,890.152 2114.62,1019.32 2116.93,861.691 2119.24,896.194 2121.55,807.14 2123.85,849.17 2126.16,882.011 2128.47,783.956 2130.78,926.432 2133.08,863.43 2135.39,950.354 2137.7,837.53 2140.01,760.78 2142.32,810.736 2144.62,713.113 2146.93,789.263 2149.24,951.426 2151.55,783.48 2153.86,817.315 2156.16,946.472 2158.47,869.206 2160.78,1019.21 2163.09,1036.25 2165.4,994.887 2167.7,1002.44 2170.01,857.532 2172.32,872.627 2174.63,897.741 2176.93,889.244 2179.24,933.391 2181.55,869.458 2183.86,1073.19 2186.17,1015.56 2188.47,903.918 2190.78,958.216 2193.09,869.985 2195.4,921.962 2197.71,989.14 2200.01,760.268 2202.32,796.984 2204.63,868.496 2206.94,975.095 2209.25,883.839 2211.55,698.408 2213.86,874.604 2216.17,606.378 2218.48,779.462 2220.79,1062.78 2223.09,817.262 2225.4,897.964 2227.71,1027.05 2230.02,928.298 2232.32,859.655 2234.63,890.45 2236.94,846.373 2239.25,867.216 2241.56,815.831 2243.86,910.834 2246.17,858.712 2248.48,893.993 2250.79,966.448 2253.1,850.382 2255.4,880.62 2257.71,920.426 2260.02,787.946 2262.33,741.678 2264.64,719.239 2266.94,991.806 2269.25,926.285 2271.56,990.344 2273.87,763.536 2276.18,1029.25 2278.48,1031.01 2280.79,1154.07 2283.1,807.988 2285.41,1044.55 2287.71,963.096 2290.02,1039.16 2292.33,908.064 2294.64,945.539 2296.95,815.973 2299.25,723.838 2301.56,1001.93 2303.87,946.545 2306.18,1030.22 2308.49,1194.28 2310.79,1023.91 2313.1,972.745 2315.41,784.738 2317.72,952.83 2320.03,918.67 2322.33,822.198 2324.64,876.768 2326.95,1009 2329.26,957.386 2331.56,980.817 2333.87,811.477 2336.18,883.613 2338.49,1073.76 2340.8,940.717 2343.1,1031.88 2345.41,961.955 2347.72,687.865 2350.03,837.374 2352.34,928.557 2354.64,1096.24 2356.95,859.661 2359.26,771.929 2361.57,985.145 2363.88,978.385 2366.18,946.179 2368.49,884.66 2370.8,987.735 2373.11,819.171 2375.42,772.359 2377.72,855.019 2380.03,928.171 2382.34,846.008 2384.65,799.088 2386.95,629.254 2389.26,732.537 2391.57,1090.67 2393.88,895.23 2396.19,891.869 2398.49,965.393 2400.8,803.883 2403.11,853.564 2405.42,876.958 2407.73,944.183 2410.03,940.755 2412.34,803.888 2414.65,805.796 2416.96,935.568 2419.27,1024.77 2421.57,890.967 2423.88,881.246 2426.19,987.992 2428.5,1007.25 2430.81,834.89 2433.11,975.504 2435.42,1060.44 2437.73,878.928 2440.04,897.78 2442.34,1050.7 2444.65,812.643 2446.96,947.488 2449.27,902.081 2451.58,1127.85 2453.88,895.615 2456.19,851.681 2458.5,1013.92 2460.81,908.705 2463.12,935.181 2465.42,831.363 2467.73,967.806 2470.04,994.188 2472.35,956.593 2474.66,990.832 2476.96,1038.66 2479.27,1030.42 2481.58,823.346 2483.89,833.773 2486.2,914.722 2488.5,962.981 2490.81,907.552 2493.12,1026.1 2495.43,893.543 2497.73,932.749 2500.04,791.84 2502.35,884.404 2504.66,880.514 2506.97,888.929 2509.27,1019.49 2511.58,899.328 2513.89,722.132 2516.2,960.558 2518.51,770.259 2520.81,971.733 2523.12,923.316 2525.43,899.492 2527.74,772.355 2530.05,915.013 2532.35,701.989 2534.66,833.105 2536.97,785.567 2539.28,894.974 2541.58,876.956 2543.89,871.956 2546.2,952.295 2548.51,996.858 2550.82,932.028 2553.12,1089.25 2555.43,996.35 2557.74,1053.39 2560.05,883.34 2562.36,795.606 2564.66,845.365 2566.97,886.767 2569.28,909.216 2571.59,991.574 "></polyline>
<polyline clip-path="url(#clip402)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,673.485 268.292,461.969 270.6,638.19 272.908,495.022 275.216,322.948 277.524,472.152 279.832,225.065 282.139,415.92 284.447,353.247 286.755,426.399 289.063,382.072 291.371,340.397 293.679,302.059 295.987,432.145 298.295,463.392 300.603,322.168 302.911,421.382 305.219,404.602 307.527,461.13 309.834,400.142 312.142,301.608 314.45,371.562 316.758,398.759 319.066,284.721 321.374,350.066 323.682,425.077 325.99,457.003 328.298,218.082 330.606,412.842 332.914,431.465 335.221,375.925 337.529,369.446 339.837,440.085 342.145,415.34 344.453,315.27 346.761,517.335 349.069,581.293 351.377,344.969 353.685,472.925 355.993,420.137 358.301,178.801 360.608,417.218 362.916,265.275 365.224,491.734 367.532,309.793 369.84,559.503 372.148,423.381 374.456,512.829 376.764,438.121 379.072,341.585 381.38,325.549 383.688,453.97 385.996,333.344 388.303,319.282 390.611,289.853 392.919,325.401 395.227,335.705 397.535,330.526 399.843,354.387 402.151,291.27 404.459,451.092 406.767,387.008 409.075,298.499 411.383,481.277 413.69,518.005 415.998,262.293 418.306,434.415 420.614,478.559 422.922,341.12 425.23,320.023 427.538,335.067 429.846,553.07 432.154,422.944 434.462,413.916 436.77,159.7 439.077,303.905 441.385,434.594 443.693,480.652 446.001,483.388 448.309,480.679 450.617,407.134 452.925,484.751 455.233,437.568 457.541,274.636 459.849,403.495 462.157,498.607 464.465,330.171 466.772,373.967 469.08,389.263 471.388,395.327 473.696,448.438 476.004,502.326 478.312,512.122 480.62,576.277 482.928,345.51 485.236,344.362 487.544,440.526 489.852,437.033 492.159,438.841 494.467,374.883 496.775,469.627 499.083,383.872 501.391,322.937 503.699,351.368 506.007,370.343 508.315,428.828 510.623,473.879 512.931,299.512 515.239,409.5 517.546,591.329 519.854,264.525 522.162,236.229 524.47,361.401 526.778,448.357 529.086,350.912 531.394,358.315 533.702,675.111 536.01,337.066 538.318,429.996 540.626,340.296 542.933,427.808 545.241,387.754 547.549,333.123 549.857,373.626 552.165,456.606 554.473,453.95 556.781,321.771 559.089,511.782 561.397,289.154 563.705,478.819 566.013,249.763 568.321,286.324 570.628,350.644 572.936,546.08 575.244,425.731 577.552,330.227 579.86,437.139 582.168,623.604 584.476,470.953 586.784,380.399 589.092,328.232 591.4,316.692 593.708,456.171 596.015,480.421 598.323,413.479 600.631,475.205 602.939,459.195 605.247,402.766 607.555,562.797 609.863,553.075 612.171,534.137 614.479,351.91 616.787,270.94 619.095,251.592 621.402,417.108 623.71,375.964 626.018,388.631 628.326,463.956 630.634,481.328 632.942,369.265 635.25,449.394 637.558,406.089 639.866,482.316 642.174,206.811 644.482,507.839 646.79,177.431 649.097,291.021 651.405,364.634 653.713,378.336 656.021,214.265 658.329,399.485 660.637,419.948 662.945,357.285 665.253,372.496 667.561,435.312 669.869,663.783 672.177,433.059 674.484,401.545 676.792,254.217 679.1,301.669 681.408,300.321 683.716,394.371 686.024,415.442 688.332,359.665 690.64,263.121 692.948,381.22 695.256,288.75 697.564,437.369 699.871,283.093 702.179,479.032 704.487,371.943 706.795,439 709.103,443.277 711.411,347.498 713.719,328.094 716.027,469.319 718.335,380.89 720.643,398.632 722.951,291.916 725.259,523.778 727.566,407.261 729.874,580.945 732.182,333.414 734.49,456.032 736.798,360.898 739.106,524.719 741.414,300.276 743.722,398.146 746.03,511.138 748.338,473.979 750.646,333.91 752.953,314.08 755.261,427.431 757.569,403.888 759.877,501.654 762.185,537.4 764.493,494.347 766.801,440.441 769.109,480.868 771.417,320.175 773.725,407.587 776.033,533.02 778.34,426.922 780.648,511.155 782.956,342.142 785.264,224.479 787.572,364.407 789.88,395.76 792.188,426.624 794.496,455.388 796.804,444.596 799.112,511.037 801.42,134.345 803.728,497.561 806.035,604.659 808.343,547.882 810.651,561.291 812.959,423.629 815.267,238.802 817.575,516.031 819.883,414.716 822.191,541.513 824.499,123.496 826.807,289.257 829.115,493.122 831.422,554.813 833.73,542.258 836.038,513.077 838.346,468.807 840.654,453.516 842.962,563.337 845.27,341.125 847.578,582.633 849.886,440.097 852.194,277.746 854.502,227.08 856.809,406.204 859.117,330.554 861.425,535.928 863.733,624.952 866.041,377.341 868.349,433.571 870.657,367.001 872.965,558.217 875.273,437.614 877.581,423.946 879.889,293.457 882.197,524.984 884.504,370.24 886.812,301.013 889.12,592.159 891.428,466.653 893.736,546.354 896.044,379.175 898.352,540.653 900.66,218.95 902.968,473.046 905.276,389.441 907.584,534.259 909.891,320.801 912.199,388.916 914.507,357.051 916.815,448.824 919.123,326.049 921.431,491.591 923.739,334.365 926.047,518.297 928.355,471.179 930.663,237.305 932.971,366.81 935.278,231.702 937.586,461.837 939.894,449.352 942.202,281.691 944.51,519.925 946.818,345.457 949.126,601.562 951.434,402.451 953.742,387.974 956.05,403.29 958.358,539.088 960.665,498.544 962.973,364.11 965.281,542.857 967.589,343.726 969.897,416.311 972.205,223.797 974.513,401.197 976.821,537.299 979.129,493.162 981.437,475.354 983.745,532.522 986.053,290.601 988.36,379.77 990.668,535.297 992.976,497.464 995.284,372.755 997.592,503.697 999.9,538.249 1002.21,401.483 1004.52,541.544 1006.82,447.192 1009.13,401.896 1011.44,519.48 1013.75,398.654 1016.06,396.121 1018.36,404.596 1020.67,376.445 1022.98,455.351 1025.29,334.936 1027.59,472.144 1029.9,204.729 1032.21,388.668 1034.52,366.363 1036.83,403.545 1039.13,468.347 1041.44,316.956 1043.75,510.201 1046.06,422.021 1048.37,177.011 1050.67,515.196 1052.98,296.083 1055.29,524.813 1057.6,427.128 1059.91,225.504 1062.21,497.304 1064.52,341.275 1066.83,364.227 1069.14,372.948 1071.45,406.379 1073.75,577.37 1076.06,391.761 1078.37,343.049 1080.68,389.482 1082.98,364.184 1085.29,296.817 1087.6,372.641 1089.91,381.595 1092.22,509.778 1094.52,442.925 1096.83,412.466 1099.14,460.499 1101.45,573.246 1103.76,515.723 1106.06,364.413 1108.37,556.084 1110.68,384.809 1112.99,158.129 1115.3,319.911 1117.6,488.034 1119.91,532.982 1122.22,300.534 1124.53,256.692 1126.84,409.385 1129.14,328.46 1131.45,378.109 1133.76,421.317 1136.07,685.332 1138.37,523.922 1140.68,328.913 1142.99,472.045 1145.3,408.263 1147.61,386.185 1149.91,448.051 1152.22,425.154 1154.53,383.97 1156.84,236.795 1159.15,449.358 1161.45,466.107 1163.76,539.987 1166.07,283.334 1168.38,371.156 1170.69,368.463 1172.99,471.831 1175.3,526.144 1177.61,227.191 1179.92,420.44 1182.23,514.424 1184.53,362.512 1186.84,393.433 1189.15,382.046 1191.46,317.135 1193.76,340.435 1196.07,390.81 1198.38,340.097 1200.69,455.463 1203,411.816 1205.3,208.206 1207.61,453.789 1209.92,399.72 1212.23,409.826 1214.54,438.993 1216.84,461.151 1219.15,543.238 1221.46,432.126 1223.77,483.767 1226.08,391.215 1228.38,316.316 1230.69,201.491 1233,468.868 1235.31,294.101 1237.61,524.028 1239.92,543.528 1242.23,553.679 1244.54,339.26 1246.85,475.067 1249.15,412.449 1251.46,220.954 1253.77,401.76 1256.08,567.46 1258.39,514.325 1260.69,373.053 1263,441.259 1265.31,211.374 1267.62,334.671 1269.93,401.887 1272.23,277.428 1274.54,499.06 1276.85,400.055 1279.16,398.389 1281.47,463.916 1283.77,284.603 1286.08,446.702 1288.39,409.866 1290.7,418.32 1293,347.837 1295.31,364.924 1297.62,454.259 1299.93,380.936 1302.24,195.142 1304.54,666.641 1306.85,449.545 1309.16,375.977 1311.47,385.836 1313.78,419.846 1316.08,278.127 1318.39,405.252 1320.7,413.411 1323.01,475.771 1325.32,484.027 1327.62,368.319 1329.93,574.372 1332.24,431.413 1334.55,433.505 1336.86,513.818 1339.16,436.84 1341.47,536.028 1343.78,375.725 1346.09,386.77 1348.39,525.674 1350.7,512.36 1353.01,306.866 1355.32,545.623 1357.63,394.624 1359.93,363.501 1362.24,468.595 1364.55,649.029 1366.86,563.022 1369.17,345.222 1371.47,377.848 1373.78,482.056 1376.09,260.03 1378.4,348.569 1380.71,248.533 1383.01,448.815 1385.32,500.346 1387.63,443.965 1389.94,448.072 1392.24,325.258 1394.55,516.65 1396.86,423.591 1399.17,356.332 1401.48,412.922 1403.78,355.337 1406.09,398.125 1408.4,328.309 1410.71,232.967 1413.02,519.868 1415.32,338.218 1417.63,330.105 1419.94,316.155 1422.25,404.988 1424.56,556.272 1426.86,494.547 1429.17,215.946 1431.48,544.513 1433.79,637.684 1436.1,312.502 1438.4,296.247 1440.71,368.111 1443.02,215.195 1445.33,373.036 1447.63,377.895 1449.94,317.26 1452.25,221.021 1454.56,471.765 1456.87,502.92 1459.17,380.189 1461.48,333.398 1463.79,435.294 1466.1,252.138 1468.41,338.029 1470.71,430.489 1473.02,299.67 1475.33,341.768 1477.64,379.298 1479.95,329.189 1482.25,393.188 1484.56,334.469 1486.87,259.908 1489.18,542.027 1491.49,371.868 1493.79,583.139 1496.1,275.141 1498.41,223.743 1500.72,438.364 1503.02,362.697 1505.33,487.149 1507.64,391.925 1509.95,341.229 1512.26,559 1514.56,521.303 1516.87,291.17 1519.18,496.195 1521.49,518.961 1523.8,479.558 1526.1,501.546 1528.41,476.98 1530.72,351.51 1533.03,341.582 1535.34,353.218 1537.64,250.094 1539.95,453.239 1542.26,355.221 1544.57,352.78 1546.88,436.694 1549.18,234.442 1551.49,464.901 1553.8,453.777 1556.11,483.79 1558.41,431.277 1560.72,366.868 1563.03,506.067 1565.34,480.58 1567.65,384.977 1569.95,313.04 1572.26,266.898 1574.57,670.757 1576.88,359.424 1579.19,353.963 1581.49,416.525 1583.8,397.183 1586.11,370.072 1588.42,475.927 1590.73,479.323 1593.03,395.897 1595.34,337.65 1597.65,432.767 1599.96,376.323 1602.26,96.8724 1604.57,291.838 1606.88,203.689 1609.19,230.057 1611.5,373.291 1613.8,347.13 1616.11,453.196 1618.42,308.928 1620.73,511.398 1623.04,576.443 1625.34,280.843 1627.65,334.982 1629.96,172.895 1632.27,452.756 1634.58,304.394 1636.88,369.878 1639.19,269.921 1641.5,497.402 1643.81,317.629 1646.12,442.18 1648.42,556.157 1650.73,444.142 1653.04,368.874 1655.35,438.477 1657.65,470.376 1659.96,562.933 1662.27,400.292 1664.58,451.733 1666.89,453.216 1669.19,334.959 1671.5,363.07 1673.81,384.234 1676.12,363.522 1678.43,488.954 1680.73,441.459 1683.04,449.935 1685.35,345.086 1687.66,238.206 1689.97,423.086 1692.27,355.123 1694.58,523.464 1696.89,188.271 1699.2,454.329 1701.51,316.451 1703.81,492.959 1706.12,437.34 1708.43,474.184 1710.74,379.954 1713.04,431.797 1715.35,382.88 1717.66,496.177 1719.97,455.714 1722.28,482.162 1724.58,430.015 1726.89,455.392 1729.2,428.535 1731.51,470.49 1733.82,452.552 1736.12,406.574 1738.43,308.998 1740.74,327.308 1743.05,359.197 1745.36,255.873 1747.66,261.683 1749.97,504.018 1752.28,419.816 1754.59,466.984 1756.9,534.965 1759.2,257.147 1761.51,445.487 1763.82,470.722 1766.13,402.244 1768.43,314.772 1770.74,394.615 1773.05,316.518 1775.36,554.51 1777.67,394.954 1779.97,525.983 1782.28,286.149 1784.59,491.489 1786.9,440.278 1789.21,417.27 1791.51,501.453 1793.82,527.703 1796.13,441.486 1798.44,410.692 1800.75,417.69 1803.05,198.561 1805.36,370.127 1807.67,396.216 1809.98,442.534 1812.28,449.385 1814.59,376.674 1816.9,345.323 1819.21,281.102 1821.52,448.431 1823.82,623.951 1826.13,231.648 1828.44,414.568 1830.75,284.467 1833.06,406.869 1835.36,487.866 1837.67,615.388 1839.98,597.726 1842.29,381.432 1844.6,392.411 1846.9,517.411 1849.21,411.995 1851.52,408.324 1853.83,418.402 1856.14,574.883 1858.44,507.508 1860.75,324.757 1863.06,429.363 1865.37,353.162 1867.67,353.782 1869.98,472.853 1872.29,369.019 1874.6,346.59 1876.91,268.555 1879.21,497.929 1881.52,420.609 1883.83,524.571 1886.14,197.14 1888.45,409.249 1890.75,463.136 1893.06,361.308 1895.37,351.296 1897.68,455.688 1899.99,520.273 1902.29,360.587 1904.6,490.576 1906.91,500.156 1909.22,369.363 1911.53,476.503 1913.83,666.652 1916.14,480.439 1918.45,385.369 1920.76,429.871 1923.06,300.191 1925.37,317.589 1927.68,387.524 1929.99,300.488 1932.3,364.074 1934.6,458.623 1936.91,343.313 1939.22,461.347 1941.53,494.498 1943.84,523.019 1946.14,320.74 1948.45,427.706 1950.76,585.385 1953.07,525.71 1955.38,469.57 1957.68,400.172 1959.99,273.662 1962.3,192.001 1964.61,338.515 1966.91,448.33 1969.22,274.233 1971.53,388.43 1973.84,444.421 1976.15,364.062 1978.45,522.403 1980.76,394.611 1983.07,465.502 1985.38,409.075 1987.69,420.069 1989.99,437.936 1992.3,450.468 1994.61,460.58 1996.92,474.989 1999.23,597.657 2001.53,378.141 2003.84,232.93 2006.15,547.564 2008.46,447.919 2010.77,336.839 2013.07,340.835 2015.38,284.8 2017.69,330.187 2020,570.496 2022.3,383.496 2024.61,303.258 2026.92,334.708 2029.23,419.307 2031.54,275.252 2033.84,417.452 2036.15,431.028 2038.46,434.554 2040.77,302.143 2043.08,490.549 2045.38,576.569 2047.69,491.444 2050,448.073 2052.31,300.832 2054.62,268.87 2056.92,387.979 2059.23,375.381 2061.54,406.32 2063.85,471.189 2066.16,358.342 2068.46,265.447 2070.77,332.509 2073.08,352.137 2075.39,455.258 2077.69,268.915 2080,339.808 2082.31,230.124 2084.62,619.949 2086.93,554.898 2089.23,513.335 2091.54,299.866 2093.85,412.566 2096.16,312.961 2098.47,482.755 2100.77,430.128 2103.08,180.883 2105.39,386.395 2107.7,396.723 2110.01,315.953 2112.31,336.611 2114.62,451.11 2116.93,427.562 2119.24,366.491 2121.55,264.38 2123.85,414.195 2126.16,261.418 2128.47,398.728 2130.78,389.149 2133.08,402.913 2135.39,340.738 2137.7,406.953 2140.01,469.396 2142.32,480.945 2144.62,488.281 2146.93,474.877 2149.24,533.65 2151.55,213.659 2153.86,206.319 2156.16,419.938 2158.47,426.5 2160.78,482.557 2163.09,324.365 2165.4,407.129 2167.7,530.021 2170.01,387.162 2172.32,354.284 2174.63,486.858 2176.93,425.912 2179.24,315.284 2181.55,461.88 2183.86,351.337 2186.17,443.747 2188.47,570.832 2190.78,607.081 2193.09,344.927 2195.4,326.006 2197.71,501.517 2200.01,304.397 2202.32,339.198 2204.63,334.751 2206.94,443.778 2209.25,390.273 2211.55,525.659 2213.86,564.78 2216.17,437.658 2218.48,543.578 2220.79,242.305 2223.09,413.094 2225.4,472.337 2227.71,370.686 2230.02,464.148 2232.32,280.992 2234.63,409.755 2236.94,704.31 2239.25,246.844 2241.56,288.556 2243.86,301.159 2246.17,379.533 2248.48,429.663 2250.79,374.189 2253.1,481.791 2255.4,299.802 2257.71,427.078 2260.02,322.524 2262.33,266.497 2264.64,357.037 2266.94,307.824 2269.25,339.435 2271.56,231.881 2273.87,627.084 2276.18,325.366 2278.48,422.467 2280.79,396.01 2283.1,320.889 2285.41,484.451 2287.71,365.67 2290.02,592.983 2292.33,468.394 2294.64,465.311 2296.95,437.93 2299.25,333.464 2301.56,462.42 2303.87,409.105 2306.18,518.76 2308.49,259.192 2310.79,474.548 2313.1,262.728 2315.41,417.71 2317.72,374.728 2320.03,295.838 2322.33,303.69 2324.64,368.11 2326.95,497.693 2329.26,535.206 2331.56,377.502 2333.87,494.003 2336.18,364.559 2338.49,555.7 2340.8,475.706 2343.1,478.895 2345.41,284.621 2347.72,399.081 2350.03,319.671 2352.34,279.883 2354.64,179.529 2356.95,325.85 2359.26,333.597 2361.57,493.223 2363.88,322.929 2366.18,375.162 2368.49,394.466 2370.8,486.12 2373.11,423.39 2375.42,314.079 2377.72,462.54 2380.03,355.081 2382.34,420.084 2384.65,598.039 2386.95,565.282 2389.26,315.203 2391.57,327.952 2393.88,520.827 2396.19,493.176 2398.49,484.329 2400.8,317.193 2403.11,625.554 2405.42,615.978 2407.73,248.801 2410.03,409.679 2412.34,408.814 2414.65,348.149 2416.96,395.02 2419.27,432.129 2421.57,279.19 2423.88,332.984 2426.19,357.267 2428.5,317.444 2430.81,305.399 2433.11,412.636 2435.42,392.867 2437.73,586.023 2440.04,475.798 2442.34,385.305 2444.65,458.962 2446.96,488.958 2449.27,458.096 2451.58,349.739 2453.88,545.749 2456.19,446.09 2458.5,418.676 2460.81,265.283 2463.12,368.38 2465.42,331.354 2467.73,363.564 2470.04,463.045 2472.35,489.721 2474.66,465.529 2476.96,349.595 2479.27,496.918 2481.58,617.04 2483.89,263.782 2486.2,470.081 2488.5,441.41 2490.81,452.535 2493.12,571.478 2495.43,342.423 2497.73,578.234 2500.04,428.279 2502.35,296.907 2504.66,312.978 2506.97,236.391 2509.27,417.971 2511.58,456.928 2513.89,433.414 2516.2,506.038 2518.51,394.169 2520.81,302.864 2523.12,344.136 2525.43,233.255 2527.74,193.027 2530.05,627.064 2532.35,356.63 2534.66,364.184 2536.97,312.98 2539.28,211.881 2541.58,305.061 2543.89,436.545 2546.2,431.277 2548.51,467.707 2550.82,554.6 2553.12,451.694 2555.43,437.636 2557.74,434.278 2560.05,367.302 2562.36,424.959 2564.66,313.7 2566.97,324.579 2569.28,374.995 2571.59,281.741 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -1.50541   -2.56255   -5.47864  …  -4.31545   -4.37367   -4.37367
  0.603915  -0.357665  -1.22728      0.990363   0.314832   0.314832
  2.36236    4.1856     3.15273      4.51393    6.27699    6.27699

[:, :, 2] =
 -3.62646   -4.30847   -4.15241   …  -2.14354   -3.00342   -2.05611
  0.129612   0.652493  -0.280922     -0.265339   0.172097  -0.914406
  4.21222    4.64957    5.02514       6.0361     6.13377    4.81314

[:, :, 3] =
 -3.27163    -2.83978    -4.95171   …  -4.86389   -5.66761  -6.47939
  0.0164727  -0.0365753   0.801266     -0.902651  -1.78912  -0.722278
  2.08132     4.2204      5.12582       5.91852    4.79925   6.07295

[:, :, 4] =
 -0.74704   -2.98112   -4.52966   -3.65867  …  -4.5291   -5.40963    -5.11403
  1.14392   -0.211136   0.588452   1.73504     -1.61185   0.0666343  -0.4931
  0.384084   0.893855   3.63186    4.76676      4.19997   4.30854     6.75918</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.96767     1.00594
  0.00530504  0.989684
  4.97717     0.999522</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.63 seconds
Compute duration  = 2.63 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -4.9920    1.0053    0.0181   3088.2243   5348.8951    1.0000   ⋯
        x[2]   -0.0359    1.0044    0.0179   3160.4767   4373.4109    0.9999   ⋯
        x[3]    4.9966    1.0093    0.0178   3237.6917   4807.7352    1.0000   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -6.9068   -5.6698   -4.9929   -4.3229   -3.0358
        x[2]   -2.0110   -0.7048   -0.0285    0.6297    1.9352
        x[3]    3.0207    4.3102    4.9979    5.6981    6.9289</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.56 seconds
Compute duration  = 1.56 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.5018    0.1869    0.0029   4200.4187   5979.4502    1.0005   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1441    0.3652    0.5052    0.6390    0.8467</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.24 seconds
Compute duration  = 0.24 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk   ess_tail      rhat    ⋯
      Symbol   Float64   Float64   Float64     Float64    Float64   Float64    ⋯

           x    0.1518    0.0186    0.0003   4774.5916        NaN    1.0001    ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1521    0.1521    0.1521    0.1521    0.1521</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(-0.38661292598017954, "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with -0.38661292598017954:
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/nmUhn/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/compiler.jl:579 [inlined]
  [7] demo(__model__::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, __varinfo__::DynamicPPL.ThreadSafeVarInfo{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, Vector{Base.RefValue{Float64}}}, __context__::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:592
  [8] _evaluate!!
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:973 [inlined]
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, context::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:962
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:892 [inlined]
 [11] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/values_as_in_model.jl:196 [inlined]
 [12] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/values_as_in_model.jl:195 [inlined]
 [13] getparams(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:343
 [14] Turing.Inference.Transition(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, t::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:226
 [15] transition_to_turing
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:12 [inlined]
 [16] transition_to_turing(f::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, transition::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:17
 [17] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}; initial_state::Nothing, initial_params::Nothing, kwargs::@Kwargs{})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:141
 [18] step
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:96 [inlined]
 [19] macro expansion
    @ ~/.julia/packages/AbstractMCMC/YrmkI/src/sample.jl:130 [inlined]
 [20] macro expansion
    @ ~/.julia/packages/AbstractMCMC/YrmkI/src/logging.jl:16 [inlined]
 [21] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/YrmkI/src/sample.jl:120
 [22] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/MjWTB/src/sampler.jl:93
 [23] sample
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/sampler.jl:83 [inlined]
 [24] #sample#4
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:276 [inlined]
 [25] sample
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:267 [inlined]
 [26] #sample#3
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:264 [inlined]
 [27] top-level scope
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:594</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.68 seconds
Compute duration  = 1.68 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8538    0.6095    0.0309   282.9593    72.5856    1.0100     ⋯
           x   -0.0573    0.9640    0.0547   368.2696   379.3488    1.0009     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1069    0.3784    0.7017    1.1994    2.3736
           x   -2.1505   -0.4826   -0.0161    0.3553    2.0527</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 3.12 seconds
Compute duration  = 3.12 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8915    0.5947    0.0264   511.5963   481.1844    1.0022     ⋯
           x   -0.0886    1.0435    0.0573   444.0093   272.6604    1.0026     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1365    0.4239    0.7619    1.2556    2.3036
           x   -2.6855   -0.4929   -0.0220    0.3975    1.8587</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>