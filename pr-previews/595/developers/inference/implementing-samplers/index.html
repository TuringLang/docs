<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing Samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../developers/inference/variational-inference/index.html" rel="prev">
<link href="../../../assets/favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-34237cea2e2cc12c7515d5a9baa4807c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark-2ce616a69abdabb5d8b1d1ad44f632cf.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../tutorials/coin-flipping/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.37" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.37</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.37">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../developers/contributing/index.html">Developers</a></li><li class="breadcrumb-item"><a href="../../../developers/inference/abstractmcmc-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../../developers/inference/implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../core-functionality/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Core Functionality</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">User Guide</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/automatic-differentiation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/custom-distribution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Custom Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/probability-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Querying Model Probabilities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/modifying-logprob/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modifying the Log Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/generated-quantities/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generated Quantities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/sampler-visualisation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../usage/external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/coin-flipping/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction: Coin Flipping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/gaussian-mixture-models/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/bayesian-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/bayesian-neural-networks/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/hidden-markov-models/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/bayesian-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/infinite-mixture-models/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/bayesian-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/bayesian-time-series-analysis/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/gaussian-processes-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Processes: Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../tutorials/gaussian-process-latent-variable-models/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/contributing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contributing</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">DynamicPPL’s Compiler</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/compiler/model-manual/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manually Defining a Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/compiler/minituring-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/compiler/minituring-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/compiler/design-overview/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design (Outdated)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Variable Transformations</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/transforms/distributions/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Distributions and the Jacobian</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/transforms/bijectors/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bijectors in MCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/transforms/dynamicppl/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variable transformations in DynamicPPL</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Inference (note: outdated)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/inference/abstractmcmc-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/inference/abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing Implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/inference/variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../developers/inference/implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/main/developers/inference/implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../developers/contributing/index.html">Developers</a></li><li class="breadcrumb-item"><a href="../../../developers/inference/abstractmcmc-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../../developers/inference/implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing Samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-30.972844571333077</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-30.972844571333077</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([0.0, 0.0, 0.0]), MALAState{Vector{Float64}}([0.0, 0.0, 0.0]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -0.953737  -2.921    -4.51969   -4.08169   …  -5.78434  -5.68397  -7.00586
  0.329602  -1.20936   0.179406  -0.104692     -2.04173  -2.00539   0.0308794
  2.64337    1.49825   3.54167    4.96607       7.26438   6.1422    5.78851</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -5.00855    0.99136
  0.0353114  0.998098
  4.99808    1.00749</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip750">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip750)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip751">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip750)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip752">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1649.61 2640.76,1649.61 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1402.49 2640.76,1402.49 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1155.38 2640.76,1155.38 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,908.26 2640.76,908.26 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,661.145 2640.76,661.145 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,414.03 2640.76,414.03 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,166.915 2640.76,166.915 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip750)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1649.61 215.714,1649.61 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1402.49 215.714,1402.49 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1155.38 215.714,1155.38 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,908.26 215.714,908.26 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,661.145 215.714,661.145 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,414.03 215.714,414.03 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,166.915 215.714,166.915 "></polyline>
<path clip-path="url(#clip750)" d="M50.5475 1650.06 L80.2233 1650.06 L80.2233 1653.99 L50.5475 1653.99 L50.5475 1650.06 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M89.1352 1632.33 L111.357 1632.33 L111.357 1634.32 L98.8111 1666.89 L93.9269 1666.89 L105.732 1636.26 L89.1352 1636.26 L89.1352 1632.33 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M120.478 1661.01 L125.362 1661.01 L125.362 1666.89 L120.478 1666.89 L120.478 1661.01 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M135.593 1632.33 L153.95 1632.33 L153.95 1636.26 L139.876 1636.26 L139.876 1644.73 Q140.894 1644.39 141.913 1644.22 Q142.931 1644.04 143.95 1644.04 Q149.737 1644.04 153.116 1647.21 Q156.496 1650.38 156.496 1655.8 Q156.496 1661.38 153.024 1664.48 Q149.552 1667.56 143.232 1667.56 Q141.056 1667.56 138.788 1667.19 Q136.542 1666.82 134.135 1666.08 L134.135 1661.38 Q136.218 1662.51 138.441 1663.07 Q140.663 1663.62 143.14 1663.62 Q147.144 1663.62 149.482 1661.52 Q151.82 1659.41 151.82 1655.8 Q151.82 1652.19 149.482 1650.08 Q147.144 1647.97 143.14 1647.97 Q141.265 1647.97 139.39 1648.39 Q137.538 1648.81 135.593 1649.69 L135.593 1632.33 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M49.5521 1402.94 L79.2279 1402.94 L79.2279 1406.88 L49.5521 1406.88 L49.5521 1402.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M89.3667 1385.21 L107.723 1385.21 L107.723 1389.15 L93.6491 1389.15 L93.6491 1397.62 Q94.6676 1397.27 95.6861 1397.11 Q96.7047 1396.92 97.7232 1396.92 Q103.51 1396.92 106.89 1400.09 Q110.269 1403.27 110.269 1408.68 Q110.269 1414.26 106.797 1417.36 Q103.325 1420.44 97.0056 1420.44 Q94.8297 1420.44 92.5612 1420.07 Q90.3158 1419.7 87.9084 1418.96 L87.9084 1414.26 Q89.9917 1415.4 92.2139 1415.95 Q94.4361 1416.51 96.913 1416.51 Q100.918 1416.51 103.256 1414.4 Q105.593 1412.29 105.593 1408.68 Q105.593 1405.07 103.256 1402.97 Q100.918 1400.86 96.913 1400.86 Q95.038 1400.86 93.163 1401.28 Q91.3112 1401.69 89.3667 1402.57 L89.3667 1385.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M119.482 1413.89 L124.367 1413.89 L124.367 1419.77 L119.482 1419.77 L119.482 1413.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M144.552 1388.29 Q140.941 1388.29 139.112 1391.85 Q137.306 1395.4 137.306 1402.53 Q137.306 1409.63 139.112 1413.2 Q140.941 1416.74 144.552 1416.74 Q148.186 1416.74 149.991 1413.2 Q151.82 1409.63 151.82 1402.53 Q151.82 1395.4 149.991 1391.85 Q148.186 1388.29 144.552 1388.29 M144.552 1384.59 Q150.362 1384.59 153.417 1389.19 Q156.496 1393.78 156.496 1402.53 Q156.496 1411.25 153.417 1415.86 Q150.362 1420.44 144.552 1420.44 Q138.741 1420.44 135.663 1415.86 Q132.607 1411.25 132.607 1402.53 Q132.607 1393.78 135.663 1389.19 Q138.741 1384.59 144.552 1384.59 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M50.5475 1155.83 L80.2233 1155.83 L80.2233 1159.76 L50.5475 1159.76 L50.5475 1155.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M94.3436 1168.72 L110.663 1168.72 L110.663 1172.66 L88.7186 1172.66 L88.7186 1168.72 Q91.3806 1165.97 95.9639 1161.34 Q100.57 1156.68 101.751 1155.34 Q103.996 1152.82 104.876 1151.08 Q105.779 1149.32 105.779 1147.63 Q105.779 1144.88 103.834 1143.14 Q101.913 1141.41 98.8111 1141.41 Q96.6121 1141.41 94.1584 1142.17 Q91.7278 1142.93 88.9501 1144.48 L88.9501 1139.76 Q91.7741 1138.63 94.2278 1138.05 Q96.6815 1137.47 98.7185 1137.47 Q104.089 1137.47 107.283 1140.16 Q110.478 1142.84 110.478 1147.33 Q110.478 1149.46 109.668 1151.38 Q108.881 1153.28 106.774 1155.87 Q106.195 1156.54 103.094 1159.76 Q99.9917 1162.96 94.3436 1168.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M120.478 1166.78 L125.362 1166.78 L125.362 1172.66 L120.478 1172.66 L120.478 1166.78 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M135.593 1138.1 L153.95 1138.1 L153.95 1142.03 L139.876 1142.03 L139.876 1150.5 Q140.894 1150.16 141.913 1149.99 Q142.931 1149.81 143.95 1149.81 Q149.737 1149.81 153.116 1152.98 Q156.496 1156.15 156.496 1161.57 Q156.496 1167.15 153.024 1170.25 Q149.552 1173.33 143.232 1173.33 Q141.056 1173.33 138.788 1172.96 Q136.542 1172.59 134.135 1171.85 L134.135 1167.15 Q136.218 1168.28 138.441 1168.84 Q140.663 1169.39 143.14 1169.39 Q147.144 1169.39 149.482 1167.29 Q151.82 1165.18 151.82 1161.57 Q151.82 1157.96 149.482 1155.85 Q147.144 1153.74 143.14 1153.74 Q141.265 1153.74 139.39 1154.16 Q137.538 1154.58 135.593 1155.46 L135.593 1138.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M99.3204 894.059 Q95.7093 894.059 93.8806 897.624 Q92.075 901.165 92.075 908.295 Q92.075 915.401 93.8806 918.966 Q95.7093 922.508 99.3204 922.508 Q102.955 922.508 104.76 918.966 Q106.589 915.401 106.589 908.295 Q106.589 901.165 104.76 897.624 Q102.955 894.059 99.3204 894.059 M99.3204 890.355 Q105.131 890.355 108.186 894.962 Q111.265 899.545 111.265 908.295 Q111.265 917.022 108.186 921.628 Q105.131 926.212 99.3204 926.212 Q93.5102 926.212 90.4315 921.628 Q87.376 917.022 87.376 908.295 Q87.376 899.545 90.4315 894.962 Q93.5102 890.355 99.3204 890.355 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M119.482 919.661 L124.367 919.661 L124.367 925.54 L119.482 925.54 L119.482 919.661 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M144.552 894.059 Q140.941 894.059 139.112 897.624 Q137.306 901.165 137.306 908.295 Q137.306 915.401 139.112 918.966 Q140.941 922.508 144.552 922.508 Q148.186 922.508 149.991 918.966 Q151.82 915.401 151.82 908.295 Q151.82 901.165 149.991 897.624 Q148.186 894.059 144.552 894.059 M144.552 890.355 Q150.362 890.355 153.417 894.962 Q156.496 899.545 156.496 908.295 Q156.496 917.022 153.417 921.628 Q150.362 926.212 144.552 926.212 Q138.741 926.212 135.663 921.628 Q132.607 917.022 132.607 908.295 Q132.607 899.545 135.663 894.962 Q138.741 890.355 144.552 890.355 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M94.3436 674.49 L110.663 674.49 L110.663 678.425 L88.7186 678.425 L88.7186 674.49 Q91.3806 671.735 95.9639 667.106 Q100.57 662.453 101.751 661.11 Q103.996 658.587 104.876 656.851 Q105.779 655.092 105.779 653.402 Q105.779 650.647 103.834 648.911 Q101.913 647.175 98.8111 647.175 Q96.6121 647.175 94.1584 647.939 Q91.7278 648.703 88.9501 650.254 L88.9501 645.532 Q91.7741 644.397 94.2278 643.819 Q96.6815 643.24 98.7185 643.24 Q104.089 643.24 107.283 645.925 Q110.478 648.61 110.478 653.101 Q110.478 655.231 109.668 657.152 Q108.881 659.05 106.774 661.643 Q106.195 662.314 103.094 665.532 Q99.9917 668.726 94.3436 674.49 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M120.478 672.545 L125.362 672.545 L125.362 678.425 L120.478 678.425 L120.478 672.545 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M135.593 643.865 L153.95 643.865 L153.95 647.8 L139.876 647.8 L139.876 656.272 Q140.894 655.925 141.913 655.763 Q142.931 655.578 143.95 655.578 Q149.737 655.578 153.116 658.749 Q156.496 661.921 156.496 667.337 Q156.496 672.916 153.024 676.018 Q149.552 679.096 143.232 679.096 Q141.056 679.096 138.788 678.726 Q136.542 678.356 134.135 677.615 L134.135 672.916 Q136.218 674.05 138.441 674.606 Q140.663 675.161 143.14 675.161 Q147.144 675.161 149.482 673.055 Q151.82 670.948 151.82 667.337 Q151.82 663.726 149.482 661.62 Q147.144 659.513 143.14 659.513 Q141.265 659.513 139.39 659.93 Q137.538 660.346 135.593 661.226 L135.593 643.865 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M89.3667 396.75 L107.723 396.75 L107.723 400.685 L93.6491 400.685 L93.6491 409.157 Q94.6676 408.81 95.6861 408.648 Q96.7047 408.463 97.7232 408.463 Q103.51 408.463 106.89 411.634 Q110.269 414.805 110.269 420.222 Q110.269 425.801 106.797 428.902 Q103.325 431.981 97.0056 431.981 Q94.8297 431.981 92.5612 431.611 Q90.3158 431.24 87.9084 430.5 L87.9084 425.801 Q89.9917 426.935 92.2139 427.49 Q94.4361 428.046 96.913 428.046 Q100.918 428.046 103.256 425.94 Q105.593 423.833 105.593 420.222 Q105.593 416.611 103.256 414.504 Q100.918 412.398 96.913 412.398 Q95.038 412.398 93.163 412.815 Q91.3112 413.231 89.3667 414.111 L89.3667 396.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M119.482 425.43 L124.367 425.43 L124.367 431.31 L119.482 431.31 L119.482 425.43 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M144.552 399.829 Q140.941 399.829 139.112 403.393 Q137.306 406.935 137.306 414.065 Q137.306 421.171 139.112 424.736 Q140.941 428.277 144.552 428.277 Q148.186 428.277 149.991 424.736 Q151.82 421.171 151.82 414.065 Q151.82 406.935 149.991 403.393 Q148.186 399.829 144.552 399.829 M144.552 396.125 Q150.362 396.125 153.417 400.731 Q156.496 405.315 156.496 414.065 Q156.496 422.791 153.417 427.398 Q150.362 431.981 144.552 431.981 Q138.741 431.981 135.663 427.398 Q132.607 422.791 132.607 414.065 Q132.607 405.315 135.663 400.731 Q138.741 396.125 144.552 396.125 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M89.1352 149.635 L111.357 149.635 L111.357 151.625 L98.8111 184.195 L93.9269 184.195 L105.732 153.57 L89.1352 153.57 L89.1352 149.635 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M120.478 178.315 L125.362 178.315 L125.362 184.195 L120.478 184.195 L120.478 178.315 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M135.593 149.635 L153.95 149.635 L153.95 153.57 L139.876 153.57 L139.876 162.042 Q140.894 161.695 141.913 161.533 Q142.931 161.348 143.95 161.348 Q149.737 161.348 153.116 164.519 Q156.496 167.69 156.496 173.107 Q156.496 178.685 153.024 181.787 Q149.552 184.866 143.232 184.866 Q141.056 184.866 138.788 184.496 Q136.542 184.125 134.135 183.384 L134.135 178.685 Q136.218 179.82 138.441 180.375 Q140.663 180.931 143.14 180.931 Q147.144 180.931 149.482 178.824 Q151.82 176.718 151.82 173.107 Q151.82 169.496 149.482 167.389 Q147.144 165.283 143.14 165.283 Q141.265 165.283 139.39 165.699 Q137.538 166.116 135.593 166.996 L135.593 149.635 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip752)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1002.53 268.292,1452.7 270.6,1506.58 272.908,1339.3 275.216,1420.59 277.524,1457.21 279.832,1401.94 282.139,1176.37 284.447,1444.23 286.755,1290.41 289.063,1363.52 291.371,1469.51 293.679,1484.79 295.987,1556.35 298.295,1527.79 300.603,1363.55 302.911,1485.26 305.219,1161.81 307.527,1507.03 309.834,1425.11 312.142,1478.74 314.45,1487.89 316.758,1614.87 319.066,1425.77 321.374,1343.93 323.682,1399.67 325.99,1520.06 328.298,1338.15 330.606,1471.34 332.914,1340.21 335.221,1376.98 337.529,1440.32 339.837,1482.78 342.145,1406.94 344.453,1336.51 346.761,1555.8 349.069,1640.81 351.377,1583.86 353.685,1380.47 355.993,1459.98 358.301,1530.14 360.608,1368.77 362.916,1445.37 365.224,1460.53 367.532,1262.9 369.84,1230.91 372.148,1417.27 374.456,1452.39 376.764,1498.86 379.072,1389.52 381.38,1435.35 383.688,1383.05 385.996,1539.05 388.303,1258.83 390.611,1424.23 392.919,1379.02 395.227,1371.17 397.535,1446.68 399.843,1363.73 402.151,1408.8 404.459,1375.72 406.767,1333.03 409.075,1478.8 411.383,1751.15 413.69,1468.91 415.998,1286.12 418.306,1402.61 420.614,1437.07 422.922,1343.68 425.23,1351.55 427.538,1378.09 429.846,1364.9 432.154,1295.17 434.462,1406.56 436.77,1496.76 439.077,1472.45 441.385,1348.51 443.693,1353.7 446.001,1322.03 448.309,1479.96 450.617,1372.22 452.925,1345.64 455.233,1341.91 457.541,1487.36 459.849,1473.51 462.157,1301.15 464.465,1592.74 466.772,1460.74 469.08,1494.83 471.388,1227.33 473.696,1441.97 476.004,1193.45 478.312,1583.47 480.62,1389.7 482.928,1517.09 485.236,1475.38 487.544,1293.6 489.852,1384.72 492.159,1410.29 494.467,1381.22 496.775,1347.48 499.083,1119.98 501.391,1392.47 503.699,1531.59 506.007,1397.5 508.315,1480.57 510.623,1340.97 512.931,1498.17 515.239,1400.68 517.546,1434.77 519.854,1373.19 522.162,1313.73 524.47,1548.24 526.778,1326.77 529.086,1667.06 531.394,1519.48 533.702,1426.71 536.01,1316.94 538.318,1507.8 540.626,1359.18 542.933,1461.72 545.241,1246.46 547.549,1569.69 549.857,1315.72 552.165,1508.55 554.473,1382.4 556.781,1481.12 559.089,1374.38 561.397,1328.8 563.705,1404 566.013,1305.26 568.321,1270.65 570.628,1506.05 572.936,1087.65 575.244,1445.5 577.552,1513.8 579.86,1317.75 582.168,1367.58 584.476,1429.98 586.784,1388.33 589.092,1398.11 591.4,1427.11 593.708,1255.21 596.015,1461.12 598.323,1489.03 600.631,1286.43 602.939,1295.44 605.247,1285.44 607.555,1402.22 609.863,1398.31 612.171,1300.46 614.479,1374.9 616.787,1286.64 619.095,1436.61 621.402,1524.96 623.71,1384.48 626.018,1530.58 628.326,1553.92 630.634,1626.25 632.942,1404.65 635.25,1449.5 637.558,1439.54 639.866,1548.61 642.174,1418.68 644.482,1367.57 646.79,1509.74 649.097,1429.12 651.405,1270.08 653.713,1278.81 656.021,1220.87 658.329,1505.07 660.637,1566.14 662.945,1321.93 665.253,1357.13 667.561,1256.02 669.869,1629.06 672.177,1427.52 674.484,1489.98 676.792,1270.34 679.1,1377.16 681.408,1438.08 683.716,1454.82 686.024,1423.29 688.332,1384.08 690.64,1291.81 692.948,1374.41 695.256,1665.83 697.564,1460.22 699.871,1459.58 702.179,1303.6 704.487,1414.57 706.795,1545.41 709.103,1456.44 711.411,1257.73 713.719,1371.99 716.027,1347.93 718.335,1441 720.643,1576.46 722.951,1314.79 725.259,1353.03 727.566,1419.44 729.874,1369.04 732.182,1373.86 734.49,1321.33 736.798,1320.95 739.106,1526.1 741.414,1378.86 743.722,1450.38 746.03,1426.06 748.338,1368.38 750.646,1563.05 752.953,1312.94 755.261,1349.71 757.569,1303.5 759.877,1466.27 762.185,1408.86 764.493,1423.91 766.801,1436.81 769.109,1399.45 771.417,1264.42 773.725,1380.85 776.033,1306.51 778.34,1316.27 780.648,1446.98 782.956,1491.95 785.264,1336.33 787.572,1461.34 789.88,1390.42 792.188,1201.98 794.496,1494.76 796.804,1313.8 799.112,1222.88 801.42,1532.32 803.728,1432.43 806.035,1154.46 808.343,1512.91 810.651,1493.74 812.959,1423.34 815.267,1335.26 817.575,1502.5 819.883,1298.88 822.191,1539.47 824.499,1245.18 826.807,1358.88 829.115,1362.71 831.422,1317.01 833.73,1301.41 836.038,1222.88 838.346,1626.78 840.654,1414.4 842.962,1538.54 845.27,1320.38 847.578,1468.43 849.886,1263.18 852.194,1528.02 854.502,1467.56 856.809,1427.85 859.117,1235.12 861.425,1288.75 863.733,1510.82 866.041,1524.94 868.349,1478.53 870.657,1280.01 872.965,1310.93 875.273,1652.07 877.581,1174.96 879.889,1549.93 882.197,1411.11 884.504,1567.87 886.812,1475.77 889.12,1239.53 891.428,1336.39 893.736,1538.76 896.044,1400.12 898.352,1357.1 900.66,1385.43 902.968,1290.37 905.276,1538.27 907.584,1312.33 909.891,1385.75 912.199,1198.04 914.507,1488.82 916.815,1483.68 919.123,1458.74 921.431,1525.6 923.739,1636.47 926.047,1637.93 928.355,1363.07 930.663,1314.32 932.971,1353 935.278,1515.6 937.586,1321.04 939.894,1242.66 942.202,1433.44 944.51,1352.03 946.818,1421.27 949.126,1509.45 951.434,1332.51 953.742,1278.87 956.05,1574.62 958.358,1335.66 960.665,1462.65 962.973,1389.15 965.281,1439.64 967.589,1468.88 969.897,1480.84 972.205,1184.5 974.513,1498.38 976.821,1403.42 979.129,1434.4 981.437,1403.03 983.745,1188.25 986.053,1515.48 988.36,1363.36 990.668,1352.94 992.976,1350.43 995.284,1442.51 997.592,1499.18 999.9,1216.19 1002.21,1195.45 1004.52,1245.67 1006.82,1254.45 1009.13,1268.58 1011.44,1516.85 1013.75,1477.79 1016.06,1243.12 1018.36,1355.95 1020.67,1467.02 1022.98,1649.68 1025.29,1299.68 1027.59,1404.59 1029.9,1496.02 1032.21,1459.06 1034.52,1291 1036.83,1432.07 1039.13,1624.28 1041.44,1401.56 1043.75,1370.53 1046.06,1470.81 1048.37,1438.46 1050.67,1505.15 1052.98,1415.19 1055.29,1613.21 1057.6,1339.84 1059.91,1362.56 1062.21,1492.77 1064.52,1490.94 1066.83,1233.54 1069.14,1540.79 1071.45,1428.89 1073.75,1427.53 1076.06,1394.58 1078.37,1493.91 1080.68,1444.62 1082.98,1301.45 1085.29,1476.04 1087.6,1329.88 1089.91,1510.07 1092.22,1434.73 1094.52,1368.61 1096.83,1311.71 1099.14,1442.17 1101.45,1315.52 1103.76,1520.13 1106.06,1426.97 1108.37,1345.92 1110.68,1271.33 1112.99,1492.77 1115.3,1331.35 1117.6,1413.99 1119.91,1494.61 1122.22,1358.52 1124.53,1327.16 1126.84,1445.21 1129.14,1345.82 1131.45,1173.14 1133.76,1478.59 1136.07,1414.09 1138.37,1456.16 1140.68,1346.65 1142.99,1438.89 1145.3,1414.43 1147.61,1185.02 1149.91,1232.41 1152.22,1491.7 1154.53,1530.83 1156.84,1530.18 1159.15,1240.27 1161.45,1496.89 1163.76,1440.94 1166.07,1350.86 1168.38,1479.48 1170.69,1405.48 1172.99,1476.09 1175.3,1371.49 1177.61,1455.41 1179.92,1365.48 1182.23,1483.54 1184.53,1503.39 1186.84,1511.9 1189.15,1517.02 1191.46,1372.43 1193.76,1201.76 1196.07,1415.99 1198.38,1346.36 1200.69,1318.91 1203,1395.57 1205.3,1394.35 1207.61,1389.8 1209.92,1207.74 1212.23,1236.94 1214.54,1259.46 1216.84,1391.61 1219.15,1287.76 1221.46,1399.26 1223.77,1397.73 1226.08,1467.51 1228.38,1426.07 1230.69,1298.81 1233,1376.98 1235.31,1456.46 1237.61,1311.27 1239.92,1262.98 1242.23,1503.63 1244.54,1341.06 1246.85,1628.52 1249.15,1342.13 1251.46,1365.16 1253.77,1425.92 1256.08,1458.54 1258.39,1166.1 1260.69,1300.34 1263,1407.42 1265.31,1398.15 1267.62,1572.92 1269.93,1335.48 1272.23,1482.24 1274.54,1372.66 1276.85,1519.75 1279.16,1407.38 1281.47,1495.92 1283.77,1580.46 1286.08,1476.67 1288.39,1382.31 1290.7,1535.14 1293,1468.87 1295.31,1373.84 1297.62,1426.73 1299.93,1250.65 1302.24,1360.87 1304.54,1208.66 1306.85,1381.33 1309.16,1285.46 1311.47,1415.88 1313.78,1323.36 1316.08,1370.62 1318.39,1497.44 1320.7,1474.24 1323.01,1332.59 1325.32,1400.09 1327.62,1454.85 1329.93,1446.89 1332.24,1414.07 1334.55,1269.82 1336.86,1528.18 1339.16,1544.19 1341.47,1446.16 1343.78,1584.77 1346.09,1420.84 1348.39,1421.62 1350.7,1544.25 1353.01,1509.11 1355.32,1167.8 1357.63,1451.49 1359.93,1524.78 1362.24,1479.27 1364.55,1400.29 1366.86,1460.46 1369.17,1303.43 1371.47,1172.08 1373.78,1330.25 1376.09,1571.53 1378.4,1399.48 1380.71,1353.27 1383.01,1500.25 1385.32,1496.26 1387.63,1340.89 1389.94,1570.73 1392.24,1526.38 1394.55,1448.94 1396.86,1349.86 1399.17,1053.08 1401.48,1260.45 1403.78,1529.77 1406.09,1374.08 1408.4,1302.46 1410.71,1136.04 1413.02,1535.13 1415.32,1508.68 1417.63,1403.18 1419.94,1362.69 1422.25,1394.94 1424.56,1330.03 1426.86,1389.09 1429.17,1428.13 1431.48,1421 1433.79,1242.91 1436.1,1413.45 1438.4,1357.78 1440.71,1376.1 1443.02,1191.68 1445.33,1605.46 1447.63,1362.49 1449.94,1346 1452.25,1433.74 1454.56,1239.61 1456.87,1563.48 1459.17,1379.53 1461.48,1288.99 1463.79,1304.91 1466.1,1514.43 1468.41,1429.25 1470.71,1533.28 1473.02,1402.88 1475.33,1230.53 1477.64,1268.52 1479.95,1427.94 1482.25,1348.85 1484.56,1305.56 1486.87,1485.46 1489.18,1360.54 1491.49,1388.53 1493.79,1623.19 1496.1,1380.38 1498.41,1562.91 1500.72,1407.5 1503.02,1386.74 1505.33,1291.7 1507.64,1393.6 1509.95,1521.66 1512.26,1282.6 1514.56,1413.66 1516.87,1411.63 1519.18,1267.21 1521.49,1270.58 1523.8,1493.2 1526.1,1441.63 1528.41,1524.37 1530.72,1266.34 1533.03,1487.23 1535.34,1408.37 1537.64,1418.54 1539.95,1298.48 1542.26,1492.31 1544.57,1507.57 1546.88,1442.1 1549.18,1332.95 1551.49,1527.45 1553.8,1500.98 1556.11,1517.2 1558.41,1413.41 1560.72,1518.96 1563.03,1387.08 1565.34,1561.88 1567.65,1594.79 1569.95,1476 1572.26,1220.35 1574.57,1308.96 1576.88,1309.86 1579.19,1328.56 1581.49,1332.05 1583.8,1289.63 1586.11,1435.38 1588.42,1424.43 1590.73,1433.74 1593.03,1401 1595.34,1464.68 1597.65,1312.82 1599.96,1440.77 1602.26,1610.68 1604.57,1371.91 1606.88,1447.95 1609.19,1466.25 1611.5,1410.25 1613.8,1380.58 1616.11,1323.12 1618.42,1368.53 1620.73,1247.98 1623.04,1453.7 1625.34,1492.52 1627.65,1585.92 1629.96,1341.91 1632.27,1228.9 1634.58,1387.82 1636.88,1526.66 1639.19,1376.13 1641.5,1164.75 1643.81,1456.92 1646.12,1479.07 1648.42,1425.05 1650.73,1402.96 1653.04,1334.73 1655.35,1424.11 1657.65,1361.53 1659.96,1308.82 1662.27,1540.47 1664.58,1251.25 1666.89,1401.91 1669.19,1474.01 1671.5,1400.75 1673.81,1630.15 1676.12,1338.86 1678.43,1352.68 1680.73,1467.76 1683.04,1415.91 1685.35,1489.77 1687.66,1457.97 1689.97,1564.07 1692.27,1430.29 1694.58,1500.19 1696.89,1351.67 1699.2,1377.01 1701.51,1325.19 1703.81,1488.11 1706.12,1245.72 1708.43,1530.61 1710.74,1408.17 1713.04,1480.31 1715.35,1283.07 1717.66,1314.3 1719.97,1576.31 1722.28,1317.11 1724.58,1370.47 1726.89,1548.08 1729.2,1440.05 1731.51,1529.56 1733.82,1518.6 1736.12,1462.77 1738.43,1435.16 1740.74,1274.2 1743.05,1451.39 1745.36,1453.22 1747.66,1386.46 1749.97,1419.84 1752.28,1410.71 1754.59,1330.17 1756.9,1422.48 1759.2,1441.95 1761.51,1316.77 1763.82,1336.52 1766.13,1506.65 1768.43,1609.84 1770.74,1392.57 1773.05,1385.16 1775.36,1302.77 1777.67,1409.67 1779.97,1448.05 1782.28,1296.3 1784.59,1402.24 1786.9,1237.51 1789.21,1505.3 1791.51,1365.31 1793.82,1233.8 1796.13,1389.08 1798.44,1349.37 1800.75,1373.37 1803.05,1381.99 1805.36,1287.54 1807.67,1440 1809.98,1480.37 1812.28,1370.79 1814.59,1513.49 1816.9,1307.96 1819.21,1589.72 1821.52,1489.77 1823.82,1536.81 1826.13,1621.47 1828.44,1468.51 1830.75,1353.92 1833.06,1445.1 1835.36,1497.22 1837.67,1320.2 1839.98,1350.51 1842.29,1403.47 1844.6,1473.34 1846.9,1523.16 1849.21,1494.76 1851.52,1470.84 1853.83,1443.3 1856.14,1355.31 1858.44,1394.58 1860.75,1273.02 1863.06,1529.14 1865.37,1422.58 1867.67,1431.19 1869.98,1430.63 1872.29,1497.14 1874.6,1615.51 1876.91,1602.89 1879.21,1464.03 1881.52,1573.33 1883.83,1496.94 1886.14,1327.6 1888.45,1271.11 1890.75,1093.67 1893.06,1559.47 1895.37,1373.84 1897.68,1300.94 1899.99,1528.02 1902.29,1281.6 1904.6,1458.72 1906.91,1480.51 1909.22,1498.25 1911.53,1531.83 1913.83,1360.49 1916.14,1550.1 1918.45,1496.31 1920.76,1304.77 1923.06,1265.98 1925.37,1497.11 1927.68,1320.47 1929.99,1262.29 1932.3,1413.21 1934.6,1354.22 1936.91,1307.11 1939.22,1440.85 1941.53,1442.46 1943.84,1423.01 1946.14,1396.73 1948.45,1486.15 1950.76,1518.78 1953.07,1293.67 1955.38,1490.45 1957.68,1342.75 1959.99,1219.31 1962.3,1381.21 1964.61,1609.85 1966.91,1504.73 1969.22,1599.38 1971.53,1513.06 1973.84,1260.82 1976.15,1389.39 1978.45,1519.45 1980.76,1313.05 1983.07,1372.01 1985.38,1362.63 1987.69,1691.57 1989.99,1358.07 1992.3,1584.38 1994.61,1206.47 1996.92,1475.48 1999.23,1464.82 2001.53,1309.05 2003.84,1462.23 2006.15,1339.67 2008.46,1398.32 2010.77,1461.02 2013.07,1341.65 2015.38,1469.86 2017.69,1486.44 2020,1517.48 2022.3,1385.68 2024.61,1235.18 2026.92,1368.44 2029.23,1350.61 2031.54,1258.86 2033.84,1423.97 2036.15,1553.57 2038.46,1281.46 2040.77,1330.31 2043.08,1537.49 2045.38,1386.41 2047.69,1386.35 2050,1456.96 2052.31,1368.02 2054.62,1226.43 2056.92,1415.02 2059.23,1390.41 2061.54,1384.54 2063.85,1486.87 2066.16,1373.53 2068.46,1459.71 2070.77,1363.79 2073.08,1422.43 2075.39,1329.54 2077.69,1372.91 2080,1178.7 2082.31,1407.08 2084.62,1458.51 2086.93,1398.7 2089.23,1449.41 2091.54,1280.54 2093.85,1505.68 2096.16,1495.2 2098.47,1324.55 2100.77,1413.37 2103.08,1500.2 2105.39,1459.69 2107.7,1518.02 2110.01,1413.77 2112.31,1288.93 2114.62,1563.13 2116.93,1437.29 2119.24,1427.34 2121.55,1603.38 2123.85,1510.57 2126.16,1470.21 2128.47,1408.18 2130.78,1576.6 2133.08,1258.64 2135.39,1480.09 2137.7,1353.8 2140.01,1528.93 2142.32,1375.35 2144.62,1447.58 2146.93,1365.65 2149.24,1477.91 2151.55,1371.95 2153.86,1403.66 2156.16,1417.58 2158.47,1281 2160.78,1383.69 2163.09,1483.19 2165.4,1446.85 2167.7,1325.88 2170.01,1498.06 2172.32,1461.11 2174.63,1409.53 2176.93,1325.02 2179.24,1644.13 2181.55,1292.38 2183.86,1464.06 2186.17,1218.43 2188.47,1513.84 2190.78,1340.25 2193.09,1436.8 2195.4,1410.73 2197.71,1302.47 2200.01,1474.72 2202.32,1490.39 2204.63,1621.44 2206.94,1310.98 2209.25,1435.71 2211.55,1344.32 2213.86,1516.03 2216.17,1234.42 2218.48,1412.49 2220.79,1331.29 2223.09,1604.25 2225.4,1474.25 2227.71,1515.87 2230.02,1379.51 2232.32,1500.33 2234.63,1289.84 2236.94,1357.67 2239.25,1223.56 2241.56,1474.6 2243.86,1469.71 2246.17,1468.82 2248.48,1282.54 2250.79,1392.24 2253.1,1299.61 2255.4,1415.01 2257.71,1419.72 2260.02,1519.7 2262.33,1426.26 2264.64,1374.98 2266.94,1423.36 2269.25,1373.51 2271.56,1406.69 2273.87,1246.24 2276.18,1530.28 2278.48,1455.97 2280.79,1409.42 2283.1,1646.68 2285.41,1408.75 2287.71,1447.8 2290.02,1389.5 2292.33,1437.99 2294.64,1243.97 2296.95,1434.86 2299.25,1206.37 2301.56,1318.15 2303.87,1550 2306.18,1373.32 2308.49,1348.67 2310.79,1328.69 2313.1,1309.51 2315.41,1423.66 2317.72,1457.53 2320.03,1447.22 2322.33,1456.11 2324.64,1261.71 2326.95,1452.18 2329.26,1397 2331.56,1348.72 2333.87,1385.01 2336.18,1401.45 2338.49,1534.24 2340.8,1302.27 2343.1,1425.87 2345.41,1297.28 2347.72,1541.23 2350.03,1433.07 2352.34,1323.56 2354.64,1275.03 2356.95,1455.73 2359.26,1401.07 2361.57,1198.8 2363.88,1369.04 2366.18,1203.96 2368.49,1503.59 2370.8,1481.09 2373.11,1343.21 2375.42,1366.78 2377.72,1480.6 2380.03,1274.63 2382.34,1440.46 2384.65,1309.68 2386.95,1405.94 2389.26,1440.74 2391.57,1168.69 2393.88,1482.17 2396.19,1455.66 2398.49,1365.13 2400.8,1463.35 2403.11,1369.7 2405.42,1293.14 2407.73,1602.03 2410.03,1460.23 2412.34,1365.2 2414.65,1364.45 2416.96,1426.22 2419.27,1306.69 2421.57,1332.36 2423.88,1428.41 2426.19,1411.48 2428.5,1343.15 2430.81,1361.6 2433.11,1396.8 2435.42,1291.41 2437.73,1332.62 2440.04,1454.06 2442.34,1555.07 2444.65,1531.46 2446.96,1280.19 2449.27,1391.7 2451.58,1276.94 2453.88,1370.85 2456.19,1497.82 2458.5,1313.85 2460.81,1383.56 2463.12,1365.97 2465.42,1376.57 2467.73,1280.67 2470.04,1367.98 2472.35,1491.67 2474.66,1272.26 2476.96,1305.59 2479.27,1506 2481.58,1338.21 2483.89,1354.49 2486.2,1434.17 2488.5,1265.1 2490.81,1344.49 2493.12,1576.15 2495.43,1430.1 2497.73,1505.25 2500.04,1453.18 2502.35,1532.73 2504.66,1358.63 2506.97,1427.42 2509.27,1271.98 2511.58,1272.94 2513.89,1550.46 2516.2,1399.14 2518.51,1432.57 2520.81,1424.43 2523.12,1325.17 2525.43,1455.34 2527.74,1462.67 2530.05,1655.25 2532.35,1488.52 2534.66,1385.64 2536.97,1535.47 2539.28,1521.86 2541.58,1232.35 2543.89,1392.83 2546.2,1442.14 2548.51,1330.69 2550.82,1574.51 2553.12,1416.06 2555.43,1322.73 2557.74,1618.43 2560.05,1361.83 2562.36,1359.56 2564.66,1461.77 2566.97,1560.02 2569.28,1311.68 2571.59,1439.83 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,875.68 268.292,1019.1 270.6,1095.81 272.908,1047.94 275.216,834.737 277.524,788.645 279.832,1032.81 282.139,933.337 284.447,758.851 286.755,813.799 289.063,1141.78 291.371,946.191 293.679,1078.13 295.987,825.868 298.295,1130.73 300.603,883.017 302.911,948.654 305.219,1000.57 307.527,989.196 309.834,1011.71 312.142,910.002 314.45,904.569 316.758,830.444 319.066,892.055 321.374,819.773 323.682,876.817 325.99,942.843 328.298,929.71 330.606,993.874 332.914,916.128 335.221,883.371 337.529,793.841 339.837,863.476 342.145,802.737 344.453,830.588 346.761,766.027 349.069,895.817 351.377,958.556 353.685,1009.54 355.993,774.319 358.301,893.257 360.608,935.276 362.916,877.841 365.224,833.539 367.532,903.205 369.84,1064.52 372.148,903.819 374.456,1061.54 376.764,890.681 379.072,902.412 381.38,883.68 383.688,810.175 385.996,904.854 388.303,919.229 390.611,909.142 392.919,981.716 395.227,809.951 397.535,980.09 399.843,792.238 402.151,935.528 404.459,799.369 406.767,917.316 409.075,883.597 411.383,1059.54 413.69,863.103 415.998,929.71 418.306,944.693 420.614,1030.01 422.922,863.933 425.23,918.166 427.538,1005.95 429.846,973.813 432.154,936.938 434.462,1032.68 436.77,944.175 439.077,767.72 441.385,1097.25 443.693,769.135 446.001,1095.77 448.309,836.372 450.617,1028 452.925,767.371 455.233,982.158 457.541,871.39 459.849,992.675 462.157,880.453 464.465,978.514 466.772,901.537 469.08,891.521 471.388,827.17 473.696,888.274 476.004,794.725 478.312,972.873 480.62,1010.04 482.928,939.455 485.236,855.688 487.544,731.175 489.852,931.877 492.159,907.774 494.467,989.881 496.775,808.837 499.083,873.493 501.391,841.616 503.699,1027.39 506.007,951.785 508.315,922.918 510.623,949.347 512.931,956.779 515.239,997.089 517.546,872.888 519.854,699.521 522.162,984.355 524.47,1012.37 526.778,735.187 529.086,793.821 531.394,984.357 533.702,868.078 536.01,944.888 538.318,928.507 540.626,1132.21 542.933,1106.76 545.241,1012.14 547.549,1053.09 549.857,956.447 552.165,1060.98 554.473,894.09 556.781,1076.98 559.089,966.378 561.397,928.944 563.705,936.191 566.013,935.43 568.321,916.237 570.628,1070.48 572.936,920.675 575.244,958.176 577.552,1086.69 579.86,753.821 582.168,779.062 584.476,1041.73 586.784,922.7 589.092,819.399 591.4,862.187 593.708,964.847 596.015,913.64 598.323,849.097 600.631,964.087 602.939,862.707 605.247,963.195 607.555,985.584 609.863,1025.4 612.171,899.445 614.479,755.01 616.787,780.122 619.095,764.961 621.402,835.89 623.71,919.259 626.018,936.413 628.326,889.013 630.634,913.371 632.942,1029.38 635.25,837.237 637.558,946.728 639.866,880.082 642.174,959.365 644.482,823.086 646.79,881.222 649.097,931.17 651.405,985.583 653.713,1124.93 656.021,1015.02 658.329,930.583 660.637,1024.18 662.945,948.624 665.253,862.94 667.561,900.757 669.869,653.98 672.177,949.312 674.484,922.727 676.792,1000.87 679.1,852.595 681.408,798.316 683.716,1095.41 686.024,686.484 688.332,925.944 690.64,893.509 692.948,815.009 695.256,889.059 697.564,789.199 699.871,801.82 702.179,950.342 704.487,899.07 706.795,897.915 709.103,906.582 711.411,917.348 713.719,921.349 716.027,963.81 718.335,836.404 720.643,938.132 722.951,876.106 725.259,859.342 727.566,870.701 729.874,1091.42 732.182,885.955 734.49,975.984 736.798,877.13 739.106,923.481 741.414,823.525 743.722,1026.9 746.03,837.635 748.338,924.059 750.646,825.83 752.953,945.874 755.261,1064.23 757.569,907.707 759.877,842.203 762.185,900.837 764.493,879.468 766.801,937.922 769.109,992.275 771.417,655.913 773.725,997.301 776.033,865.157 778.34,966.199 780.648,1025.35 782.956,802.911 785.264,943.566 787.572,1022.76 789.88,871.28 792.188,826.48 794.496,880.429 796.804,1037.74 799.112,888.912 801.42,949.384 803.728,639.191 806.035,884.816 808.343,950.321 810.651,968.589 812.959,912.393 815.267,943.396 817.575,892.509 819.883,1039.99 822.191,865.654 824.499,771.477 826.807,827.026 829.115,917.15 831.422,1056.95 833.73,964.778 836.038,830.305 838.346,1191.93 840.654,891.954 842.962,964.843 845.27,684.082 847.578,925.848 849.886,983.796 852.194,897.076 854.502,900.183 856.809,1018.09 859.117,908.821 861.425,940.372 863.733,1028.55 866.041,961.367 868.349,903.253 870.657,762.871 872.965,936.307 875.273,872.062 877.581,759.967 879.889,885.574 882.197,908.235 884.504,975.44 886.812,874.274 889.12,881.61 891.428,992.869 893.736,1028.7 896.044,700.431 898.352,1018.15 900.66,1007.84 902.968,867.738 905.276,799.604 907.584,881.838 909.891,874.629 912.199,820.613 914.507,880.818 916.815,889.393 919.123,1013.62 921.431,847.155 923.739,798.01 926.047,945.401 928.355,809.384 930.663,804.583 932.971,714.355 935.278,913.021 937.586,728.366 939.894,919.954 942.202,1025.54 944.51,783.356 946.818,855.772 949.126,966.659 951.434,871.231 953.742,718.417 956.05,883.262 958.358,866.729 960.665,856.592 962.973,939.956 965.281,945.86 967.589,981.389 969.897,1084.63 972.205,995.295 974.513,933.688 976.821,841.176 979.129,951.389 981.437,834.808 983.745,933.743 986.053,885.931 988.36,938.841 990.668,816.203 992.976,1003.29 995.284,982.504 997.592,866.83 999.9,962.931 1002.21,922.984 1004.52,763.859 1006.82,887.331 1009.13,721.704 1011.44,830.478 1013.75,893.11 1016.06,1025.98 1018.36,907.232 1020.67,812.533 1022.98,881.318 1025.29,1018.02 1027.59,950.795 1029.9,1010.27 1032.21,822.353 1034.52,841.352 1036.83,813.656 1039.13,833.353 1041.44,900.271 1043.75,792.29 1046.06,852.916 1048.37,773.021 1050.67,983.753 1052.98,946.065 1055.29,905.772 1057.6,839.687 1059.91,884.021 1062.21,924.975 1064.52,791.293 1066.83,955.746 1069.14,899.891 1071.45,847.743 1073.75,781.985 1076.06,1018.42 1078.37,718.668 1080.68,899.334 1082.98,915.712 1085.29,917.121 1087.6,849.348 1089.91,977.812 1092.22,836.282 1094.52,972.628 1096.83,1087.09 1099.14,973.607 1101.45,983.021 1103.76,942.757 1106.06,806.26 1108.37,1098.69 1110.68,932.1 1112.99,928.348 1115.3,939.003 1117.6,1048.27 1119.91,865.166 1122.22,1029.41 1124.53,806.398 1126.84,896.819 1129.14,778.392 1131.45,986.32 1133.76,877.922 1136.07,712.62 1138.37,855.786 1140.68,926.155 1142.99,916.55 1145.3,888.008 1147.61,677.953 1149.91,833.495 1152.22,693.303 1154.53,823.085 1156.84,752.446 1159.15,691.291 1161.45,928.841 1163.76,732.217 1166.07,966.571 1168.38,843.442 1170.69,984.199 1172.99,865.564 1175.3,993.408 1177.61,883.238 1179.92,779.759 1182.23,957.648 1184.53,745.208 1186.84,933.273 1189.15,832.473 1191.46,931.575 1193.76,938.043 1196.07,838.968 1198.38,804.787 1200.69,810.305 1203,882.602 1205.3,1021.64 1207.61,810.358 1209.92,739.874 1212.23,835.725 1214.54,868.799 1216.84,915.612 1219.15,745.579 1221.46,763.504 1223.77,1000.52 1226.08,1054.55 1228.38,870.687 1230.69,780.706 1233,964.686 1235.31,816.893 1237.61,893.547 1239.92,958.033 1242.23,891.267 1244.54,1106.17 1246.85,994.705 1249.15,995.384 1251.46,1058.45 1253.77,1000.78 1256.08,845.231 1258.39,1058.64 1260.69,955.479 1263,952.942 1265.31,835.511 1267.62,976.228 1269.93,1158.21 1272.23,813.032 1274.54,722.288 1276.85,811.388 1279.16,810.577 1281.47,1025.61 1283.77,760.11 1286.08,804.019 1288.39,854.99 1290.7,828.127 1293,1018.75 1295.31,790.929 1297.62,896.313 1299.93,750.742 1302.24,907.496 1304.54,772.84 1306.85,921.375 1309.16,661.685 1311.47,848.883 1313.78,1116.49 1316.08,896.825 1318.39,1049.3 1320.7,981.677 1323.01,926.771 1325.32,868.81 1327.62,912.193 1329.93,973.605 1332.24,735.287 1334.55,899.828 1336.86,784.783 1339.16,956.392 1341.47,763.381 1343.78,890.864 1346.09,1085.65 1348.39,845.691 1350.7,868.872 1353.01,1135.12 1355.32,840.172 1357.63,798.62 1359.93,857.734 1362.24,780.463 1364.55,924.908 1366.86,859.151 1369.17,848.874 1371.47,938.165 1373.78,941.503 1376.09,1010.76 1378.4,834.798 1380.71,804.81 1383.01,829.839 1385.32,958.361 1387.63,910.455 1389.94,914.558 1392.24,996.596 1394.55,946.464 1396.86,982.354 1399.17,787.925 1401.48,981.073 1403.78,985.154 1406.09,927.005 1408.4,947.252 1410.71,1027.09 1413.02,1055.42 1415.32,895.894 1417.63,867.011 1419.94,894.788 1422.25,945.219 1424.56,1021.75 1426.86,962.477 1429.17,830.935 1431.48,1011.08 1433.79,833.312 1436.1,866.623 1438.4,1092.48 1440.71,946.227 1443.02,906.46 1445.33,898.631 1447.63,960.234 1449.94,947.434 1452.25,826.584 1454.56,853.719 1456.87,895.218 1459.17,912.85 1461.48,829.567 1463.79,846.862 1466.1,650.603 1468.41,984.535 1470.71,916.419 1473.02,804.192 1475.33,939.936 1477.64,992.923 1479.95,965.426 1482.25,1251.69 1484.56,848.534 1486.87,910.918 1489.18,797.419 1491.49,981.547 1493.79,791.696 1496.1,852.186 1498.41,887.805 1500.72,799.333 1503.02,960.38 1505.33,959.772 1507.64,956.065 1509.95,849.423 1512.26,795.484 1514.56,925.843 1516.87,889.475 1519.18,856.845 1521.49,872.19 1523.8,823.54 1526.1,881.264 1528.41,975.064 1530.72,779.395 1533.03,840.047 1535.34,1017.57 1537.64,702.845 1539.95,903.304 1542.26,922.126 1544.57,954.652 1546.88,734.203 1549.18,941.96 1551.49,917.689 1553.8,744.493 1556.11,1008.53 1558.41,768.547 1560.72,1017.64 1563.03,893.806 1565.34,815.693 1567.65,759.109 1569.95,848.423 1572.26,971.136 1574.57,769.774 1576.88,608.036 1579.19,990.975 1581.49,894.63 1583.8,1027.05 1586.11,819.204 1588.42,894.388 1590.73,918.428 1593.03,939.246 1595.34,936.471 1597.65,877.266 1599.96,867.599 1602.26,940.312 1604.57,812.75 1606.88,776.17 1609.19,763.733 1611.5,1019.93 1613.8,846.131 1616.11,753.85 1618.42,1106.21 1620.73,829.357 1623.04,764.6 1625.34,1023.61 1627.65,930.445 1629.96,885.75 1632.27,838.263 1634.58,969.138 1636.88,700.015 1639.19,1096.95 1641.5,968.346 1643.81,913.626 1646.12,833.674 1648.42,800.27 1650.73,1055.84 1653.04,840.542 1655.35,926.905 1657.65,793.602 1659.96,809.595 1662.27,982.382 1664.58,840.968 1666.89,882.062 1669.19,916.213 1671.5,976.607 1673.81,908.308 1676.12,994.809 1678.43,849.327 1680.73,813.665 1683.04,963.572 1685.35,1005.65 1687.66,860.155 1689.97,902.976 1692.27,799.449 1694.58,815.117 1696.89,900.744 1699.2,932.476 1701.51,906.303 1703.81,1061.42 1706.12,846.43 1708.43,690.707 1710.74,1025.2 1713.04,995.585 1715.35,895.947 1717.66,895.943 1719.97,711.509 1722.28,916.337 1724.58,822.249 1726.89,1034.65 1729.2,789.981 1731.51,801.598 1733.82,971.173 1736.12,945.03 1738.43,945.888 1740.74,883.048 1743.05,906.354 1745.36,850.409 1747.66,1034.63 1749.97,956.512 1752.28,862.638 1754.59,795.317 1756.9,910.681 1759.2,953.315 1761.51,859.871 1763.82,983.405 1766.13,685.661 1768.43,859.652 1770.74,852.273 1773.05,978.43 1775.36,1060.04 1777.67,857.781 1779.97,852.283 1782.28,1034.1 1784.59,788.115 1786.9,886.515 1789.21,877.468 1791.51,825.821 1793.82,851.974 1796.13,894.159 1798.44,977.215 1800.75,743.736 1803.05,894.426 1805.36,751.398 1807.67,912.207 1809.98,997.803 1812.28,937.69 1814.59,876.377 1816.9,868.08 1819.21,921.224 1821.52,903.647 1823.82,1174.62 1826.13,882.726 1828.44,931.098 1830.75,1066.52 1833.06,854.031 1835.36,697.216 1837.67,823.452 1839.98,971.825 1842.29,838.833 1844.6,854.185 1846.9,913.801 1849.21,820.345 1851.52,783.37 1853.83,945.828 1856.14,941.412 1858.44,897.673 1860.75,1060.31 1863.06,917.817 1865.37,1045.02 1867.67,918.514 1869.98,790.834 1872.29,1165.64 1874.6,1003.29 1876.91,1056.63 1879.21,911.719 1881.52,791.067 1883.83,944.277 1886.14,931.017 1888.45,1037.8 1890.75,906.567 1893.06,974.544 1895.37,674.812 1897.68,952.941 1899.99,980.937 1902.29,1071.01 1904.6,814.309 1906.91,1016.73 1909.22,808.197 1911.53,1018.36 1913.83,846.841 1916.14,899.483 1918.45,973.151 1920.76,892.356 1923.06,997.036 1925.37,1013.37 1927.68,1030.68 1929.99,881.218 1932.3,953.068 1934.6,934.357 1936.91,1001.01 1939.22,853.909 1941.53,816.8 1943.84,818.588 1946.14,990.585 1948.45,926.265 1950.76,925.69 1953.07,1038.66 1955.38,907.732 1957.68,788.422 1959.99,926.834 1962.3,884.035 1964.61,954.742 1966.91,860.937 1969.22,830.437 1971.53,980.846 1973.84,992.436 1976.15,807.194 1978.45,744.585 1980.76,1136.03 1983.07,998.544 1985.38,958.374 1987.69,890.549 1989.99,928.132 1992.3,922.606 1994.61,900.689 1996.92,755.714 1999.23,1015.88 2001.53,816.953 2003.84,903.971 2006.15,804.216 2008.46,927.486 2010.77,849.173 2013.07,892.254 2015.38,843.193 2017.69,859.463 2020,873.06 2022.3,1028.29 2024.61,886.034 2026.92,988.673 2029.23,770.421 2031.54,975.038 2033.84,824.528 2036.15,983.7 2038.46,838.349 2040.77,955.75 2043.08,868.55 2045.38,1022.64 2047.69,792.125 2050,906.879 2052.31,956.689 2054.62,675.183 2056.92,875.857 2059.23,914.672 2061.54,980.552 2063.85,1031.08 2066.16,975.559 2068.46,906.568 2070.77,971.107 2073.08,1120.76 2075.39,883.452 2077.69,875.597 2080,696.099 2082.31,818.467 2084.62,1006.82 2086.93,839.426 2089.23,1012.65 2091.54,1014.33 2093.85,959.677 2096.16,999.772 2098.47,929.173 2100.77,925.063 2103.08,891.508 2105.39,989.141 2107.7,956.304 2110.01,867.704 2112.31,974.959 2114.62,868.78 2116.93,867.234 2119.24,904.77 2121.55,597.666 2123.85,842.008 2126.16,811.398 2128.47,872.852 2130.78,901.509 2133.08,683.08 2135.39,723.757 2137.7,820.301 2140.01,959.836 2142.32,887.247 2144.62,919.119 2146.93,962.696 2149.24,911.501 2151.55,925.251 2153.86,870.193 2156.16,1020.56 2158.47,883.727 2160.78,976.907 2163.09,904.602 2165.4,1002.11 2167.7,793.344 2170.01,748.846 2172.32,912.255 2174.63,861.881 2176.93,929.869 2179.24,788.242 2181.55,857.203 2183.86,961.781 2186.17,941.968 2188.47,841.861 2190.78,1012.73 2193.09,762.558 2195.4,1049.92 2197.71,837.101 2200.01,865.177 2202.32,1010.64 2204.63,844.805 2206.94,937.652 2209.25,1007.04 2211.55,943.005 2213.86,995.411 2216.17,993.972 2218.48,996.222 2220.79,885.284 2223.09,996.435 2225.4,1068.81 2227.71,1005.96 2230.02,950.627 2232.32,978.958 2234.63,918.115 2236.94,826.14 2239.25,910.814 2241.56,925.696 2243.86,894.101 2246.17,1014.05 2248.48,992.946 2250.79,811.518 2253.1,973.465 2255.4,918.569 2257.71,1010.15 2260.02,835.521 2262.33,873.499 2264.64,939.755 2266.94,867.36 2269.25,821.468 2271.56,951.302 2273.87,762.405 2276.18,823.933 2278.48,1051.6 2280.79,971.584 2283.1,827.162 2285.41,1071.65 2287.71,871.822 2290.02,949.661 2292.33,1066.3 2294.64,711.812 2296.95,798.555 2299.25,924.688 2301.56,873.446 2303.87,969.201 2306.18,808.012 2308.49,996.402 2310.79,1028.36 2313.1,892.266 2315.41,879.013 2317.72,1032.51 2320.03,696.993 2322.33,801.59 2324.64,949.492 2326.95,858.142 2329.26,1030.86 2331.56,901.76 2333.87,1072.15 2336.18,869.896 2338.49,781.122 2340.8,970.415 2343.1,1015.87 2345.41,751.968 2347.72,709.965 2350.03,960.986 2352.34,932.292 2354.64,929.412 2356.95,841.653 2359.26,1075.57 2361.57,890.715 2363.88,1031.85 2366.18,845.555 2368.49,1027.88 2370.8,898.623 2373.11,1007.81 2375.42,856.129 2377.72,850.978 2380.03,830.697 2382.34,868.305 2384.65,977.636 2386.95,828.267 2389.26,972.416 2391.57,1074.2 2393.88,839.109 2396.19,727.751 2398.49,904.04 2400.8,912.078 2403.11,1089.65 2405.42,976.903 2407.73,830.536 2410.03,846.798 2412.34,917.985 2414.65,686.855 2416.96,911.695 2419.27,977.707 2421.57,850.845 2423.88,638.575 2426.19,929.724 2428.5,931.312 2430.81,856.273 2433.11,1036.07 2435.42,1044.58 2437.73,1025.26 2440.04,773.679 2442.34,780.283 2444.65,827.063 2446.96,814.397 2449.27,829.063 2451.58,854.19 2453.88,1035.88 2456.19,1056.91 2458.5,887.562 2460.81,998.513 2463.12,769.33 2465.42,800.563 2467.73,1029.77 2470.04,885.625 2472.35,894.757 2474.66,1077.23 2476.96,820.457 2479.27,1019.57 2481.58,734.749 2483.89,738.593 2486.2,886.083 2488.5,933.845 2490.81,879.404 2493.12,1044.7 2495.43,763.548 2497.73,1032.52 2500.04,788.818 2502.35,1006.34 2504.66,990.004 2506.97,870.911 2509.27,937.802 2511.58,913.966 2513.89,991.836 2516.2,832.493 2518.51,972.446 2520.81,948.052 2523.12,843.432 2525.43,1006.62 2527.74,880.936 2530.05,816.573 2532.35,759.582 2534.66,999.573 2536.97,816.723 2539.28,1075.52 2541.58,868.076 2543.89,979.854 2546.2,1027.15 2548.51,895.35 2550.82,931.045 2553.12,1047.54 2555.43,1079.56 2557.74,780.132 2560.05,815.85 2562.36,974.007 2564.66,748.364 2566.97,812.763 2569.28,1030.29 2571.59,957.496 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,646.974 268.292,243.403 270.6,443.244 272.908,321.352 275.216,482.684 277.524,436.248 279.832,556.085 282.139,344.288 284.447,517.958 286.755,221.295 289.063,277.805 291.371,305.908 293.679,297.671 295.987,348.939 298.295,509.178 300.603,217.449 302.911,407.526 305.219,301.022 307.527,376.846 309.834,322.608 312.142,538.692 314.45,441.86 316.758,268.789 319.066,345.077 321.374,535.913 323.682,371.879 325.99,338.374 328.298,386.593 330.606,440.527 332.914,383.263 335.221,286.139 337.529,323.17 339.837,386.383 342.145,259.54 344.453,424.714 346.761,406.072 349.069,561.375 351.377,210.569 353.685,338.902 355.993,402.653 358.301,324.183 360.608,300.898 362.916,309.548 365.224,495.962 367.532,456.176 369.84,517.454 372.148,531.568 374.456,500.882 376.764,514.502 379.072,618.42 381.38,611.128 383.688,447.827 385.996,474.548 388.303,465.081 390.611,364.781 392.919,460.561 395.227,357.894 397.535,430.145 399.843,483.291 402.151,520.318 404.459,455.231 406.767,258.021 409.075,462.888 411.383,282.653 413.69,247.289 415.998,432.471 418.306,323.148 420.614,426.1 422.922,599.26 425.23,455.882 427.538,226.944 429.846,517.853 432.154,489.87 434.462,291.28 436.77,264.593 439.077,540.048 441.385,326.126 443.693,300.426 446.001,404.982 448.309,476.065 450.617,523.843 452.925,600.152 455.233,441.095 457.541,312.432 459.849,356.089 462.157,385.119 464.465,412.368 466.772,525.504 469.08,522.716 471.388,405.286 473.696,340.041 476.004,413.132 478.312,474.048 480.62,420.232 482.928,404.157 485.236,405.734 487.544,351.467 489.852,308.535 492.159,218.933 494.467,146.283 496.775,310.998 499.083,480.969 501.391,463.996 503.699,448.31 506.007,496.184 508.315,497.929 510.623,426.585 512.931,265.539 515.239,499.622 517.546,450.372 519.854,406.565 522.162,460.213 524.47,410.833 526.778,466.728 529.086,482.24 531.394,265.606 533.702,344.197 536.01,423.547 538.318,391.657 540.626,310.948 542.933,489.818 545.241,380.896 547.549,311.932 549.857,282.654 552.165,400.187 554.473,254.391 556.781,452.263 559.089,470.948 561.397,438.707 563.705,378.82 566.013,364.732 568.321,423.046 570.628,445.339 572.936,410.004 575.244,508.129 577.552,534.43 579.86,412.088 582.168,377.636 584.476,560.418 586.784,651.491 589.092,459.533 591.4,336.059 593.708,367.215 596.015,437.381 598.323,429.129 600.631,510.184 602.939,319.627 605.247,474.652 607.555,221.499 609.863,605.986 612.171,282.583 614.479,440.141 616.787,460.963 619.095,183.377 621.402,411.965 623.71,431.538 626.018,352.597 628.326,353.918 630.634,402.331 632.942,349.692 635.25,355.273 637.558,287.727 639.866,326.776 642.174,530.331 644.482,595.753 646.79,577.598 649.097,305.601 651.405,384.44 653.713,459.319 656.021,512.754 658.329,261.061 660.637,303.962 662.945,575.942 665.253,360.452 667.561,375.443 669.869,402.987 672.177,449.543 674.484,355.17 676.792,344.349 679.1,234.902 681.408,336.958 683.716,443.321 686.024,414.227 688.332,484.623 690.64,455.571 692.948,402.429 695.256,503.244 697.564,330.635 699.871,459.317 702.179,278.238 704.487,263.371 706.795,426.365 709.103,526.697 711.411,407.848 713.719,492.969 716.027,452.992 718.335,370.028 720.643,406.419 722.951,451.864 725.259,660.312 727.566,452.493 729.874,640.5 732.182,537.792 734.49,275.232 736.798,521.135 739.106,390.759 741.414,404.542 743.722,335.48 746.03,474.008 748.338,406.829 750.646,464.896 752.953,206.757 755.261,585.562 757.569,636.117 759.877,345.932 762.185,295.244 764.493,451.372 766.801,317.224 769.109,534.204 771.417,371.698 773.725,359.349 776.033,270.605 778.34,398.079 780.648,375.575 782.956,443.541 785.264,358.17 787.572,525.044 789.88,347.999 792.188,383.773 794.496,436.899 796.804,527.233 799.112,374.086 801.42,334.576 803.728,436.309 806.035,318.655 808.343,396.512 810.651,376.566 812.959,193.181 815.267,408.479 817.575,597.338 819.883,305.947 822.191,505.935 824.499,261.003 826.807,496.071 829.115,356.032 831.422,483.502 833.73,380.317 836.038,223.367 838.346,422.937 840.654,490.66 842.962,248.8 845.27,496.718 847.578,529.57 849.886,479.905 852.194,381.689 854.502,505.633 856.809,326.904 859.117,448.835 861.425,319.398 863.733,457.384 866.041,469.615 868.349,254.928 870.657,331 872.965,307.159 875.273,228.297 877.581,467.748 879.889,352.029 882.197,389.807 884.504,519.81 886.812,429.177 889.12,398.998 891.428,579.862 893.736,418.694 896.044,435.277 898.352,624.919 900.66,536.598 902.968,463.504 905.276,392.082 907.584,335.336 909.891,400.596 912.199,318.877 914.507,482.408 916.815,355.636 919.123,288.419 921.431,386.804 923.739,507.84 926.047,400.391 928.355,538.893 930.663,429.177 932.971,405.161 935.278,320.165 937.586,358.248 939.894,476.752 942.202,313.881 944.51,594.441 946.818,584.865 949.126,485.384 951.434,323.758 953.742,362.253 956.05,454.789 958.358,514.711 960.665,579.663 962.973,362.187 965.281,227.995 967.589,387.819 969.897,473.611 972.205,279.415 974.513,623.802 976.821,468.628 979.129,250.832 981.437,243.263 983.745,432.075 986.053,247.481 988.36,465.179 990.668,451.579 992.976,543.004 995.284,418.626 997.592,433.101 999.9,265.549 1002.21,311.507 1004.52,523.803 1006.82,533.517 1009.13,383.712 1011.44,703.426 1013.75,567.708 1016.06,494.462 1018.36,500.469 1020.67,412.843 1022.98,589.367 1025.29,438.985 1027.59,369.027 1029.9,406.806 1032.21,604.225 1034.52,252.397 1036.83,528.316 1039.13,405.026 1041.44,425.083 1043.75,405.778 1046.06,373.387 1048.37,461.221 1050.67,578.04 1052.98,459.593 1055.29,434.682 1057.6,536.284 1059.91,537.889 1062.21,362.999 1064.52,511.976 1066.83,227.02 1069.14,396.089 1071.45,277.27 1073.75,579.296 1076.06,352.187 1078.37,378.596 1080.68,510.762 1082.98,585.124 1085.29,478.33 1087.6,333.103 1089.91,513.33 1092.22,453.049 1094.52,314.422 1096.83,375.574 1099.14,613.44 1101.45,545.209 1103.76,292.626 1106.06,409.371 1108.37,392.879 1110.68,541.29 1112.99,541.535 1115.3,215.568 1117.6,316.723 1119.91,436.895 1122.22,322.201 1124.53,210.275 1126.84,475.778 1129.14,375.003 1131.45,386.11 1133.76,389.551 1136.07,341.482 1138.37,514.81 1140.68,610.258 1142.99,347.962 1145.3,472.38 1147.61,422.494 1149.91,457.615 1152.22,298.95 1154.53,410.587 1156.84,342.468 1159.15,404.013 1161.45,287.7 1163.76,350.556 1166.07,454.313 1168.38,642.763 1170.69,390.82 1172.99,437.542 1175.3,334.188 1177.61,575.915 1179.92,526.483 1182.23,409.369 1184.53,524.88 1186.84,402.336 1189.15,609.884 1191.46,286.88 1193.76,338.034 1196.07,406.649 1198.38,532.336 1200.69,313.605 1203,336.085 1205.3,474.284 1207.61,404.728 1209.92,277.519 1212.23,229.75 1214.54,203.862 1216.84,366.124 1219.15,326.538 1221.46,451.91 1223.77,621.67 1226.08,353.097 1228.38,305.694 1230.69,405.542 1233,442.66 1235.31,196.947 1237.61,449.091 1239.92,402.629 1242.23,459.138 1244.54,335.548 1246.85,349.146 1249.15,442.943 1251.46,359.704 1253.77,368.174 1256.08,371.698 1258.39,577.735 1260.69,484.229 1263,398.151 1265.31,357.686 1267.62,390.086 1269.93,186.694 1272.23,550.351 1274.54,374.826 1276.85,567.314 1279.16,560.422 1281.47,101.087 1283.77,417.04 1286.08,327.129 1288.39,532.897 1290.7,524.511 1293,209.939 1295.31,442.713 1297.62,458.316 1299.93,389.953 1302.24,493.871 1304.54,581.832 1306.85,383.804 1309.16,433.159 1311.47,500.139 1313.78,361.863 1316.08,218.271 1318.39,488.331 1320.7,277.504 1323.01,479.631 1325.32,401.968 1327.62,443.873 1329.93,446.57 1332.24,454.33 1334.55,403.103 1336.86,400.525 1339.16,482.12 1341.47,601.353 1343.78,308.767 1346.09,394.678 1348.39,321.724 1350.7,432.639 1353.01,421.822 1355.32,394.574 1357.63,193.789 1359.93,542.965 1362.24,520.393 1364.55,495.393 1366.86,351.817 1369.17,390.396 1371.47,384.176 1373.78,515.945 1376.09,591.302 1378.4,334.144 1380.71,475.868 1383.01,374.481 1385.32,368.321 1387.63,483.365 1389.94,434.781 1392.24,415.591 1394.55,189.406 1396.86,364.747 1399.17,402.649 1401.48,433.056 1403.78,393.26 1406.09,214.751 1408.4,479.948 1410.71,371.886 1413.02,507.742 1415.32,525.509 1417.63,261.634 1419.94,416.249 1422.25,469.076 1424.56,397.481 1426.86,525.153 1429.17,254.516 1431.48,424.722 1433.79,278.435 1436.1,293.545 1438.4,342.482 1440.71,413.769 1443.02,398.362 1445.33,268.672 1447.63,398.775 1449.94,257.026 1452.25,288.081 1454.56,146.322 1456.87,423.224 1459.17,772.742 1461.48,344.321 1463.79,409.688 1466.1,238.764 1468.41,447.357 1470.71,333.448 1473.02,344.028 1475.33,352.947 1477.64,459.643 1479.95,344.916 1482.25,274.045 1484.56,462.668 1486.87,317.81 1489.18,378.277 1491.49,455.999 1493.79,408.685 1496.1,541.034 1498.41,304.056 1500.72,353.021 1503.02,352.58 1505.33,316.32 1507.64,402.413 1509.95,372.056 1512.26,409.182 1514.56,416.79 1516.87,295.486 1519.18,336.538 1521.49,270.661 1523.8,591.545 1526.1,429.967 1528.41,490.573 1530.72,240.404 1533.03,537.378 1535.34,388.316 1537.64,357.055 1539.95,397.449 1542.26,613.344 1544.57,473.859 1546.88,521.469 1549.18,402.11 1551.49,547.059 1553.8,371.218 1556.11,382.164 1558.41,230.597 1560.72,336.344 1563.03,211.399 1565.34,455.452 1567.65,454.123 1569.95,315.19 1572.26,430.655 1574.57,501.253 1576.88,379.033 1579.19,386.459 1581.49,606.823 1583.8,306.235 1586.11,405.067 1588.42,228.95 1590.73,486.431 1593.03,388.287 1595.34,403.556 1597.65,498.718 1599.96,279.995 1602.26,539.549 1604.57,437.348 1606.88,345.952 1609.19,500.651 1611.5,320.325 1613.8,371.383 1616.11,326.128 1618.42,356.686 1620.73,478.086 1623.04,409.133 1625.34,500.533 1627.65,465.008 1629.96,523.808 1632.27,293.653 1634.58,253.154 1636.88,471.089 1639.19,132.517 1641.5,350.409 1643.81,550.283 1646.12,531.867 1648.42,531.92 1650.73,386.778 1653.04,385.018 1655.35,510.296 1657.65,220.041 1659.96,355.662 1662.27,371.197 1664.58,339.674 1666.89,295.301 1669.19,408.561 1671.5,398.878 1673.81,258.38 1676.12,340.138 1678.43,461.08 1680.73,474.303 1683.04,318.456 1685.35,401.106 1687.66,566.301 1689.97,413.256 1692.27,592.68 1694.58,531.129 1696.89,466.803 1699.2,449.652 1701.51,314.688 1703.81,537.705 1706.12,330.078 1708.43,461.279 1710.74,539.563 1713.04,436.881 1715.35,361.737 1717.66,330.845 1719.97,331.415 1722.28,417.8 1724.58,352.872 1726.89,327.432 1729.2,187.305 1731.51,535.43 1733.82,345.998 1736.12,278.361 1738.43,443.487 1740.74,580.362 1743.05,423.891 1745.36,441.5 1747.66,400.967 1749.97,403.063 1752.28,470.158 1754.59,497.117 1756.9,447.731 1759.2,524.267 1761.51,415.999 1763.82,455.773 1766.13,369.359 1768.43,420.366 1770.74,402.433 1773.05,504.889 1775.36,462.74 1777.67,632.104 1779.97,444.818 1782.28,345.553 1784.59,645.011 1786.9,216.637 1789.21,545.455 1791.51,386.955 1793.82,478.243 1796.13,391.045 1798.44,509.853 1800.75,368.702 1803.05,291.857 1805.36,366.115 1807.67,294.976 1809.98,413.741 1812.28,385.163 1814.59,305.165 1816.9,347.422 1819.21,525.897 1821.52,370.61 1823.82,548.798 1826.13,352.128 1828.44,443.737 1830.75,396.767 1833.06,400.96 1835.36,591.092 1837.67,393.279 1839.98,387.104 1842.29,390.143 1844.6,244.921 1846.9,383.982 1849.21,344.296 1851.52,553.471 1853.83,441.623 1856.14,357.163 1858.44,375.674 1860.75,389.364 1863.06,553.074 1865.37,325.8 1867.67,437.101 1869.98,554.529 1872.29,265.468 1874.6,404.96 1876.91,518.255 1879.21,475.549 1881.52,382.465 1883.83,425.451 1886.14,461.456 1888.45,384.738 1890.75,522.648 1893.06,465.973 1895.37,434.92 1897.68,431.653 1899.99,475.849 1902.29,409.559 1904.6,291.962 1906.91,237.892 1909.22,444.137 1911.53,202.599 1913.83,520.833 1916.14,444.168 1918.45,652.449 1920.76,518.329 1923.06,570.566 1925.37,454.141 1927.68,360.047 1929.99,480.111 1932.3,573.705 1934.6,482.326 1936.91,470.945 1939.22,333.205 1941.53,369.253 1943.84,409.607 1946.14,308.557 1948.45,375.681 1950.76,209.9 1953.07,382.231 1955.38,486.926 1957.68,570.872 1959.99,575.702 1962.3,357.906 1964.61,442.349 1966.91,487.266 1969.22,401.564 1971.53,206.91 1973.84,417.59 1976.15,613.512 1978.45,637.895 1980.76,327.71 1983.07,351.709 1985.38,446.752 1987.69,508.083 1989.99,313.486 1992.3,481.392 1994.61,419.494 1996.92,387.33 1999.23,483.968 2001.53,372.333 2003.84,331.849 2006.15,434.299 2008.46,405.39 2010.77,172.845 2013.07,412.576 2015.38,587.867 2017.69,475.188 2020,253.297 2022.3,439.253 2024.61,407.512 2026.92,377.614 2029.23,357.116 2031.54,507.021 2033.84,343.654 2036.15,243.585 2038.46,625.455 2040.77,450.725 2043.08,548.849 2045.38,407.196 2047.69,416.717 2050,359.153 2052.31,371.407 2054.62,330.865 2056.92,320.566 2059.23,534.926 2061.54,467.509 2063.85,356.808 2066.16,429.145 2068.46,571.84 2070.77,292.681 2073.08,388.541 2075.39,432.719 2077.69,494.364 2080,411.359 2082.31,481.33 2084.62,405.78 2086.93,350.183 2089.23,408.071 2091.54,412.474 2093.85,609.672 2096.16,401.478 2098.47,322.047 2100.77,399.44 2103.08,411.317 2105.39,329.182 2107.7,325.57 2110.01,451.429 2112.31,184.432 2114.62,472.382 2116.93,398.887 2119.24,372.421 2121.55,566.61 2123.85,447.5 2126.16,392.999 2128.47,412.604 2130.78,323.395 2133.08,243.78 2135.39,270.626 2137.7,498.759 2140.01,434.267 2142.32,344.098 2144.62,403.885 2146.93,354.665 2149.24,361.067 2151.55,531.375 2153.86,227.328 2156.16,444.437 2158.47,487.244 2160.78,350.335 2163.09,322.904 2165.4,517.096 2167.7,394.629 2170.01,506.834 2172.32,437.073 2174.63,493.93 2176.93,377.259 2179.24,409.283 2181.55,383.752 2183.86,544.202 2186.17,315.309 2188.47,217.547 2190.78,368.627 2193.09,259.906 2195.4,256.168 2197.71,284.237 2200.01,645.215 2202.32,501.927 2204.63,457.189 2206.94,337.108 2209.25,412.837 2211.55,466.582 2213.86,470.026 2216.17,225.772 2218.48,361.832 2220.79,426.459 2223.09,461.341 2225.4,445.4 2227.71,474.509 2230.02,642.844 2232.32,331.356 2234.63,384.979 2236.94,373.643 2239.25,533.604 2241.56,352.662 2243.86,521.05 2246.17,469.189 2248.48,363.258 2250.79,534.931 2253.1,381.165 2255.4,357.668 2257.71,411.249 2260.02,422.877 2262.33,599.779 2264.64,241.766 2266.94,325.631 2269.25,345.805 2271.56,508.579 2273.87,447.554 2276.18,493.665 2278.48,610.75 2280.79,554.465 2283.1,390.556 2285.41,458.744 2287.71,363.964 2290.02,508.683 2292.33,356.105 2294.64,438.448 2296.95,394.677 2299.25,295.229 2301.56,444.687 2303.87,303.957 2306.18,351.14 2308.49,319.055 2310.79,426.208 2313.1,496.452 2315.41,277.027 2317.72,415.42 2320.03,427.852 2322.33,338.202 2324.64,225.061 2326.95,384.947 2329.26,683.273 2331.56,334.298 2333.87,429.854 2336.18,474.492 2338.49,460.281 2340.8,385.329 2343.1,475.397 2345.41,509.078 2347.72,401.666 2350.03,421.195 2352.34,437.957 2354.64,541.276 2356.95,378.192 2359.26,430.708 2361.57,512.311 2363.88,450.604 2366.18,514.842 2368.49,267.414 2370.8,373.787 2373.11,323.157 2375.42,513.054 2377.72,416.132 2380.03,268.467 2382.34,548.068 2384.65,406.735 2386.95,369.941 2389.26,385.364 2391.57,369.853 2393.88,96.8724 2396.19,500.52 2398.49,516.958 2400.8,363.535 2403.11,453.847 2405.42,500.78 2407.73,369.641 2410.03,556.374 2412.34,290.062 2414.65,514.534 2416.96,147.954 2419.27,427.888 2421.57,441.579 2423.88,413.303 2426.19,531.315 2428.5,456.326 2430.81,521.155 2433.11,504.169 2435.42,375.927 2437.73,364.521 2440.04,434.957 2442.34,422.303 2444.65,455.384 2446.96,382.742 2449.27,460.964 2451.58,393.587 2453.88,425.08 2456.19,440.184 2458.5,305.233 2460.81,378.815 2463.12,417.813 2465.42,207.257 2467.73,331.219 2470.04,458.197 2472.35,366.29 2474.66,359.377 2476.96,205.582 2479.27,514.026 2481.58,435.346 2483.89,478.14 2486.2,298.295 2488.5,530.331 2490.81,346.545 2493.12,623.696 2495.43,515.614 2497.73,354.091 2500.04,443.679 2502.35,429.8 2504.66,407.642 2506.97,476.506 2509.27,425.98 2511.58,436.951 2513.89,436.998 2516.2,475.996 2518.51,470.421 2520.81,262.777 2523.12,497.128 2525.43,472.033 2527.74,427.606 2530.05,565.792 2532.35,449.07 2534.66,195.785 2536.97,293.461 2539.28,648.222 2541.58,255.554 2543.89,440.892 2546.2,483.414 2548.51,502.272 2550.82,466.751 2553.12,298.387 2555.43,498.294 2557.74,468.177 2560.05,420.501 2562.36,472.023 2564.66,466.478 2566.97,174.95 2569.28,526.952 2571.59,321.201 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -3.47719   -2.70824   -2.90485   …  -6.874      -5.12327  -4.88765
  0.452253   0.440368  -0.611552     -0.0918846  -1.2669    0.510061
  2.75446    3.59425    2.84561       4.87789     4.18814   6.47257

[:, :, 2] =
 -2.49568  -3.46008  -4.35367   -4.94529  …  -4.88066  -4.88469  -5.45033
  1.58055   0.53808   0.587702   1.02896     -2.01711  -1.00255  -1.57911
  3.75779   4.25741   3.72997    6.49876      5.01051   5.43105   4.51756

[:, :, 3] =
 -2.28742    -4.25779   -2.99633   …  -6.11527   -5.85486  -5.70469
 -0.0487472   0.999815   0.214538     -0.696278   1.24341   0.317536
  0.655753    2.098      2.47938       4.28327    5.491     6.4764

[:, :, 4] =
 -3.64247   -5.81247   -3.20938  -3.95152  …  -4.43235  -5.16058  -6.16751
 -0.222081   0.790719   1.39643   2.72965     -0.54352  -1.17238  -0.0210749
  2.57933    4.88376    6.87611   5.55366      3.94265   4.58648   3.08714</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -5.00172    0.983441
  0.0164508  1.01055
  4.98153    1.00744</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.98 seconds
Compute duration  = 2.98 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -5.0098    1.0095    0.0182   3067.9511   5074.0025    1.0001   ⋯
        x[2]    0.0038    0.9935    0.0167   3532.9974   5417.3797    1.0003   ⋯
        x[3]    4.9917    0.9900    0.0169   3450.6338   5718.2764    1.0001   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -6.9719   -5.7005   -5.0109   -4.3307   -3.0428
        x[2]   -1.9146   -0.6776    0.0028    0.6589    1.9495
        x[3]    3.0425    4.3196    4.9963    5.6677    6.8930</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.93 seconds
Compute duration  = 1.93 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.4990    0.1869    0.0027   4750.0999   5894.9749    1.0010   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1481    0.3617    0.5008    0.6374    0.8501</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.18 seconds
Compute duration  = 0.18 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

           x    0.5039    0.1441    0.0122   123.8134    36.7196    1.0838     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.2512    0.4084    0.5019    0.6060    0.7474</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}(-0.026894234023814523,1.0,0.0), "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}(-0.026894234023814523,1.0,0.0):
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/fi8Qd/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/fi8Qd/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/fi8Qd/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/fi8Qd/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/fi8Qd/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/l7W1f/src/compiler.jl:574 [inlined]
  [7] demo(__model__::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, __varinfo__::DynamicPPL.ThreadSafeVarInfo{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Base.RefValue{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, __context__::DynamicPPL.DefaultContext)
    @ Main.Notebook ~/work/docs/docs/developers/inference/implementing-samplers/index.qmd:595
  [8] _evaluate!!
    @ ~/.julia/packages/DynamicPPL/l7W1f/src/model.jl:936 [inlined]
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, context::DynamicPPL.DefaultContext)
    @ DynamicPPL ~/.julia/packages/DynamicPPL/l7W1f/src/model.jl:925
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/l7W1f/src/model.jl:855 [inlined]
 [11] logdensity_at
    @ ~/.julia/packages/DynamicPPL/l7W1f/src/logdensityfunction.jl:184 [inlined]
 [12] FixTail
    @ ~/.julia/packages/DifferentiationInterface/7eD1K/src/utils/context.jl:169 [inlined]
 [13] vector_mode_dual_eval!(f::DifferentiationInterface.FixTail{typeof(DynamicPPL.logdensity_at), Tuple{DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}}}, Float64}, DynamicPPL.DefaultContext}}, cfg::ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}, x::Vector{Float64})
    @ ForwardDiff ~/.julia/packages/ForwardDiff/UBbGT/src/apiutils.jl:24
 [14] vector_mode_gradient!
    @ ~/.julia/packages/ForwardDiff/UBbGT/src/gradient.jl:98 [inlined]
 [15] gradient!(result::DiffResults.MutableDiffResult{1, Float64, Tuple{Vector{Float64}}}, f::DifferentiationInterface.FixTail{typeof(DynamicPPL.logdensity_at), Tuple{DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}}}, Float64}, DynamicPPL.DefaultContext}}, x::Vector{Float64}, cfg::ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}, ::Val{false})
    @ ForwardDiff ~/.julia/packages/ForwardDiff/UBbGT/src/gradient.jl:39
 [16] value_and_gradient(::typeof(DynamicPPL.logdensity_at), ::DifferentiationInterfaceForwardDiffExt.ForwardDiffGradientPrep{Nothing, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}, Tuple{Nothing, Nothing, Nothing}}, ::AutoForwardDiff{2, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}, ::Vector{Float64}, ::DifferentiationInterface.Constant{DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}}, ::DifferentiationInterface.Constant{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}}}, Float64}}, ::DifferentiationInterface.Constant{DynamicPPL.DefaultContext})
    @ DifferentiationInterfaceForwardDiffExt ~/.julia/packages/DifferentiationInterface/7eD1K/ext/DifferentiationInterfaceForwardDiffExt/onearg.jl:417
 [17] logdensity_and_gradient(f::LogDensityFunction{DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}}}, Float64}, DynamicPPL.DefaultContext, AutoForwardDiff{2, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}}, x::Vector{Float64})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/l7W1f/src/logdensityfunction.jl:215
 [18] leapfrog_step(model::LogDensityFunction{DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}}}, Float64}, DynamicPPL.DefaultContext, AutoForwardDiff{2, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}}, x::Vector{Float64}, p::Vector{Float64}, ϵ::Int64, M::UniformScaling{Bool})
    @ Main.Notebook ~/work/docs/docs/developers/inference/implementing-samplers/index.qmd:371
 [19] step(rng::TaskLocalRNG, model_wrapper::AbstractMCMC.LogDensityModel{LogDensityFunction{DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}}}, Float64}, DynamicPPL.DefaultContext, AutoForwardDiff{2, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}}}, sampler::MALA{Int64, UniformScaling{Bool}}, state::MALAState{Vector{Float64}}; kwargs::@Kwargs{})
    @ Main.Notebook ~/work/docs/docs/developers/inference/implementing-samplers/index.qmd:336
 [20] step(rng::TaskLocalRNG, model_wrapper::AbstractMCMC.LogDensityModel{LogDensityFunction{DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}}}, Float64}, DynamicPPL.DefaultContext, AutoForwardDiff{2, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}}}, sampler::MALA{Int64, UniformScaling{Bool}}, state::MALAState{Vector{Float64}})
    @ Main.Notebook ~/work/docs/docs/developers/inference/implementing-samplers/index.qmd:318
 [21] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, state::Turing.Inference.TuringState{MALAState{Vector{Float64}}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}}}, Float64}, DynamicPPL.DefaultContext}; kwargs::@Kwargs{})
    @ Turing.Inference ~/.julia/packages/Turing/IXycm/src/mcmc/abstractmcmc.jl:91
 [22] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, state::Turing.Inference.TuringState{MALAState{Vector{Float64}}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}}}, Float64}, DynamicPPL.DefaultContext})
    @ Turing.Inference ~/.julia/packages/Turing/IXycm/src/mcmc/abstractmcmc.jl:80
 [23] macro expansion
    @ ~/.julia/packages/AbstractMCMC/FSyVk/src/sample.jl:217 [inlined]
 [24] macro expansion
    @ ~/.julia/packages/AbstractMCMC/FSyVk/src/logging.jl:16 [inlined]
 [25] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, num_warmup::Int64, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/FSyVk/src/sample.jl:142
 [26] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/l7W1f/src/sampler.jl:102
 [27] sample
    @ ~/.julia/packages/DynamicPPL/l7W1f/src/sampler.jl:92 [inlined]
 [28] #sample#8
    @ ~/.julia/packages/Turing/IXycm/src/mcmc/Inference.jl:278 [inlined]
 [29] sample
    @ ~/.julia/packages/Turing/IXycm/src/mcmc/Inference.jl:269 [inlined]
 [30] #sample#7
    @ ~/.julia/packages/Turing/IXycm/src/mcmc/Inference.jl:266 [inlined]
 [31] top-level scope
    @ ~/work/docs/docs/developers/inference/implementing-samplers/index.qmd:597</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.61 seconds
Compute duration  = 0.61 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8988    0.5597    0.0243   524.1271   370.0832    1.0001     ⋯
           x    0.0911    1.0219    0.0531   456.1576   342.9172    1.0013     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1541    0.4348    0.7937    1.2328    2.2743
           x   -2.2476   -0.3880    0.0186    0.5754    2.3979</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.82 seconds
Compute duration  = 2.82 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8634    0.5701    0.0210   559.9462   276.5646    1.0036     ⋯
           x   -0.0294    0.9401    0.0386   675.2127   527.2026    1.0033     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1133    0.4060    0.7624    1.1888    2.2377
           x   -2.1718   -0.4088    0.0016    0.4079    2.0007</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/docs\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../../developers/inference/variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/main/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/main/developers/inference/implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>