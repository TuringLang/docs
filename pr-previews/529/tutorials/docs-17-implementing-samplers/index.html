<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../tutorials/docs-07-for-developers-variational-inference/index.html" rel="prev">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/docs-00-getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/00-introduction/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.34" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.34</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.34">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Users</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-00-getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-12-using-turing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Core Functionality</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Usage Tips</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-10-using-turing-autodiff/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-custom-distribution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Custom Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-modifying-logprob/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modifying the Log Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-generated-quantities/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generated Quantities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-13-using-turing-performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-15-using-turing-sampler-viz/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-11-using-turing-dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-16-using-turing-external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/00-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction: Coin Flipping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/01-gaussian-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/02-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/03-bayesian-neural-network/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/04-hidden-markov-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/05-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/06-infinite-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/07-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/08-multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/09-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/10-bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/11-probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/13-seasonal-time-series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/15-gaussian-processes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Gaussian Processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/12-gplvm/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Contributing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-01-contributing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to Contribute</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">DynamicPPL in Depth</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/dev-model-manual/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manually Defining a Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-05-for-developers-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/14-minituring/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/16-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Inference (note: outdated)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-06-for-developers-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-21.00528573854944</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-21.00528573854944</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([-1.2600912940625195, 1.1503361279528348, -0.3178952576143078]), MALAState{Vector{Float64}}([-1.2600912940625195, 1.1503361279528348, -0.3178952576143078]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -2.27859    -3.99949    -4.20371    …  -6.80034  -7.47933  -4.93621
  0.468484   -0.0030349  -0.0492386     -1.05271  -1.18775  -1.50949
  0.0364115   4.64218     5.15653        5.91556   5.47973   5.93282</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.98686     1.00601
  0.00632072  0.995052
  5.04183     0.997633</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip290">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip290)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip291">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip290)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip292">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1703.88 2640.76,1703.88 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1459.04 2640.76,1459.04 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1214.2 2640.76,1214.2 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,969.365 2640.76,969.365 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,724.526 2640.76,724.526 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,479.687 2640.76,479.687 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,234.848 2640.76,234.848 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip290)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1703.88 215.714,1703.88 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1459.04 215.714,1459.04 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1214.2 215.714,1214.2 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,969.365 215.714,969.365 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,724.526 215.714,724.526 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,479.687 215.714,479.687 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,234.848 215.714,234.848 "></polyline>
<path clip-path="url(#clip290)" d="M50.5475 1704.33 L80.2233 1704.33 L80.2233 1708.27 L50.5475 1708.27 L50.5475 1704.33 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M89.1352 1686.6 L111.357 1686.6 L111.357 1688.59 L98.8111 1721.16 L93.9269 1721.16 L105.732 1690.54 L89.1352 1690.54 L89.1352 1686.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M120.478 1715.28 L125.362 1715.28 L125.362 1721.16 L120.478 1721.16 L120.478 1715.28 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M135.593 1686.6 L153.95 1686.6 L153.95 1690.54 L139.876 1690.54 L139.876 1699.01 Q140.894 1698.66 141.913 1698.5 Q142.931 1698.31 143.95 1698.31 Q149.737 1698.31 153.116 1701.49 Q156.496 1704.66 156.496 1710.07 Q156.496 1715.65 153.024 1718.75 Q149.552 1721.83 143.232 1721.83 Q141.056 1721.83 138.788 1721.46 Q136.542 1721.09 134.135 1720.35 L134.135 1715.65 Q136.218 1716.79 138.441 1717.34 Q140.663 1717.9 143.14 1717.9 Q147.144 1717.9 149.482 1715.79 Q151.82 1713.68 151.82 1710.07 Q151.82 1706.46 149.482 1704.36 Q147.144 1702.25 143.14 1702.25 Q141.265 1702.25 139.39 1702.67 Q137.538 1703.08 135.593 1703.96 L135.593 1686.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M49.5521 1459.49 L79.2279 1459.49 L79.2279 1463.43 L49.5521 1463.43 L49.5521 1459.49 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M89.3667 1441.76 L107.723 1441.76 L107.723 1445.7 L93.6491 1445.7 L93.6491 1454.17 Q94.6676 1453.82 95.6861 1453.66 Q96.7047 1453.48 97.7232 1453.48 Q103.51 1453.48 106.89 1456.65 Q110.269 1459.82 110.269 1465.23 Q110.269 1470.81 106.797 1473.92 Q103.325 1476.99 97.0056 1476.99 Q94.8297 1476.99 92.5612 1476.62 Q90.3158 1476.25 87.9084 1475.51 L87.9084 1470.81 Q89.9917 1471.95 92.2139 1472.5 Q94.4361 1473.06 96.913 1473.06 Q100.918 1473.06 103.256 1470.95 Q105.593 1468.85 105.593 1465.23 Q105.593 1461.62 103.256 1459.52 Q100.918 1457.41 96.913 1457.41 Q95.038 1457.41 93.163 1457.83 Q91.3112 1458.24 89.3667 1459.12 L89.3667 1441.76 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M119.482 1470.44 L124.367 1470.44 L124.367 1476.32 L119.482 1476.32 L119.482 1470.44 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M144.552 1444.84 Q140.941 1444.84 139.112 1448.41 Q137.306 1451.95 137.306 1459.08 Q137.306 1466.18 139.112 1469.75 Q140.941 1473.29 144.552 1473.29 Q148.186 1473.29 149.991 1469.75 Q151.82 1466.18 151.82 1459.08 Q151.82 1451.95 149.991 1448.41 Q148.186 1444.84 144.552 1444.84 M144.552 1441.14 Q150.362 1441.14 153.417 1445.74 Q156.496 1450.33 156.496 1459.08 Q156.496 1467.8 153.417 1472.41 Q150.362 1476.99 144.552 1476.99 Q138.741 1476.99 135.663 1472.41 Q132.607 1467.8 132.607 1459.08 Q132.607 1450.33 135.663 1445.74 Q138.741 1441.14 144.552 1441.14 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M50.5475 1214.66 L80.2233 1214.66 L80.2233 1218.59 L50.5475 1218.59 L50.5475 1214.66 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M94.3436 1227.55 L110.663 1227.55 L110.663 1231.48 L88.7186 1231.48 L88.7186 1227.55 Q91.3806 1224.79 95.9639 1220.16 Q100.57 1215.51 101.751 1214.17 Q103.996 1211.65 104.876 1209.91 Q105.779 1208.15 105.779 1206.46 Q105.779 1203.71 103.834 1201.97 Q101.913 1200.23 98.8111 1200.23 Q96.6121 1200.23 94.1584 1201 Q91.7278 1201.76 88.9501 1203.31 L88.9501 1198.59 Q91.7741 1197.46 94.2278 1196.88 Q96.6815 1196.3 98.7185 1196.3 Q104.089 1196.3 107.283 1198.98 Q110.478 1201.67 110.478 1206.16 Q110.478 1208.29 109.668 1210.21 Q108.881 1212.11 106.774 1214.7 Q106.195 1215.37 103.094 1218.59 Q99.9917 1221.78 94.3436 1227.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M120.478 1225.6 L125.362 1225.6 L125.362 1231.48 L120.478 1231.48 L120.478 1225.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M135.593 1196.92 L153.95 1196.92 L153.95 1200.86 L139.876 1200.86 L139.876 1209.33 Q140.894 1208.98 141.913 1208.82 Q142.931 1208.64 143.95 1208.64 Q149.737 1208.64 153.116 1211.81 Q156.496 1214.98 156.496 1220.4 Q156.496 1225.97 153.024 1229.08 Q149.552 1232.15 143.232 1232.15 Q141.056 1232.15 138.788 1231.78 Q136.542 1231.41 134.135 1230.67 L134.135 1225.97 Q136.218 1227.11 138.441 1227.66 Q140.663 1228.22 143.14 1228.22 Q147.144 1228.22 149.482 1226.11 Q151.82 1224.01 151.82 1220.4 Q151.82 1216.78 149.482 1214.68 Q147.144 1212.57 143.14 1212.57 Q141.265 1212.57 139.39 1212.99 Q137.538 1213.41 135.593 1214.28 L135.593 1196.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M99.3204 955.164 Q95.7093 955.164 93.8806 958.728 Q92.075 962.27 92.075 969.4 Q92.075 976.506 93.8806 980.071 Q95.7093 983.612 99.3204 983.612 Q102.955 983.612 104.76 980.071 Q106.589 976.506 106.589 969.4 Q106.589 962.27 104.76 958.728 Q102.955 955.164 99.3204 955.164 M99.3204 951.46 Q105.131 951.46 108.186 956.066 Q111.265 960.65 111.265 969.4 Q111.265 978.126 108.186 982.733 Q105.131 987.316 99.3204 987.316 Q93.5102 987.316 90.4315 982.733 Q87.376 978.126 87.376 969.4 Q87.376 960.65 90.4315 956.066 Q93.5102 951.46 99.3204 951.46 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M119.482 980.765 L124.367 980.765 L124.367 986.645 L119.482 986.645 L119.482 980.765 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M144.552 955.164 Q140.941 955.164 139.112 958.728 Q137.306 962.27 137.306 969.4 Q137.306 976.506 139.112 980.071 Q140.941 983.612 144.552 983.612 Q148.186 983.612 149.991 980.071 Q151.82 976.506 151.82 969.4 Q151.82 962.27 149.991 958.728 Q148.186 955.164 144.552 955.164 M144.552 951.46 Q150.362 951.46 153.417 956.066 Q156.496 960.65 156.496 969.4 Q156.496 978.126 153.417 982.733 Q150.362 987.316 144.552 987.316 Q138.741 987.316 135.663 982.733 Q132.607 978.126 132.607 969.4 Q132.607 960.65 135.663 956.066 Q138.741 951.46 144.552 951.46 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M94.3436 737.871 L110.663 737.871 L110.663 741.806 L88.7186 741.806 L88.7186 737.871 Q91.3806 735.116 95.9639 730.487 Q100.57 725.834 101.751 724.491 Q103.996 721.968 104.876 720.232 Q105.779 718.473 105.779 716.783 Q105.779 714.028 103.834 712.292 Q101.913 710.556 98.8111 710.556 Q96.6121 710.556 94.1584 711.32 Q91.7278 712.084 88.9501 713.635 L88.9501 708.913 Q91.7741 707.778 94.2278 707.2 Q96.6815 706.621 98.7185 706.621 Q104.089 706.621 107.283 709.306 Q110.478 711.991 110.478 716.482 Q110.478 718.612 109.668 720.533 Q108.881 722.431 106.774 725.024 Q106.195 725.695 103.094 728.913 Q99.9917 732.107 94.3436 737.871 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M120.478 735.926 L125.362 735.926 L125.362 741.806 L120.478 741.806 L120.478 735.926 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M135.593 707.246 L153.95 707.246 L153.95 711.181 L139.876 711.181 L139.876 719.653 Q140.894 719.306 141.913 719.144 Q142.931 718.959 143.95 718.959 Q149.737 718.959 153.116 722.13 Q156.496 725.302 156.496 730.718 Q156.496 736.297 153.024 739.399 Q149.552 742.477 143.232 742.477 Q141.056 742.477 138.788 742.107 Q136.542 741.737 134.135 740.996 L134.135 736.297 Q136.218 737.431 138.441 737.987 Q140.663 738.542 143.14 738.542 Q147.144 738.542 149.482 736.436 Q151.82 734.329 151.82 730.718 Q151.82 727.107 149.482 725.001 Q147.144 722.894 143.14 722.894 Q141.265 722.894 139.39 723.311 Q137.538 723.727 135.593 724.607 L135.593 707.246 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M89.3667 462.407 L107.723 462.407 L107.723 466.342 L93.6491 466.342 L93.6491 474.815 Q94.6676 474.467 95.6861 474.305 Q96.7047 474.12 97.7232 474.12 Q103.51 474.12 106.89 477.291 Q110.269 480.463 110.269 485.879 Q110.269 491.458 106.797 494.56 Q103.325 497.639 97.0056 497.639 Q94.8297 497.639 92.5612 497.268 Q90.3158 496.898 87.9084 496.157 L87.9084 491.458 Q89.9917 492.592 92.2139 493.148 Q94.4361 493.703 96.913 493.703 Q100.918 493.703 103.256 491.597 Q105.593 489.49 105.593 485.879 Q105.593 482.268 103.256 480.162 Q100.918 478.055 96.913 478.055 Q95.038 478.055 93.163 478.472 Q91.3112 478.889 89.3667 479.768 L89.3667 462.407 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M119.482 491.088 L124.367 491.088 L124.367 496.967 L119.482 496.967 L119.482 491.088 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M144.552 465.486 Q140.941 465.486 139.112 469.051 Q137.306 472.592 137.306 479.722 Q137.306 486.828 139.112 490.393 Q140.941 493.935 144.552 493.935 Q148.186 493.935 149.991 490.393 Q151.82 486.828 151.82 479.722 Q151.82 472.592 149.991 469.051 Q148.186 465.486 144.552 465.486 M144.552 461.782 Q150.362 461.782 153.417 466.389 Q156.496 470.972 156.496 479.722 Q156.496 488.449 153.417 493.055 Q150.362 497.639 144.552 497.639 Q138.741 497.639 135.663 493.055 Q132.607 488.449 132.607 479.722 Q132.607 470.972 135.663 466.389 Q138.741 461.782 144.552 461.782 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M89.1352 217.568 L111.357 217.568 L111.357 219.559 L98.8111 252.128 L93.9269 252.128 L105.732 221.504 L89.1352 221.504 L89.1352 217.568 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M120.478 246.249 L125.362 246.249 L125.362 252.128 L120.478 252.128 L120.478 246.249 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M135.593 217.568 L153.95 217.568 L153.95 221.504 L139.876 221.504 L139.876 229.976 Q140.894 229.629 141.913 229.467 Q142.931 229.281 143.95 229.281 Q149.737 229.281 153.116 232.453 Q156.496 235.624 156.496 241.041 Q156.496 246.619 153.024 249.721 Q149.552 252.8 143.232 252.8 Q141.056 252.8 138.788 252.429 Q136.542 252.059 134.135 251.318 L134.135 246.619 Q136.218 247.753 138.441 248.309 Q140.663 248.865 143.14 248.865 Q147.144 248.865 149.482 246.758 Q151.82 244.652 151.82 241.041 Q151.82 237.429 149.482 235.323 Q147.144 233.217 143.14 233.217 Q141.265 233.217 139.39 233.633 Q137.538 234.05 135.593 234.929 L135.593 217.568 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip292)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1192.52 268.292,1528.13 270.6,1587.03 272.908,1250.94 275.216,1587.95 277.524,1473.98 279.832,1525.23 282.139,1408.49 284.447,1561.26 286.755,1377.81 289.063,1405.07 291.371,1407.73 293.679,1472.58 295.987,1481.07 298.295,1429.77 300.603,1420.76 302.911,1327.09 305.219,1346.08 307.527,1353.57 309.834,1573.97 312.142,1541.89 314.45,1367.26 316.758,1532.97 319.066,1510.37 321.374,1577.55 323.682,1353.58 325.99,1557.7 328.298,1632.57 330.606,1537.97 332.914,1520.54 335.221,1384.94 337.529,1471.56 339.837,1447.76 342.145,1395.57 344.453,1496.6 346.761,1552.59 349.069,1410.66 351.377,1440.67 353.685,1563.9 355.993,1744.85 358.301,1532.43 360.608,1492.19 362.916,1328.15 365.224,1417.48 367.532,1595.49 369.84,1287.95 372.148,1452.39 374.456,1332.86 376.764,1400.27 379.072,1360.97 381.38,1407.33 383.688,1412.53 385.996,1408.02 388.303,1527.17 390.611,1314.18 392.919,1408.81 395.227,1375.99 397.535,1562.99 399.843,1417.2 402.151,1384.23 404.459,1447.96 406.767,1469.9 409.075,1460.48 411.383,1537.36 413.69,1518.74 415.998,1453.4 418.306,1534.39 420.614,1423.81 422.922,1579.11 425.23,1475.36 427.538,1470.6 429.846,1591 432.154,1316.88 434.462,1275.18 436.77,1372.24 439.077,1434.12 441.385,1556.32 443.693,1518.57 446.001,1532.41 448.309,1398.34 450.617,1362.67 452.925,1440.22 455.233,1537.4 457.541,1542.83 459.849,1456.95 462.157,1624.28 464.465,1601.2 466.772,1508.91 469.08,1625.62 471.388,1695.66 473.696,1416.23 476.004,1399.97 478.312,1438.68 480.62,1497.17 482.928,1631.03 485.236,1406.32 487.544,1494.31 489.852,1526.37 492.159,1466.88 494.467,1412.81 496.775,1389.61 499.083,1514.46 501.391,1497.72 503.699,1307.12 506.007,1467.85 508.315,1368.16 510.623,1541.74 512.931,1447.97 515.239,1489.09 517.546,1286.03 519.854,1338.63 522.162,1549.75 524.47,1373.19 526.778,1386.32 529.086,1274.67 531.394,1472.95 533.702,1454.81 536.01,1578.74 538.318,1400.03 540.626,1447.15 542.933,1368.08 545.241,1292.23 547.549,1350.26 549.857,1410.49 552.165,1509.41 554.473,1605.53 556.781,1677 559.089,1401.82 561.397,1540.79 563.705,1400.2 566.013,1363.88 568.321,1401.17 570.628,1522.75 572.936,1331.48 575.244,1462.07 577.552,1460.76 579.86,1413.57 582.168,1358.67 584.476,1495.41 586.784,1246.21 589.092,1450.34 591.4,1382.19 593.708,1473.51 596.015,1510.57 598.323,1360.59 600.631,1655.37 602.939,1529.45 605.247,1440.88 607.555,1600.41 609.863,1495.52 612.171,1266.27 614.479,1352.17 616.787,1563.92 619.095,1534.37 621.402,1377.52 623.71,1403.12 626.018,1500.67 628.326,1326.22 630.634,1492.86 632.942,1518.69 635.25,1465.51 637.558,1491.73 639.866,1521.92 642.174,1456.67 644.482,1478.34 646.79,1525.06 649.097,1433.28 651.405,1534.13 653.713,1482.28 656.021,1592.52 658.329,1647.11 660.637,1458.12 662.945,1443.67 665.253,1457.17 667.561,1529.61 669.869,1628.65 672.177,1471.81 674.484,1370.62 676.792,1445.03 679.1,1342.38 681.408,1411.74 683.716,1585.64 686.024,1265.97 688.332,1588.12 690.64,1681.63 692.948,1592.69 695.256,1497.85 697.564,1542.45 699.871,1599.01 702.179,1484.39 704.487,1463.03 706.795,1555.56 709.103,1334.29 711.411,1471.83 713.719,1454.93 716.027,1734.92 718.335,1537.69 720.643,1604.67 722.951,1355.72 725.259,1235.54 727.566,1484.15 729.874,1436.53 732.182,1430.33 734.49,1511.68 736.798,1492.52 739.106,1557.7 741.414,1460.58 743.722,1580.31 746.03,1384.13 748.338,1709.43 750.646,1453.35 752.953,1377.25 755.261,1256.48 757.569,1406.09 759.877,1484.93 762.185,1383.2 764.493,1274.32 766.801,1385.48 769.109,1432.12 771.417,1416.84 773.725,1551.72 776.033,1323.01 778.34,1157.17 780.648,1412.82 782.956,1467.38 785.264,1432.95 787.572,1367.41 789.88,1369.64 792.188,1428.82 794.496,1548.69 796.804,1361.28 799.112,1412.45 801.42,1515.24 803.728,1355.25 806.035,1394.81 808.343,1445.28 810.651,1357.23 812.959,1360.71 815.267,1467.9 817.575,1484.62 819.883,1441.71 822.191,1445.32 824.499,1232.69 826.807,1571.12 829.115,1452.88 831.422,1424.36 833.73,1409.3 836.038,1504.44 838.346,1395.28 840.654,1420.35 842.962,1459.23 845.27,1507.25 847.578,1510.67 849.886,1404.81 852.194,1649.18 854.502,1491.97 856.809,1666.45 859.117,1609.63 861.425,1577.37 863.733,1611.5 866.041,1519.41 868.349,1324.42 870.657,1472.44 872.965,1603.25 875.273,1211.36 877.581,1385.52 879.889,1361.79 882.197,1351.22 884.504,1551.71 886.812,1517.07 889.12,1368.44 891.428,1409.84 893.736,1496.89 896.044,1382.71 898.352,1405.43 900.66,1427.24 902.968,1520.93 905.276,1509.23 907.584,1352.64 909.891,1423.63 912.199,1469.02 914.507,1518.15 916.815,1477.43 919.123,1615.54 921.431,1485.63 923.739,1396.17 926.047,1325.92 928.355,1423.66 930.663,1399.66 932.971,1390.17 935.278,1508.25 937.586,1521.42 939.894,1483.08 942.202,1307.64 944.51,1335.58 946.818,1746.73 949.126,1576.53 951.434,1266.58 953.742,1350.97 956.05,1482.1 958.358,1458.61 960.665,1576.26 962.973,1314.94 965.281,1282.77 967.589,1390.35 969.897,1301.6 972.205,1475.87 974.513,1380.72 976.821,1439.97 979.129,1541.45 981.437,1334.76 983.745,1680.66 986.053,1340.75 988.36,1681.31 990.668,1485.95 992.976,1400.86 995.284,1460.48 997.592,1514.67 999.9,1512.71 1002.21,1577.73 1004.52,1596.69 1006.82,1417.13 1009.13,1428.33 1011.44,1498.58 1013.75,1358.32 1016.06,1401.37 1018.36,1438.38 1020.67,1649.2 1022.98,1666.19 1025.29,1355.25 1027.59,1430.98 1029.9,1448.56 1032.21,1447.77 1034.52,1464.6 1036.83,1567.28 1039.13,1419.81 1041.44,1501.05 1043.75,1495.63 1046.06,1629.85 1048.37,1557.28 1050.67,1530.75 1052.98,1414.85 1055.29,1552.45 1057.6,1483.3 1059.91,1310 1062.21,1390.93 1064.52,1376.05 1066.83,1366.49 1069.14,1548.62 1071.45,1451.66 1073.75,1442.79 1076.06,1308.72 1078.37,1549.2 1080.68,1572.51 1082.98,1458.87 1085.29,1527.04 1087.6,1539.95 1089.91,1443.46 1092.22,1546.08 1094.52,1443.54 1096.83,1317.55 1099.14,1343.1 1101.45,1373.37 1103.76,1443.64 1106.06,1658.95 1108.37,1515.54 1110.68,1295.49 1112.99,1249.6 1115.3,1391.52 1117.6,1563.25 1119.91,1402.52 1122.22,1511.53 1124.53,1538.93 1126.84,1340.55 1129.14,1334.87 1131.45,1492.53 1133.76,1323.81 1136.07,1559 1138.37,1409.99 1140.68,1431.35 1142.99,1419.23 1145.3,1642.98 1147.61,1484.71 1149.91,1571.04 1152.22,1476.7 1154.53,1534.88 1156.84,1396.44 1159.15,1487.75 1161.45,1561.02 1163.76,1578.56 1166.07,1363.39 1168.38,1445.2 1170.69,1582.28 1172.99,1448.33 1175.3,1537.09 1177.61,1316.95 1179.92,1289.55 1182.23,1502.4 1184.53,1549.29 1186.84,1469.44 1189.15,1413.97 1191.46,1544.47 1193.76,1310.69 1196.07,1466.89 1198.38,1378.79 1200.69,1420.85 1203,1365.68 1205.3,1546.17 1207.61,1487.88 1209.92,1418.69 1212.23,1360.98 1214.54,1252.73 1216.84,1460.63 1219.15,1372.1 1221.46,1580.84 1223.77,1386.87 1226.08,1523.69 1228.38,1348.76 1230.69,1396.66 1233,1360.09 1235.31,1393.07 1237.61,1487.06 1239.92,1412.98 1242.23,1372.26 1244.54,1435.92 1246.85,1500.58 1249.15,1549.2 1251.46,1541.69 1253.77,1319.74 1256.08,1423.34 1258.39,1414.88 1260.69,1751.15 1263,1537.24 1265.31,1371.7 1267.62,1491.53 1269.93,1485.62 1272.23,1365.19 1274.54,1385.66 1276.85,1543.69 1279.16,1439.43 1281.47,1452.89 1283.77,1506.34 1286.08,1399.71 1288.39,1399.22 1290.7,1492.12 1293,1490.44 1295.31,1385.97 1297.62,1426.72 1299.93,1462.46 1302.24,1471.89 1304.54,1424.17 1306.85,1507.65 1309.16,1573.68 1311.47,1363.45 1313.78,1380.95 1316.08,1517.28 1318.39,1513.48 1320.7,1571.35 1323.01,1356.29 1325.32,1413.21 1327.62,1706.07 1329.93,1422.67 1332.24,1302.02 1334.55,1374.27 1336.86,1579.78 1339.16,1542.78 1341.47,1453.03 1343.78,1371.29 1346.09,1409.2 1348.39,1341.32 1350.7,1382.36 1353.01,1508.55 1355.32,1602.6 1357.63,1304.15 1359.93,1450.51 1362.24,1620.45 1364.55,1399.43 1366.86,1416.06 1369.17,1453.89 1371.47,1380.91 1373.78,1595.58 1376.09,1723.27 1378.4,1400.86 1380.71,1253.1 1383.01,1475.48 1385.32,1497.63 1387.63,1461.08 1389.94,1439.87 1392.24,1555.2 1394.55,1328.65 1396.86,1489.62 1399.17,1678.4 1401.48,1489.05 1403.78,1356.58 1406.09,1529.89 1408.4,1400.84 1410.71,1451.36 1413.02,1633.44 1415.32,1463.04 1417.63,1406.47 1419.94,1461.66 1422.25,1454.46 1424.56,1622.57 1426.86,1255.07 1429.17,1393.16 1431.48,1336.89 1433.79,1368.19 1436.1,1213.4 1438.4,1397.13 1440.71,1586.95 1443.02,1437.82 1445.33,1306.75 1447.63,1371.58 1449.94,1527.47 1452.25,1698.09 1454.56,1528.79 1456.87,1285.56 1459.17,1395 1461.48,1458.54 1463.79,1539.73 1466.1,1415.53 1468.41,1338.43 1470.71,1447.59 1473.02,1392.88 1475.33,1636.49 1477.64,1244.02 1479.95,1425.65 1482.25,1334.98 1484.56,1423.07 1486.87,1482.1 1489.18,1534.45 1491.49,1400.79 1493.79,1411.46 1496.1,1368.31 1498.41,1392.13 1500.72,1431.6 1503.02,1452.24 1505.33,1524.75 1507.64,1470.25 1509.95,1338.33 1512.26,1374.01 1514.56,1543.85 1516.87,1390.29 1519.18,1441.84 1521.49,1504.29 1523.8,1618.74 1526.1,1421.91 1528.41,1558.14 1530.72,1375.25 1533.03,1587.8 1535.34,1437.89 1537.64,1595.3 1539.95,1555.73 1542.26,1427.64 1544.57,1175.78 1546.88,1500.01 1549.18,1482.53 1551.49,1467.17 1553.8,1480.62 1556.11,1472.81 1558.41,1605.6 1560.72,1513.55 1563.03,1550.5 1565.34,1422.07 1567.65,1494.1 1569.95,1377.62 1572.26,1405.7 1574.57,1416.8 1576.88,1490.44 1579.19,1484.28 1581.49,1366.78 1583.8,1511.17 1586.11,1330.6 1588.42,1285.66 1590.73,1402.35 1593.03,1632.52 1595.34,1542 1597.65,1474.99 1599.96,1456.35 1602.26,1421.21 1604.57,1624.63 1606.88,1435.72 1609.19,1405.26 1611.5,1434.1 1613.8,1442.8 1616.11,1469.91 1618.42,1422.91 1620.73,1490.97 1623.04,1514.73 1625.34,1500.62 1627.65,1252.7 1629.96,1346.64 1632.27,1573.79 1634.58,1334.12 1636.88,1402.76 1639.19,1394.6 1641.5,1437.11 1643.81,1496.99 1646.12,1540.22 1648.42,1617.42 1650.73,1628.74 1653.04,1401.75 1655.35,1480.96 1657.65,1490.07 1659.96,1442.76 1662.27,1590.05 1664.58,1401.4 1666.89,1575.05 1669.19,1413.62 1671.5,1369.27 1673.81,1557.48 1676.12,1572.72 1678.43,1401.8 1680.73,1522.87 1683.04,1193.03 1685.35,1375.5 1687.66,1543.96 1689.97,1509.1 1692.27,1444.7 1694.58,1404.69 1696.89,1475.84 1699.2,1402.33 1701.51,1565.12 1703.81,1373.94 1706.12,1401.53 1708.43,1343.69 1710.74,1399.67 1713.04,1340.54 1715.35,1397.54 1717.66,1394.9 1719.97,1459.7 1722.28,1445.17 1724.58,1490.79 1726.89,1539.6 1729.2,1515.51 1731.51,1451.71 1733.82,1463.68 1736.12,1402.37 1738.43,1418.63 1740.74,1350.25 1743.05,1423.77 1745.36,1665.97 1747.66,1496.49 1749.97,1577.95 1752.28,1212.75 1754.59,1606.09 1756.9,1413.67 1759.2,1542.6 1761.51,1598.39 1763.82,1530.99 1766.13,1470.36 1768.43,1517.63 1770.74,1399.37 1773.05,1446.76 1775.36,1349.51 1777.67,1572.08 1779.97,1371.85 1782.28,1451.69 1784.59,1393.43 1786.9,1506.8 1789.21,1533.25 1791.51,1537.52 1793.82,1437.99 1796.13,1438.59 1798.44,1434.13 1800.75,1550.02 1803.05,1362.76 1805.36,1564.99 1807.67,1417.39 1809.98,1477.12 1812.28,1470.42 1814.59,1508.25 1816.9,1409.04 1819.21,1425.71 1821.52,1353.37 1823.82,1359.84 1826.13,1280.52 1828.44,1391.81 1830.75,1393.99 1833.06,1524.94 1835.36,1415.92 1837.67,1397.22 1839.98,1472.32 1842.29,1375.14 1844.6,1409.66 1846.9,1289.48 1849.21,1497.79 1851.52,1351.49 1853.83,1640 1856.14,1592.86 1858.44,1368.07 1860.75,1503.2 1863.06,1538.71 1865.37,1458.73 1867.67,1565.7 1869.98,1522.7 1872.29,1475.02 1874.6,1447.03 1876.91,1504.67 1879.21,1493.7 1881.52,1663.71 1883.83,1278.1 1886.14,1597.84 1888.45,1437.06 1890.75,1311.93 1893.06,1640.77 1895.37,1365.17 1897.68,1332.57 1899.99,1486.25 1902.29,1533.68 1904.6,1401.63 1906.91,1520.93 1909.22,1390.59 1911.53,1497.99 1913.83,1597.07 1916.14,1496.89 1918.45,1456.22 1920.76,1357.99 1923.06,1480.92 1925.37,1469.3 1927.68,1392.42 1929.99,1390.76 1932.3,1470.14 1934.6,1505.95 1936.91,1472.96 1939.22,1578.35 1941.53,1524.18 1943.84,1620.76 1946.14,1570.37 1948.45,1446.23 1950.76,1402.12 1953.07,1523.41 1955.38,1200.39 1957.68,1526.4 1959.99,1447.95 1962.3,1366.94 1964.61,1415.5 1966.91,1521.93 1969.22,1366.77 1971.53,1412.06 1973.84,1559.77 1976.15,1299 1978.45,1405.07 1980.76,1411.59 1983.07,1488.95 1985.38,1429.68 1987.69,1496.69 1989.99,1406.93 1992.3,1429.06 1994.61,1654.4 1996.92,1377.89 1999.23,1440.74 2001.53,1498.12 2003.84,1509.16 2006.15,1616.53 2008.46,1345.75 2010.77,1429.7 2013.07,1452.82 2015.38,1432.42 2017.69,1373.72 2020,1333.71 2022.3,1486.29 2024.61,1430.61 2026.92,1457.81 2029.23,1489.21 2031.54,1525.49 2033.84,1485.53 2036.15,1446.82 2038.46,1366.48 2040.77,1410.49 2043.08,1463.21 2045.38,1510.43 2047.69,1581.26 2050,1448.65 2052.31,1509.69 2054.62,1428.75 2056.92,1485.68 2059.23,1420.25 2061.54,1359.71 2063.85,1256.08 2066.16,1393.08 2068.46,1434.85 2070.77,1318.48 2073.08,1582.56 2075.39,1269.61 2077.69,1479.22 2080,1339.93 2082.31,1413.02 2084.62,1340.03 2086.93,1429.42 2089.23,1585.07 2091.54,1483.15 2093.85,1613.23 2096.16,1401.31 2098.47,1321.63 2100.77,1740.14 2103.08,1388.21 2105.39,1515.4 2107.7,1526.26 2110.01,1495.52 2112.31,1588.17 2114.62,1525.82 2116.93,1371.68 2119.24,1534.53 2121.55,1557.91 2123.85,1443.03 2126.16,1430.72 2128.47,1353.35 2130.78,1373.38 2133.08,1634.63 2135.39,1430.98 2137.7,1656.66 2140.01,1452.89 2142.32,1510.95 2144.62,1634.92 2146.93,1342.32 2149.24,1376.85 2151.55,1587.26 2153.86,1568.61 2156.16,1225 2158.47,1503.47 2160.78,1488.58 2163.09,1432.48 2165.4,1264.19 2167.7,1336.31 2170.01,1343.88 2172.32,1379.11 2174.63,1305.35 2176.93,1532.91 2179.24,1637.98 2181.55,1367.11 2183.86,1497.53 2186.17,1513.43 2188.47,1632.35 2190.78,1336.28 2193.09,1519.51 2195.4,1406.57 2197.71,1308.92 2200.01,1491.36 2202.32,1369.29 2204.63,1596.27 2206.94,1315.08 2209.25,1408.52 2211.55,1476.3 2213.86,1411.12 2216.17,1323.09 2218.48,1391.76 2220.79,1531.81 2223.09,1333.76 2225.4,1451.19 2227.71,1384.48 2230.02,1564.8 2232.32,1565.58 2234.63,1409.65 2236.94,1484.32 2239.25,1498.69 2241.56,1515.48 2243.86,1444.36 2246.17,1382.55 2248.48,1469.56 2250.79,1303.81 2253.1,1550.32 2255.4,1477.73 2257.71,1406.26 2260.02,1470.18 2262.33,1463.51 2264.64,1295.82 2266.94,1545.7 2269.25,1346.22 2271.56,1436.41 2273.87,1579.87 2276.18,1508.81 2278.48,1363.42 2280.79,1470.34 2283.1,1421.79 2285.41,1442.71 2287.71,1266.93 2290.02,1344.21 2292.33,1548.63 2294.64,1471.08 2296.95,1326.77 2299.25,1427.43 2301.56,1436.44 2303.87,1432.77 2306.18,1477.74 2308.49,1326.94 2310.79,1450.94 2313.1,1274.42 2315.41,1299.34 2317.72,1485.89 2320.03,1483.31 2322.33,1506.21 2324.64,1220.97 2326.95,1350.01 2329.26,1546.77 2331.56,1412.17 2333.87,1367.37 2336.18,1425.51 2338.49,1479.9 2340.8,1390.41 2343.1,1373.31 2345.41,1706.5 2347.72,1246.63 2350.03,1322.47 2352.34,1575.68 2354.64,1576.65 2356.95,1259.43 2359.26,1361.81 2361.57,1526.2 2363.88,1437.15 2366.18,1443.38 2368.49,1312.8 2370.8,1580.36 2373.11,1417.28 2375.42,1374.64 2377.72,1458.46 2380.03,1348.9 2382.34,1649.63 2384.65,1497.52 2386.95,1680.84 2389.26,1419.9 2391.57,1526.97 2393.88,1453.94 2396.19,1391.79 2398.49,1374 2400.8,1572.36 2403.11,1589.96 2405.42,1502.81 2407.73,1426.09 2410.03,1671.66 2412.34,1298.21 2414.65,1581.84 2416.96,1718.68 2419.27,1363.34 2421.57,1513.36 2423.88,1485.19 2426.19,1538.37 2428.5,1710.77 2430.81,1355.12 2433.11,1421.94 2435.42,1419.99 2437.73,1339.38 2440.04,1494.31 2442.34,1347.47 2444.65,1563.29 2446.96,1516.15 2449.27,1577.05 2451.58,1472.63 2453.88,1544.25 2456.19,1563.05 2458.5,1509.79 2460.81,1500.33 2463.12,1573.48 2465.42,1330.83 2467.73,1493.65 2470.04,1334.55 2472.35,1512.49 2474.66,1412.12 2476.96,1538.35 2479.27,1450.23 2481.58,1667.61 2483.89,1475.33 2486.2,1498.57 2488.5,1447.47 2490.81,1334.91 2493.12,1496.34 2495.43,1406.15 2497.73,1324.7 2500.04,1342.11 2502.35,1575.25 2504.66,1425.55 2506.97,1581.64 2509.27,1469.57 2511.58,1373.78 2513.89,1416 2516.2,1436.87 2518.51,1410.41 2520.81,1465.39 2523.12,1393.68 2525.43,1313.77 2527.74,1533.08 2530.05,1452.19 2532.35,1250.87 2534.66,1599.64 2536.97,1515.13 2539.28,1595.46 2541.58,1373.98 2543.89,1419.3 2546.2,1464.19 2548.51,1367.45 2550.82,1566.1 2553.12,1466.44 2555.43,1290.21 2557.74,1486.66 2560.05,1359.71 2562.36,1476.36 2564.66,1357.19 2566.97,1442.06 2569.28,1418.73 2571.59,1589.98 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,923.484 268.292,969.822 270.6,1019.98 272.908,796.116 275.216,762.819 277.524,731.5 279.832,902.16 282.139,1059.54 284.447,994.381 286.755,981.636 289.063,998.496 291.371,985.547 293.679,937.954 295.987,1114.01 298.295,938.375 300.603,1066.52 302.911,933.43 305.219,945.104 307.527,963.914 309.834,880.734 312.142,1072.67 314.45,897.209 316.758,998.7 319.066,1009.85 321.374,969.32 323.682,1005.55 325.99,857.931 328.298,1045.33 330.606,1071.65 332.914,977.801 335.221,861.696 337.529,856.472 339.837,901.744 342.145,990.65 344.453,919.312 346.761,802.258 349.069,922.298 351.377,909.2 353.685,721.058 355.993,853.538 358.301,1135.03 360.608,992.392 362.916,985.394 365.224,951.916 367.532,1034.73 369.84,1088.49 372.148,1225.98 374.456,1092.75 376.764,1051.67 379.072,1075.63 381.38,941.489 383.688,969.526 385.996,895.928 388.303,1006.96 390.611,1128.57 392.919,1114.17 395.227,1012.01 397.535,966.749 399.843,1113.96 402.151,922.602 404.459,1007.02 406.767,919.555 409.075,1114.93 411.383,1007.82 413.69,970.721 415.998,922.608 418.306,745.201 420.614,1025.56 422.922,1186.62 425.23,877.742 427.538,1089.32 429.846,881.559 432.154,1000.11 434.462,885.313 436.77,1075.24 439.077,1044.17 441.385,927.967 443.693,960.092 446.001,1013.03 448.309,912.154 450.617,1009.53 452.925,845.328 455.233,1030.2 457.541,918.889 459.849,1022.55 462.157,1011.69 464.465,833.276 466.772,1072.77 469.08,849.703 471.388,816.413 473.696,970.841 476.004,1007.24 478.312,1047.19 480.62,1010.62 482.928,1075.65 485.236,961.243 487.544,916.847 489.852,881.854 492.159,997.582 494.467,1044.72 496.775,1104.57 499.083,941.137 501.391,1026.93 503.699,908.536 506.007,881.378 508.315,1137.68 510.623,934.666 512.931,996.183 515.239,1197.98 517.546,864.62 519.854,1130.25 522.162,1031.31 524.47,1059.36 526.778,964.538 529.086,1097.94 531.394,935.2 533.702,968.275 536.01,1041.02 538.318,825.359 540.626,1002.6 542.933,1065.57 545.241,872.856 547.549,956.865 549.857,937.437 552.165,905.147 554.473,1152.73 556.781,950.397 559.089,912.781 561.397,965.752 563.705,989.201 566.013,1032.12 568.321,1092.94 570.628,823.902 572.936,778.436 575.244,1117.83 577.552,813.565 579.86,1008.32 582.168,930.031 584.476,990.491 586.784,940.831 589.092,1070.17 591.4,857.305 593.708,896.34 596.015,1067.84 598.323,902.016 600.631,1072.62 602.939,885.942 605.247,985.936 607.555,980.582 609.863,1102.46 612.171,1036.9 614.479,962.741 616.787,1031.54 619.095,975.026 621.402,825.373 623.71,929.398 626.018,928.403 628.326,909.757 630.634,1000.04 632.942,957.423 635.25,1020.45 637.558,918.106 639.866,940.367 642.174,856.9 644.482,749.379 646.79,1090.95 649.097,913.284 651.405,1032.29 653.713,1070.03 656.021,958.413 658.329,993.684 660.637,992.173 662.945,981.019 665.253,868.177 667.561,803.559 669.869,1001.52 672.177,965.303 674.484,813.542 676.792,999.447 679.1,808.463 681.408,1141.79 683.716,913.306 686.024,1013.83 688.332,921.47 690.64,1070.63 692.948,928.388 695.256,919.307 697.564,863.111 699.871,968.087 702.179,921.579 704.487,856.725 706.795,833.763 709.103,1085.46 711.411,1121.3 713.719,904.665 716.027,923.431 718.335,877.701 720.643,1008.77 722.951,957.735 725.259,1126.42 727.566,913.553 729.874,938.43 732.182,1008.71 734.49,994.857 736.798,1054.75 739.106,989.249 741.414,910.317 743.722,994.073 746.03,837.024 748.338,1220.2 750.646,874.068 752.953,888.108 755.261,1150.76 757.569,944.004 759.877,982.915 762.185,642.544 764.493,980.582 766.801,920.372 769.109,958.084 771.417,1074.82 773.725,1050.24 776.033,958.821 778.34,948.796 780.648,968.439 782.956,973.074 785.264,895.599 787.572,977.93 789.88,1075.37 792.188,1057.37 794.496,931.845 796.804,878.406 799.112,1022.1 801.42,1029.11 803.728,948.583 806.035,915.931 808.343,1036.65 810.651,1126.45 812.959,884.916 815.267,1009.51 817.575,1046.02 819.883,1020.72 822.191,1161.59 824.499,822.712 826.807,884.278 829.115,1026.8 831.422,879.485 833.73,999.167 836.038,1168.36 838.346,1067.5 840.654,935.169 842.962,1070.64 845.27,975.057 847.578,920.818 849.886,954.269 852.194,1141.67 854.502,911.773 856.809,950.912 859.117,1026.86 861.425,1055.68 863.733,1053.69 866.041,994.165 868.349,1081.52 870.657,743.474 872.965,960.156 875.273,946.958 877.581,1021.24 879.889,1121.98 882.197,958.16 884.504,1010.76 886.812,925.362 889.12,889.3 891.428,691.168 893.736,949.76 896.044,994.866 898.352,976.522 900.66,976.565 902.968,926.841 905.276,1165.86 907.584,816.616 909.891,986.474 912.199,1080.2 914.507,854.134 916.815,935.784 919.123,924.942 921.431,1005.8 923.739,974.716 926.047,1041.09 928.355,1124.65 930.663,990.943 932.971,1115.48 935.278,993.457 937.586,1128.49 939.894,899.715 942.202,818.058 944.51,1047.9 946.818,1009.04 949.126,1021.86 951.434,889.714 953.742,955.925 956.05,976.065 958.358,957.14 960.665,885.607 962.973,706.748 965.281,1065.13 967.589,1006.76 969.897,986.71 972.205,855.388 974.513,1029.85 976.821,1118.1 979.129,943.938 981.437,848.802 983.745,1002.8 986.053,910.345 988.36,933.038 990.668,1030.59 992.976,1128.51 995.284,968.071 997.592,999.853 999.9,949.199 1002.21,783.891 1004.52,1032.05 1006.82,988.841 1009.13,963.309 1011.44,1017.11 1013.75,1184.88 1016.06,996.026 1018.36,855.303 1020.67,1075 1022.98,1042.84 1025.29,987.756 1027.59,881.548 1029.9,1008.78 1032.21,964.418 1034.52,1052.48 1036.83,1060.76 1039.13,1052.9 1041.44,1086.07 1043.75,1088.08 1046.06,1070.56 1048.37,934.614 1050.67,878.058 1052.98,1044.74 1055.29,879.797 1057.6,1127.37 1059.91,889.003 1062.21,725.495 1064.52,884.967 1066.83,987.436 1069.14,853.198 1071.45,932.55 1073.75,921.565 1076.06,798.798 1078.37,1015.78 1080.68,1058.77 1082.98,1035.48 1085.29,920.271 1087.6,1014.23 1089.91,1118.22 1092.22,1022.45 1094.52,1020.73 1096.83,999.359 1099.14,1134.97 1101.45,1101.38 1103.76,763.582 1106.06,765.11 1108.37,1063.47 1110.68,942.537 1112.99,978.851 1115.3,947.454 1117.6,883.095 1119.91,919.024 1122.22,978.418 1124.53,857.954 1126.84,982.804 1129.14,947.94 1131.45,1005.95 1133.76,1085.98 1136.07,879.275 1138.37,850.369 1140.68,1198.9 1142.99,980.174 1145.3,1163.78 1147.61,1057.97 1149.91,1090.64 1152.22,917.817 1154.53,941.596 1156.84,1061.1 1159.15,1006.93 1161.45,1095.1 1163.76,836.546 1166.07,947.439 1168.38,966.916 1170.69,859.149 1172.99,919.097 1175.3,1070.9 1177.61,960.716 1179.92,842.494 1182.23,948.732 1184.53,1010.64 1186.84,859.999 1189.15,1062.02 1191.46,974.354 1193.76,915.548 1196.07,883.822 1198.38,942.362 1200.69,1045.23 1203,993.842 1205.3,924.294 1207.61,945.448 1209.92,1142.99 1212.23,902.876 1214.54,998.857 1216.84,1117.62 1219.15,1016.84 1221.46,1024.03 1223.77,955.191 1226.08,1096.72 1228.38,753.056 1230.69,986.504 1233,916.3 1235.31,853.551 1237.61,887.014 1239.92,859.812 1242.23,869.778 1244.54,1112.87 1246.85,1043.54 1249.15,935.184 1251.46,851.342 1253.77,902.503 1256.08,893.687 1258.39,1074.99 1260.69,965.741 1263,1116.12 1265.31,1030.07 1267.62,937.323 1269.93,879.405 1272.23,1023.64 1274.54,875.08 1276.85,973.531 1279.16,1019.11 1281.47,944.841 1283.77,1096.52 1286.08,869.423 1288.39,1111.34 1290.7,929.676 1293,945.104 1295.31,847.381 1297.62,1061.01 1299.93,1104.75 1302.24,1003.77 1304.54,1011.79 1306.85,1101.55 1309.16,890.353 1311.47,859.421 1313.78,1071.26 1316.08,748.224 1318.39,1094.97 1320.7,1141.31 1323.01,1011.83 1325.32,971.38 1327.62,850.849 1329.93,965.849 1332.24,1073.08 1334.55,1035.92 1336.86,1119.91 1339.16,756.027 1341.47,1142.7 1343.78,860.865 1346.09,1048.4 1348.39,872.918 1350.7,929.8 1353.01,937.781 1355.32,983.623 1357.63,779.692 1359.93,903.146 1362.24,1076.28 1364.55,1026.22 1366.86,894.631 1369.17,792.315 1371.47,1012.15 1373.78,888.675 1376.09,1045.07 1378.4,1001.84 1380.71,979.705 1383.01,1066.2 1385.32,839.263 1387.63,954.893 1389.94,1078.08 1392.24,937.265 1394.55,1065.55 1396.86,944.385 1399.17,895.903 1401.48,919.846 1403.78,900.93 1406.09,902.026 1408.4,857.672 1410.71,956.613 1413.02,921.813 1415.32,837.602 1417.63,1094.31 1419.94,941.013 1422.25,945.976 1424.56,986.212 1426.86,959.351 1429.17,947.006 1431.48,1115.05 1433.79,1011.18 1436.1,1065.12 1438.4,1001.43 1440.71,912.323 1443.02,893.371 1445.33,983.037 1447.63,1082.25 1449.94,852.206 1452.25,907.882 1454.56,1009.43 1456.87,1112.97 1459.17,1120.03 1461.48,999.183 1463.79,841.19 1466.1,1128.56 1468.41,1027.47 1470.71,987.887 1473.02,1055.48 1475.33,903.58 1477.64,870.565 1479.95,973.367 1482.25,945.001 1484.56,1007.39 1486.87,1012.49 1489.18,1124.41 1491.49,1073.37 1493.79,778.945 1496.1,941.989 1498.41,967.357 1500.72,906.583 1503.02,925.014 1505.33,927.754 1507.64,995.361 1509.95,834.494 1512.26,1163.59 1514.56,844.406 1516.87,938.6 1519.18,1142.28 1521.49,1033.04 1523.8,1045.86 1526.1,1119.27 1528.41,971.28 1530.72,981.021 1533.03,1008.12 1535.34,1046.78 1537.64,929.352 1539.95,943.402 1542.26,961.077 1544.57,1077.75 1546.88,806.49 1549.18,922.891 1551.49,1002 1553.8,1025 1556.11,950.637 1558.41,1065.81 1560.72,953.297 1563.03,978.936 1565.34,1023.32 1567.65,875.238 1569.95,1024.57 1572.26,998.595 1574.57,1090.84 1576.88,900.129 1579.19,1046.57 1581.49,957.137 1583.8,940.032 1586.11,846.669 1588.42,1039.21 1590.73,968.006 1593.03,961.828 1595.34,1005.9 1597.65,1092.9 1599.96,879.445 1602.26,1090.65 1604.57,969.498 1606.88,1102.04 1609.19,924.002 1611.5,1102.45 1613.8,1042.85 1616.11,1171.49 1618.42,942.654 1620.73,1139.22 1623.04,1034.42 1625.34,841.861 1627.65,967.789 1629.96,1044.16 1632.27,966.539 1634.58,951.819 1636.88,832.183 1639.19,1054.22 1641.5,892.67 1643.81,1031.17 1646.12,787.407 1648.42,857.043 1650.73,866.574 1653.04,1052.41 1655.35,991.604 1657.65,845.549 1659.96,1074.78 1662.27,935.687 1664.58,766.073 1666.89,971.402 1669.19,859.133 1671.5,1064.07 1673.81,864.043 1676.12,943.559 1678.43,1006.42 1680.73,1070.78 1683.04,984.374 1685.35,1172.43 1687.66,850.954 1689.97,987.95 1692.27,966.451 1694.58,971.457 1696.89,1026.14 1699.2,893.036 1701.51,949.008 1703.81,882.52 1706.12,779.487 1708.43,929.465 1710.74,935.616 1713.04,914.464 1715.35,995.473 1717.66,1102.98 1719.97,1061.19 1722.28,1050.1 1724.58,1223.41 1726.89,1008.16 1729.2,1067.39 1731.51,797.204 1733.82,1126.37 1736.12,881.691 1738.43,1126.43 1740.74,1100.1 1743.05,891.195 1745.36,1017.41 1747.66,946.934 1749.97,734.739 1752.28,1017.07 1754.59,984.521 1756.9,1122.04 1759.2,970.45 1761.51,1048.55 1763.82,1123.91 1766.13,845.88 1768.43,747.465 1770.74,844.854 1773.05,963.162 1775.36,725.993 1777.67,1049.89 1779.97,1107.38 1782.28,982.803 1784.59,704.829 1786.9,1057.88 1789.21,812.024 1791.51,942.233 1793.82,936.994 1796.13,1022.05 1798.44,1003.9 1800.75,1057.07 1803.05,917.329 1805.36,901.697 1807.67,970.205 1809.98,973.093 1812.28,880.559 1814.59,1094.26 1816.9,1162.62 1819.21,932.056 1821.52,761.968 1823.82,1069.95 1826.13,973.906 1828.44,1015.9 1830.75,913.634 1833.06,937.262 1835.36,899.586 1837.67,855.948 1839.98,1128.18 1842.29,1047.72 1844.6,792.948 1846.9,710.497 1849.21,855.849 1851.52,1001.96 1853.83,864.69 1856.14,812.88 1858.44,1152.3 1860.75,905.548 1863.06,924.324 1865.37,911.609 1867.67,1159.76 1869.98,1049.73 1872.29,971.49 1874.6,1015.65 1876.91,973.988 1879.21,1028.81 1881.52,923.03 1883.83,882.903 1886.14,937.799 1888.45,926.4 1890.75,1084.1 1893.06,928.922 1895.37,979.311 1897.68,927.159 1899.99,918.831 1902.29,988.336 1904.6,927.396 1906.91,1064.72 1909.22,809.304 1911.53,1085.26 1913.83,915.615 1916.14,1020.06 1918.45,850.041 1920.76,846.115 1923.06,941.731 1925.37,964.903 1927.68,902.837 1929.99,1036.55 1932.3,824.541 1934.6,874.648 1936.91,927.793 1939.22,1045.62 1941.53,1015.75 1943.84,896.887 1946.14,903.468 1948.45,1006.68 1950.76,1039.75 1953.07,934.424 1955.38,952.002 1957.68,1014.55 1959.99,1032.93 1962.3,898.511 1964.61,999.229 1966.91,912.714 1969.22,856.736 1971.53,874.894 1973.84,904.946 1976.15,919.793 1978.45,947.514 1980.76,885.269 1983.07,1166.7 1985.38,867.737 1987.69,1020.09 1989.99,823.06 1992.3,947.996 1994.61,1087.14 1996.92,904.768 1999.23,990.793 2001.53,948.05 2003.84,1074.57 2006.15,833.239 2008.46,1079.57 2010.77,999.42 2013.07,1122.55 2015.38,855.931 2017.69,972.945 2020,866.276 2022.3,939.769 2024.61,994.651 2026.92,837.176 2029.23,974.705 2031.54,939.865 2033.84,1094.08 2036.15,1003.44 2038.46,950.6 2040.77,917.645 2043.08,906.513 2045.38,887.947 2047.69,1025.85 2050,851.718 2052.31,964.37 2054.62,920.174 2056.92,1014.86 2059.23,1127.17 2061.54,894.89 2063.85,881.954 2066.16,829.248 2068.46,1061.68 2070.77,904.285 2073.08,943.243 2075.39,961.639 2077.69,947.263 2080,940.446 2082.31,817.127 2084.62,989.912 2086.93,1101.28 2089.23,687.307 2091.54,1108.26 2093.85,920.625 2096.16,854.908 2098.47,892.003 2100.77,1102.45 2103.08,1004.02 2105.39,1053.66 2107.7,1086.48 2110.01,946.393 2112.31,1072.98 2114.62,898.085 2116.93,905.111 2119.24,875.614 2121.55,989.881 2123.85,1030.18 2126.16,774.683 2128.47,1076.07 2130.78,1000.51 2133.08,843.065 2135.39,873.637 2137.7,952.288 2140.01,899.468 2142.32,1018.98 2144.62,1009.91 2146.93,974.006 2149.24,986.244 2151.55,1072.58 2153.86,1066.75 2156.16,1053.1 2158.47,1001.93 2160.78,1043.4 2163.09,860.722 2165.4,1047.03 2167.7,1078.14 2170.01,1078.31 2172.32,1087.54 2174.63,909.041 2176.93,991.496 2179.24,994.157 2181.55,981.48 2183.86,1135.35 2186.17,1080.55 2188.47,850.147 2190.78,816.013 2193.09,973.359 2195.4,1088.11 2197.71,972.618 2200.01,977.977 2202.32,1064.43 2204.63,1012.5 2206.94,1134.28 2209.25,918.217 2211.55,952.407 2213.86,724.934 2216.17,997.591 2218.48,895.832 2220.79,1006.04 2223.09,970.756 2225.4,934.922 2227.71,897.31 2230.02,980.365 2232.32,775.461 2234.63,634.592 2236.94,891.316 2239.25,917.221 2241.56,912.932 2243.86,1105.67 2246.17,995.627 2248.48,1048.99 2250.79,952.943 2253.1,981.956 2255.4,936.184 2257.71,1049.25 2260.02,879.438 2262.33,1036.53 2264.64,1008.8 2266.94,862.538 2269.25,1124.32 2271.56,1034.21 2273.87,953.206 2276.18,999.229 2278.48,956.445 2280.79,1052.48 2283.1,1012.49 2285.41,1123.01 2287.71,962.183 2290.02,1114.72 2292.33,920.541 2294.64,1060.49 2296.95,891.053 2299.25,1043.18 2301.56,933.35 2303.87,814.42 2306.18,975.121 2308.49,1062.14 2310.79,904.814 2313.1,948.18 2315.41,982.901 2317.72,958.13 2320.03,938.331 2322.33,1035.75 2324.64,928.519 2326.95,1003.7 2329.26,1213.02 2331.56,929.305 2333.87,904.733 2336.18,865.415 2338.49,846.076 2340.8,1107.2 2343.1,980.248 2345.41,888.471 2347.72,966.66 2350.03,915.209 2352.34,1038.38 2354.64,987.809 2356.95,879.61 2359.26,1048.15 2361.57,1026.01 2363.88,990.739 2366.18,1068.62 2368.49,1174.82 2370.8,975.344 2373.11,880.167 2375.42,889.012 2377.72,1093.43 2380.03,889.109 2382.34,1000.43 2384.65,1180.93 2386.95,1042.98 2389.26,1044.65 2391.57,955.526 2393.88,1048.89 2396.19,950.174 2398.49,1112.16 2400.8,1054.81 2403.11,1008.79 2405.42,1066.79 2407.73,974.408 2410.03,1088.24 2412.34,993.551 2414.65,1011.63 2416.96,1040.29 2419.27,1001.63 2421.57,1039.09 2423.88,852.85 2426.19,845.656 2428.5,1036.83 2430.81,1032.44 2433.11,1155.52 2435.42,1029.28 2437.73,1052.67 2440.04,974.61 2442.34,1036.93 2444.65,1017.61 2446.96,934.864 2449.27,849.289 2451.58,907.995 2453.88,976.656 2456.19,976.201 2458.5,957.318 2460.81,908.719 2463.12,901.609 2465.42,807.46 2467.73,1030.6 2470.04,1130.68 2472.35,1035.93 2474.66,918.14 2476.96,1101.62 2479.27,882.838 2481.58,960.562 2483.89,1027.18 2486.2,1040.95 2488.5,1068.28 2490.81,859.097 2493.12,969.687 2495.43,992.397 2497.73,1090.48 2500.04,798.281 2502.35,1038.06 2504.66,932.118 2506.97,1168.43 2509.27,983.443 2511.58,764.799 2513.89,905.353 2516.2,1034.89 2518.51,944.419 2520.81,1133.96 2523.12,1034.99 2525.43,1016.52 2527.74,1095.46 2530.05,889.26 2532.35,1113.43 2534.66,957.328 2536.97,989.503 2539.28,897.672 2541.58,1073.1 2543.89,837.461 2546.2,957.631 2548.51,878.867 2550.82,1119.46 2553.12,940.017 2555.43,865.611 2557.74,837.756 2560.05,1014.92 2562.36,1093.67 2564.66,889.472 2566.97,808.588 2569.28,964.709 2571.59,970.792 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,965.799 268.292,593.09 270.6,478.583 272.908,563.851 275.216,591.814 277.524,544.091 279.832,408.089 282.139,381.484 284.447,496.896 286.755,257.215 289.063,334.615 291.371,465.682 293.679,585.171 295.987,685.28 298.295,560.063 300.603,430.724 302.911,492.904 305.219,603.935 307.527,311.257 309.834,563.628 312.142,447.985 314.45,498.333 316.758,548.828 319.066,777.844 321.374,333.083 323.682,405.595 325.99,515.067 328.298,433.821 330.606,512.741 332.914,507.918 335.221,465.955 337.529,323.286 339.837,531.835 342.145,479.011 344.453,364.019 346.761,416.6 349.069,627.435 351.377,580.258 353.685,484.43 355.993,353.746 358.301,550.815 360.608,561.456 362.916,622.152 365.224,408.087 367.532,361.415 369.84,547.598 372.148,617.349 374.456,727.622 376.764,610.178 379.072,384.867 381.38,634.107 383.688,476.092 385.996,426.168 388.303,612.11 390.611,427.969 392.919,406.745 395.227,517.352 397.535,413.307 399.843,334.528 402.151,598.049 404.459,509.623 406.767,475.802 409.075,498.89 411.383,706.425 413.69,393.055 415.998,507.499 418.306,475.526 420.614,464.339 422.922,635.064 425.23,505.514 427.538,502.765 429.846,532.874 432.154,267.15 434.462,505.081 436.77,635.699 439.077,498.198 441.385,504.166 443.693,401.414 446.001,463 448.309,380.749 450.617,524.856 452.925,538.726 455.233,297.5 457.541,172.043 459.849,289.842 462.157,642.755 464.465,368.35 466.772,441.623 469.08,545.9 471.388,449.309 473.696,465.151 476.004,586.501 478.312,470.794 480.62,480.247 482.928,406.199 485.236,591.868 487.544,518.448 489.852,481.085 492.159,492.108 494.467,483.015 496.775,424.594 499.083,567.073 501.391,457.003 503.699,558.393 506.007,472.703 508.315,447.442 510.623,355.554 512.931,460.404 515.239,473.296 517.546,485.561 519.854,429.76 522.162,391.558 524.47,441.918 526.778,613.578 529.086,433.626 531.394,416.429 533.702,532.248 536.01,636.122 538.318,545.885 540.626,537.265 542.933,418.966 545.241,485.104 547.549,572.901 549.857,382.571 552.165,570.344 554.473,288.281 556.781,638.139 559.089,354.785 561.397,422.507 563.705,377.747 566.013,493.731 568.321,328.85 570.628,623.563 572.936,686.783 575.244,480.332 577.552,398.591 579.86,329.293 582.168,547.581 584.476,512.076 586.784,462.327 589.092,492.223 591.4,514.371 593.708,466.51 596.015,573.861 598.323,330.342 600.631,562.362 602.939,406.283 605.247,543.434 607.555,351.686 609.863,503.461 612.171,522.644 614.479,440.745 616.787,379.29 619.095,356.345 621.402,555.235 623.71,439.915 626.018,286.909 628.326,402.619 630.634,482.037 632.942,491.517 635.25,610.649 637.558,334.114 639.866,493.487 642.174,665.836 644.482,602.828 646.79,447.483 649.097,428.789 651.405,442.224 653.713,512.435 656.021,581.022 658.329,512.471 660.637,448.692 662.945,409.021 665.253,468.452 667.561,440.442 669.869,528.492 672.177,469.058 674.484,573.49 676.792,591.079 679.1,387.126 681.408,545.646 683.716,235.839 686.024,506.828 688.332,419.982 690.64,463.091 692.948,587.288 695.256,194.011 697.564,559.011 699.871,411.831 702.179,490.037 704.487,585.097 706.795,533.654 709.103,430.424 711.411,321.784 713.719,507.994 716.027,508.384 718.335,402.084 720.643,674.781 722.951,497.341 725.259,583.787 727.566,563.962 729.874,477.675 732.182,508.451 734.49,428.993 736.798,381.881 739.106,537.958 741.414,415.769 743.722,357.523 746.03,596.932 748.338,417.176 750.646,655.454 752.953,390.294 755.261,543.112 757.569,405.7 759.877,323.124 762.185,505.499 764.493,485.293 766.801,417.549 769.109,523.977 771.417,457.621 773.725,605.638 776.033,521.852 778.34,564.224 780.648,437.725 782.956,543.769 785.264,552.507 787.572,309.974 789.88,309.018 792.188,437.529 794.496,541.586 796.804,477.013 799.112,536.176 801.42,519.1 803.728,559.483 806.035,593.356 808.343,484.451 810.651,527.329 812.959,478.387 815.267,560.905 817.575,500.058 819.883,454.953 822.191,520.662 824.499,510.322 826.807,473.444 829.115,548.773 831.422,536.988 833.73,561.894 836.038,361.289 838.346,447.707 840.654,489.477 842.962,347.957 845.27,516.132 847.578,316.456 849.886,366.357 852.194,468.667 854.502,413.343 856.809,631.466 859.117,540.574 861.425,454.558 863.733,469.3 866.041,502.412 868.349,618.708 870.657,523.175 872.965,336.417 875.273,568.992 877.581,608.396 879.889,276.171 882.197,437.198 884.504,344.8 886.812,446.979 889.12,655.13 891.428,390.235 893.736,480.167 896.044,496.554 898.352,555.329 900.66,498.752 902.968,584.242 905.276,518.701 907.584,474.352 909.891,473.377 912.199,397.606 914.507,421.954 916.815,388.798 919.123,479.616 921.431,567.773 923.739,379.376 926.047,637.568 928.355,553.774 930.663,582.189 932.971,608.423 935.278,471.942 937.586,407.699 939.894,508.406 942.202,528.413 944.51,431.311 946.818,434.028 949.126,494.942 951.434,348.214 953.742,424.226 956.05,356.155 958.358,263.553 960.665,466.764 962.973,449.896 965.281,622.035 967.589,417.099 969.897,456.21 972.205,554.613 974.513,618.366 976.821,488.122 979.129,558.57 981.437,420.426 983.745,477.127 986.053,380.071 988.36,512.18 990.668,390.763 992.976,461.482 995.284,588.055 997.592,328.379 999.9,469.397 1002.21,476.135 1004.52,347.7 1006.82,264.972 1009.13,601.765 1011.44,453.058 1013.75,600.852 1016.06,562.822 1018.36,360.15 1020.67,479.043 1022.98,523.881 1025.29,471.87 1027.59,384.368 1029.9,538.544 1032.21,462.395 1034.52,488.468 1036.83,395.382 1039.13,584.359 1041.44,487.59 1043.75,395.451 1046.06,468.052 1048.37,455.429 1050.67,354.429 1052.98,783.544 1055.29,589.989 1057.6,488.019 1059.91,411.213 1062.21,480.557 1064.52,521.428 1066.83,598.091 1069.14,605.099 1071.45,568.017 1073.75,546.804 1076.06,438.469 1078.37,338.5 1080.68,463.144 1082.98,526.153 1085.29,300.955 1087.6,583.502 1089.91,401.719 1092.22,514.486 1094.52,533.038 1096.83,455.461 1099.14,396.258 1101.45,323.92 1103.76,434.416 1106.06,183.786 1108.37,509.664 1110.68,536.161 1112.99,788.363 1115.3,473.675 1117.6,611.827 1119.91,531.371 1122.22,493.156 1124.53,604.994 1126.84,387.292 1129.14,468.987 1131.45,489.874 1133.76,635.11 1136.07,589.003 1138.37,484.97 1140.68,389.438 1142.99,508.727 1145.3,480.771 1147.61,398.797 1149.91,512.615 1152.22,488.211 1154.53,322.747 1156.84,420.029 1159.15,445.776 1161.45,354.974 1163.76,601.027 1166.07,489.163 1168.38,527.796 1170.69,522.354 1172.99,454.33 1175.3,433.765 1177.61,463.562 1179.92,317.002 1182.23,585.658 1184.53,529.172 1186.84,351.541 1189.15,516.33 1191.46,348.258 1193.76,364.035 1196.07,296.761 1198.38,504.941 1200.69,513.743 1203,372.25 1205.3,576.987 1207.61,473.98 1209.92,505.598 1212.23,410.75 1214.54,381.302 1216.84,465.741 1219.15,641.465 1221.46,434.161 1223.77,480.975 1226.08,389.283 1228.38,464.831 1230.69,193.997 1233,464.181 1235.31,415.208 1237.61,384.345 1239.92,416.581 1242.23,595.358 1244.54,407.278 1246.85,406.584 1249.15,427.148 1251.46,324.1 1253.77,561.972 1256.08,514.544 1258.39,472.798 1260.69,467.095 1263,460.588 1265.31,535.65 1267.62,368.598 1269.93,649.337 1272.23,419.393 1274.54,417.512 1276.85,574.052 1279.16,450.242 1281.47,414.742 1283.77,363.83 1286.08,423.279 1288.39,477.121 1290.7,300.884 1293,606.274 1295.31,475.94 1297.62,509.157 1299.93,386.821 1302.24,190.623 1304.54,333.525 1306.85,612.197 1309.16,356.55 1311.47,219.983 1313.78,442.109 1316.08,542.311 1318.39,521.558 1320.7,547.642 1323.01,271.251 1325.32,584.897 1327.62,518.291 1329.93,686.422 1332.24,444.701 1334.55,390.653 1336.86,393.1 1339.16,465.988 1341.47,515.835 1343.78,597.534 1346.09,418.006 1348.39,512.984 1350.7,630.547 1353.01,283.086 1355.32,355.328 1357.63,563.278 1359.93,428.018 1362.24,339.559 1364.55,513.574 1366.86,433.779 1369.17,476.639 1371.47,421.713 1373.78,548.216 1376.09,436.135 1378.4,500.62 1380.71,382.746 1383.01,433.439 1385.32,442.111 1387.63,447.241 1389.94,440.959 1392.24,399.563 1394.55,608.906 1396.86,490.362 1399.17,331.525 1401.48,541.219 1403.78,553.996 1406.09,330.889 1408.4,442.901 1410.71,434.231 1413.02,347.437 1415.32,548.187 1417.63,310.004 1419.94,347.631 1422.25,512.31 1424.56,570.662 1426.86,504.986 1429.17,403.493 1431.48,476.106 1433.79,467.017 1436.1,372.089 1438.4,515.679 1440.71,497.572 1443.02,400.942 1445.33,570.71 1447.63,501.266 1449.94,543.649 1452.25,520.605 1454.56,284.285 1456.87,572.511 1459.17,505.125 1461.48,547.839 1463.79,489.552 1466.1,533.369 1468.41,556.273 1470.71,576.102 1473.02,435.222 1475.33,488.78 1477.64,398.834 1479.95,684.828 1482.25,378.929 1484.56,520.487 1486.87,559.968 1489.18,461.11 1491.49,610.969 1493.79,351.309 1496.1,590.533 1498.41,580.023 1500.72,444.326 1503.02,536.114 1505.33,355.363 1507.64,499.417 1509.95,417.454 1512.26,413.614 1514.56,585.698 1516.87,543.147 1519.18,570.293 1521.49,430.002 1523.8,493.067 1526.1,405.975 1528.41,463.842 1530.72,357.958 1533.03,620.729 1535.34,458.517 1537.64,432.519 1539.95,508.576 1542.26,430.091 1544.57,319.498 1546.88,346.032 1549.18,344.487 1551.49,566.463 1553.8,526.596 1556.11,464.881 1558.41,544.644 1560.72,269.166 1563.03,655.701 1565.34,628.899 1567.65,518.127 1569.95,411.261 1572.26,571.148 1574.57,623.256 1576.88,572.965 1579.19,404.693 1581.49,299.935 1583.8,466.291 1586.11,651.323 1588.42,447.326 1590.73,495.18 1593.03,315.4 1595.34,605.319 1597.65,562.028 1599.96,662.083 1602.26,453.21 1604.57,563.691 1606.88,426.644 1609.19,652.452 1611.5,504.04 1613.8,430.97 1616.11,463.033 1618.42,247.18 1620.73,491.917 1623.04,400.524 1625.34,306.019 1627.65,351.506 1629.96,634.646 1632.27,407.975 1634.58,471.239 1636.88,613.252 1639.19,491.787 1641.5,611.799 1643.81,662.177 1646.12,458.804 1648.42,531.683 1650.73,547.91 1653.04,588.417 1655.35,409.905 1657.65,382.749 1659.96,509.094 1662.27,525.01 1664.58,524.182 1666.89,497.54 1669.19,525.67 1671.5,515.596 1673.81,453.664 1676.12,606.741 1678.43,388.694 1680.73,606.017 1683.04,286.008 1685.35,376.678 1687.66,517.478 1689.97,308.379 1692.27,115.042 1694.58,418.324 1696.89,507.705 1699.2,509.172 1701.51,290.288 1703.81,418.749 1706.12,482.292 1708.43,456.669 1710.74,534.541 1713.04,318.572 1715.35,471.756 1717.66,321.152 1719.97,318.003 1722.28,503.599 1724.58,454.275 1726.89,517.615 1729.2,588.927 1731.51,472.332 1733.82,658.511 1736.12,418.646 1738.43,396.707 1740.74,535.923 1743.05,462.878 1745.36,437.216 1747.66,615.734 1749.97,536.17 1752.28,378.507 1754.59,497.961 1756.9,433.03 1759.2,316.119 1761.51,510.085 1763.82,427.52 1766.13,533.459 1768.43,368.524 1770.74,451.745 1773.05,417.63 1775.36,545.911 1777.67,506.896 1779.97,449.216 1782.28,373.224 1784.59,404.627 1786.9,409.964 1789.21,340.796 1791.51,273.66 1793.82,381.824 1796.13,588.456 1798.44,471.252 1800.75,310.365 1803.05,452.161 1805.36,419.32 1807.67,543.753 1809.98,421.262 1812.28,589.536 1814.59,529.681 1816.9,591.695 1819.21,417.286 1821.52,498.223 1823.82,379.828 1826.13,486.858 1828.44,432.361 1830.75,400.025 1833.06,337.201 1835.36,459.724 1837.67,472.044 1839.98,583.539 1842.29,377.398 1844.6,367.941 1846.9,457.563 1849.21,493.342 1851.52,308.181 1853.83,186.842 1856.14,412.066 1858.44,509.416 1860.75,419.384 1863.06,474.778 1865.37,646.289 1867.67,430.726 1869.98,429.805 1872.29,511.276 1874.6,558.291 1876.91,495.531 1879.21,592.255 1881.52,559.126 1883.83,584.484 1886.14,420.119 1888.45,199.07 1890.75,291.993 1893.06,600.995 1895.37,393.377 1897.68,404.84 1899.99,470.02 1902.29,601.965 1904.6,441.51 1906.91,487.615 1909.22,492.645 1911.53,497.331 1913.83,450.594 1916.14,457.642 1918.45,288.818 1920.76,508.888 1923.06,492.34 1925.37,415.094 1927.68,720.529 1929.99,487.46 1932.3,453.478 1934.6,465.423 1936.91,367.047 1939.22,537.592 1941.53,459.248 1943.84,466.971 1946.14,461.778 1948.45,500.932 1950.76,524.021 1953.07,577.534 1955.38,468.689 1957.68,774.976 1959.99,408.98 1962.3,288.723 1964.61,528.582 1966.91,473.774 1969.22,613.831 1971.53,397.266 1973.84,308.532 1976.15,497.082 1978.45,505.277 1980.76,574.501 1983.07,433.53 1985.38,361.304 1987.69,258.595 1989.99,546.868 1992.3,290 1994.61,495.905 1996.92,655.306 1999.23,440.506 2001.53,545.478 2003.84,609.529 2006.15,401.687 2008.46,457.125 2010.77,637.023 2013.07,636.59 2015.38,533.951 2017.69,439.323 2020,504.569 2022.3,613.238 2024.61,584.603 2026.92,653.012 2029.23,469.359 2031.54,553.229 2033.84,574.905 2036.15,406.919 2038.46,694.294 2040.77,459.542 2043.08,522.886 2045.38,389.458 2047.69,497.658 2050,556.434 2052.31,549.106 2054.62,636.983 2056.92,464.508 2059.23,386.423 2061.54,561.545 2063.85,432.607 2066.16,370.806 2068.46,511.57 2070.77,382.838 2073.08,395.713 2075.39,574.409 2077.69,316.011 2080,278.773 2082.31,533.151 2084.62,397.768 2086.93,550.091 2089.23,430.267 2091.54,409.169 2093.85,292.279 2096.16,509.795 2098.47,579.102 2100.77,515.632 2103.08,317.843 2105.39,284.206 2107.7,547.475 2110.01,482.384 2112.31,478.017 2114.62,329.878 2116.93,378.248 2119.24,414.626 2121.55,436.401 2123.85,463.924 2126.16,511.348 2128.47,418.221 2130.78,384.932 2133.08,525.289 2135.39,518.89 2137.7,479.237 2140.01,364 2142.32,516.906 2144.62,621.393 2146.93,637.713 2149.24,426.728 2151.55,540.795 2153.86,534.416 2156.16,578.381 2158.47,552.238 2160.78,417.135 2163.09,608.238 2165.4,469.847 2167.7,530.059 2170.01,530.496 2172.32,522.472 2174.63,356.894 2176.93,590.451 2179.24,599.306 2181.55,96.8724 2183.86,577.839 2186.17,392.864 2188.47,485.847 2190.78,522.659 2193.09,400.937 2195.4,522.929 2197.71,319.695 2200.01,597.102 2202.32,582.197 2204.63,474.206 2206.94,437.691 2209.25,558.702 2211.55,247.191 2213.86,660.941 2216.17,305.124 2218.48,646.744 2220.79,597.576 2223.09,383.398 2225.4,557.491 2227.71,343.474 2230.02,489.507 2232.32,692.323 2234.63,477.92 2236.94,504.719 2239.25,629.058 2241.56,482.271 2243.86,454.188 2246.17,188.889 2248.48,485.844 2250.79,406.778 2253.1,409.182 2255.4,569.35 2257.71,496.415 2260.02,534.429 2262.33,406.212 2264.64,402.857 2266.94,494.922 2269.25,536.313 2271.56,700.784 2273.87,535.974 2276.18,374.859 2278.48,551.249 2280.79,396.163 2283.1,658.978 2285.41,464.938 2287.71,391.032 2290.02,406.594 2292.33,493.518 2294.64,500.93 2296.95,465.326 2299.25,437.316 2301.56,543.633 2303.87,368.364 2306.18,482.225 2308.49,535.934 2310.79,324.089 2313.1,468.943 2315.41,453.304 2317.72,492.503 2320.03,506.965 2322.33,563.719 2324.64,595.238 2326.95,398.602 2329.26,436.14 2331.56,388.942 2333.87,462.193 2336.18,488.589 2338.49,380.814 2340.8,389.922 2343.1,501.596 2345.41,339.295 2347.72,596.116 2350.03,573.896 2352.34,228.323 2354.64,581.136 2356.95,466.431 2359.26,430.347 2361.57,407.024 2363.88,424.803 2366.18,549.716 2368.49,774.046 2370.8,610.398 2373.11,500.772 2375.42,534.616 2377.72,524.123 2380.03,606.569 2382.34,397.892 2384.65,405.978 2386.95,459.005 2389.26,414.074 2391.57,527.587 2393.88,463.918 2396.19,446.149 2398.49,468.492 2400.8,452.664 2403.11,366.206 2405.42,606.152 2407.73,595.762 2410.03,654.461 2412.34,464.209 2414.65,513.615 2416.96,484.31 2419.27,347.086 2421.57,548.673 2423.88,444.215 2426.19,523.859 2428.5,358.297 2430.81,318.815 2433.11,489.751 2435.42,576.168 2437.73,395.882 2440.04,595.824 2442.34,488.324 2444.65,655.343 2446.96,287.617 2449.27,474.209 2451.58,337.543 2453.88,383.119 2456.19,457.947 2458.5,568.899 2460.81,393.503 2463.12,599.732 2465.42,458.183 2467.73,359.614 2470.04,419.35 2472.35,491.888 2474.66,445.191 2476.96,506.784 2479.27,527.896 2481.58,528.496 2483.89,408.441 2486.2,486.631 2488.5,528.141 2490.81,379.676 2493.12,487.378 2495.43,649.876 2497.73,479.733 2500.04,603.071 2502.35,459.768 2504.66,542.838 2506.97,270.86 2509.27,552.316 2511.58,596.352 2513.89,450.437 2516.2,271.596 2518.51,467.05 2520.81,558.008 2523.12,598.955 2525.43,491.432 2527.74,527.612 2530.05,362.012 2532.35,527.984 2534.66,337.083 2536.97,407.546 2539.28,348.713 2541.58,483.139 2543.89,452.516 2546.2,442.919 2548.51,619.321 2550.82,506.564 2553.12,562.546 2555.43,652.125 2557.74,650.625 2560.05,558.082 2562.36,515.352 2564.66,395.904 2566.97,392.806 2569.28,486.615 2571.59,517.817 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -1.77952    -3.21776   -3.21776   …  -5.70306   -5.06786   -5.06786
  0.0638585  -0.145254  -0.145254      0.460885   0.898484   0.898484
  1.82704     3.35063    3.35063       5.09257    4.49859    4.49859

[:, :, 2] =
 -3.98136   -6.5041    -5.92762   -6.03445   …  -5.37078  -4.64071  -4.35079
 -0.623747   0.704874   0.246308   0.812719     -2.73275  -2.11726  -1.2794
  1.53363    3.39095    2.63227    4.73615       5.65394   3.60638   3.22142

[:, :, 3] =
 -2.09473  -3.26627   -6.48011   -3.89207   …  -4.98287   -5.79152   -5.80073
 -1.35713  -0.873049  -0.197219   0.215328     -0.897072  -0.687133   1.66021
  2.58703   4.69153    4.1885     3.57707       5.22617    4.90283    3.67863

[:, :, 4] =
 -2.51238   -2.12605  -4.31634  -4.45305  …  -3.9265    -3.9265    -3.9265
 -0.827034  -1.04732  -1.80569   2.05713     -0.667897  -0.667897  -0.667897
  1.74787    2.21342   4.55173   5.71527      4.09732    4.09732    4.09732</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.98197    0.981873
  0.0384162  1.00896
  5.01928    1.00612</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.6 seconds
Compute duration  = 2.6 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -5.0021    1.0072    0.0179   3161.8664   4948.9011    1.0000   ⋯
        x[2]    0.0138    0.9972    0.0174   3291.2328   5064.7803    1.0003   ⋯
        x[3]    5.0246    0.9945    0.0178   3124.9913   5550.0876    1.0007   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -6.9520   -5.6670   -5.0189   -4.3189   -2.9836
        x[2]   -1.9739   -0.6559    0.0228    0.6848    1.9393
        x[3]    3.1236    4.3510    5.0349    5.6805    7.0060</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.53 seconds
Compute duration  = 1.53 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.5030    0.1876    0.0027   4646.1407   6149.8860    1.0000   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1447    0.3642    0.5053    0.6439    0.8514</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.24 seconds
Compute duration  = 0.24 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

           x    0.4857    0.1414    0.0099   171.9335    46.7854    1.0028     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.2447    0.3662    0.4904    0.5990    0.7142</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}(-0.19941543259323735,1.0,0.0), "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}(-0.19941543259323735,1.0,0.0):
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/nmUhn/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/compiler.jl:579 [inlined]
  [7] demo(__model__::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, __varinfo__::DynamicPPL.ThreadSafeVarInfo{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}}, ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Base.RefValue{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, __context__::DynamicPPL.DefaultContext)
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:593
  [8] _evaluate!!
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:973 [inlined]
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}}, ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, context::DynamicPPL.DefaultContext)
    @ DynamicPPL ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:962
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:892 [inlined]
 [11] logdensity
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/logdensityfunction.jl:140 [inlined]
 [12] Fix1
    @ ./operators.jl:1118 [inlined]
 [13] vector_mode_dual_eval!(f::Base.Fix1{typeof(LogDensityProblems.logdensity), LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}}, cfg::ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}, x::Vector{Float64})
    @ ForwardDiff ~/.julia/packages/ForwardDiff/PcZ48/src/apiutils.jl:24
 [14] vector_mode_gradient!(result::DiffResults.MutableDiffResult{1, Float64, Tuple{Vector{Float64}}}, f::Base.Fix1{typeof(LogDensityProblems.logdensity), LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}}, x::Vector{Float64}, cfg::ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}})
    @ ForwardDiff ~/.julia/packages/ForwardDiff/PcZ48/src/gradient.jl:96
 [15] gradient!
    @ ~/.julia/packages/ForwardDiff/PcZ48/src/gradient.jl:37 [inlined]
 [16] gradient!
    @ ~/.julia/packages/ForwardDiff/PcZ48/src/gradient.jl:35 [inlined]
 [17] logdensity_and_gradient
    @ ~/.julia/packages/LogDensityProblemsAD/rBlLq/ext/LogDensityProblemsADForwardDiffExt.jl:118 [inlined]
 [18] leapfrog_step(model::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, x::Vector{Float64}, p::Vector{Float64}, ϵ::Int64, M::UniformScaling{Bool})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:369
 [19] step(rng::TaskLocalRNG, model_wrapper::AbstractMCMC.LogDensityModel{LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}}, sampler::MALA{Int64, UniformScaling{Bool}}, state::MALAState{Vector{Float64}}; kwargs::@Kwargs{})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:334
 [20] step
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:316 [inlined]
 [21] #step#107
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:155 [inlined]
 [22] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, state::Turing.Inference.TuringState{MALAState{Vector{Float64}}, LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:144
 [23] macro expansion
    @ ~/.julia/packages/AbstractMCMC/YrmkI/src/sample.jl:176 [inlined]
 [24] macro expansion
    @ ~/.julia/packages/AbstractMCMC/YrmkI/src/logging.jl:16 [inlined]
 [25] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/YrmkI/src/sample.jl:120
 [26] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/MjWTB/src/sampler.jl:93
 [27] sample
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/sampler.jl:83 [inlined]
 [28] #sample#4
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:276 [inlined]
 [29] sample
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:267 [inlined]
 [30] #sample#3
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:264 [inlined]
 [31] top-level scope
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:595</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.57 seconds
Compute duration  = 0.57 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.7820    0.5688    0.0498    70.2541    24.4873    1.0266     ⋯
           x   -0.0316    0.9943    0.0586   500.7053   422.5620    1.0133     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.0711    0.3246    0.6650    1.1380    2.1049
           x   -2.1623   -0.3515   -0.0270    0.3293    1.9034</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.99 seconds
Compute duration  = 2.99 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.1035    0.0000    0.0000        NaN        NaN       NaN     ⋯
           x   -0.6774    0.0000    0.0000        NaN        NaN       NaN     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1035    0.1035    0.1035    0.1035    0.1035
           x   -0.6774   -0.6774   -0.6774   -0.6774   -0.6774</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>