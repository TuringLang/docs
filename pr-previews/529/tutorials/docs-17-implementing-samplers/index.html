<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../tutorials/docs-07-for-developers-variational-inference/index.html" rel="prev">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/docs-00-getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/00-introduction/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.34" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.34</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.34">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Users</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-00-getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-12-using-turing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Core Functionality</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Usage Tips</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-10-using-turing-autodiff/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-custom-distribution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Custom Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-modifying-logprob/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modifying the Log Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-generated-quantities/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generated Quantities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-13-using-turing-performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-15-using-turing-sampler-viz/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-11-using-turing-dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-16-using-turing-external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/00-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction: Coin Flipping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/01-gaussian-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/02-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/03-bayesian-neural-network/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/04-hidden-markov-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/05-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/06-infinite-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/07-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/08-multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/09-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/10-bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/11-probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/13-seasonal-time-series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/15-gaussian-processes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Gaussian Processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/12-gplvm/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Contributing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-01-contributing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to Contribute</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">DynamicPPL in Depth</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/dev-model-manual/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manually Defining a Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-05-for-developers-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/14-minituring/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/16-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Inference (note: outdated)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-06-for-developers-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-36.40845615695938</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-36.40845615695938</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([0.0, 0.0, 0.0]), MALAState{Vector{Float64}}([0.0, 0.0, 0.0]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -1.73945   -3.61667  -5.11857  -4.40031   …  -5.16203   -5.16203   -3.95629
 -0.438876  -1.67433  -1.07139  -0.587901     -0.805066  -0.805066   0.271344
  1.61559    2.06379   3.85928   5.97509       4.59314    4.59314    4.34974</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -5.00479    1.00442
 -0.0203371  0.990769
  5.01034    1.00177</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip290">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip290)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip291">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip290)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip292">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1696.99 2640.76,1696.99 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1450.92 2640.76,1450.92 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1204.84 2640.76,1204.84 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,958.768 2640.76,958.768 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,712.692 2640.76,712.692 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,466.616 2640.76,466.616 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,220.541 2640.76,220.541 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip290)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1696.99 215.714,1696.99 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1450.92 215.714,1450.92 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1204.84 215.714,1204.84 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,958.768 215.714,958.768 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,712.692 215.714,712.692 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,466.616 215.714,466.616 "></polyline>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,220.541 215.714,220.541 "></polyline>
<path clip-path="url(#clip290)" d="M50.5475 1697.45 L80.2233 1697.45 L80.2233 1701.38 L50.5475 1701.38 L50.5475 1697.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M89.1352 1679.71 L111.357 1679.71 L111.357 1681.71 L98.8111 1714.27 L93.9269 1714.27 L105.732 1683.65 L89.1352 1683.65 L89.1352 1679.71 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M120.478 1708.39 L125.362 1708.39 L125.362 1714.27 L120.478 1714.27 L120.478 1708.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M135.593 1679.71 L153.95 1679.71 L153.95 1683.65 L139.876 1683.65 L139.876 1692.12 Q140.894 1691.77 141.913 1691.61 Q142.931 1691.43 143.95 1691.43 Q149.737 1691.43 153.116 1694.6 Q156.496 1697.77 156.496 1703.19 Q156.496 1708.77 153.024 1711.87 Q149.552 1714.95 143.232 1714.95 Q141.056 1714.95 138.788 1714.58 Q136.542 1714.2 134.135 1713.46 L134.135 1708.77 Q136.218 1709.9 138.441 1710.45 Q140.663 1711.01 143.14 1711.01 Q147.144 1711.01 149.482 1708.9 Q151.82 1706.8 151.82 1703.19 Q151.82 1699.58 149.482 1697.47 Q147.144 1695.36 143.14 1695.36 Q141.265 1695.36 139.39 1695.78 Q137.538 1696.2 135.593 1697.08 L135.593 1679.71 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M49.5521 1451.37 L79.2279 1451.37 L79.2279 1455.31 L49.5521 1455.31 L49.5521 1451.37 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M89.3667 1433.64 L107.723 1433.64 L107.723 1437.57 L93.6491 1437.57 L93.6491 1446.05 Q94.6676 1445.7 95.6861 1445.54 Q96.7047 1445.35 97.7232 1445.35 Q103.51 1445.35 106.89 1448.52 Q110.269 1451.69 110.269 1457.11 Q110.269 1462.69 106.797 1465.79 Q103.325 1468.87 97.0056 1468.87 Q94.8297 1468.87 92.5612 1468.5 Q90.3158 1468.13 87.9084 1467.39 L87.9084 1462.69 Q89.9917 1463.82 92.2139 1464.38 Q94.4361 1464.93 96.913 1464.93 Q100.918 1464.93 103.256 1462.83 Q105.593 1460.72 105.593 1457.11 Q105.593 1453.5 103.256 1451.39 Q100.918 1449.29 96.913 1449.29 Q95.038 1449.29 93.163 1449.7 Q91.3112 1450.12 89.3667 1451 L89.3667 1433.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M119.482 1462.32 L124.367 1462.32 L124.367 1468.2 L119.482 1468.2 L119.482 1462.32 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M144.552 1436.72 Q140.941 1436.72 139.112 1440.28 Q137.306 1443.82 137.306 1450.95 Q137.306 1458.06 139.112 1461.62 Q140.941 1465.17 144.552 1465.17 Q148.186 1465.17 149.991 1461.62 Q151.82 1458.06 151.82 1450.95 Q151.82 1443.82 149.991 1440.28 Q148.186 1436.72 144.552 1436.72 M144.552 1433.01 Q150.362 1433.01 153.417 1437.62 Q156.496 1442.2 156.496 1450.95 Q156.496 1459.68 153.417 1464.29 Q150.362 1468.87 144.552 1468.87 Q138.741 1468.87 135.663 1464.29 Q132.607 1459.68 132.607 1450.95 Q132.607 1442.2 135.663 1437.62 Q138.741 1433.01 144.552 1433.01 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M50.5475 1205.29 L80.2233 1205.29 L80.2233 1209.23 L50.5475 1209.23 L50.5475 1205.29 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M94.3436 1218.19 L110.663 1218.19 L110.663 1222.12 L88.7186 1222.12 L88.7186 1218.19 Q91.3806 1215.43 95.9639 1210.8 Q100.57 1206.15 101.751 1204.81 Q103.996 1202.29 104.876 1200.55 Q105.779 1198.79 105.779 1197.1 Q105.779 1194.35 103.834 1192.61 Q101.913 1190.87 98.8111 1190.87 Q96.6121 1190.87 94.1584 1191.64 Q91.7278 1192.4 88.9501 1193.95 L88.9501 1189.23 Q91.7741 1188.1 94.2278 1187.52 Q96.6815 1186.94 98.7185 1186.94 Q104.089 1186.94 107.283 1189.62 Q110.478 1192.31 110.478 1196.8 Q110.478 1198.93 109.668 1200.85 Q108.881 1202.75 106.774 1205.34 Q106.195 1206.01 103.094 1209.23 Q99.9917 1212.42 94.3436 1218.19 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M120.478 1216.24 L125.362 1216.24 L125.362 1222.12 L120.478 1222.12 L120.478 1216.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M135.593 1187.56 L153.95 1187.56 L153.95 1191.5 L139.876 1191.5 L139.876 1199.97 Q140.894 1199.62 141.913 1199.46 Q142.931 1199.28 143.95 1199.28 Q149.737 1199.28 153.116 1202.45 Q156.496 1205.62 156.496 1211.04 Q156.496 1216.61 153.024 1219.72 Q149.552 1222.79 143.232 1222.79 Q141.056 1222.79 138.788 1222.42 Q136.542 1222.05 134.135 1221.31 L134.135 1216.61 Q136.218 1217.75 138.441 1218.3 Q140.663 1218.86 143.14 1218.86 Q147.144 1218.86 149.482 1216.75 Q151.82 1214.65 151.82 1211.04 Q151.82 1207.42 149.482 1205.32 Q147.144 1203.21 143.14 1203.21 Q141.265 1203.21 139.39 1203.63 Q137.538 1204.04 135.593 1204.92 L135.593 1187.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M99.3204 944.566 Q95.7093 944.566 93.8806 948.131 Q92.075 951.673 92.075 958.802 Q92.075 965.909 93.8806 969.474 Q95.7093 973.015 99.3204 973.015 Q102.955 973.015 104.76 969.474 Q106.589 965.909 106.589 958.802 Q106.589 951.673 104.76 948.131 Q102.955 944.566 99.3204 944.566 M99.3204 940.863 Q105.131 940.863 108.186 945.469 Q111.265 950.052 111.265 958.802 Q111.265 967.529 108.186 972.136 Q105.131 976.719 99.3204 976.719 Q93.5102 976.719 90.4315 972.136 Q87.376 967.529 87.376 958.802 Q87.376 950.052 90.4315 945.469 Q93.5102 940.863 99.3204 940.863 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M119.482 970.168 L124.367 970.168 L124.367 976.048 L119.482 976.048 L119.482 970.168 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M144.552 944.566 Q140.941 944.566 139.112 948.131 Q137.306 951.673 137.306 958.802 Q137.306 965.909 139.112 969.474 Q140.941 973.015 144.552 973.015 Q148.186 973.015 149.991 969.474 Q151.82 965.909 151.82 958.802 Q151.82 951.673 149.991 948.131 Q148.186 944.566 144.552 944.566 M144.552 940.863 Q150.362 940.863 153.417 945.469 Q156.496 950.052 156.496 958.802 Q156.496 967.529 153.417 972.136 Q150.362 976.719 144.552 976.719 Q138.741 976.719 135.663 972.136 Q132.607 967.529 132.607 958.802 Q132.607 950.052 135.663 945.469 Q138.741 940.863 144.552 940.863 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M94.3436 726.037 L110.663 726.037 L110.663 729.972 L88.7186 729.972 L88.7186 726.037 Q91.3806 723.282 95.9639 718.653 Q100.57 714 101.751 712.657 Q103.996 710.134 104.876 708.398 Q105.779 706.639 105.779 704.949 Q105.779 702.194 103.834 700.458 Q101.913 698.722 98.8111 698.722 Q96.6121 698.722 94.1584 699.486 Q91.7278 700.25 88.9501 701.801 L88.9501 697.079 Q91.7741 695.944 94.2278 695.366 Q96.6815 694.787 98.7185 694.787 Q104.089 694.787 107.283 697.472 Q110.478 700.157 110.478 704.648 Q110.478 706.778 109.668 708.699 Q108.881 710.597 106.774 713.19 Q106.195 713.861 103.094 717.079 Q99.9917 720.273 94.3436 726.037 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M120.478 724.092 L125.362 724.092 L125.362 729.972 L120.478 729.972 L120.478 724.092 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M135.593 695.412 L153.95 695.412 L153.95 699.347 L139.876 699.347 L139.876 707.819 Q140.894 707.472 141.913 707.31 Q142.931 707.125 143.95 707.125 Q149.737 707.125 153.116 710.296 Q156.496 713.467 156.496 718.884 Q156.496 724.463 153.024 727.565 Q149.552 730.643 143.232 730.643 Q141.056 730.643 138.788 730.273 Q136.542 729.903 134.135 729.162 L134.135 724.463 Q136.218 725.597 138.441 726.153 Q140.663 726.708 143.14 726.708 Q147.144 726.708 149.482 724.602 Q151.82 722.495 151.82 718.884 Q151.82 715.273 149.482 713.167 Q147.144 711.06 143.14 711.06 Q141.265 711.06 139.39 711.477 Q137.538 711.893 135.593 712.773 L135.593 695.412 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M89.3667 449.336 L107.723 449.336 L107.723 453.272 L93.6491 453.272 L93.6491 461.744 Q94.6676 461.397 95.6861 461.235 Q96.7047 461.049 97.7232 461.049 Q103.51 461.049 106.89 464.221 Q110.269 467.392 110.269 472.809 Q110.269 478.387 106.797 481.489 Q103.325 484.568 97.0056 484.568 Q94.8297 484.568 92.5612 484.197 Q90.3158 483.827 87.9084 483.086 L87.9084 478.387 Q89.9917 479.521 92.2139 480.077 Q94.4361 480.633 96.913 480.633 Q100.918 480.633 103.256 478.526 Q105.593 476.42 105.593 472.809 Q105.593 469.197 103.256 467.091 Q100.918 464.985 96.913 464.985 Q95.038 464.985 93.163 465.401 Q91.3112 465.818 89.3667 466.697 L89.3667 449.336 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M119.482 478.017 L124.367 478.017 L124.367 483.896 L119.482 483.896 L119.482 478.017 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M144.552 452.415 Q140.941 452.415 139.112 455.98 Q137.306 459.522 137.306 466.651 Q137.306 473.758 139.112 477.322 Q140.941 480.864 144.552 480.864 Q148.186 480.864 149.991 477.322 Q151.82 473.758 151.82 466.651 Q151.82 459.522 149.991 455.98 Q148.186 452.415 144.552 452.415 M144.552 448.711 Q150.362 448.711 153.417 453.318 Q156.496 457.901 156.496 466.651 Q156.496 475.378 153.417 479.984 Q150.362 484.568 144.552 484.568 Q138.741 484.568 135.663 479.984 Q132.607 475.378 132.607 466.651 Q132.607 457.901 135.663 453.318 Q138.741 448.711 144.552 448.711 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M89.1352 203.261 L111.357 203.261 L111.357 205.252 L98.8111 237.821 L93.9269 237.821 L105.732 207.196 L89.1352 207.196 L89.1352 203.261 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M120.478 231.941 L125.362 231.941 L125.362 237.821 L120.478 237.821 L120.478 231.941 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip290)" d="M135.593 203.261 L153.95 203.261 L153.95 207.196 L139.876 207.196 L139.876 215.668 Q140.894 215.321 141.913 215.159 Q142.931 214.974 143.95 214.974 Q149.737 214.974 153.116 218.145 Q156.496 221.316 156.496 226.733 Q156.496 232.312 153.024 235.413 Q149.552 238.492 143.232 238.492 Q141.056 238.492 138.788 238.122 Q136.542 237.751 134.135 237.011 L134.135 232.312 Q136.218 233.446 138.441 234.001 Q140.663 234.557 143.14 234.557 Q147.144 234.557 149.482 232.451 Q151.82 230.344 151.82 226.733 Q151.82 223.122 149.482 221.015 Q147.144 218.909 143.14 218.909 Q141.265 218.909 139.39 219.326 Q137.538 219.742 135.593 220.622 L135.593 203.261 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip292)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1129.98 268.292,1316.07 270.6,1182.1 272.908,1432.59 275.216,1552.13 277.524,1209.09 279.832,1485.99 282.139,1379.26 284.447,1417.02 286.755,1610.08 289.063,1543.89 291.371,1272.7 293.679,1393 295.987,1487.41 298.295,1417.16 300.603,1469.48 302.911,1294.74 305.219,1570.16 307.527,1531.3 309.834,1458.8 312.142,1376.66 314.45,1751.15 316.758,1486.23 319.066,1486.8 321.374,1535.78 323.682,1533.24 325.99,1533.28 328.298,1472.35 330.606,1327.1 332.914,1362.07 335.221,1319.41 337.529,1406.44 339.837,1515.39 342.145,1374.51 344.453,1460.9 346.761,1459.32 349.069,1574.65 351.377,1601.12 353.685,1296.12 355.993,1369.62 358.301,1380.29 360.608,1737.06 362.916,1430.31 365.224,1556.3 367.532,1644.06 369.84,1300.26 372.148,1438.88 374.456,1549.97 376.764,1475.36 379.072,1542.55 381.38,1479.94 383.688,1575.81 385.996,1301.12 388.303,1408.77 390.611,1306.54 392.919,1615.83 395.227,1467.95 397.535,1709.89 399.843,1340.24 402.151,1525.28 404.459,1621.55 406.767,1524.21 409.075,1498.34 411.383,1384.71 413.69,1489.09 415.998,1329.98 418.306,1515.42 420.614,1407.09 422.922,1514.11 425.23,1583.61 427.538,1561.21 429.846,1358.81 432.154,1442.75 434.462,1439.65 436.77,1327.13 439.077,1542.07 441.385,1481.16 443.693,1358.13 446.001,1322.3 448.309,1398.12 450.617,1326.14 452.925,1281.31 455.233,1294.7 457.541,1519.36 459.849,1605.9 462.157,1534.96 464.465,1515.24 466.772,1378 469.08,1604 471.388,1481.22 473.696,1390.35 476.004,1497.09 478.312,1348.52 480.62,1402.5 482.928,1537 485.236,1373.2 487.544,1421.34 489.852,1493.02 492.159,1340.57 494.467,1554.8 496.775,1584.27 499.083,1467.91 501.391,1450.67 503.699,1398.28 506.007,1504.79 508.315,1348.76 510.623,1594.65 512.931,1364.98 515.239,1572.89 517.546,1283.54 519.854,1437.05 522.162,1351.94 524.47,1449.89 526.778,1232.17 529.086,1366.54 531.394,1449.02 533.702,1468.29 536.01,1428.32 538.318,1270.08 540.626,1518.51 542.933,1540.09 545.241,1430.14 547.549,1450.16 549.857,1438.02 552.165,1465.67 554.473,1561.48 556.781,1327.01 559.089,1505.49 561.397,1311.53 563.705,1623.86 566.013,1532.95 568.321,1491.1 570.628,1506.14 572.936,1370.29 575.244,1586.2 577.552,1540.88 579.86,1511.18 582.168,1600.72 584.476,1700.83 586.784,1312.92 589.092,1508.35 591.4,1438.43 593.708,1546.82 596.015,1370.55 598.323,1526 600.631,1417.92 602.939,1565.45 605.247,1533.65 607.555,1438.54 609.863,1555.07 612.171,1444.34 614.479,1232.47 616.787,1746.94 619.095,1382.23 621.402,1441.94 623.71,1404.01 626.018,1525.33 628.326,1571.07 630.634,1469.23 632.942,1523.69 635.25,1439.1 637.558,1351.64 639.866,1531.16 642.174,1565.92 644.482,1414.16 646.79,1147.38 649.097,1265.52 651.405,1302.51 653.713,1566.78 656.021,1453.44 658.329,1303.75 660.637,1414.87 662.945,1415.43 665.253,1457.58 667.561,1437.88 669.869,1529.6 672.177,1335.02 674.484,1441.4 676.792,1326.06 679.1,1588.72 681.408,1517.34 683.716,1634.39 686.024,1575.08 688.332,1166.9 690.64,1503.53 692.948,1497.5 695.256,1365.38 697.564,1620.47 699.871,1479.78 702.179,1276.82 704.487,1420.95 706.795,1392.44 709.103,1505.38 711.411,1377.16 713.719,1480.1 716.027,1345.02 718.335,1449.87 720.643,1337.37 722.951,1376.59 725.259,1324.62 727.566,1438.45 729.874,1516.78 732.182,1649.45 734.49,1591.13 736.798,1537.54 739.106,1502.74 741.414,1357.37 743.722,1266.6 746.03,1504.69 748.338,1392.85 750.646,1465.7 752.953,1512.93 755.261,1705.59 757.569,1391.32 759.877,1528.23 762.185,1438.26 764.493,1377.44 766.801,1464.24 769.109,1519.42 771.417,1359.52 773.725,1193.84 776.033,1490.94 778.34,1628.5 780.648,1507.64 782.956,1684.42 785.264,1470.68 787.572,1443.65 789.88,1481.28 792.188,1374.54 794.496,1514.23 796.804,1387.37 799.112,1411.13 801.42,1560.47 803.728,1557.54 806.035,1368.97 808.343,1489.98 810.651,1366.22 812.959,1387.97 815.267,1336.17 817.575,1600.62 819.883,1413.98 822.191,1290.3 824.499,1446.04 826.807,1469.83 829.115,1421.49 831.422,1503.32 833.73,1476.12 836.038,1588.8 838.346,1297.97 840.654,1456.16 842.962,1502.83 845.27,1217.75 847.578,1447.99 849.886,1268.12 852.194,1585.49 854.502,1391.99 856.809,1255.59 859.117,1366.38 861.425,1366.93 863.733,1393.22 866.041,1507.38 868.349,1491.22 870.657,1480.18 872.965,1618.75 875.273,1276.53 877.581,1461.15 879.889,1457.74 882.197,1153.43 884.504,1397.81 886.812,1378.95 889.12,1345.75 891.428,1346.19 893.736,1339.15 896.044,1642.78 898.352,1231.98 900.66,1365.29 902.968,1312.1 905.276,1537.89 907.584,1491.59 909.891,1402.6 912.199,1437.47 914.507,1556.68 916.815,1356.44 919.123,1557.78 921.431,1469.97 923.739,1480.24 926.047,1420.85 928.355,1537.53 930.663,1471.73 932.971,1389.62 935.278,1669.32 937.586,1264.26 939.894,1359.89 942.202,1335.72 944.51,1433.59 946.818,1394.56 949.126,1571.64 951.434,1343.03 953.742,1431.5 956.05,1417.65 958.358,1307.81 960.665,1563.22 962.973,1352.8 965.281,1429.46 967.589,1346.57 969.897,1698.96 972.205,1411.52 974.513,1538.23 976.821,1303.86 979.129,1491.91 981.437,1493.74 983.745,1465.62 986.053,1267.27 988.36,1605.81 990.668,1340.23 992.976,1342.32 995.284,1364.28 997.592,1551.6 999.9,1484.06 1002.21,1485.32 1004.52,1512.96 1006.82,1510.71 1009.13,1447.23 1011.44,1434.05 1013.75,1504.6 1016.06,1598.75 1018.36,1442.51 1020.67,1492.13 1022.98,1426.41 1025.29,1395.16 1027.59,1286.97 1029.9,1243.29 1032.21,1544.56 1034.52,1554.72 1036.83,1523.07 1039.13,1602.27 1041.44,1434.09 1043.75,1370.21 1046.06,1462.21 1048.37,1253.78 1050.67,1417.61 1052.98,1608.8 1055.29,1408.05 1057.6,1564.8 1059.91,1381.56 1062.21,1534.72 1064.52,1570.36 1066.83,1455.68 1069.14,1526.7 1071.45,1419.32 1073.75,1605.88 1076.06,1400.52 1078.37,1283.5 1080.68,1385.62 1082.98,1476.97 1085.29,1488.16 1087.6,1374.01 1089.91,1282.26 1092.22,1620.89 1094.52,1409 1096.83,1610.94 1099.14,1423.52 1101.45,1337.36 1103.76,1404.47 1106.06,1318.76 1108.37,1350.67 1110.68,1485.82 1112.99,1343.51 1115.3,1656.54 1117.6,1319.53 1119.91,1409.63 1122.22,1659.69 1124.53,1605.91 1126.84,1325.8 1129.14,1469.8 1131.45,1392.13 1133.76,1548.02 1136.07,1471.24 1138.37,1407.36 1140.68,1367.65 1142.99,1565.57 1145.3,1397.35 1147.61,1463.72 1149.91,1481.74 1152.22,1407.77 1154.53,1482.69 1156.84,1506.51 1159.15,1300.03 1161.45,1512.8 1163.76,1569.79 1166.07,1447.18 1168.38,1434.79 1170.69,1515.44 1172.99,1602.66 1175.3,1435.75 1177.61,1615.42 1179.92,1648.01 1182.23,1543.17 1184.53,1404.14 1186.84,1295.29 1189.15,1454.48 1191.46,1440.5 1193.76,1482.45 1196.07,1536.91 1198.38,1411.83 1200.69,1476.74 1203,1250.94 1205.3,1321.43 1207.61,1264.72 1209.92,1380.29 1212.23,1390.91 1214.54,1416.41 1216.84,1412.02 1219.15,1453.15 1221.46,1413.47 1223.77,1476.12 1226.08,1608.35 1228.38,1517.22 1230.69,1464.23 1233,1443.06 1235.31,1455.55 1237.61,1411.81 1239.92,1553.62 1242.23,1404.48 1244.54,1436.75 1246.85,1613.24 1249.15,1521.1 1251.46,1477.22 1253.77,1407.13 1256.08,1590.24 1258.39,1526.51 1260.69,1290.1 1263,1463.42 1265.31,1399.2 1267.62,1539.22 1269.93,1286.48 1272.23,1445.19 1274.54,1281.06 1276.85,1404.81 1279.16,1639.22 1281.47,1411.25 1283.77,1408.66 1286.08,1285.26 1288.39,1576.37 1290.7,1472.26 1293,1305.99 1295.31,1530.11 1297.62,1554.32 1299.93,1487.35 1302.24,1416.46 1304.54,1462.11 1306.85,1484.95 1309.16,1539.08 1311.47,1633.87 1313.78,1348.45 1316.08,1450.34 1318.39,1546.68 1320.7,1546.92 1323.01,1339.51 1325.32,1351.83 1327.62,1567.69 1329.93,1454.32 1332.24,1371.05 1334.55,1458.05 1336.86,1461.49 1339.16,1439.28 1341.47,1377.11 1343.78,1244.12 1346.09,1527.17 1348.39,1513.66 1350.7,1460.31 1353.01,1464 1355.32,1441.72 1357.63,1374.07 1359.93,1462.1 1362.24,1325.44 1364.55,1322.12 1366.86,1608.02 1369.17,1355.51 1371.47,1487.06 1373.78,1462.39 1376.09,1393.86 1378.4,1512.62 1380.71,1343.43 1383.01,1469.89 1385.32,1390.22 1387.63,1385.1 1389.94,1404.18 1392.24,1301.44 1394.55,1451.32 1396.86,1531.72 1399.17,1518.76 1401.48,1455.71 1403.78,1539.67 1406.09,1464.15 1408.4,1500.97 1410.71,1403.46 1413.02,1476.4 1415.32,1473.67 1417.63,1451.7 1419.94,1537.48 1422.25,1427.1 1424.56,1537.32 1426.86,1516.48 1429.17,1527.31 1431.48,1443.09 1433.79,1282.37 1436.1,1442.97 1438.4,1373.71 1440.71,1507.9 1443.02,1485.47 1445.33,1630.4 1447.63,1642.53 1449.94,1469.67 1452.25,1607.17 1454.56,1389.82 1456.87,1410.66 1459.17,1417.71 1461.48,1468.93 1463.79,1484.19 1466.1,1357.09 1468.41,1438.52 1470.71,1556.75 1473.02,1589.76 1475.33,1447.99 1477.64,1370.85 1479.95,1384.68 1482.25,1534.19 1484.56,1597.09 1486.87,1373.74 1489.18,1333.42 1491.49,1506.6 1493.79,1510.91 1496.1,1432.54 1498.41,1483.88 1500.72,1509.81 1503.02,1366.76 1505.33,1303.65 1507.64,1381.45 1509.95,1442.65 1512.26,1635.69 1514.56,1458 1516.87,1403.46 1519.18,1483.85 1521.49,1438.07 1523.8,1369.05 1526.1,1577 1528.41,1483.07 1530.72,1340.43 1533.03,1326.67 1535.34,1672.43 1537.64,1644.91 1539.95,1633.06 1542.26,1356.83 1544.57,1353.88 1546.88,1232.78 1549.18,1326.9 1551.49,1408.19 1553.8,1496.22 1556.11,1409.49 1558.41,1383.98 1560.72,1532.79 1563.03,1522.34 1565.34,1283.27 1567.65,1413.4 1569.95,1443.51 1572.26,1545.48 1574.57,1587.1 1576.88,1502.89 1579.19,1555.2 1581.49,1352.63 1583.8,1442.97 1586.11,1665.64 1588.42,1371.42 1590.73,1425.16 1593.03,1360.38 1595.34,1155.39 1597.65,1367.64 1599.96,1657.8 1602.26,1466.11 1604.57,1353.56 1606.88,1562.79 1609.19,1515.94 1611.5,1367.3 1613.8,1391.87 1616.11,1447.39 1618.42,1545.28 1620.73,1424.15 1623.04,1686.65 1625.34,1358.98 1627.65,1445.93 1629.96,1407.06 1632.27,1256.49 1634.58,1589.11 1636.88,1342.24 1639.19,1383.38 1641.5,1422.21 1643.81,1548.86 1646.12,1427.91 1648.42,1391.92 1650.73,1399.93 1653.04,1473.32 1655.35,1516.48 1657.65,1467.39 1659.96,1506.78 1662.27,1419.22 1664.58,1383.86 1666.89,1514.73 1669.19,1379.42 1671.5,1257.77 1673.81,1422.96 1676.12,1403.54 1678.43,1441.68 1680.73,1437.22 1683.04,1684.44 1685.35,1614.49 1687.66,1349.38 1689.97,1548.83 1692.27,1510.07 1694.58,1443.75 1696.89,1324.14 1699.2,1366.22 1701.51,1414.36 1703.81,1524.4 1706.12,1486.87 1708.43,1433.6 1710.74,1458.66 1713.04,1490.1 1715.35,1354.85 1717.66,1581.16 1719.97,1335.21 1722.28,1454.48 1724.58,1421.18 1726.89,1490.42 1729.2,1514.44 1731.51,1687.84 1733.82,1562.54 1736.12,1357.24 1738.43,1385.93 1740.74,1444.22 1743.05,1425.17 1745.36,1500.18 1747.66,1336.09 1749.97,1525.23 1752.28,1634.94 1754.59,1399.6 1756.9,1408.76 1759.2,1335.42 1761.51,1381.56 1763.82,1427.41 1766.13,1498.54 1768.43,1375.1 1770.74,1567.18 1773.05,1424.17 1775.36,1380.4 1777.67,1253.8 1779.97,1397.51 1782.28,1418.15 1784.59,1615.24 1786.9,1312.75 1789.21,1424.53 1791.51,1433.82 1793.82,1532.42 1796.13,1539.08 1798.44,1606.5 1800.75,1546.81 1803.05,1591.74 1805.36,1433.98 1807.67,1652.3 1809.98,1465.73 1812.28,1504.26 1814.59,1512.2 1816.9,1405.01 1819.21,1473.68 1821.52,1723.26 1823.82,1409.25 1826.13,1516.19 1828.44,1578.87 1830.75,1363.07 1833.06,1386.76 1835.36,1312.93 1837.67,1427.81 1839.98,1488.08 1842.29,1478.14 1844.6,1593.46 1846.9,1440.72 1849.21,1462.54 1851.52,1604.41 1853.83,1426.99 1856.14,1503.55 1858.44,1403.96 1860.75,1336.62 1863.06,1524.51 1865.37,1411.91 1867.67,1425.17 1869.98,1416.9 1872.29,1488.27 1874.6,1526.23 1876.91,1414.41 1879.21,1465.22 1881.52,1373.77 1883.83,1437.89 1886.14,1432.29 1888.45,1526 1890.75,1419.5 1893.06,1524.11 1895.37,1433.7 1897.68,1485.9 1899.99,1575.29 1902.29,1471.33 1904.6,1446.36 1906.91,1456.59 1909.22,1397.14 1911.53,1586.05 1913.83,1521.25 1916.14,1450.26 1918.45,1459.89 1920.76,1391.68 1923.06,1522.98 1925.37,1272.97 1927.68,1426.21 1929.99,1474.47 1932.3,1411.01 1934.6,1494.51 1936.91,1408.65 1939.22,1506.7 1941.53,1361.35 1943.84,1444.36 1946.14,1426.97 1948.45,1555.81 1950.76,1313.85 1953.07,1425.35 1955.38,1390.18 1957.68,1383.8 1959.99,1263.24 1962.3,1492.38 1964.61,1360.29 1966.91,1500.5 1969.22,1726.28 1971.53,1473.89 1973.84,1572.87 1976.15,1513.36 1978.45,1576.35 1980.76,1443.44 1983.07,1457.73 1985.38,1475.71 1987.69,1513.38 1989.99,1412.18 1992.3,1678.08 1994.61,1497.15 1996.92,1624.55 1999.23,1323.11 2001.53,1510.21 2003.84,1537.59 2006.15,1455.61 2008.46,1435.01 2010.77,1405.73 2013.07,1571.71 2015.38,1522.67 2017.69,1239.32 2020,1426.06 2022.3,1442.18 2024.61,1426.9 2026.92,1520.7 2029.23,1543.23 2031.54,1620.74 2033.84,1394.04 2036.15,1456.06 2038.46,1614.27 2040.77,1334.42 2043.08,1443.17 2045.38,1340.05 2047.69,1333.15 2050,1405.55 2052.31,1492.72 2054.62,1534.56 2056.92,1519.62 2059.23,1507.17 2061.54,1146.2 2063.85,1413.1 2066.16,1481.25 2068.46,1469.94 2070.77,1344.31 2073.08,1467.31 2075.39,1275.08 2077.69,1471.4 2080,1563.75 2082.31,1074.08 2084.62,1350.14 2086.93,1426.24 2089.23,1355.5 2091.54,1458.73 2093.85,1569.55 2096.16,1551.03 2098.47,1484.07 2100.77,1635.55 2103.08,1431.09 2105.39,1590.43 2107.7,1347.92 2110.01,1550.33 2112.31,1451.36 2114.62,1359.49 2116.93,1351.41 2119.24,1484.14 2121.55,1581.79 2123.85,1420.7 2126.16,1528.97 2128.47,1405.85 2130.78,1529.61 2133.08,1412.79 2135.39,1505.87 2137.7,1612.03 2140.01,1601.72 2142.32,1409.45 2144.62,1537.06 2146.93,1348.32 2149.24,1452.03 2151.55,1326.34 2153.86,1408.69 2156.16,1346.57 2158.47,1378.68 2160.78,1404.21 2163.09,1478.15 2165.4,1397.28 2167.7,1562.06 2170.01,1405.86 2172.32,1547.38 2174.63,1318.13 2176.93,1627.6 2179.24,1347.42 2181.55,1496.43 2183.86,1399.18 2186.17,1234.54 2188.47,1255.68 2190.78,1568.11 2193.09,1411.5 2195.4,1447.68 2197.71,1560.76 2200.01,1525.33 2202.32,1373.45 2204.63,1457.5 2206.94,1432.88 2209.25,1396.91 2211.55,1461.36 2213.86,1473.24 2216.17,1412.18 2218.48,1321.46 2220.79,1621.99 2223.09,1384.08 2225.4,1393.93 2227.71,1568.23 2230.02,1367.58 2232.32,1656.59 2234.63,1461.26 2236.94,1413.76 2239.25,1434.25 2241.56,1496.82 2243.86,1471.12 2246.17,1460.92 2248.48,1586.71 2250.79,1484.22 2253.1,1310.99 2255.4,1536.56 2257.71,1344.85 2260.02,1469.31 2262.33,1468.7 2264.64,1438.44 2266.94,1483.01 2269.25,1366.12 2271.56,1545.36 2273.87,1341.52 2276.18,1346.17 2278.48,1381.49 2280.79,1561.43 2283.1,1526.71 2285.41,1486.91 2287.71,1424.04 2290.02,1428.37 2292.33,1307.62 2294.64,1462.25 2296.95,1447.32 2299.25,1653.25 2301.56,1355.91 2303.87,1419.3 2306.18,1568.44 2308.49,1544.03 2310.79,1501.28 2313.1,1372.21 2315.41,1445.24 2317.72,1464.32 2320.03,1495.46 2322.33,1494.05 2324.64,1553.05 2326.95,1299.11 2329.26,1439.86 2331.56,1422.17 2333.87,1574.02 2336.18,1556.27 2338.49,1437.55 2340.8,1416.61 2343.1,1455.8 2345.41,1498.55 2347.72,1275.38 2350.03,1361.31 2352.34,1365.52 2354.64,1572.59 2356.95,1382.37 2359.26,1524.34 2361.57,1427.56 2363.88,1314.09 2366.18,1314.99 2368.49,1348.08 2370.8,1486.77 2373.11,1416.4 2375.42,1441.29 2377.72,1517.74 2380.03,1432.47 2382.34,1483.5 2384.65,1307.36 2386.95,1434.87 2389.26,1457.63 2391.57,1639.03 2393.88,1559.35 2396.19,1400.21 2398.49,1446.94 2400.8,1456.34 2403.11,1473.41 2405.42,1533.21 2407.73,1515.94 2410.03,1280.91 2412.34,1406.48 2414.65,1426.92 2416.96,1393.45 2419.27,1389.08 2421.57,1340.26 2423.88,1431.27 2426.19,1348.99 2428.5,1536.52 2430.81,1372.11 2433.11,1395.5 2435.42,1331.39 2437.73,1342.73 2440.04,1443.76 2442.34,1459.85 2444.65,1571.82 2446.96,1520.88 2449.27,1364.71 2451.58,1563.32 2453.88,1372.56 2456.19,1356.11 2458.5,1349.68 2460.81,1273.55 2463.12,1393.65 2465.42,1413.91 2467.73,1293.25 2470.04,1387.11 2472.35,1437.14 2474.66,1507.07 2476.96,1420.99 2479.27,1368.72 2481.58,1525.63 2483.89,1451.64 2486.2,1645.36 2488.5,1414.89 2490.81,1463.35 2493.12,1401.04 2495.43,1448.08 2497.73,1461.09 2500.04,1577.4 2502.35,1470.67 2504.66,1459.46 2506.97,1467.03 2509.27,1410.14 2511.58,1576.15 2513.89,1588.71 2516.2,1339.94 2518.51,1518.26 2520.81,1457.75 2523.12,1328.48 2525.43,1338.08 2527.74,1362.76 2530.05,1342.57 2532.35,1468.32 2534.66,1531.47 2536.97,1311.51 2539.28,1419.21 2541.58,1652.34 2543.89,1412.15 2546.2,1420.27 2548.51,1465.01 2550.82,1413.97 2553.12,1514.61 2555.43,1419.07 2557.74,1477.13 2560.05,1427.41 2562.36,1373.42 2564.66,1390.02 2566.97,1479.6 2569.28,1602.52 2571.59,1428.47 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1001.97 268.292,956.29 270.6,891.621 272.908,925.604 275.216,929.138 277.524,936.231 279.832,928.831 282.139,1045.92 284.447,863.519 286.755,1073.41 289.063,995.046 291.371,1057.96 293.679,1024.55 295.987,874.94 298.295,788.051 300.603,987.584 302.911,1015.4 305.219,885.598 307.527,1057.4 309.834,878.371 312.142,780.229 314.45,1049.5 316.758,816.562 319.066,973.248 321.374,948.367 323.682,808.481 325.99,977.528 328.298,806.431 330.606,1059.18 332.914,862.064 335.221,1035.04 337.529,925.248 339.837,1002.31 342.145,831.822 344.453,932.431 346.761,812.582 349.069,1048.73 351.377,951.173 353.685,1063.55 355.993,872.588 358.301,977.461 360.608,889.846 362.916,1018.96 365.224,934.513 367.532,815.255 369.84,1016.17 372.148,956.504 374.456,969.568 376.764,894.622 379.072,1062.09 381.38,1135.98 383.688,970.946 385.996,968.284 388.303,864.223 390.611,1035.86 392.919,888.787 395.227,861.117 397.535,1055.4 399.843,1025.43 402.151,1067.1 404.459,888.458 406.767,1071.46 409.075,933.208 411.383,973.187 413.69,860.028 415.998,990.119 418.306,1006.76 420.614,1008.8 422.922,1054.97 425.23,893.504 427.538,1080.44 429.846,1150.03 432.154,955.885 434.462,966.393 436.77,1048.6 439.077,891.808 441.385,1088.5 443.693,936.9 446.001,1080.38 448.309,872.401 450.617,950.193 452.925,975.384 455.233,785.039 457.541,853.462 459.849,935.198 462.157,905.334 464.465,872.549 466.772,1031.6 469.08,892.504 471.388,958.385 473.696,1050.71 476.004,988.787 478.312,1027.6 480.62,911.677 482.928,1048.15 485.236,987.707 487.544,929.326 489.852,1108.23 492.159,1025.19 494.467,856.889 496.775,930.973 499.083,693.506 501.391,870.665 503.699,1075.51 506.007,790.85 508.315,1003.56 510.623,983.443 512.931,1242.34 515.239,928.468 517.546,888.003 519.854,1013.84 522.162,1081.96 524.47,924.394 526.778,930.415 529.086,1016.14 531.394,960.992 533.702,1021.58 536.01,995.075 538.318,897.659 540.626,1099.91 542.933,877.596 545.241,916.753 547.549,822.161 549.857,909.463 552.165,893.538 554.473,970.18 556.781,1011.03 559.089,1078.63 561.397,820.011 563.705,913.686 566.013,960.937 568.321,905.149 570.628,979.363 572.936,975.511 575.244,908.211 577.552,931.373 579.86,1008.64 582.168,945.981 584.476,942.705 586.784,1000.57 589.092,947.593 591.4,979.062 593.708,845.696 596.015,1114.95 598.323,1128.95 600.631,959.288 602.939,997.025 605.247,1026.03 607.555,1025.73 609.863,1075.49 612.171,988.4 614.479,1089.26 616.787,954.785 619.095,909.62 621.402,1153.04 623.71,1118.55 626.018,1020.43 628.326,912.132 630.634,939.36 632.942,1105.74 635.25,1016.03 637.558,1052.94 639.866,978.882 642.174,927.13 644.482,953.957 646.79,751.051 649.097,1169.64 651.405,926.125 653.713,909.25 656.021,1067.42 658.329,911.388 660.637,778.117 662.945,889.826 665.253,949.459 667.561,880.855 669.869,884.616 672.177,859.028 674.484,907.765 676.792,1125.51 679.1,840.994 681.408,947.061 683.716,1033.92 686.024,945.038 688.332,1011.83 690.64,976.884 692.948,1022.62 695.256,945.663 697.564,946.457 699.871,1142.53 702.179,1041 704.487,1038.4 706.795,1039.55 709.103,1012.52 711.411,1147.68 713.719,1004.79 716.027,1031.7 718.335,1031.46 720.643,988.324 722.951,884.346 725.259,1046.02 727.566,967.659 729.874,957.963 732.182,1148 734.49,974.895 736.798,845.175 739.106,905.017 741.414,967.342 743.722,1057.49 746.03,1078.68 748.338,957.241 750.646,844.699 752.953,861.409 755.261,1212.12 757.569,1118.12 759.877,732.213 762.185,1008.13 764.493,752.818 766.801,997.144 769.109,1190.46 771.417,1100.85 773.725,865.453 776.033,944.975 778.34,1086.49 780.648,867.215 782.956,1077.98 785.264,940.41 787.572,873.691 789.88,920.045 792.188,1176.54 794.496,802.571 796.804,931.733 799.112,1061.85 801.42,881.413 803.728,1075.75 806.035,987.92 808.343,992.351 810.651,763.354 812.959,1178.44 815.267,1085.29 817.575,1146.24 819.883,1009.47 822.191,734.482 824.499,1003.35 826.807,848.525 829.115,934.981 831.422,878.627 833.73,1019.66 836.038,958.111 838.346,1070.67 840.654,888.309 842.962,1112.99 845.27,766.491 847.578,905.954 849.886,854.241 852.194,936.082 854.502,857.433 856.809,997.188 859.117,1004.67 861.425,875.087 863.733,895.184 866.041,1164.56 868.349,870.387 870.657,1030.66 872.965,936.583 875.273,815.002 877.581,1047.08 879.889,1012.51 882.197,941.682 884.504,944.348 886.812,953.533 889.12,921.958 891.428,865.632 893.736,1092.41 896.044,1028.74 898.352,982.381 900.66,1005.78 902.968,915.245 905.276,1109.01 907.584,986.43 909.891,945.69 912.199,978.45 914.507,950.104 916.815,1119.28 919.123,829.686 921.431,1227.81 923.739,1076.26 926.047,1000.22 928.355,994.793 930.663,1043.5 932.971,1039.28 935.278,906.129 937.586,903.082 939.894,870.633 942.202,967.69 944.51,931.981 946.818,794.204 949.126,918.895 951.434,1103.59 953.742,1114.81 956.05,816.874 958.358,980.878 960.665,721.993 962.973,820.845 965.281,1058.47 967.589,939.345 969.897,1155.85 972.205,1101.67 974.513,903.798 976.821,1025.26 979.129,1024.92 981.437,838.584 983.745,954.406 986.053,806.876 988.36,875.294 990.668,998.418 992.976,850.993 995.284,980.43 997.592,915.978 999.9,1051.55 1002.21,810.764 1004.52,1011.28 1006.82,822.992 1009.13,931.621 1011.44,892.997 1013.75,912.94 1016.06,868.424 1018.36,810.414 1020.67,1063.05 1022.98,971.624 1025.29,988.094 1027.59,978.914 1029.9,827.031 1032.21,1112 1034.52,972.875 1036.83,942.819 1039.13,1013.42 1041.44,911.087 1043.75,991.232 1046.06,1172.84 1048.37,1046.27 1050.67,824.197 1052.98,1039.47 1055.29,761.884 1057.6,984.717 1059.91,943.183 1062.21,1001.55 1064.52,1106.14 1066.83,765.699 1069.14,880.531 1071.45,957.133 1073.75,983.176 1076.06,974.651 1078.37,845.324 1080.68,1014.38 1082.98,989.269 1085.29,941.488 1087.6,1030.39 1089.91,984.578 1092.22,992.966 1094.52,909.461 1096.83,1072.69 1099.14,1108.05 1101.45,1110.84 1103.76,960.471 1106.06,951.63 1108.37,1015.71 1110.68,1051.51 1112.99,852.798 1115.3,801.608 1117.6,1007.29 1119.91,1065.55 1122.22,975.303 1124.53,1120.91 1126.84,857.745 1129.14,1034.64 1131.45,1030.06 1133.76,961.36 1136.07,961.069 1138.37,732.868 1140.68,733.117 1142.99,950.575 1145.3,981.887 1147.61,1022.38 1149.91,765.529 1152.22,924.039 1154.53,915.2 1156.84,1067.36 1159.15,861.813 1161.45,967.039 1163.76,910.292 1166.07,1050.96 1168.38,937.113 1170.69,1059.42 1172.99,1025.72 1175.3,992.475 1177.61,924.521 1179.92,869.127 1182.23,1125.97 1184.53,956.608 1186.84,852.67 1189.15,890.233 1191.46,1164.31 1193.76,1039.08 1196.07,1134.32 1198.38,905.02 1200.69,859.427 1203,963.357 1205.3,1071.95 1207.61,1019.4 1209.92,866.638 1212.23,971.448 1214.54,993.231 1216.84,1218.88 1219.15,973.292 1221.46,970.316 1223.77,1047.96 1226.08,1048.05 1228.38,860.488 1230.69,989.224 1233,996.419 1235.31,907.31 1237.61,926.671 1239.92,936.258 1242.23,981.247 1244.54,986.66 1246.85,1057.4 1249.15,977.352 1251.46,907.99 1253.77,1052.3 1256.08,1122.73 1258.39,1025.75 1260.69,887.466 1263,919.537 1265.31,828.987 1267.62,987.648 1269.93,893.399 1272.23,990.551 1274.54,1141.23 1276.85,1062.75 1279.16,953.404 1281.47,786.551 1283.77,896.107 1286.08,941.261 1288.39,1076.39 1290.7,1121.91 1293,877.947 1295.31,942.658 1297.62,880.755 1299.93,1071.01 1302.24,934.077 1304.54,946.798 1306.85,938.834 1309.16,1084.95 1311.47,1144.09 1313.78,872.694 1316.08,1100.11 1318.39,882.159 1320.7,979.366 1323.01,975.474 1325.32,959.343 1327.62,1028.93 1329.93,1051.26 1332.24,824.134 1334.55,951.439 1336.86,987.511 1339.16,998.545 1341.47,861.522 1343.78,929.263 1346.09,1043.82 1348.39,931.885 1350.7,1040.24 1353.01,997.252 1355.32,982.814 1357.63,1062.13 1359.93,1050.73 1362.24,975.299 1364.55,820.575 1366.86,830.068 1369.17,686.862 1371.47,1011.33 1373.78,1042.82 1376.09,1036.8 1378.4,938.075 1380.71,1045.5 1383.01,1099.68 1385.32,938.893 1387.63,911.809 1389.94,961.174 1392.24,908.18 1394.55,881.439 1396.86,903.36 1399.17,1028.93 1401.48,1142.78 1403.78,1040.48 1406.09,1019.93 1408.4,1060.33 1410.71,950.358 1413.02,908.904 1415.32,1157.58 1417.63,723.317 1419.94,933.635 1422.25,973.837 1424.56,939.842 1426.86,999.155 1429.17,1066.99 1431.48,796.71 1433.79,1048.42 1436.1,934.955 1438.4,977.712 1440.71,926.663 1443.02,900.909 1445.33,1097.21 1447.63,1069.54 1449.94,1063.64 1452.25,1043.05 1454.56,998.942 1456.87,1036.12 1459.17,893.333 1461.48,1031.76 1463.79,970.03 1466.1,1048.52 1468.41,898.855 1470.71,763.162 1473.02,896.325 1475.33,959.799 1477.64,933.635 1479.95,860.545 1482.25,978.096 1484.56,961.612 1486.87,887.929 1489.18,965.683 1491.49,974.865 1493.79,788.927 1496.1,1100.73 1498.41,949.261 1500.72,913.86 1503.02,1167.28 1505.33,1008.71 1507.64,848.718 1509.95,979.035 1512.26,1025.27 1514.56,970.886 1516.87,988.654 1519.18,984.729 1521.49,912.69 1523.8,987.834 1526.1,944.908 1528.41,808.555 1530.72,1029.09 1533.03,957.372 1535.34,794.295 1537.64,996.224 1539.95,1117.15 1542.26,1066.7 1544.57,1023.85 1546.88,876.453 1549.18,968.875 1551.49,757.701 1553.8,958.036 1556.11,996.699 1558.41,951.403 1560.72,1212.7 1563.03,987.832 1565.34,927.698 1567.65,1016.32 1569.95,981.158 1572.26,921.837 1574.57,1071.89 1576.88,1138.9 1579.19,1096.06 1581.49,990.5 1583.8,934.69 1586.11,922.672 1588.42,933.207 1590.73,964.747 1593.03,785.993 1595.34,992.913 1597.65,1210.72 1599.96,995.456 1602.26,976.26 1604.57,1002.71 1606.88,1032.34 1609.19,1018.1 1611.5,895.309 1613.8,937.179 1616.11,869.106 1618.42,1063.8 1620.73,989.216 1623.04,838.486 1625.34,983.747 1627.65,1067.28 1629.96,727.638 1632.27,894.754 1634.58,939.306 1636.88,906.572 1639.19,880.835 1641.5,703.881 1643.81,1066.89 1646.12,1014.3 1648.42,873.228 1650.73,911.902 1653.04,1046.43 1655.35,1074.21 1657.65,1032.35 1659.96,1024.02 1662.27,867.952 1664.58,822.814 1666.89,954.124 1669.19,824.314 1671.5,967.459 1673.81,785.464 1676.12,1091.66 1678.43,906.448 1680.73,933.111 1683.04,1097.92 1685.35,933.328 1687.66,1039.01 1689.97,871.006 1692.27,1026 1694.58,1021.78 1696.89,863.709 1699.2,982.639 1701.51,870.477 1703.81,1099.71 1706.12,1100.58 1708.43,878.62 1710.74,1145.8 1713.04,959.52 1715.35,957.413 1717.66,972.896 1719.97,843.803 1722.28,947.758 1724.58,913.165 1726.89,1068.45 1729.2,1109.2 1731.51,880.589 1733.82,927.439 1736.12,1035.77 1738.43,1004.44 1740.74,939.205 1743.05,988.964 1745.36,972.929 1747.66,944.773 1749.97,1178.07 1752.28,1128.75 1754.59,918.527 1756.9,829.134 1759.2,844.453 1761.51,872.521 1763.82,1008.63 1766.13,972.676 1768.43,977.148 1770.74,938.953 1773.05,1002.17 1775.36,1020.74 1777.67,1010.78 1779.97,976.141 1782.28,1002.51 1784.59,931.068 1786.9,931.226 1789.21,1149.4 1791.51,1064.38 1793.82,943.562 1796.13,946.849 1798.44,1036.37 1800.75,1034.5 1803.05,1219.63 1805.36,987.473 1807.67,854.603 1809.98,830.799 1812.28,1009.19 1814.59,1061.71 1816.9,1036.56 1819.21,923.487 1821.52,873.06 1823.82,930.872 1826.13,941.687 1828.44,897.869 1830.75,935.264 1833.06,978.127 1835.36,920.627 1837.67,1009.33 1839.98,909.59 1842.29,1091.99 1844.6,799.917 1846.9,1061.16 1849.21,896.583 1851.52,825.514 1853.83,883.396 1856.14,775.256 1858.44,959.503 1860.75,846.371 1863.06,1078.36 1865.37,1036.68 1867.67,1021.77 1869.98,934.35 1872.29,1041.07 1874.6,845.097 1876.91,1129.55 1879.21,967.228 1881.52,1022.9 1883.83,980.709 1886.14,837.382 1888.45,889.727 1890.75,817.391 1893.06,907.099 1895.37,1062.9 1897.68,897.988 1899.99,787.789 1902.29,978.321 1904.6,875.373 1906.91,903.898 1909.22,897.484 1911.53,922.402 1913.83,922.712 1916.14,976.791 1918.45,986.189 1920.76,748.079 1923.06,1009.46 1925.37,867.281 1927.68,1037.12 1929.99,1079.08 1932.3,1004.66 1934.6,980.94 1936.91,931.458 1939.22,982.759 1941.53,1053.18 1943.84,1025.89 1946.14,964.494 1948.45,1075.03 1950.76,1079.28 1953.07,926.411 1955.38,952.059 1957.68,823.055 1959.99,949.644 1962.3,973.896 1964.61,987.076 1966.91,1063.9 1969.22,1121.41 1971.53,916.047 1973.84,728.37 1976.15,867.978 1978.45,908.065 1980.76,888.043 1983.07,937.572 1985.38,1231.1 1987.69,1023.28 1989.99,881.687 1992.3,924.426 1994.61,1035.06 1996.92,1115.22 1999.23,918.789 2001.53,1007.64 2003.84,1047.81 2006.15,980.601 2008.46,879.504 2010.77,865.881 2013.07,1060.43 2015.38,1028.91 2017.69,1010.29 2020,896.767 2022.3,1035.53 2024.61,1031.1 2026.92,976.247 2029.23,930.537 2031.54,897.024 2033.84,1101.89 2036.15,810.117 2038.46,967.197 2040.77,1039.46 2043.08,1089.03 2045.38,950.725 2047.69,1002.54 2050,1047.71 2052.31,919.092 2054.62,1005.07 2056.92,957.289 2059.23,864.06 2061.54,1118.25 2063.85,892.028 2066.16,968.858 2068.46,930.768 2070.77,1035 2073.08,924.768 2075.39,1075.33 2077.69,1051.49 2080,1000.54 2082.31,949.793 2084.62,1065.04 2086.93,854.974 2089.23,896.647 2091.54,847.553 2093.85,832.159 2096.16,966.412 2098.47,1261.4 2100.77,1023.53 2103.08,1003.16 2105.39,847.302 2107.7,971.327 2110.01,990.348 2112.31,994.968 2114.62,1163.44 2116.93,923.546 2119.24,908.577 2121.55,897.871 2123.85,1000.25 2126.16,1080.78 2128.47,1082.7 2130.78,1097.49 2133.08,871.892 2135.39,909.756 2137.7,904.233 2140.01,790.727 2142.32,982.643 2144.62,962.203 2146.93,882.558 2149.24,841.636 2151.55,853.762 2153.86,909.64 2156.16,1031.14 2158.47,1127.08 2160.78,1076.51 2163.09,933.65 2165.4,891.434 2167.7,1013.64 2170.01,946.465 2172.32,957.714 2174.63,1072.06 2176.93,1014.32 2179.24,959.137 2181.55,1020.56 2183.86,905.418 2186.17,866.623 2188.47,757.668 2190.78,919.584 2193.09,975.541 2195.4,1022.54 2197.71,903.838 2200.01,1028.35 2202.32,985.451 2204.63,862.376 2206.94,930.162 2209.25,946.341 2211.55,974.994 2213.86,899.271 2216.17,1025.17 2218.48,1086.93 2220.79,855.147 2223.09,1005.43 2225.4,907.007 2227.71,920.955 2230.02,1001.27 2232.32,948.952 2234.63,971.737 2236.94,992.023 2239.25,1055.5 2241.56,913.177 2243.86,1059.98 2246.17,886.957 2248.48,1036.22 2250.79,843.49 2253.1,949.486 2255.4,859.839 2257.71,935.442 2260.02,857.85 2262.33,1040.08 2264.64,1149.74 2266.94,1135.22 2269.25,893.534 2271.56,1046.17 2273.87,961.313 2276.18,1008.56 2278.48,914.021 2280.79,917.938 2283.1,991.323 2285.41,778.824 2287.71,846.083 2290.02,986.966 2292.33,1011.69 2294.64,1054.82 2296.95,1023.89 2299.25,871.542 2301.56,834.15 2303.87,1087.73 2306.18,979.068 2308.49,905.121 2310.79,985.412 2313.1,1009.7 2315.41,958.865 2317.72,938.341 2320.03,902.214 2322.33,826.561 2324.64,814.627 2326.95,946.132 2329.26,869.454 2331.56,913.728 2333.87,900.81 2336.18,880.131 2338.49,1059.94 2340.8,896.212 2343.1,884.136 2345.41,1061.76 2347.72,771.105 2350.03,875.255 2352.34,951.705 2354.64,856.73 2356.95,895.242 2359.26,1009.64 2361.57,1015.29 2363.88,943.179 2366.18,1068.75 2368.49,809.105 2370.8,995.603 2373.11,995.529 2375.42,929.69 2377.72,810.344 2380.03,873.005 2382.34,867.3 2384.65,876.843 2386.95,930.983 2389.26,702.841 2391.57,903.414 2393.88,993.365 2396.19,906.747 2398.49,957.663 2400.8,984.077 2403.11,1009.64 2405.42,1029.84 2407.73,988.424 2410.03,1091.16 2412.34,1065.48 2414.65,968.089 2416.96,1100.79 2419.27,1100.47 2421.57,941.444 2423.88,915.912 2426.19,981.966 2428.5,828.801 2430.81,1120.54 2433.11,948.736 2435.42,940.909 2437.73,785.584 2440.04,986.631 2442.34,842.096 2444.65,935.12 2446.96,927.863 2449.27,1000.13 2451.58,950.52 2453.88,793.346 2456.19,836.5 2458.5,1010.84 2460.81,876.85 2463.12,877.736 2465.42,1034.1 2467.73,949.72 2470.04,928.681 2472.35,896.996 2474.66,848.903 2476.96,1006.86 2479.27,888.197 2481.58,1120.88 2483.89,942.348 2486.2,1201.04 2488.5,937.887 2490.81,999.353 2493.12,954.043 2495.43,996.014 2497.73,1018.25 2500.04,981.573 2502.35,945.705 2504.66,918.102 2506.97,1006.21 2509.27,1116.85 2511.58,824.761 2513.89,811.161 2516.2,865.171 2518.51,1047.57 2520.81,1066.74 2523.12,1089.16 2525.43,1048.75 2527.74,918.164 2530.05,981.65 2532.35,1026.7 2534.66,1005.56 2536.97,800.638 2539.28,951.923 2541.58,867.326 2543.89,857.32 2546.2,685.802 2548.51,924.541 2550.82,886.649 2553.12,970.341 2555.43,988.185 2557.74,957.474 2560.05,1019.82 2562.36,815.672 2564.66,963.677 2566.97,1060.25 2569.28,1070.31 2571.59,751.265 "></polyline>
<polyline clip-path="url(#clip292)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,799.745 268.292,605.749 270.6,567.8 272.908,276.25 275.216,383.184 277.524,539.392 279.832,334.005 282.139,408.924 284.447,243.205 286.755,500.271 289.063,535.773 291.371,428.453 293.679,463.683 295.987,404.672 298.295,456.535 300.603,548.747 302.911,524.194 305.219,433.007 307.527,486.252 309.834,635.427 312.142,447.101 314.45,508.863 316.758,401.84 319.066,584.169 321.374,526.235 323.682,561.776 325.99,364.744 328.298,517.684 330.606,467.828 332.914,362.12 335.221,388.405 337.529,454.497 339.837,555.969 342.145,492.516 344.453,474.173 346.761,584.217 349.069,544.753 351.377,492.246 353.685,489.913 355.993,451.166 358.301,562.741 360.608,390.351 362.916,453.723 365.224,331.738 367.532,406.565 369.84,538.136 372.148,528.246 374.456,549.288 376.764,539.487 379.072,388.489 381.38,389.495 383.688,428.007 385.996,495.091 388.303,441.873 390.611,419.306 392.919,429.033 395.227,443.597 397.535,366.589 399.843,470.757 402.151,588.83 404.459,567.058 406.767,543.822 409.075,331.75 411.383,268.233 413.69,399.64 415.998,630.235 418.306,461.114 420.614,285.083 422.922,665.426 425.23,457.076 427.538,480.222 429.846,391.105 432.154,471.354 434.462,638.675 436.77,348.56 439.077,337.917 441.385,264.036 443.693,422.629 446.001,566.552 448.309,544.522 450.617,398.691 452.925,337.737 455.233,603.203 457.541,539.762 459.849,406.958 462.157,500.296 464.465,482.406 466.772,403.665 469.08,361.169 471.388,589.627 473.696,442.918 476.004,499.432 478.312,485.099 480.62,473.251 482.928,375.281 485.236,514.072 487.544,359.806 489.852,664.766 492.159,436.599 494.467,606.962 496.775,311.645 499.083,400.638 501.391,339.489 503.699,368.037 506.007,507.75 508.315,550.896 510.623,474.535 512.931,484.445 515.239,530.499 517.546,372.219 519.854,261.619 522.162,499.827 524.47,364.856 526.778,446.949 529.086,578.45 531.394,464.148 533.702,413.793 536.01,387.016 538.318,470.658 540.626,498.994 542.933,535.214 545.241,342.869 547.549,558.85 549.857,284.426 552.165,221.557 554.473,96.8724 556.781,442.458 559.089,407.675 561.397,453.01 563.705,427.742 566.013,567.25 568.321,307.779 570.628,625.063 572.936,546.814 575.244,612.05 577.552,428.622 579.86,571.858 582.168,640.886 584.476,538.458 586.784,433.085 589.092,527.107 591.4,434.245 593.708,267.391 596.015,513.939 598.323,527.627 600.631,419.459 602.939,605.724 605.247,498.349 607.555,486.06 609.863,473.166 612.171,464.39 614.479,618.798 616.787,437.204 619.095,438.355 621.402,337.832 623.71,536.75 626.018,513.268 628.326,314.487 630.634,580.64 632.942,494.455 635.25,482.884 637.558,220.976 639.866,542.499 642.174,519.812 644.482,535.414 646.79,389.01 649.097,447.735 651.405,442.474 653.713,488.228 656.021,399.097 658.329,297.458 660.637,451.207 662.945,253.378 665.253,544.671 667.561,617.079 669.869,442.294 672.177,436.059 674.484,276.658 676.792,460.408 679.1,479.955 681.408,547.123 683.716,392.958 686.024,546.05 688.332,382.14 690.64,362.707 692.948,511.424 695.256,442.723 697.564,493.209 699.871,683.807 702.179,560.525 704.487,547.609 706.795,349.123 709.103,424.485 711.411,541.203 713.719,571.799 716.027,559.56 718.335,378.533 720.643,440.594 722.951,403.046 725.259,333.265 727.566,562.692 729.874,517.204 732.182,638.366 734.49,514.624 736.798,291.642 739.106,544.388 741.414,522.444 743.722,449.288 746.03,514.18 748.338,694.15 750.646,587.12 752.953,640.324 755.261,579.319 757.569,544.325 759.877,428.275 762.185,452.417 764.493,394.056 766.801,409.333 769.109,390.589 771.417,462.765 773.725,313.464 776.033,475.931 778.34,438.117 780.648,421.46 782.956,745.605 785.264,307.185 787.572,485.342 789.88,427.119 792.188,655.957 794.496,391.958 796.804,390.001 799.112,439.498 801.42,520.285 803.728,528.303 806.035,483.088 808.343,470.275 810.651,614.983 812.959,428.893 815.267,438.68 817.575,549.567 819.883,453.715 822.191,505.776 824.499,355.343 826.807,355.539 829.115,318.556 831.422,451.147 833.73,419.644 836.038,507.027 838.346,567.853 840.654,616.474 842.962,591.647 845.27,314.419 847.578,446.705 849.886,526.962 852.194,403.373 854.502,467.375 856.809,414.651 859.117,554.306 861.425,439.461 863.733,484.993 866.041,398.868 868.349,443.024 870.657,481.34 872.965,397.004 875.273,629.757 877.581,649.078 879.889,649.959 882.197,435.499 884.504,538.873 886.812,402.229 889.12,509.443 891.428,585.618 893.736,466.191 896.044,448.995 898.352,519.65 900.66,528.443 902.968,396.274 905.276,470.381 907.584,567.015 909.891,546.422 912.199,386.067 914.507,470.571 916.815,478.667 919.123,649.05 921.431,567.046 923.739,407.188 926.047,623.037 928.355,485.512 930.663,460.607 932.971,576.594 935.278,526.325 937.586,432.947 939.894,301.131 942.202,411.898 944.51,463.436 946.818,482.266 949.126,515.252 951.434,383.981 953.742,334.204 956.05,611.233 958.358,660.533 960.665,538.046 962.973,572.017 965.281,531.786 967.589,520.275 969.897,388.2 972.205,422.007 974.513,329.967 976.821,516.004 979.129,685.767 981.437,455.621 983.745,433.882 986.053,494.797 988.36,418.793 990.668,413.957 992.976,437.038 995.284,503.637 997.592,434.487 999.9,357.13 1002.21,460.943 1004.52,300.592 1006.82,468.206 1009.13,416.551 1011.44,262.791 1013.75,550.296 1016.06,492.683 1018.36,699.674 1020.67,457.408 1022.98,497.387 1025.29,475.267 1027.59,473.93 1029.9,377.785 1032.21,477.948 1034.52,488.315 1036.83,304.296 1039.13,432.635 1041.44,353.516 1043.75,499.683 1046.06,304.15 1048.37,296.199 1050.67,579.781 1052.98,414.133 1055.29,394.963 1057.6,417.121 1059.91,564.938 1062.21,559.138 1064.52,418.174 1066.83,574.82 1069.14,417.093 1071.45,595.748 1073.75,447.985 1076.06,573.283 1078.37,482.894 1080.68,513.046 1082.98,355.761 1085.29,502.116 1087.6,273.035 1089.91,440.028 1092.22,641.156 1094.52,459.533 1096.83,378.435 1099.14,260.162 1101.45,473.938 1103.76,323.467 1106.06,592.787 1108.37,430.289 1110.68,556.885 1112.99,480.521 1115.3,562.937 1117.6,489.374 1119.91,641.369 1122.22,465.448 1124.53,335.063 1126.84,429.184 1129.14,527.409 1131.45,522.97 1133.76,512.971 1136.07,414.056 1138.37,618.12 1140.68,549.014 1142.99,341.252 1145.3,486.455 1147.61,451.863 1149.91,539.042 1152.22,413.153 1154.53,504.299 1156.84,520.842 1159.15,570.783 1161.45,571.725 1163.76,224.921 1166.07,433.794 1168.38,598.775 1170.69,400.583 1172.99,393.196 1175.3,398.623 1177.61,635.505 1179.92,559.328 1182.23,440.646 1184.53,622.716 1186.84,472.313 1189.15,531.281 1191.46,512.059 1193.76,435.247 1196.07,498.847 1198.38,486.926 1200.69,648.715 1203,330.999 1205.3,527.217 1207.61,536.3 1209.92,658.775 1212.23,562.21 1214.54,273.186 1216.84,329.225 1219.15,485.609 1221.46,407.767 1223.77,429.423 1226.08,476.453 1228.38,501.515 1230.69,556.619 1233,512.368 1235.31,452.042 1237.61,519.008 1239.92,200.769 1242.23,503.173 1244.54,342.626 1246.85,568.98 1249.15,564.56 1251.46,349.206 1253.77,527.982 1256.08,593.813 1258.39,433.657 1260.69,402.377 1263,653.555 1265.31,381.034 1267.62,410.742 1269.93,404.433 1272.23,515.643 1274.54,280.372 1276.85,484.724 1279.16,332.559 1281.47,402.662 1283.77,438.287 1286.08,316.944 1288.39,405.993 1290.7,432.821 1293,562.884 1295.31,365.237 1297.62,547.779 1299.93,442.249 1302.24,438.895 1304.54,447.212 1306.85,655.559 1309.16,490.67 1311.47,536.963 1313.78,391.064 1316.08,428.098 1318.39,620.633 1320.7,373.561 1323.01,294.276 1325.32,615.623 1327.62,485.692 1329.93,579.087 1332.24,297.668 1334.55,426.241 1336.86,357.56 1339.16,557.544 1341.47,527.444 1343.78,488.431 1346.09,611.185 1348.39,479.501 1350.7,455.559 1353.01,546.37 1355.32,522.113 1357.63,396.451 1359.93,304.443 1362.24,475.756 1364.55,541.862 1366.86,554.591 1369.17,490.448 1371.47,438.815 1373.78,347.115 1376.09,386.999 1378.4,418.412 1380.71,453.852 1383.01,507.218 1385.32,397.912 1387.63,507.649 1389.94,436.147 1392.24,398.129 1394.55,295.534 1396.86,597.379 1399.17,437.101 1401.48,389.039 1403.78,648.09 1406.09,465.712 1408.4,499.79 1410.71,655.916 1413.02,480.109 1415.32,415.985 1417.63,411.498 1419.94,503.851 1422.25,561.291 1424.56,187.299 1426.86,379.594 1429.17,401.866 1431.48,373.241 1433.79,562.933 1436.1,309.511 1438.4,353.805 1440.71,400.043 1443.02,411.193 1445.33,440.268 1447.63,427.366 1449.94,556.295 1452.25,536.186 1454.56,508.565 1456.87,396.719 1459.17,365.149 1461.48,344.25 1463.79,560.241 1466.1,580.676 1468.41,420.573 1470.71,447.389 1473.02,490.615 1475.33,461.327 1477.64,530.447 1479.95,321.735 1482.25,392.703 1484.56,473.864 1486.87,529.566 1489.18,621.11 1491.49,561.377 1493.79,464.79 1496.1,310.772 1498.41,528.541 1500.72,489.946 1503.02,355.172 1505.33,542.684 1507.64,506.414 1509.95,536.093 1512.26,507.223 1514.56,578.615 1516.87,625.665 1519.18,448.964 1521.49,423.528 1523.8,445.043 1526.1,585.448 1528.41,498.494 1530.72,525.791 1533.03,484.918 1535.34,486.936 1537.64,498.175 1539.95,376.508 1542.26,364.795 1544.57,338.681 1546.88,557.328 1549.18,580.735 1551.49,591.676 1553.8,360.888 1556.11,639.75 1558.41,595.014 1560.72,468.489 1563.03,446.926 1565.34,486.468 1567.65,240.61 1569.95,482.214 1572.26,524.483 1574.57,489.169 1576.88,626.041 1579.19,519.163 1581.49,544.253 1583.8,251.773 1586.11,591.91 1588.42,386.527 1590.73,335.851 1593.03,357.888 1595.34,470.849 1597.65,355.803 1599.96,510.048 1602.26,608.766 1604.57,552.209 1606.88,411.607 1609.19,490.969 1611.5,423.745 1613.8,475.227 1616.11,414.405 1618.42,511.39 1620.73,519.934 1623.04,708.124 1625.34,410.316 1627.65,567.002 1629.96,416.376 1632.27,290.419 1634.58,700.828 1636.88,511.987 1639.19,401.536 1641.5,397.538 1643.81,474.458 1646.12,424.685 1648.42,445.407 1650.73,367.847 1653.04,426.272 1655.35,465.573 1657.65,383.444 1659.96,347.36 1662.27,368.486 1664.58,568.401 1666.89,504.324 1669.19,460.138 1671.5,369.1 1673.81,424.47 1676.12,532.061 1678.43,366.869 1680.73,503.559 1683.04,541.474 1685.35,375.525 1687.66,508.765 1689.97,441.957 1692.27,372.313 1694.58,510.635 1696.89,518.594 1699.2,349.804 1701.51,458.101 1703.81,604.746 1706.12,482.357 1708.43,649.456 1710.74,282.202 1713.04,490.475 1715.35,389.729 1717.66,426.732 1719.97,308.876 1722.28,607.852 1724.58,433.513 1726.89,318.412 1729.2,507.267 1731.51,410.357 1733.82,438.214 1736.12,543.957 1738.43,521.169 1740.74,327.135 1743.05,608.71 1745.36,612.723 1747.66,578.401 1749.97,429.309 1752.28,593.759 1754.59,676.366 1756.9,425.83 1759.2,595.504 1761.51,480.134 1763.82,558.71 1766.13,567.225 1768.43,544.892 1770.74,549.37 1773.05,323.454 1775.36,698.363 1777.67,542.076 1779.97,360.624 1782.28,565.892 1784.59,454.238 1786.9,481.936 1789.21,439.544 1791.51,478.411 1793.82,444.769 1796.13,513.52 1798.44,453.661 1800.75,678.233 1803.05,389.62 1805.36,418.132 1807.67,484.687 1809.98,588.743 1812.28,447.129 1814.59,477.79 1816.9,511.082 1819.21,449.954 1821.52,544.315 1823.82,454.715 1826.13,507.858 1828.44,560.648 1830.75,542.085 1833.06,656.883 1835.36,385.188 1837.67,540.715 1839.98,463.035 1842.29,377.13 1844.6,461.606 1846.9,396.522 1849.21,551.295 1851.52,377.106 1853.83,592.684 1856.14,771.06 1858.44,512.55 1860.75,482.078 1863.06,327.333 1865.37,463.131 1867.67,438.986 1869.98,470.059 1872.29,428.367 1874.6,577.796 1876.91,437.761 1879.21,442.821 1881.52,271.555 1883.83,284.268 1886.14,573.505 1888.45,232.386 1890.75,456.292 1893.06,454.973 1895.37,592.219 1897.68,375.842 1899.99,462.436 1902.29,484.828 1904.6,302.574 1906.91,356.075 1909.22,404.664 1911.53,592.164 1913.83,625.947 1916.14,429.911 1918.45,439.521 1920.76,581.489 1923.06,644.555 1925.37,356.798 1927.68,503.049 1929.99,507.047 1932.3,461.706 1934.6,415.655 1936.91,350.018 1939.22,527.447 1941.53,696.742 1943.84,633.955 1946.14,449.353 1948.45,593.213 1950.76,579.133 1953.07,507.964 1955.38,434.956 1957.68,305.046 1959.99,591.936 1962.3,451.251 1964.61,537.85 1966.91,535.775 1969.22,342.305 1971.53,366.9 1973.84,435.724 1976.15,448.274 1978.45,432.367 1980.76,381.187 1983.07,361.665 1985.38,606.858 1987.69,455.695 1989.99,413.995 1992.3,441.771 1994.61,291.971 1996.92,283.342 1999.23,526.791 2001.53,514.602 2003.84,666.362 2006.15,502.135 2008.46,622.23 2010.77,408.397 2013.07,538.832 2015.38,538.624 2017.69,359.325 2020,503.052 2022.3,380.885 2024.61,608.165 2026.92,491.399 2029.23,399.424 2031.54,427.716 2033.84,460.54 2036.15,543.269 2038.46,560.807 2040.77,477.065 2043.08,418.012 2045.38,494.43 2047.69,408.905 2050,395.828 2052.31,304.955 2054.62,323.003 2056.92,579.274 2059.23,444.571 2061.54,553.729 2063.85,472.87 2066.16,353.791 2068.46,556.125 2070.77,389.781 2073.08,349.056 2075.39,477.924 2077.69,498.77 2080,586.697 2082.31,603.446 2084.62,435.717 2086.93,690.238 2089.23,525.81 2091.54,570.828 2093.85,499.658 2096.16,542.562 2098.47,347.494 2100.77,482.273 2103.08,304.009 2105.39,411.496 2107.7,333.703 2110.01,483.89 2112.31,517.415 2114.62,523.045 2116.93,459.595 2119.24,365.476 2121.55,263.501 2123.85,511.981 2126.16,466.819 2128.47,531.12 2130.78,406.221 2133.08,483.663 2135.39,362.381 2137.7,368.012 2140.01,520.701 2142.32,433.377 2144.62,401.031 2146.93,506.411 2149.24,483.721 2151.55,594.883 2153.86,525.054 2156.16,430.74 2158.47,298.386 2160.78,331.53 2163.09,458.436 2165.4,331.871 2167.7,440.671 2170.01,457.77 2172.32,277.919 2174.63,361.862 2176.93,405.796 2179.24,508.49 2181.55,308.591 2183.86,270.664 2186.17,550.013 2188.47,540.046 2190.78,405.032 2193.09,593.165 2195.4,684.494 2197.71,554.857 2200.01,479.267 2202.32,414.256 2204.63,410.63 2206.94,546.99 2209.25,316.451 2211.55,423.579 2213.86,515.416 2216.17,662.288 2218.48,317.229 2220.79,563.652 2223.09,604.033 2225.4,330.201 2227.71,401.126 2230.02,353.721 2232.32,434.177 2234.63,433.583 2236.94,710.915 2239.25,573.691 2241.56,484.416 2243.86,289.448 2246.17,473.762 2248.48,339.632 2250.79,453.515 2253.1,371.867 2255.4,399.125 2257.71,479.818 2260.02,332.339 2262.33,456.976 2264.64,517.073 2266.94,484.126 2269.25,380.555 2271.56,558.764 2273.87,235.359 2276.18,589.084 2278.48,419.841 2280.79,221.725 2283.1,491.444 2285.41,533.645 2287.71,409.585 2290.02,556.373 2292.33,381.578 2294.64,493.297 2296.95,556.896 2299.25,397.053 2301.56,477.942 2303.87,543.549 2306.18,437.275 2308.49,360.084 2310.79,237.071 2313.1,433.582 2315.41,540.493 2317.72,542.307 2320.03,517.088 2322.33,594.93 2324.64,345.97 2326.95,550.372 2329.26,430.515 2331.56,605.83 2333.87,608.809 2336.18,441.081 2338.49,421.655 2340.8,586.538 2343.1,461.905 2345.41,575.878 2347.72,514.513 2350.03,284.407 2352.34,606.243 2354.64,477.595 2356.95,477.165 2359.26,417.639 2361.57,584.725 2363.88,607.965 2366.18,557.61 2368.49,471.669 2370.8,412.301 2373.11,499.724 2375.42,630.412 2377.72,504.19 2380.03,397.364 2382.34,396.611 2384.65,625.061 2386.95,415.407 2389.26,534.829 2391.57,445.458 2393.88,370.745 2396.19,382.156 2398.49,431.253 2400.8,381.924 2403.11,628.221 2405.42,593.449 2407.73,360.249 2410.03,547.237 2412.34,455.42 2414.65,483.72 2416.96,515.455 2419.27,464.039 2421.57,470.581 2423.88,373.355 2426.19,508.705 2428.5,399.571 2430.81,364.784 2433.11,509.158 2435.42,474.964 2437.73,499.568 2440.04,402.383 2442.34,598.579 2444.65,499.512 2446.96,290.113 2449.27,477.788 2451.58,565.586 2453.88,535.799 2456.19,421.148 2458.5,691.869 2460.81,521.455 2463.12,588.036 2465.42,441.664 2467.73,434.883 2470.04,349.348 2472.35,505.141 2474.66,360.735 2476.96,532.209 2479.27,623.811 2481.58,424.993 2483.89,475.136 2486.2,461.993 2488.5,350.297 2490.81,453.256 2493.12,707.592 2495.43,667.171 2497.73,619.363 2500.04,408.544 2502.35,405.862 2504.66,432.178 2506.97,472.374 2509.27,477.101 2511.58,558.777 2513.89,471.87 2516.2,498.891 2518.51,338.373 2520.81,355.205 2523.12,572.661 2525.43,493.227 2527.74,457.407 2530.05,592.769 2532.35,452.787 2534.66,568.149 2536.97,401.025 2539.28,557.365 2541.58,519.345 2543.89,567.888 2546.2,473.182 2548.51,411.77 2550.82,496.009 2553.12,346.905 2555.43,561.552 2557.74,570.193 2560.05,430.641 2562.36,538.721 2564.66,422.012 2566.97,496.617 2569.28,552.147 2571.59,398.62 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -3.27641   -4.83862   -5.69115  …  -5.58099   -4.91035   -4.91035
 -0.424041   0.825206   1.54953     -0.242696  -0.725046  -0.725046
  4.87107    3.02883    4.06046      4.47479    4.22444    4.22444

[:, :, 2] =
 -1.98246   -4.06091   -4.52011   …  -5.39161   -5.07525   -3.97328
  0.476469   0.153247   0.221315      0.539121   0.732757  -2.75167
  1.65382    2.52312    5.8834        3.0259     4.67532    3.86027

[:, :, 3] =
 -2.73713   -2.64352   -5.32939   -6.03767  …  -6.33871   -4.70806  -5.47905
  0.358834  -0.844318   0.997496   0.4776      -0.735373  -2.1612   -0.83551
  1.74149    3.44783    5.11587    4.93068      6.7299     6.91348   7.21537

[:, :, 4] =
 -3.48004   -3.88685   -3.04783  -5.2917   …  -5.19422  -6.18057   -5.84523
  0.862627  -0.225651  -1.34868  -2.74587     -1.65237   0.818445   0.972752
  1.61023    2.99452    2.36956   4.61076      3.84365   4.28982    4.23832</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.99129   0.998009
  0.015192  1.00711
  4.99471   0.988272</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.53 seconds
Compute duration  = 2.53 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -4.9939    1.0142    0.0190   2863.4667   4701.4887    1.0006   ⋯
        x[2]    0.0019    0.9961    0.0167   3552.5581   5184.2352    0.9999   ⋯
        x[3]    4.9785    1.0063    0.0178   3185.5700   5237.6024    1.0002   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -6.9625   -5.6771   -5.0022   -4.3184   -3.0333
        x[2]   -1.9791   -0.6771   -0.0082    0.6824    1.9248
        x[3]    3.0284    4.3010    4.9816    5.6557    6.9530</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.47 seconds
Compute duration  = 1.47 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.5045    0.1880    0.0027   4639.0524   5693.6502    1.0000   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1493    0.3663    0.5067    0.6468    0.8505</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.23 seconds
Compute duration  = 0.23 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

           x    0.4769    0.1552    0.0137   106.7625    43.8456    1.0245     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.2300    0.3490    0.4744    0.5929    0.7452</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(-1.2081467284240475, "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with -1.2081467284240475:
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/nmUhn/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/compiler.jl:579 [inlined]
  [7] demo(__model__::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, __varinfo__::DynamicPPL.ThreadSafeVarInfo{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, Vector{Base.RefValue{Float64}}}, __context__::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:593
  [8] _evaluate!!
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:973 [inlined]
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, context::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:962
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:892 [inlined]
 [11] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/values_as_in_model.jl:196 [inlined]
 [12] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/values_as_in_model.jl:195 [inlined]
 [13] getparams(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:343
 [14] Turing.Inference.Transition(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, t::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:226
 [15] transition_to_turing
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:12 [inlined]
 [16] transition_to_turing(f::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, transition::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:17
 [17] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}; initial_state::Nothing, initial_params::Nothing, kwargs::@Kwargs{})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:141
 [18] step
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:96 [inlined]
 [19] macro expansion
    @ ~/.julia/packages/AbstractMCMC/YrmkI/src/sample.jl:130 [inlined]
 [20] macro expansion
    @ ~/.julia/packages/AbstractMCMC/YrmkI/src/logging.jl:16 [inlined]
 [21] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/YrmkI/src/sample.jl:120
 [22] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/MjWTB/src/sampler.jl:93
 [23] sample
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/sampler.jl:83 [inlined]
 [24] #sample#4
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:276 [inlined]
 [25] sample
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:267 [inlined]
 [26] #sample#3
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:264 [inlined]
 [27] top-level scope
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:595</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.61 seconds
Compute duration  = 1.61 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8039    0.5773    0.0489    78.7343    26.0514    1.0359     ⋯
           x    0.0229    0.8616    0.0353   731.4445   494.1693    1.0080     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1374    0.3188    0.6971    1.1478    2.1787
           x   -1.8290   -0.3587   -0.0594    0.3937    2.0924</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.95 seconds
Compute duration  = 2.95 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8626    0.5425    0.0188   633.0766   365.2720    1.0026     ⋯
           x   -0.0415    0.9715    0.0434   596.3575   427.6431    1.0001     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1531    0.4275    0.7474    1.1981    2.1261
           x   -2.2556   -0.4609   -0.0232    0.3922    2.2366</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>