<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../tutorials/docs-07-for-developers-variational-inference/index.html" rel="prev">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/docs-00-getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/00-introduction/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.34" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.34</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.34">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Documentation</li><li class="breadcrumb-item"><a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html">Developers: Inference</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Documentation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Using Turing - Modelling Syntax and Interface</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-00-getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-14-using-turing-quick-start/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quick Start</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-12-using-turing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-09-using-turing-advanced/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced Usage</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-10-using-turing-autodiff/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-13-using-turing-performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-11-using-turing-dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-15-using-turing-sampler-viz/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-16-using-turing-external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Using Turing - Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/00-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Turing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/01-gaussian-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/02-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/03-bayesian-neural-network/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/04-hidden-markov-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/05-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/06-infinite-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/07-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/08-multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/09-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/10-bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/11-probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/13-seasonal-time-series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/15-gaussian-processes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Gaussian Processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/12-gplvm/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Developers: Contributing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-01-contributing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to Contribute</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Developers: PPL</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-05-for-developers-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/14-minituring/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/16-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-06-for-developers-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers: Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Documentation</li><li class="breadcrumb-item"><a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html">Developers: Inference</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-19.469360549518466</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-19.469360549518466</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([0.0, 0.0, 0.0]), MALAState{Vector{Float64}}([0.0, 0.0, 0.0]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -2.32767  -4.15034   -4.07534  -4.07534  …  -3.63162   -3.66028  -3.66028
 -1.13002  -0.787035  -0.13344  -0.13344     -0.599306   1.20169   1.20169
  3.15449   4.84603    4.77652   4.77652      4.06322    4.27933   4.27933</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -5.01136    0.993741
  0.0135119  1.02126
  5.01681    0.996196</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip570">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip570)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip571">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip570)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip572">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip572)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip572)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip572)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip572)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip572)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip572)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1629.28 2640.76,1629.28 "></polyline>
<polyline clip-path="url(#clip572)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1390.06 2640.76,1390.06 "></polyline>
<polyline clip-path="url(#clip572)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1150.83 2640.76,1150.83 "></polyline>
<polyline clip-path="url(#clip572)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,911.608 2640.76,911.608 "></polyline>
<polyline clip-path="url(#clip572)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,672.382 2640.76,672.382 "></polyline>
<polyline clip-path="url(#clip572)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,433.157 2640.76,433.157 "></polyline>
<polyline clip-path="url(#clip572)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,193.932 2640.76,193.932 "></polyline>
<polyline clip-path="url(#clip570)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip570)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip570)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip570)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip570)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip570)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip570)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip570)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip570)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1629.28 215.714,1629.28 "></polyline>
<polyline clip-path="url(#clip570)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1390.06 215.714,1390.06 "></polyline>
<polyline clip-path="url(#clip570)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1150.83 215.714,1150.83 "></polyline>
<polyline clip-path="url(#clip570)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,911.608 215.714,911.608 "></polyline>
<polyline clip-path="url(#clip570)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,672.382 215.714,672.382 "></polyline>
<polyline clip-path="url(#clip570)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,433.157 215.714,433.157 "></polyline>
<polyline clip-path="url(#clip570)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,193.932 215.714,193.932 "></polyline>
<path clip-path="url(#clip570)" d="M50.5475 1629.73 L80.2233 1629.73 L80.2233 1633.67 L50.5475 1633.67 L50.5475 1629.73 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M89.1352 1612 L111.357 1612 L111.357 1613.99 L98.8111 1646.56 L93.9269 1646.56 L105.732 1615.94 L89.1352 1615.94 L89.1352 1612 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M120.478 1640.68 L125.362 1640.68 L125.362 1646.56 L120.478 1646.56 L120.478 1640.68 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M135.593 1612 L153.95 1612 L153.95 1615.94 L139.876 1615.94 L139.876 1624.41 Q140.894 1624.06 141.913 1623.9 Q142.931 1623.72 143.95 1623.72 Q149.737 1623.72 153.116 1626.89 Q156.496 1630.06 156.496 1635.48 Q156.496 1641.05 153.024 1644.16 Q149.552 1647.23 143.232 1647.23 Q141.056 1647.23 138.788 1646.86 Q136.542 1646.49 134.135 1645.75 L134.135 1641.05 Q136.218 1642.19 138.441 1642.74 Q140.663 1643.3 143.14 1643.3 Q147.144 1643.3 149.482 1641.19 Q151.82 1639.09 151.82 1635.48 Q151.82 1631.86 149.482 1629.76 Q147.144 1627.65 143.14 1627.65 Q141.265 1627.65 139.39 1628.07 Q137.538 1628.48 135.593 1629.36 L135.593 1612 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M49.5521 1390.51 L79.2279 1390.51 L79.2279 1394.44 L49.5521 1394.44 L49.5521 1390.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M89.3667 1372.78 L107.723 1372.78 L107.723 1376.71 L93.6491 1376.71 L93.6491 1385.19 Q94.6676 1384.84 95.6861 1384.68 Q96.7047 1384.49 97.7232 1384.49 Q103.51 1384.49 106.89 1387.66 Q110.269 1390.83 110.269 1396.25 Q110.269 1401.83 106.797 1404.93 Q103.325 1408.01 97.0056 1408.01 Q94.8297 1408.01 92.5612 1407.64 Q90.3158 1407.27 87.9084 1406.53 L87.9084 1401.83 Q89.9917 1402.96 92.2139 1403.52 Q94.4361 1404.07 96.913 1404.07 Q100.918 1404.07 103.256 1401.97 Q105.593 1399.86 105.593 1396.25 Q105.593 1392.64 103.256 1390.53 Q100.918 1388.43 96.913 1388.43 Q95.038 1388.43 93.163 1388.84 Q91.3112 1389.26 89.3667 1390.14 L89.3667 1372.78 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M119.482 1401.46 L124.367 1401.46 L124.367 1407.34 L119.482 1407.34 L119.482 1401.46 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M144.552 1375.86 Q140.941 1375.86 139.112 1379.42 Q137.306 1382.96 137.306 1390.09 Q137.306 1397.2 139.112 1400.76 Q140.941 1404.31 144.552 1404.31 Q148.186 1404.31 149.991 1400.76 Q151.82 1397.2 151.82 1390.09 Q151.82 1382.96 149.991 1379.42 Q148.186 1375.86 144.552 1375.86 M144.552 1372.15 Q150.362 1372.15 153.417 1376.76 Q156.496 1381.34 156.496 1390.09 Q156.496 1398.82 153.417 1403.43 Q150.362 1408.01 144.552 1408.01 Q138.741 1408.01 135.663 1403.43 Q132.607 1398.82 132.607 1390.09 Q132.607 1381.34 135.663 1376.76 Q138.741 1372.15 144.552 1372.15 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M50.5475 1151.28 L80.2233 1151.28 L80.2233 1155.22 L50.5475 1155.22 L50.5475 1151.28 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M94.3436 1164.18 L110.663 1164.18 L110.663 1168.11 L88.7186 1168.11 L88.7186 1164.18 Q91.3806 1161.42 95.9639 1156.79 Q100.57 1152.14 101.751 1150.8 Q103.996 1148.28 104.876 1146.54 Q105.779 1144.78 105.779 1143.09 Q105.779 1140.34 103.834 1138.6 Q101.913 1136.86 98.8111 1136.86 Q96.6121 1136.86 94.1584 1137.63 Q91.7278 1138.39 88.9501 1139.94 L88.9501 1135.22 Q91.7741 1134.09 94.2278 1133.51 Q96.6815 1132.93 98.7185 1132.93 Q104.089 1132.93 107.283 1135.61 Q110.478 1138.3 110.478 1142.79 Q110.478 1144.92 109.668 1146.84 Q108.881 1148.74 106.774 1151.33 Q106.195 1152 103.094 1155.22 Q99.9917 1158.41 94.3436 1164.18 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M120.478 1162.23 L125.362 1162.23 L125.362 1168.11 L120.478 1168.11 L120.478 1162.23 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M135.593 1133.55 L153.95 1133.55 L153.95 1137.49 L139.876 1137.49 L139.876 1145.96 Q140.894 1145.61 141.913 1145.45 Q142.931 1145.27 143.95 1145.27 Q149.737 1145.27 153.116 1148.44 Q156.496 1151.61 156.496 1157.03 Q156.496 1162.6 153.024 1165.71 Q149.552 1168.78 143.232 1168.78 Q141.056 1168.78 138.788 1168.41 Q136.542 1168.04 134.135 1167.3 L134.135 1162.6 Q136.218 1163.74 138.441 1164.29 Q140.663 1164.85 143.14 1164.85 Q147.144 1164.85 149.482 1162.74 Q151.82 1160.64 151.82 1157.03 Q151.82 1153.41 149.482 1151.31 Q147.144 1149.2 143.14 1149.2 Q141.265 1149.2 139.39 1149.62 Q137.538 1150.03 135.593 1150.91 L135.593 1133.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M99.3204 897.406 Q95.7093 897.406 93.8806 900.971 Q92.075 904.513 92.075 911.642 Q92.075 918.749 93.8806 922.314 Q95.7093 925.855 99.3204 925.855 Q102.955 925.855 104.76 922.314 Q106.589 918.749 106.589 911.642 Q106.589 904.513 104.76 900.971 Q102.955 897.406 99.3204 897.406 M99.3204 893.703 Q105.131 893.703 108.186 898.309 Q111.265 902.892 111.265 911.642 Q111.265 920.369 108.186 924.976 Q105.131 929.559 99.3204 929.559 Q93.5102 929.559 90.4315 924.976 Q87.376 920.369 87.376 911.642 Q87.376 902.892 90.4315 898.309 Q93.5102 893.703 99.3204 893.703 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M119.482 923.008 L124.367 923.008 L124.367 928.888 L119.482 928.888 L119.482 923.008 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M144.552 897.406 Q140.941 897.406 139.112 900.971 Q137.306 904.513 137.306 911.642 Q137.306 918.749 139.112 922.314 Q140.941 925.855 144.552 925.855 Q148.186 925.855 149.991 922.314 Q151.82 918.749 151.82 911.642 Q151.82 904.513 149.991 900.971 Q148.186 897.406 144.552 897.406 M144.552 893.703 Q150.362 893.703 153.417 898.309 Q156.496 902.892 156.496 911.642 Q156.496 920.369 153.417 924.976 Q150.362 929.559 144.552 929.559 Q138.741 929.559 135.663 924.976 Q132.607 920.369 132.607 911.642 Q132.607 902.892 135.663 898.309 Q138.741 893.703 144.552 893.703 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M94.3436 685.727 L110.663 685.727 L110.663 689.662 L88.7186 689.662 L88.7186 685.727 Q91.3806 682.973 95.9639 678.343 Q100.57 673.69 101.751 672.348 Q103.996 669.825 104.876 668.088 Q105.779 666.329 105.779 664.639 Q105.779 661.885 103.834 660.149 Q101.913 658.413 98.8111 658.413 Q96.6121 658.413 94.1584 659.176 Q91.7278 659.94 88.9501 661.491 L88.9501 656.769 Q91.7741 655.635 94.2278 655.056 Q96.6815 654.477 98.7185 654.477 Q104.089 654.477 107.283 657.163 Q110.478 659.848 110.478 664.338 Q110.478 666.468 109.668 668.389 Q108.881 670.287 106.774 672.88 Q106.195 673.551 103.094 676.769 Q99.9917 679.963 94.3436 685.727 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M120.478 683.783 L125.362 683.783 L125.362 689.662 L120.478 689.662 L120.478 683.783 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M135.593 655.102 L153.95 655.102 L153.95 659.038 L139.876 659.038 L139.876 667.51 Q140.894 667.162 141.913 667 Q142.931 666.815 143.95 666.815 Q149.737 666.815 153.116 669.987 Q156.496 673.158 156.496 678.574 Q156.496 684.153 153.024 687.255 Q149.552 690.334 143.232 690.334 Q141.056 690.334 138.788 689.963 Q136.542 689.593 134.135 688.852 L134.135 684.153 Q136.218 685.287 138.441 685.843 Q140.663 686.398 143.14 686.398 Q147.144 686.398 149.482 684.292 Q151.82 682.186 151.82 678.574 Q151.82 674.963 149.482 672.857 Q147.144 670.75 143.14 670.75 Q141.265 670.75 139.39 671.167 Q137.538 671.584 135.593 672.463 L135.593 655.102 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M89.3667 415.877 L107.723 415.877 L107.723 419.812 L93.6491 419.812 L93.6491 428.284 Q94.6676 427.937 95.6861 427.775 Q96.7047 427.59 97.7232 427.59 Q103.51 427.59 106.89 430.761 Q110.269 433.933 110.269 439.349 Q110.269 444.928 106.797 448.03 Q103.325 451.108 97.0056 451.108 Q94.8297 451.108 92.5612 450.738 Q90.3158 450.368 87.9084 449.627 L87.9084 444.928 Q89.9917 446.062 92.2139 446.618 Q94.4361 447.173 96.913 447.173 Q100.918 447.173 103.256 445.067 Q105.593 442.96 105.593 439.349 Q105.593 435.738 103.256 433.632 Q100.918 431.525 96.913 431.525 Q95.038 431.525 93.163 431.942 Q91.3112 432.358 89.3667 433.238 L89.3667 415.877 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M119.482 444.557 L124.367 444.557 L124.367 450.437 L119.482 450.437 L119.482 444.557 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M144.552 418.956 Q140.941 418.956 139.112 422.521 Q137.306 426.062 137.306 433.192 Q137.306 440.298 139.112 443.863 Q140.941 447.405 144.552 447.405 Q148.186 447.405 149.991 443.863 Q151.82 440.298 151.82 433.192 Q151.82 426.062 149.991 422.521 Q148.186 418.956 144.552 418.956 M144.552 415.252 Q150.362 415.252 153.417 419.859 Q156.496 424.442 156.496 433.192 Q156.496 441.919 153.417 446.525 Q150.362 451.108 144.552 451.108 Q138.741 451.108 135.663 446.525 Q132.607 441.919 132.607 433.192 Q132.607 424.442 135.663 419.859 Q138.741 415.252 144.552 415.252 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M89.1352 176.652 L111.357 176.652 L111.357 178.642 L98.8111 211.212 L93.9269 211.212 L105.732 180.587 L89.1352 180.587 L89.1352 176.652 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M120.478 205.332 L125.362 205.332 L125.362 211.212 L120.478 211.212 L120.478 205.332 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip570)" d="M135.593 176.652 L153.95 176.652 L153.95 180.587 L139.876 180.587 L139.876 189.059 Q140.894 188.712 141.913 188.55 Q142.931 188.365 143.95 188.365 Q149.737 188.365 153.116 191.536 Q156.496 194.707 156.496 200.124 Q156.496 205.703 153.024 208.804 Q149.552 211.883 143.232 211.883 Q141.056 211.883 138.788 211.513 Q136.542 211.142 134.135 210.402 L134.135 205.703 Q136.218 206.837 138.441 207.392 Q140.663 207.948 143.14 207.948 Q147.144 207.948 149.482 205.841 Q151.82 203.735 151.82 200.124 Q151.82 196.513 149.482 194.406 Q147.144 192.3 143.14 192.3 Q141.265 192.3 139.39 192.716 Q137.538 193.133 135.593 194.013 L135.593 176.652 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip572)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1134.34 268.292,1440.44 270.6,1374.76 272.908,1614.32 275.216,1654.34 277.524,1245.39 279.832,1599.62 282.139,1345.78 284.447,1354.11 286.755,1376.81 289.063,1609.49 291.371,1392.15 293.679,1481.62 295.987,1465.16 298.295,1428.09 300.603,1357.55 302.911,1405.72 305.219,1387.81 307.527,1448.54 309.834,1396.51 312.142,1466.3 314.45,1410.72 316.758,1426.84 319.066,1310.58 321.374,1559.35 323.682,1557.89 325.99,1436.03 328.298,1456.3 330.606,1431.31 332.914,1292.6 335.221,1436.89 337.529,1527.01 339.837,1260.56 342.145,1303.3 344.453,1356.44 346.761,1432.31 349.069,1455.12 351.377,1426.1 353.685,1505.12 355.993,1260.22 358.301,1516.31 360.608,1313.34 362.916,1446.96 365.224,1426.9 367.532,1333.9 369.84,1308.08 372.148,1341.66 374.456,1396.77 376.764,1342.57 379.072,1424.4 381.38,1326.36 383.688,1420.86 385.996,1378.41 388.303,1419 390.611,1343.03 392.919,1424.39 395.227,1265.66 397.535,1369.23 399.843,1260.54 402.151,1402.48 404.459,1488.6 406.767,1325.5 409.075,1428.2 411.383,1324.73 413.69,1294.51 415.998,1347.73 418.306,1471.85 420.614,1453.95 422.922,1638.21 425.23,1456.32 427.538,1334.57 429.846,1500.21 432.154,1455.27 434.462,1503.35 436.77,1403.37 439.077,1484.86 441.385,1511.82 443.693,1581.38 446.001,1278.13 448.309,1383.19 450.617,1365.25 452.925,1322.26 455.233,1410.56 457.541,1286.98 459.849,1471.6 462.157,1325.66 464.465,1366.9 466.772,1245.04 469.08,1359.59 471.388,1575.64 473.696,1438.05 476.004,1232.74 478.312,1492.07 480.62,1353.78 482.928,1315.34 485.236,1455.93 487.544,1278.18 489.852,1424.29 492.159,1458.84 494.467,1330.55 496.775,1243.37 499.083,1395.44 501.391,1211.75 503.699,1400.48 506.007,1336.53 508.315,1310.4 510.623,1183.99 512.931,1446.27 515.239,1278.05 517.546,1429.55 519.854,1255.25 522.162,1299.25 524.47,1092.58 526.778,1347.64 529.086,1360.83 531.394,1284.79 533.702,1511.16 536.01,1414.88 538.318,1243.05 540.626,1223.71 542.933,1380.54 545.241,1255.82 547.549,1461.91 549.857,1454.04 552.165,1565.25 554.473,1514.52 556.781,1342.49 559.089,1285.5 561.397,1365.4 563.705,1416.09 566.013,1389.99 568.321,1369.2 570.628,1562.22 572.936,1410.18 575.244,1355.43 577.552,1338.3 579.86,1310.26 582.168,1474.38 584.476,1422.23 586.784,1345.06 589.092,1265.41 591.4,1394.83 593.708,1399.97 596.015,1365.32 598.323,1299.32 600.631,1398.03 602.939,1468.07 605.247,1394.07 607.555,1453.45 609.863,1385.14 612.171,1203.29 614.479,1426.46 616.787,1147.58 619.095,1405.49 621.402,1284.14 623.71,1534.75 626.018,1435.8 628.326,1357.27 630.634,1367.58 632.942,1410.78 635.25,1485.57 637.558,1250 639.866,1422.45 642.174,1482.8 644.482,1450.36 646.79,1311.65 649.097,1570.17 651.405,1451.58 653.713,1460.94 656.021,1354.49 658.329,1362.59 660.637,1341.3 662.945,1282.07 665.253,1314.13 667.561,1495.66 669.869,1423.34 672.177,1415.49 674.484,1378.54 676.792,1330.01 679.1,1498.99 681.408,1461.36 683.716,1373.92 686.024,1393.69 688.332,1331.79 690.64,1376.69 692.948,1479.01 695.256,1318.59 697.564,1219.16 699.871,1500.83 702.179,1507.84 704.487,1292.07 706.795,1355.61 709.103,1558.91 711.411,1422.84 713.719,1341.76 716.027,1400.3 718.335,1448.59 720.643,1322.84 722.951,1393.55 725.259,1260.59 727.566,1356.34 729.874,1322.74 732.182,1379.06 734.49,1489.7 736.798,1234.71 739.106,1368.37 741.414,1456.37 743.722,1324.51 746.03,1566.19 748.338,1407.79 750.646,1548.49 752.953,1480.9 755.261,1390.49 757.569,1407.38 759.877,1337.49 762.185,1499.37 764.493,1390.16 766.801,1376.79 769.109,1390.36 771.417,1424.62 773.725,1434.72 776.033,1514.62 778.34,1540.67 780.648,1488.11 782.956,1511.9 785.264,1296.42 787.572,1323.77 789.88,1395.38 792.188,1398.95 794.496,1273.63 796.804,1513.44 799.112,1520.73 801.42,1471.1 803.728,1427.27 806.035,1369.14 808.343,1218.38 810.651,1491.33 812.959,1487.69 815.267,1306.26 817.575,1382.22 819.883,1493.5 822.191,1396.35 824.499,1442.87 826.807,1507.03 829.115,1296.38 831.422,1286.97 833.73,1296.41 836.038,1373.83 838.346,1503.45 840.654,1303.5 842.962,1460.88 845.27,1245.04 847.578,1533.78 849.886,1343.62 852.194,1370.27 854.502,1398.47 856.809,1425.34 859.117,1302.59 861.425,1324.29 863.733,1363.02 866.041,1566.55 868.349,1610.16 870.657,1578.39 872.965,1422.19 875.273,1417.23 877.581,1479.5 879.889,1504.1 882.197,1372.73 884.504,1206.92 886.812,1311.38 889.12,1299.29 891.428,1303.15 893.736,1441.37 896.044,1412.24 898.352,1263.33 900.66,1336.93 902.968,1389.05 905.276,1333.8 907.584,1229.77 909.891,1417.18 912.199,1377.78 914.507,1347.82 916.815,1350.01 919.123,1332.06 921.431,1439.52 923.739,1292.17 926.047,1160.49 928.355,1307.6 930.663,1332.06 932.971,1384.12 935.278,1451.6 937.586,1230.69 939.894,1442.9 942.202,1421.23 944.51,1241.18 946.818,1495.77 949.126,1325.79 951.434,1423.39 953.742,1313.13 956.05,1324.37 958.358,1424.61 960.665,1500.22 962.973,1552.66 965.281,1424.77 967.589,1346.63 969.897,1390.78 972.205,1500.85 974.513,1469.7 976.821,1284.7 979.129,1344.3 981.437,1174.62 983.745,1406.3 986.053,1403.29 988.36,1400.15 990.668,1533.81 992.976,1252.58 995.284,1367.45 997.592,1378.24 999.9,1337.28 1002.21,1202.65 1004.52,1398.8 1006.82,1401.38 1009.13,1253.47 1011.44,1320.5 1013.75,1539.25 1016.06,1329.37 1018.36,1431.2 1020.67,1458.93 1022.98,1186.7 1025.29,1269.04 1027.59,1385 1029.9,1559.61 1032.21,1348.26 1034.52,1344.09 1036.83,1372.65 1039.13,1448.83 1041.44,1334.86 1043.75,1382.27 1046.06,1276.53 1048.37,1324.62 1050.67,1421.54 1052.98,1322.13 1055.29,1489.62 1057.6,1273.63 1059.91,1382.6 1062.21,1243.87 1064.52,1359.45 1066.83,1417.13 1069.14,1347.71 1071.45,1489.93 1073.75,1344.79 1076.06,1643.51 1078.37,1462.88 1080.68,1443.57 1082.98,1383.69 1085.29,1529.91 1087.6,1486.65 1089.91,1439.77 1092.22,1489.4 1094.52,1474.99 1096.83,1490.23 1099.14,1378.03 1101.45,1512.44 1103.76,1434.18 1106.06,1461.23 1108.37,1351.61 1110.68,1261.51 1112.99,1299.44 1115.3,1377.3 1117.6,1291.19 1119.91,1347.27 1122.22,1364.91 1124.53,1213.44 1126.84,1550.09 1129.14,1398.16 1131.45,1324.04 1133.76,1511.9 1136.07,1378.03 1138.37,1373.41 1140.68,1358.14 1142.99,1381.75 1145.3,1575.78 1147.61,1279.17 1149.91,1561.36 1152.22,1375.04 1154.53,1569.7 1156.84,1361.36 1159.15,1420.85 1161.45,1414.35 1163.76,1404.05 1166.07,1593.57 1168.38,1371.93 1170.69,1471.66 1172.99,1494.29 1175.3,1454.79 1177.61,1338.33 1179.92,1431.32 1182.23,1280.99 1184.53,1312.73 1186.84,1360.29 1189.15,1337.28 1191.46,1341.82 1193.76,1356.98 1196.07,1392.26 1198.38,1452.11 1200.69,1256.97 1203,1271.27 1205.3,1411.73 1207.61,1500.81 1209.92,1241.65 1212.23,1565.83 1214.54,1461.87 1216.84,1193.41 1219.15,1551.28 1221.46,1466.03 1223.77,1429.95 1226.08,1359.09 1228.38,1282.11 1230.69,1470.34 1233,1383.45 1235.31,1357.58 1237.61,1504.39 1239.92,1360.19 1242.23,1483.89 1244.54,1434.37 1246.85,1491.99 1249.15,1509.59 1251.46,1253.17 1253.77,1470.87 1256.08,1401.6 1258.39,1341.92 1260.69,1385.14 1263,1337.16 1265.31,1449.51 1267.62,1399.49 1269.93,1313.78 1272.23,1398.11 1274.54,1468.39 1276.85,1399.93 1279.16,1515.3 1281.47,1453.86 1283.77,1470.34 1286.08,1481.99 1288.39,1448.65 1290.7,1377.02 1293,1277.84 1295.31,1295.55 1297.62,1525.87 1299.93,1328.93 1302.24,1369.77 1304.54,1410.7 1306.85,1240.03 1309.16,1507.02 1311.47,1478.88 1313.78,1226.93 1316.08,1484.94 1318.39,1352.12 1320.7,1494.79 1323.01,1298.66 1325.32,1523.5 1327.62,1445.83 1329.93,1609.3 1332.24,1351.73 1334.55,1309.13 1336.86,1366.22 1339.16,1494.78 1341.47,1493.97 1343.78,1545.12 1346.09,1386.7 1348.39,1312.08 1350.7,1404.94 1353.01,1358.12 1355.32,1410.17 1357.63,1442.79 1359.93,1592.29 1362.24,1207.3 1364.55,1571.96 1366.86,1356.48 1369.17,1481.9 1371.47,1269.68 1373.78,1409.02 1376.09,1482.25 1378.4,1501.91 1380.71,1392.94 1383.01,1349.31 1385.32,1282.89 1387.63,1361.16 1389.94,1267.36 1392.24,1280.21 1394.55,1173.08 1396.86,1258.95 1399.17,1198.32 1401.48,1279.82 1403.78,1294.27 1406.09,1420.21 1408.4,1330.85 1410.71,1398.49 1413.02,1234.36 1415.32,1416.2 1417.63,1310.3 1419.94,1391.63 1422.25,1312.94 1424.56,1393.64 1426.86,1396.44 1429.17,1240.27 1431.48,1399.31 1433.79,1425.81 1436.1,1492.05 1438.4,1380.11 1440.71,1294.06 1443.02,1521.77 1445.33,1468.88 1447.63,1373.11 1449.94,1569.41 1452.25,1237.95 1454.56,1319.24 1456.87,1455.87 1459.17,1424.53 1461.48,1407.37 1463.79,1388.69 1466.1,1494.13 1468.41,1247.75 1470.71,1264.33 1473.02,1333.79 1475.33,1514.33 1477.64,1264.84 1479.95,1359.41 1482.25,1409.82 1484.56,1436.33 1486.87,1523.13 1489.18,1258.66 1491.49,1390.83 1493.79,1479.42 1496.1,1434.52 1498.41,1394.02 1500.72,1307.66 1503.02,1413.26 1505.33,1280.1 1507.64,1400.6 1509.95,1332.87 1512.26,1629.09 1514.56,1384.26 1516.87,1333.79 1519.18,1410.99 1521.49,1288.44 1523.8,1444.96 1526.1,1427.45 1528.41,1294.76 1530.72,1458.8 1533.03,1478.81 1535.34,1318.1 1537.64,1413.97 1539.95,1397.61 1542.26,1471.1 1544.57,1357.51 1546.88,1544.09 1549.18,1315.13 1551.49,1392.07 1553.8,1505.36 1556.11,1549.21 1558.41,1363.37 1560.72,1395.25 1563.03,1283.32 1565.34,1564.58 1567.65,1372.42 1569.95,1471.38 1572.26,1454.82 1574.57,1411.36 1576.88,1124.58 1579.19,1480.79 1581.49,1336.42 1583.8,1586.54 1586.11,1246.01 1588.42,1525.9 1590.73,1408.31 1593.03,1389.65 1595.34,1304.01 1597.65,1576.52 1599.96,1427.86 1602.26,1240.68 1604.57,1400.58 1606.88,1363.55 1609.19,1380.59 1611.5,1389.64 1613.8,1318.1 1616.11,1271.54 1618.42,1497.88 1620.73,1300.89 1623.04,1277.22 1625.34,1285.98 1627.65,1249.88 1629.96,1517.66 1632.27,1457.36 1634.58,1441.03 1636.88,1373.15 1639.19,1389.08 1641.5,1411.43 1643.81,1471.13 1646.12,1281.4 1648.42,1242.12 1650.73,1391.21 1653.04,1350.77 1655.35,1225.56 1657.65,1292.53 1659.96,1366.34 1662.27,1347.9 1664.58,1439.05 1666.89,1402.25 1669.19,1338.48 1671.5,1392.91 1673.81,1132.89 1676.12,1512.07 1678.43,1333.49 1680.73,1304.91 1683.04,1240.03 1685.35,1461.79 1687.66,1524.47 1689.97,1458.31 1692.27,1360.41 1694.58,1247.64 1696.89,1436.27 1699.2,1478.11 1701.51,1406.85 1703.81,1555.24 1706.12,1366.47 1708.43,1497.25 1710.74,1298.74 1713.04,1464.99 1715.35,1350.67 1717.66,1424.69 1719.97,1400.37 1722.28,1239.2 1724.58,1384.31 1726.89,1380.8 1729.2,1322.57 1731.51,1352.29 1733.82,1564.54 1736.12,1264.48 1738.43,1157.04 1740.74,1392.25 1743.05,1366.18 1745.36,1230.84 1747.66,1444.19 1749.97,1298.51 1752.28,1383.41 1754.59,1344.2 1756.9,1439.54 1759.2,1340.89 1761.51,1407.98 1763.82,1303.32 1766.13,1334.75 1768.43,1511.85 1770.74,1338.25 1773.05,1292.06 1775.36,1325.91 1777.67,1378.61 1779.97,1292 1782.28,1359.65 1784.59,1305.99 1786.9,1364.7 1789.21,1462.03 1791.51,1433.68 1793.82,1290.27 1796.13,1523.72 1798.44,1339.91 1800.75,1407.9 1803.05,1374.13 1805.36,1331.27 1807.67,1445.53 1809.98,1366.55 1812.28,1341.02 1814.59,1408.41 1816.9,1405.86 1819.21,1282.52 1821.52,1305.11 1823.82,1302.47 1826.13,1285.49 1828.44,1345.95 1830.75,1381.27 1833.06,1237.18 1835.36,1294.82 1837.67,1338.58 1839.98,1490.11 1842.29,1389.58 1844.6,1238.43 1846.9,1404.58 1849.21,1376.43 1851.52,1391.48 1853.83,1404.67 1856.14,1401.88 1858.44,1394.52 1860.75,1337.1 1863.06,1593.25 1865.37,1432.71 1867.67,1417.13 1869.98,1438.17 1872.29,1363.6 1874.6,1502.96 1876.91,1452.28 1879.21,1494.96 1881.52,1511.37 1883.83,1445.28 1886.14,1583.15 1888.45,1348.4 1890.75,1290.63 1893.06,1339.53 1895.37,1276.89 1897.68,1313.03 1899.99,1320.89 1902.29,1357.65 1904.6,1423.68 1906.91,1479.37 1909.22,1363.71 1911.53,1288.57 1913.83,1471.19 1916.14,1366.85 1918.45,1545.01 1920.76,1488.07 1923.06,1383.55 1925.37,1405.14 1927.68,1266.58 1929.99,1411.09 1932.3,1211.06 1934.6,1358.86 1936.91,1554.81 1939.22,1290.4 1941.53,1266.89 1943.84,1508.67 1946.14,1324.71 1948.45,1405.87 1950.76,1322.04 1953.07,1383.79 1955.38,1371.05 1957.68,1160.38 1959.99,1540.65 1962.3,1368.85 1964.61,1412.23 1966.91,1395.66 1969.22,1306.64 1971.53,1465.09 1973.84,1276.66 1976.15,1277.75 1978.45,1404.65 1980.76,1357.17 1983.07,1428.76 1985.38,1475.03 1987.69,1448.57 1989.99,1415.31 1992.3,1303.06 1994.61,1283.67 1996.92,1485.6 1999.23,1398.28 2001.53,1432.9 2003.84,1751.15 2006.15,1423.39 2008.46,1411.26 2010.77,1530.64 2013.07,1356.81 2015.38,1430.29 2017.69,1412.59 2020,1454.35 2022.3,1372.04 2024.61,1260.49 2026.92,1364.18 2029.23,1624.33 2031.54,1335.5 2033.84,1378.98 2036.15,1336.46 2038.46,1308.25 2040.77,1345.82 2043.08,1352.23 2045.38,1423.3 2047.69,1381.49 2050,1539.7 2052.31,1418.42 2054.62,1310.3 2056.92,1485.17 2059.23,1220.26 2061.54,1316.61 2063.85,1445.82 2066.16,1259.81 2068.46,1288.18 2070.77,1479.4 2073.08,1442.27 2075.39,1440.6 2077.69,1432.31 2080,1356.79 2082.31,1522.5 2084.62,1380.35 2086.93,1364.44 2089.23,1469.81 2091.54,1341.8 2093.85,1366.87 2096.16,1338.04 2098.47,1433.18 2100.77,1291.47 2103.08,1278.9 2105.39,1417.08 2107.7,1301.97 2110.01,1411.06 2112.31,1438.72 2114.62,1337.5 2116.93,1398.75 2119.24,1501.38 2121.55,1403.08 2123.85,1303.84 2126.16,1451.94 2128.47,1345.99 2130.78,1496.9 2133.08,1443.5 2135.39,1424.03 2137.7,1357.76 2140.01,1397.84 2142.32,1337.26 2144.62,1261.52 2146.93,1378.01 2149.24,1520.46 2151.55,1521.5 2153.86,1409.97 2156.16,1446.13 2158.47,1364.12 2160.78,1414.45 2163.09,1484.67 2165.4,1130.64 2167.7,1331.72 2170.01,1342.85 2172.32,1339.21 2174.63,1513.72 2176.93,1553.56 2179.24,1251.58 2181.55,1230.11 2183.86,1310.84 2186.17,1481.83 2188.47,1430.1 2190.78,1300.66 2193.09,1558.49 2195.4,1588.58 2197.71,1364.41 2200.01,1426.9 2202.32,1285.03 2204.63,1220.81 2206.94,1367.56 2209.25,1445.73 2211.55,1422.73 2213.86,1398.83 2216.17,1472.8 2218.48,1462.54 2220.79,1300.01 2223.09,1326.78 2225.4,1276.79 2227.71,1516.5 2230.02,1477.69 2232.32,1152.1 2234.63,1435.87 2236.94,1292.05 2239.25,1238.97 2241.56,1416.81 2243.86,1439.12 2246.17,1326.33 2248.48,1366.47 2250.79,1330.59 2253.1,1319.37 2255.4,1414.46 2257.71,1224.73 2260.02,1420.25 2262.33,1512.83 2264.64,1309.93 2266.94,1572.73 2269.25,1362.69 2271.56,1365.11 2273.87,1558.35 2276.18,1455.32 2278.48,1282.33 2280.79,1399.02 2283.1,1353.55 2285.41,1450.65 2287.71,1410.22 2290.02,1506.3 2292.33,1393.36 2294.64,1442.43 2296.95,1499.38 2299.25,1393.86 2301.56,1408.73 2303.87,1433.26 2306.18,1427.2 2308.49,1313.64 2310.79,1247.1 2313.1,1374.7 2315.41,1471.2 2317.72,1396.06 2320.03,1531.28 2322.33,1383.96 2324.64,1276.14 2326.95,1434.58 2329.26,1442.54 2331.56,1175.43 2333.87,1409.51 2336.18,1471.69 2338.49,1287.51 2340.8,1356.75 2343.1,1348.11 2345.41,1350.52 2347.72,1319.94 2350.03,1533.06 2352.34,1388.13 2354.64,1392.63 2356.95,1663.78 2359.26,1371.35 2361.57,1467.36 2363.88,1241.37 2366.18,1413.6 2368.49,1348.75 2370.8,1383.46 2373.11,1337.86 2375.42,1643.85 2377.72,1534.57 2380.03,1455.49 2382.34,1290.05 2384.65,1524.66 2386.95,1203.46 2389.26,1344.27 2391.57,1406.36 2393.88,1398.5 2396.19,1336.45 2398.49,1427.33 2400.8,1257.58 2403.11,1518.1 2405.42,1350.99 2407.73,1242.46 2410.03,1345.86 2412.34,1323.93 2414.65,1383.91 2416.96,1402.87 2419.27,1329.6 2421.57,1420.17 2423.88,1510.54 2426.19,1335.11 2428.5,1402.94 2430.81,1442.18 2433.11,1346.12 2435.42,1401.16 2437.73,1483.13 2440.04,1324.08 2442.34,1410.87 2444.65,1344.77 2446.96,1463.03 2449.27,1511.09 2451.58,1420.24 2453.88,1436.59 2456.19,1546.29 2458.5,1173.33 2460.81,1442.66 2463.12,1450.56 2465.42,1528.34 2467.73,1318.66 2470.04,1351.22 2472.35,1295.56 2474.66,1381.29 2476.96,1435.34 2479.27,1489.26 2481.58,1419.65 2483.89,1513.58 2486.2,1410.7 2488.5,1304.28 2490.81,1597.69 2493.12,1370.78 2495.43,1373.57 2497.73,1144.66 2500.04,1353.62 2502.35,1337.2 2504.66,1238 2506.97,1361.95 2509.27,1408.41 2511.58,1308.48 2513.89,1351.47 2516.2,1343.22 2518.51,1443.77 2520.81,1235.1 2523.12,1392.35 2525.43,1361.64 2527.74,1180.24 2530.05,1509.52 2532.35,1411.98 2534.66,1247.37 2536.97,1387.87 2539.28,1433.36 2541.58,1422.93 2543.89,1312.77 2546.2,1511.25 2548.51,1498.75 2550.82,1496.37 2553.12,1347.59 2555.43,1499.04 2557.74,1395.72 2560.05,1335.42 2562.36,1450.62 2564.66,1350.47 2566.97,1422.13 2569.28,1272.23 2571.59,1322.31 "></polyline>
<polyline clip-path="url(#clip572)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1019.74 268.292,928.679 270.6,841.377 272.908,899.767 275.216,937.834 277.524,879.437 279.832,943.812 282.139,786.45 284.447,903.532 286.755,826.768 289.063,822.239 291.371,967.302 293.679,902.917 295.987,860.892 298.295,834.435 300.603,1000.26 302.911,1026.66 305.219,1077.77 307.527,1068.9 309.834,883.338 312.142,700.462 314.45,838.452 316.758,913.551 319.066,830.447 321.374,870.045 323.682,933.053 325.99,1011.53 328.298,905.559 330.606,804.265 332.914,872.249 335.221,968.22 337.529,949.079 339.837,1013.65 342.145,992.911 344.453,1063.66 346.761,882.199 349.069,770.407 351.377,934.07 353.685,907.996 355.993,1076.28 358.301,754.982 360.608,936.461 362.916,969.081 365.224,927.296 367.532,777.87 369.84,1003.76 372.148,884.126 374.456,789.348 376.764,1042.42 379.072,907.089 381.38,913.667 383.688,762.294 385.996,946.929 388.303,795.394 390.611,864.204 392.919,881.578 395.227,857.781 397.535,885.85 399.843,923.378 402.151,935.905 404.459,929.462 406.767,944.01 409.075,867.928 411.383,882.547 413.69,903.989 415.998,1019.24 418.306,959.577 420.614,1077.03 422.922,734.304 425.23,855.593 427.538,905.776 429.846,962.003 432.154,866.9 434.462,1011.56 436.77,975.069 439.077,856.205 441.385,947.366 443.693,683.198 446.001,997.664 448.309,746.882 450.617,776.065 452.925,970.524 455.233,836.476 457.541,869.635 459.849,858.491 462.157,907.731 464.465,840.353 466.772,989.296 469.08,863.951 471.388,784.402 473.696,905.782 476.004,872.226 478.312,814.023 480.62,961.347 482.928,1016.17 485.236,954.744 487.544,887.147 489.852,864.91 492.159,762.889 494.467,1085.17 496.775,873.419 499.083,942.189 501.391,767.535 503.699,985.555 506.007,678.26 508.315,882.792 510.623,837.63 512.931,923.842 515.239,856.067 517.546,911.588 519.854,888.595 522.162,1047.13 524.47,913.605 526.778,920.868 529.086,941.732 531.394,773.776 533.702,835.961 536.01,1056.67 538.318,1009.45 540.626,720.646 542.933,1048.84 545.241,889.713 547.549,897.113 549.857,1041.7 552.165,989.641 554.473,832.618 556.781,815.147 559.089,952.381 561.397,985.902 563.705,909.487 566.013,832.842 568.321,723.919 570.628,964.918 572.936,981.086 575.244,852.752 577.552,777.406 579.86,863.382 582.168,906.269 584.476,977.481 586.784,831.831 589.092,735.5 591.4,978.047 593.708,899.097 596.015,1025.51 598.323,892.773 600.631,759.674 602.939,967.565 605.247,840.705 607.555,1048.43 609.863,929.804 612.171,951.578 614.479,912.589 616.787,778.378 619.095,1032.43 621.402,936.411 623.71,948.619 626.018,996.139 628.326,884.203 630.634,881.049 632.942,1009.48 635.25,1030.6 637.558,952.75 639.866,793.104 642.174,1076.4 644.482,868.226 646.79,875.063 649.097,1007.17 651.405,1050.43 653.713,911.272 656.021,876.007 658.329,944.692 660.637,985.384 662.945,876.6 665.253,958.241 667.561,692.016 669.869,790.53 672.177,859.689 674.484,1056.87 676.792,889.774 679.1,890.853 681.408,915.716 683.716,978.663 686.024,896.303 688.332,912.636 690.64,1029.26 692.948,1051.48 695.256,877.602 697.564,856.633 699.871,835.108 702.179,787.68 704.487,1042.08 706.795,909.169 709.103,1069.12 711.411,967.686 713.719,863.401 716.027,916.149 718.335,793.636 720.643,1020.05 722.951,830.596 725.259,759.502 727.566,880.151 729.874,875.673 732.182,908.088 734.49,957.39 736.798,954.147 739.106,1091.39 741.414,1153.23 743.722,899.03 746.03,989.789 748.338,747.825 750.646,773.989 752.953,809.689 755.261,992.921 757.569,767.113 759.877,851.32 762.185,931.595 764.493,772.401 766.801,874.246 769.109,983.844 771.417,893.338 773.725,859.134 776.033,994.585 778.34,1016.41 780.648,1024.28 782.956,1042.49 785.264,954.101 787.572,878.533 789.88,775.462 792.188,994.896 794.496,968.764 796.804,891.236 799.112,960.087 801.42,976.92 803.728,889.032 806.035,959.97 808.343,1035.13 810.651,1025.5 812.959,959.544 815.267,893.837 817.575,961.912 819.883,932.594 822.191,880.529 824.499,931.277 826.807,818.142 829.115,902.969 831.422,1041.28 833.73,758.887 836.038,1087.33 838.346,975.712 840.654,987.788 842.962,1102.21 845.27,1048.75 847.578,1013.95 849.886,783.002 852.194,835.753 854.502,1001.83 856.809,881.554 859.117,983.294 861.425,988.237 863.733,959.398 866.041,950.445 868.349,825.384 870.657,984.625 872.965,1037.33 875.273,979.96 877.581,947.09 879.889,790.855 882.197,878.87 884.504,968.485 886.812,978.035 889.12,1017.18 891.428,818.351 893.736,1022.78 896.044,943.643 898.352,931.982 900.66,1036.43 902.968,862.93 905.276,834.324 907.584,1026.17 909.891,758.251 912.199,810.872 914.507,1090.93 916.815,899.704 919.123,936.144 921.431,1030.59 923.739,809.029 926.047,806.638 928.355,876.262 930.663,852.099 932.971,845.728 935.278,1016.97 937.586,944.57 939.894,1009.19 942.202,848.052 944.51,852.55 946.818,907.779 949.126,962.083 951.434,791.377 953.742,1097.56 956.05,915.436 958.358,924.89 960.665,874.781 962.973,911.467 965.281,1017.29 967.589,842.769 969.897,1026.31 972.205,799.66 974.513,909.023 976.821,885.155 979.129,784.615 981.437,954.019 983.745,845.205 986.053,991.137 988.36,707.43 990.668,936.853 992.976,931.194 995.284,927.859 997.592,832.62 999.9,964.347 1002.21,853.963 1004.52,812.048 1006.82,946.228 1009.13,832.934 1011.44,1003.67 1013.75,998.822 1016.06,837.842 1018.36,848.652 1020.67,882.685 1022.98,1020.59 1025.29,1034.85 1027.59,800.884 1029.9,871.862 1032.21,1128.35 1034.52,855.638 1036.83,1009.05 1039.13,921.814 1041.44,862.77 1043.75,1028.17 1046.06,932.268 1048.37,940.687 1050.67,724.656 1052.98,897.436 1055.29,796.678 1057.6,760.367 1059.91,942.552 1062.21,908.787 1064.52,756.431 1066.83,849.859 1069.14,809.628 1071.45,896.7 1073.75,942.325 1076.06,873.399 1078.37,769.193 1080.68,864.87 1082.98,742.315 1085.29,886.118 1087.6,817.241 1089.91,870.084 1092.22,713.706 1094.52,851.001 1096.83,971.771 1099.14,1016.5 1101.45,1077.36 1103.76,1008.77 1106.06,760.879 1108.37,906.343 1110.68,810.939 1112.99,828.494 1115.3,767.025 1117.6,957.604 1119.91,935.931 1122.22,624.537 1124.53,924.978 1126.84,823.198 1129.14,917.276 1131.45,769.296 1133.76,846.69 1136.07,884.958 1138.37,796.48 1140.68,982.116 1142.99,1023.58 1145.3,732.489 1147.61,911.265 1149.91,1032.59 1152.22,1022.05 1154.53,676.564 1156.84,887.713 1159.15,857.348 1161.45,938.547 1163.76,834.222 1166.07,949.753 1168.38,880.618 1170.69,944.753 1172.99,935.294 1175.3,832.56 1177.61,1032.08 1179.92,1010.97 1182.23,935.191 1184.53,949.953 1186.84,866.595 1189.15,932.848 1191.46,1014.71 1193.76,841.227 1196.07,1052.24 1198.38,993.087 1200.69,953.647 1203,930.807 1205.3,801.665 1207.61,895.02 1209.92,990.718 1212.23,1034.65 1214.54,787.114 1216.84,914.716 1219.15,794.474 1221.46,1001.89 1223.77,969.511 1226.08,918.343 1228.38,907.055 1230.69,843.472 1233,968.505 1235.31,953.443 1237.61,844.223 1239.92,908.329 1242.23,752.502 1244.54,902.15 1246.85,865.332 1249.15,1072.32 1251.46,844.101 1253.77,1071.6 1256.08,894.255 1258.39,1009.54 1260.69,988.333 1263,890.112 1265.31,978.102 1267.62,1085.53 1269.93,1012.48 1272.23,1103.18 1274.54,1101.4 1276.85,886.35 1279.16,835.216 1281.47,1076.29 1283.77,976.43 1286.08,817.085 1288.39,902.36 1290.7,875.727 1293,929.162 1295.31,920.031 1297.62,1000.41 1299.93,1041.79 1302.24,939.763 1304.54,1072.66 1306.85,985.165 1309.16,821.07 1311.47,895.577 1313.78,930.2 1316.08,892.605 1318.39,962.545 1320.7,864.569 1323.01,1030.53 1325.32,836.477 1327.62,896.779 1329.93,883.269 1332.24,961.854 1334.55,1075.23 1336.86,930.407 1339.16,940.198 1341.47,971.275 1343.78,865.709 1346.09,953.69 1348.39,899.659 1350.7,851.586 1353.01,1092.57 1355.32,885.628 1357.63,1072.51 1359.93,810.625 1362.24,882.445 1364.55,928.304 1366.86,840.765 1369.17,909.821 1371.47,901.797 1373.78,851.091 1376.09,879.626 1378.4,776.488 1380.71,780.473 1383.01,840.033 1385.32,759.027 1387.63,830.483 1389.94,862.785 1392.24,957.623 1394.55,988.729 1396.86,745.304 1399.17,987.23 1401.48,903.283 1403.78,808.93 1406.09,875.164 1408.4,969.068 1410.71,997.754 1413.02,891.27 1415.32,782.267 1417.63,851.244 1419.94,962.503 1422.25,950.893 1424.56,863.119 1426.86,885.998 1429.17,995.177 1431.48,936.955 1433.79,770.016 1436.1,928.535 1438.4,886.908 1440.71,992.538 1443.02,887.277 1445.33,1080.8 1447.63,802.862 1449.94,774.017 1452.25,827.485 1454.56,766.693 1456.87,1045.35 1459.17,928.098 1461.48,897.501 1463.79,938.325 1466.1,942.188 1468.41,771.011 1470.71,918.449 1473.02,747.506 1475.33,1085.93 1477.64,810.706 1479.95,1083.96 1482.25,800.598 1484.56,908.763 1486.87,954.376 1489.18,886.031 1491.49,922.026 1493.79,852.931 1496.1,1048.11 1498.41,1101.69 1500.72,707.617 1503.02,1017.38 1505.33,783.543 1507.64,864.725 1509.95,938.57 1512.26,953.754 1514.56,888.631 1516.87,1038.14 1519.18,768.226 1521.49,792.904 1523.8,879.849 1526.1,717.359 1528.41,977.741 1530.72,853.082 1533.03,798.1 1535.34,862.822 1537.64,1130.21 1539.95,998.788 1542.26,847.781 1544.57,864.317 1546.88,911.065 1549.18,918.001 1551.49,864.796 1553.8,761.807 1556.11,944.967 1558.41,863.742 1560.72,873.081 1563.03,973.671 1565.34,938.639 1567.65,887.312 1569.95,759.674 1572.26,892.132 1574.57,893.492 1576.88,904.458 1579.19,969.596 1581.49,891.75 1583.8,1018.1 1586.11,850.315 1588.42,756.586 1590.73,817.699 1593.03,878.987 1595.34,1066.49 1597.65,792.346 1599.96,708.161 1602.26,969.189 1604.57,937.936 1606.88,918.261 1609.19,878.331 1611.5,729.016 1613.8,839.292 1616.11,1076.81 1618.42,881.836 1620.73,1065.35 1623.04,829.776 1625.34,754.035 1627.65,696.48 1629.96,975.981 1632.27,949.682 1634.58,805.998 1636.88,935.754 1639.19,1011.4 1641.5,1135.34 1643.81,895.092 1646.12,945.452 1648.42,1119.52 1650.73,778.443 1653.04,902.173 1655.35,855.843 1657.65,894.443 1659.96,1123.35 1662.27,958.318 1664.58,882.494 1666.89,782.535 1669.19,940.491 1671.5,817.573 1673.81,902.169 1676.12,988.559 1678.43,874.21 1680.73,1033.88 1683.04,979.358 1685.35,898.823 1687.66,895.522 1689.97,801.424 1692.27,979.803 1694.58,802.098 1696.89,652.669 1699.2,790.742 1701.51,863.374 1703.81,1118.37 1706.12,840.101 1708.43,885.732 1710.74,879.666 1713.04,876.205 1715.35,989.549 1717.66,710.218 1719.97,903.1 1722.28,981.603 1724.58,1039.09 1726.89,910.602 1729.2,1131.87 1731.51,788.902 1733.82,921.968 1736.12,852.222 1738.43,1095.59 1740.74,821.886 1743.05,621.494 1745.36,876.706 1747.66,765.522 1749.97,1031.72 1752.28,1054.78 1754.59,833.74 1756.9,823.812 1759.2,792.007 1761.51,782.041 1763.82,875.712 1766.13,898.74 1768.43,790.44 1770.74,1032.46 1773.05,1163.74 1775.36,945.952 1777.67,874.466 1779.97,778.435 1782.28,885.525 1784.59,902.464 1786.9,913.85 1789.21,904.409 1791.51,994.34 1793.82,899.821 1796.13,981.983 1798.44,874.746 1800.75,975.236 1803.05,842.969 1805.36,885.669 1807.67,813.306 1809.98,755.983 1812.28,868.887 1814.59,823.145 1816.9,827.401 1819.21,1077.02 1821.52,1033.29 1823.82,762.153 1826.13,815.922 1828.44,671.211 1830.75,812.192 1833.06,896.236 1835.36,878.757 1837.67,925.983 1839.98,882.313 1842.29,940.047 1844.6,758.321 1846.9,881.111 1849.21,891.298 1851.52,1013.88 1853.83,872.315 1856.14,869.808 1858.44,1014.53 1860.75,765.041 1863.06,802.599 1865.37,991.892 1867.67,961.069 1869.98,961.166 1872.29,932.27 1874.6,968.281 1876.91,1022.77 1879.21,899.451 1881.52,835.629 1883.83,863.969 1886.14,857.814 1888.45,798.401 1890.75,968.484 1893.06,928.33 1895.37,781.222 1897.68,1000.16 1899.99,932.391 1902.29,997.272 1904.6,1014.88 1906.91,886.127 1909.22,914.588 1911.53,912.462 1913.83,713.017 1916.14,824.779 1918.45,890.767 1920.76,772.839 1923.06,924.182 1925.37,939.198 1927.68,681.615 1929.99,890.854 1932.3,922.89 1934.6,942.637 1936.91,1106.83 1939.22,953.447 1941.53,798.539 1943.84,901.217 1946.14,914.538 1948.45,852.956 1950.76,710.239 1953.07,1031.34 1955.38,844.335 1957.68,854.569 1959.99,935.861 1962.3,922.492 1964.61,965.272 1966.91,988.735 1969.22,990.167 1971.53,850.896 1973.84,770.459 1976.15,993.034 1978.45,802.453 1980.76,916.763 1983.07,782.1 1985.38,907.207 1987.69,987.416 1989.99,989.455 1992.3,850.903 1994.61,719.572 1996.92,910.008 1999.23,856.312 2001.53,974.142 2003.84,918.846 2006.15,801.061 2008.46,1022.55 2010.77,842.298 2013.07,763.982 2015.38,847.812 2017.69,871.812 2020,861.418 2022.3,784.206 2024.61,931.968 2026.92,922.489 2029.23,862.486 2031.54,1212.46 2033.84,996.663 2036.15,799.208 2038.46,820.527 2040.77,904.026 2043.08,637.221 2045.38,903.752 2047.69,893.26 2050,716.668 2052.31,806.064 2054.62,938.834 2056.92,885.486 2059.23,887.164 2061.54,992.249 2063.85,890.959 2066.16,664.494 2068.46,699.514 2070.77,983.794 2073.08,937.575 2075.39,951.883 2077.69,983.66 2080,797.894 2082.31,1039.19 2084.62,852.726 2086.93,827.491 2089.23,801.115 2091.54,787.054 2093.85,857.123 2096.16,985.479 2098.47,885.358 2100.77,955.168 2103.08,1044.9 2105.39,1140.09 2107.7,1009.87 2110.01,887.053 2112.31,1004.29 2114.62,1010.33 2116.93,868.551 2119.24,920.149 2121.55,882.94 2123.85,834.215 2126.16,853.417 2128.47,833.188 2130.78,934.155 2133.08,1139.59 2135.39,833.57 2137.7,915.265 2140.01,988.957 2142.32,944.307 2144.62,822.585 2146.93,841.198 2149.24,869.357 2151.55,1017.83 2153.86,1041.89 2156.16,985.132 2158.47,766.443 2160.78,1110.69 2163.09,805.199 2165.4,810.333 2167.7,930.385 2170.01,881.174 2172.32,901.449 2174.63,1065.52 2176.93,983.842 2179.24,840.117 2181.55,827.641 2183.86,933.85 2186.17,1009.27 2188.47,919.788 2190.78,909.813 2193.09,876.578 2195.4,995.884 2197.71,849.993 2200.01,984.649 2202.32,851.193 2204.63,1138.84 2206.94,1053.28 2209.25,912.779 2211.55,766.198 2213.86,931.099 2216.17,833.118 2218.48,1106.2 2220.79,980.391 2223.09,878.639 2225.4,980.213 2227.71,952.24 2230.02,986.276 2232.32,870.34 2234.63,1025.05 2236.94,912.828 2239.25,909.865 2241.56,1009.97 2243.86,839.416 2246.17,1041.46 2248.48,932.754 2250.79,754.55 2253.1,830.52 2255.4,960.129 2257.71,869.946 2260.02,1023.51 2262.33,826.697 2264.64,1068.2 2266.94,864.356 2269.25,1002.56 2271.56,876.029 2273.87,856.684 2276.18,937.605 2278.48,951.736 2280.79,903.179 2283.1,1030.12 2285.41,944.97 2287.71,965.613 2290.02,1068.63 2292.33,971.145 2294.64,876.091 2296.95,846.369 2299.25,915.761 2301.56,822.244 2303.87,933.181 2306.18,824.017 2308.49,890.656 2310.79,1010.2 2313.1,904.23 2315.41,884.056 2317.72,789.104 2320.03,894.89 2322.33,921.227 2324.64,1042.18 2326.95,1031.8 2329.26,1105.77 2331.56,970.506 2333.87,997.476 2336.18,908.263 2338.49,1020.66 2340.8,880.602 2343.1,805.314 2345.41,892.5 2347.72,1028.42 2350.03,827.467 2352.34,791.931 2354.64,848.08 2356.95,807.008 2359.26,987.369 2361.57,976.291 2363.88,1061.68 2366.18,1081.7 2368.49,863.142 2370.8,799.092 2373.11,1135.08 2375.42,871.805 2377.72,983.59 2380.03,691.072 2382.34,1012.44 2384.65,925.678 2386.95,873.479 2389.26,830.508 2391.57,900.295 2393.88,947.136 2396.19,898.363 2398.49,949.294 2400.8,1148.1 2403.11,843.947 2405.42,837.396 2407.73,911.752 2410.03,989.498 2412.34,832.931 2414.65,853.763 2416.96,1014.64 2419.27,906.048 2421.57,1065.6 2423.88,1069.61 2426.19,954.35 2428.5,1049.13 2430.81,860.376 2433.11,838.667 2435.42,984.009 2437.73,802.497 2440.04,1132.43 2442.34,880.359 2444.65,812.808 2446.96,837.766 2449.27,879.335 2451.58,855.156 2453.88,716.343 2456.19,802.611 2458.5,940.007 2460.81,947.161 2463.12,855.612 2465.42,905.285 2467.73,909.771 2470.04,979.284 2472.35,964.291 2474.66,995.667 2476.96,1085.56 2479.27,1003.72 2481.58,853.153 2483.89,900.162 2486.2,946.005 2488.5,914.687 2490.81,880.654 2493.12,942.067 2495.43,834.49 2497.73,853.704 2500.04,900.527 2502.35,891.988 2504.66,874.819 2506.97,960.334 2509.27,927.679 2511.58,975.352 2513.89,1076.99 2516.2,840.208 2518.51,716.027 2520.81,898.281 2523.12,1081.24 2525.43,1009.12 2527.74,914.844 2530.05,762.976 2532.35,716.994 2534.66,776.521 2536.97,810.915 2539.28,917.236 2541.58,995.765 2543.89,830.225 2546.2,953.413 2548.51,864.279 2550.82,879.252 2553.12,742.16 2555.43,842.746 2557.74,704.79 2560.05,872.506 2562.36,979.034 2564.66,1061.65 2566.97,778.431 2569.28,920.351 2571.59,860.038 "></polyline>
<polyline clip-path="url(#clip572)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,609.754 268.292,444.202 270.6,480.801 272.908,401.18 275.216,588.157 277.524,303.513 279.832,631.798 282.139,509.233 284.447,402.554 286.755,369.797 289.063,445.541 291.371,522.15 293.679,483.848 295.987,504.713 298.295,405.601 300.603,377.826 302.911,417.147 305.219,606.489 307.527,393.935 309.834,633.373 312.142,406.663 314.45,405.676 316.758,471.337 319.066,451.523 321.374,428.689 323.682,386.558 325.99,334.499 328.298,444.335 330.606,408.451 332.914,448.368 335.221,454.445 337.529,513.834 339.837,567.462 342.145,394.878 344.453,532.117 346.761,464.781 349.069,375.053 351.377,407.095 353.685,320.15 355.993,352.537 358.301,488.673 360.608,378.104 362.916,284.861 365.224,403.498 367.532,400.026 369.84,451.588 372.148,506.339 374.456,199.49 376.764,326.474 379.072,454.128 381.38,392.556 383.688,527.463 385.996,489.731 388.303,556.188 390.611,341.48 392.919,469.931 395.227,319.876 397.535,455.743 399.843,377.144 402.151,506.901 404.459,508.692 406.767,474.705 409.075,478.273 411.383,571.953 413.69,344.171 415.998,490.027 418.306,355.628 420.614,309.108 422.922,454.869 425.23,434.21 427.538,424.764 429.846,405.501 432.154,454.586 434.462,518.09 436.77,397.996 439.077,517.001 441.385,304.79 443.693,417.891 446.001,180.329 448.309,442.712 450.617,420.41 452.925,532.016 455.233,401.617 457.541,363 459.849,408.182 462.157,429.122 464.465,555.153 466.772,290.294 469.08,285.127 471.388,446.871 473.696,339.755 476.004,490.294 478.312,516.679 480.62,429.531 482.928,359.604 485.236,493.575 487.544,501.433 489.852,662.303 492.159,423.997 494.467,515.391 496.775,427.33 499.083,352.118 501.391,407.063 503.699,414.546 506.007,422.651 508.315,385.254 510.623,242.892 512.931,547.957 515.239,439.482 517.546,461.112 519.854,449.09 522.162,572.401 524.47,455.482 526.778,386.178 529.086,511.055 531.394,523.308 533.702,480.986 536.01,589.765 538.318,671.425 540.626,545.557 542.933,684.558 545.241,394.386 547.549,426.861 549.857,435.564 552.165,384.592 554.473,518.117 556.781,361.762 559.089,534.613 561.397,522.029 563.705,458.492 566.013,353.399 568.321,381.717 570.628,549.105 572.936,544.935 575.244,445.659 577.552,638.03 579.86,348.545 582.168,412.577 584.476,404.755 586.784,477.395 589.092,482.518 591.4,358.145 593.708,548.19 596.015,474.166 598.323,290 600.631,447.559 602.939,484.91 605.247,467.855 607.555,460.685 609.863,547.665 612.171,407.144 614.479,413.176 616.787,319.122 619.095,390.958 621.402,353.634 623.71,627.388 626.018,639.854 628.326,486.58 630.634,259.881 632.942,410.558 635.25,350.614 637.558,549.296 639.866,542.499 642.174,398.591 644.482,407.287 646.79,267.77 649.097,439.199 651.405,521.9 653.713,394.639 656.021,298.351 658.329,387.893 660.637,373.078 662.945,356.403 665.253,443.494 667.561,324.2 669.869,440.017 672.177,357.087 674.484,564.25 676.792,508.332 679.1,517.015 681.408,473.247 683.716,581.205 686.024,311.432 688.332,274.481 690.64,434.358 692.948,270.406 695.256,502.589 697.564,490.212 699.871,497.506 702.179,440.761 704.487,552.934 706.795,412.428 709.103,446.784 711.411,314.486 713.719,427.134 716.027,295.658 718.335,365.314 720.643,491.961 722.951,528.011 725.259,605.535 727.566,478.787 729.874,580.616 732.182,581.005 734.49,479.469 736.798,274.787 739.106,372.614 741.414,533.001 743.722,482.846 746.03,316.96 748.338,463.329 750.646,348.622 752.953,474.142 755.261,431.064 757.569,447.858 759.877,385.062 762.185,418.949 764.493,229.263 766.801,384.502 769.109,431.157 771.417,571.595 773.725,352.672 776.033,439.328 778.34,414.317 780.648,508.471 782.956,338.254 785.264,421.634 787.572,336.135 789.88,525.884 792.188,526.393 794.496,468.656 796.804,542.976 799.112,502.691 801.42,465.236 803.728,318.315 806.035,254.189 808.343,584.682 810.651,609.275 812.959,446.563 815.267,133.95 817.575,369.571 819.883,257.159 822.191,465.109 824.499,405.396 826.807,391.054 829.115,357.136 831.422,437.624 833.73,361.601 836.038,450.688 838.346,285.083 840.654,587.611 842.962,535.583 845.27,265.093 847.578,300.922 849.886,449.706 852.194,345.521 854.502,627.062 856.809,451.801 859.117,494.152 861.425,469.916 863.733,442.288 866.041,96.8724 868.349,498.789 870.657,434.996 872.965,352.237 875.273,327.429 877.581,239.549 879.889,405.695 882.197,577.261 884.504,334.703 886.812,404.032 889.12,484.419 891.428,626.194 893.736,411.128 896.044,468.308 898.352,485.829 900.66,518.43 902.968,335.223 905.276,366.115 907.584,371.361 909.891,416.919 912.199,491.588 914.507,686.068 916.815,402.572 919.123,415.44 921.431,479.946 923.739,401.052 926.047,499.556 928.355,409.054 930.663,322.895 932.971,420.849 935.278,400.077 937.586,458.161 939.894,331.852 942.202,443.163 944.51,458.923 946.818,617.566 949.126,399.519 951.434,174.069 953.742,469.317 956.05,449.698 958.358,341.552 960.665,404.11 962.973,353.779 965.281,328.953 967.589,461.773 969.897,562.603 972.205,516.351 974.513,243.88 976.821,344.462 979.129,403.916 981.437,371.028 983.745,392.738 986.053,444.803 988.36,333.869 990.668,387.599 992.976,554.147 995.284,422.812 997.592,434.42 999.9,312.861 1002.21,381.115 1004.52,688.355 1006.82,436.029 1009.13,435.833 1011.44,352.78 1013.75,453.066 1016.06,373.577 1018.36,442.073 1020.67,380.778 1022.98,508.556 1025.29,418.554 1027.59,342.586 1029.9,375.686 1032.21,402.697 1034.52,297.681 1036.83,524.519 1039.13,263.755 1041.44,312.934 1043.75,639.755 1046.06,321.196 1048.37,363.833 1050.67,358.049 1052.98,340.158 1055.29,551.191 1057.6,296.701 1059.91,739.746 1062.21,335.782 1064.52,421.213 1066.83,547.746 1069.14,543.857 1071.45,540.257 1073.75,409.421 1076.06,598.894 1078.37,389.167 1080.68,434.706 1082.98,422.414 1085.29,380.447 1087.6,506.65 1089.91,414.478 1092.22,470.101 1094.52,374.311 1096.83,433.902 1099.14,454.004 1101.45,452.096 1103.76,451.822 1106.06,449.169 1108.37,444.09 1110.68,412.593 1112.99,292.856 1115.3,456.715 1117.6,420.554 1119.91,380.844 1122.22,329.061 1124.53,207.905 1126.84,446.59 1129.14,421.687 1131.45,482.946 1133.76,251.223 1136.07,484.446 1138.37,447.638 1140.68,651.987 1142.99,432.353 1145.3,369.612 1147.61,377.915 1149.91,398.397 1152.22,377.951 1154.53,385.911 1156.84,324.848 1159.15,516.918 1161.45,557.906 1163.76,450.007 1166.07,423.529 1168.38,421.878 1170.69,438.158 1172.99,306.191 1175.3,335.335 1177.61,573.024 1179.92,328.061 1182.23,312.164 1184.53,411.47 1186.84,291.671 1189.15,497.502 1191.46,409.754 1193.76,467.826 1196.07,373.982 1198.38,531.959 1200.69,273.039 1203,433.332 1205.3,341.494 1207.61,406.801 1209.92,338.627 1212.23,394.363 1214.54,430.613 1216.84,560.588 1219.15,371.639 1221.46,247.928 1223.77,484.269 1226.08,397.198 1228.38,593.992 1230.69,522.245 1233,434.159 1235.31,532.365 1237.61,510.347 1239.92,269.595 1242.23,317.792 1244.54,382.611 1246.85,407.487 1249.15,481.561 1251.46,610.283 1253.77,514.795 1256.08,352.665 1258.39,347.402 1260.69,427.385 1263,375.999 1265.31,482.729 1267.62,654.399 1269.93,395.116 1272.23,465.116 1274.54,601.711 1276.85,494.66 1279.16,539.509 1281.47,284.855 1283.77,431.632 1286.08,398.423 1288.39,521.073 1290.7,506.236 1293,552.023 1295.31,329.718 1297.62,517.096 1299.93,573.676 1302.24,511.685 1304.54,414.404 1306.85,490.492 1309.16,423.113 1311.47,529.102 1313.78,481.696 1316.08,434.863 1318.39,533.465 1320.7,401.884 1323.01,394.165 1325.32,550.983 1327.62,506.821 1329.93,504.644 1332.24,400.487 1334.55,576.199 1336.86,422.559 1339.16,344.772 1341.47,446.256 1343.78,314.582 1346.09,463.897 1348.39,370.886 1350.7,457.995 1353.01,485.713 1355.32,470.86 1357.63,386.705 1359.93,312.228 1362.24,398.657 1364.55,485.827 1366.86,407.003 1369.17,470.373 1371.47,440.519 1373.78,383.951 1376.09,547.519 1378.4,312.584 1380.71,462.095 1383.01,189.312 1385.32,414.231 1387.63,530.793 1389.94,304.459 1392.24,275.4 1394.55,516.514 1396.86,518.447 1399.17,442.931 1401.48,339.186 1403.78,450.581 1406.09,383.463 1408.4,357.846 1410.71,489.807 1413.02,367.176 1415.32,484.332 1417.63,606.756 1419.94,544.792 1422.25,454.624 1424.56,543.088 1426.86,460.36 1429.17,300.945 1431.48,392.736 1433.79,374.725 1436.1,393.463 1438.4,609.408 1440.71,383.8 1443.02,451.291 1445.33,369.225 1447.63,440.843 1449.94,506.518 1452.25,407.543 1454.56,430.08 1456.87,448.47 1459.17,490.128 1461.48,580.052 1463.79,442.299 1466.1,502.301 1468.41,349.21 1470.71,371.046 1473.02,400.455 1475.33,364.595 1477.64,409.178 1479.95,438.974 1482.25,331.8 1484.56,468.744 1486.87,592.104 1489.18,426.284 1491.49,351.601 1493.79,402.49 1496.1,361.964 1498.41,319.57 1500.72,424.376 1503.02,436.589 1505.33,344.422 1507.64,552.993 1509.95,511.797 1512.26,254.445 1514.56,378.558 1516.87,402.782 1519.18,410.031 1521.49,370.182 1523.8,495.118 1526.1,608.411 1528.41,352.656 1530.72,410.219 1533.03,448.026 1535.34,433.425 1537.64,412.035 1539.95,385.325 1542.26,397.775 1544.57,406.905 1546.88,567.462 1549.18,499.639 1551.49,472.986 1553.8,543.164 1556.11,410.202 1558.41,363.736 1560.72,508.389 1563.03,389.189 1565.34,435.928 1567.65,579.563 1569.95,278.1 1572.26,499.314 1574.57,565.398 1576.88,398.269 1579.19,425.77 1581.49,447.585 1583.8,416.248 1586.11,505.972 1588.42,328.639 1590.73,536.383 1593.03,580.234 1595.34,447.634 1597.65,471.798 1599.96,611.614 1602.26,403.716 1604.57,481.634 1606.88,637.137 1609.19,439.182 1611.5,340.582 1613.8,330.298 1616.11,247.481 1618.42,386.317 1620.73,484.607 1623.04,280.954 1625.34,509.502 1627.65,651.701 1629.96,456.813 1632.27,306.745 1634.58,481.032 1636.88,345.447 1639.19,630.001 1641.5,413.477 1643.81,492.452 1646.12,549.836 1648.42,395.212 1650.73,440.482 1653.04,548.16 1655.35,543.366 1657.65,490.166 1659.96,413.21 1662.27,451.084 1664.58,278.166 1666.89,288.036 1669.19,425.91 1671.5,558.229 1673.81,506.443 1676.12,428.427 1678.43,435.347 1680.73,482.311 1683.04,529.555 1685.35,438.893 1687.66,429.073 1689.97,305.873 1692.27,558.945 1694.58,420.548 1696.89,424.988 1699.2,369.711 1701.51,470.871 1703.81,337.418 1706.12,429.679 1708.43,425.083 1710.74,420.844 1713.04,533.157 1715.35,403.803 1717.66,355.329 1719.97,386.523 1722.28,293.959 1724.58,464.392 1726.89,647.855 1729.2,246.781 1731.51,394.304 1733.82,439.524 1736.12,453.517 1738.43,393.913 1740.74,404.528 1743.05,344.278 1745.36,525.402 1747.66,411.831 1749.97,484.74 1752.28,515.249 1754.59,477.02 1756.9,409.071 1759.2,668.587 1761.51,485.171 1763.82,440.972 1766.13,585.626 1768.43,523.86 1770.74,425.267 1773.05,341.868 1775.36,304.499 1777.67,348.576 1779.97,186.383 1782.28,199.217 1784.59,506.168 1786.9,331.008 1789.21,559.54 1791.51,549.689 1793.82,428.797 1796.13,360.215 1798.44,487.416 1800.75,317.762 1803.05,579.107 1805.36,458.932 1807.67,463.323 1809.98,378.415 1812.28,412.844 1814.59,326.922 1816.9,452.689 1819.21,253.355 1821.52,327.947 1823.82,419.156 1826.13,569.389 1828.44,499.478 1830.75,455.236 1833.06,370.625 1835.36,414.123 1837.67,462.772 1839.98,432.668 1842.29,692.551 1844.6,392.028 1846.9,505.474 1849.21,638.275 1851.52,400.145 1853.83,404.942 1856.14,464.164 1858.44,376.786 1860.75,447.627 1863.06,586.252 1865.37,380.823 1867.67,434.877 1869.98,460.56 1872.29,486.235 1874.6,327.194 1876.91,505.371 1879.21,418.731 1881.52,514.238 1883.83,312.149 1886.14,490.455 1888.45,306.178 1890.75,396.812 1893.06,503.32 1895.37,477.649 1897.68,486.554 1899.99,339.649 1902.29,395.241 1904.6,347.788 1906.91,550.777 1909.22,353.276 1911.53,223.216 1913.83,400.746 1916.14,386.278 1918.45,191.284 1920.76,518.23 1923.06,354.076 1925.37,582.888 1927.68,333.362 1929.99,532.492 1932.3,491.012 1934.6,530.584 1936.91,328.85 1939.22,308.543 1941.53,609.955 1943.84,441.545 1946.14,450.389 1948.45,668.574 1950.76,414.52 1953.07,478.03 1955.38,521.922 1957.68,374.759 1959.99,659.71 1962.3,554.224 1964.61,408.074 1966.91,593.866 1969.22,326.066 1971.53,539.387 1973.84,332.059 1976.15,341.543 1978.45,558.232 1980.76,385.029 1983.07,334.568 1985.38,366.419 1987.69,546.381 1989.99,328.126 1992.3,549.443 1994.61,505.73 1996.92,557.85 1999.23,389.567 2001.53,585.733 2003.84,282.895 2006.15,395.395 2008.46,377.94 2010.77,367.956 2013.07,462.392 2015.38,570.07 2017.69,512.261 2020,420.24 2022.3,329.118 2024.61,473.997 2026.92,301.148 2029.23,401.794 2031.54,444.427 2033.84,417.354 2036.15,672.048 2038.46,460.119 2040.77,465.969 2043.08,575.692 2045.38,421.361 2047.69,320.847 2050,438.824 2052.31,555.499 2054.62,276.497 2056.92,384.664 2059.23,339.722 2061.54,491.182 2063.85,287.105 2066.16,551.664 2068.46,407.033 2070.77,494.388 2073.08,362.962 2075.39,612.72 2077.69,355.575 2080,500.685 2082.31,454.789 2084.62,576.866 2086.93,381.713 2089.23,396.735 2091.54,631.931 2093.85,511.767 2096.16,430.797 2098.47,377.33 2100.77,469.065 2103.08,331.039 2105.39,354.133 2107.7,450.752 2110.01,373.401 2112.31,591.407 2114.62,303.023 2116.93,476.12 2119.24,545.594 2121.55,409.492 2123.85,510.108 2126.16,375.816 2128.47,553.883 2130.78,482.801 2133.08,518.271 2135.39,472.273 2137.7,535.832 2140.01,367.636 2142.32,425.461 2144.62,519.318 2146.93,243.924 2149.24,575.143 2151.55,533.943 2153.86,440.5 2156.16,417.628 2158.47,341.935 2160.78,350.545 2163.09,424.581 2165.4,410.227 2167.7,319.301 2170.01,225.132 2172.32,449.169 2174.63,448.218 2176.93,241.013 2179.24,353.062 2181.55,405.396 2183.86,230.436 2186.17,428.52 2188.47,382.211 2190.78,311.824 2193.09,452.12 2195.4,583.226 2197.71,536.18 2200.01,452.98 2202.32,530.621 2204.63,443.168 2206.94,415.476 2209.25,417.016 2211.55,422.314 2213.86,272.076 2216.17,611.405 2218.48,482.992 2220.79,497.802 2223.09,423.2 2225.4,640.132 2227.71,452.511 2230.02,360.952 2232.32,489.719 2234.63,598.032 2236.94,442.76 2239.25,479.051 2241.56,378.453 2243.86,329.608 2246.17,464.236 2248.48,437.743 2250.79,390.632 2253.1,408.944 2255.4,434.064 2257.71,540.482 2260.02,420.224 2262.33,405.527 2264.64,464.587 2266.94,544.114 2269.25,232.096 2271.56,310.077 2273.87,419.045 2276.18,273.024 2278.48,473.281 2280.79,444.428 2283.1,308.216 2285.41,475.297 2287.71,255.033 2290.02,267.45 2292.33,567.818 2294.64,256.102 2296.95,360.833 2299.25,482.629 2301.56,407.13 2303.87,418.952 2306.18,494.377 2308.49,504.597 2310.79,262.967 2313.1,661.089 2315.41,487.981 2317.72,445.817 2320.03,376.704 2322.33,348.071 2324.64,487.124 2326.95,463.621 2329.26,357.609 2331.56,343.691 2333.87,504.511 2336.18,546.682 2338.49,290.323 2340.8,281.51 2343.1,413.785 2345.41,456.571 2347.72,317.545 2350.03,504.482 2352.34,525.843 2354.64,365.919 2356.95,479.056 2359.26,386.468 2361.57,462.599 2363.88,460.593 2366.18,367.71 2368.49,385.212 2370.8,353.505 2373.11,468.157 2375.42,585.184 2377.72,503.587 2380.03,360.743 2382.34,485.418 2384.65,281.66 2386.95,444.384 2389.26,469.519 2391.57,420.354 2393.88,333.976 2396.19,431.897 2398.49,280.183 2400.8,347.692 2403.11,371.105 2405.42,376.888 2407.73,459.244 2410.03,303.541 2412.34,440.548 2414.65,400.05 2416.96,673.248 2419.27,548.566 2421.57,413.177 2423.88,413.013 2426.19,512.403 2428.5,446.357 2430.81,464.472 2433.11,460.577 2435.42,360.408 2437.73,371.205 2440.04,346.484 2442.34,589.503 2444.65,397.864 2446.96,617.86 2449.27,455.557 2451.58,464.361 2453.88,406.997 2456.19,443.927 2458.5,375.165 2460.81,349.2 2463.12,409.014 2465.42,470.578 2467.73,174.815 2470.04,355.297 2472.35,436.889 2474.66,576.994 2476.96,664.222 2479.27,438.279 2481.58,588.668 2483.89,563.938 2486.2,501.972 2488.5,559.542 2490.81,452.821 2493.12,387.031 2495.43,561.565 2497.73,410.628 2500.04,466.204 2502.35,318.367 2504.66,452.157 2506.97,341.76 2509.27,402.818 2511.58,605.268 2513.89,355.877 2516.2,516.591 2518.51,324.069 2520.81,458.318 2523.12,382.745 2525.43,382.323 2527.74,310.536 2530.05,280.551 2532.35,431.905 2534.66,582.26 2536.97,520.181 2539.28,416.208 2541.58,247.152 2543.89,390.947 2546.2,576.686 2548.51,497.706 2550.82,491.547 2553.12,324.79 2555.43,414.538 2557.74,233.768 2560.05,458.612 2562.36,424.546 2564.66,421.218 2566.97,423.589 2569.28,536.363 2571.59,423.967 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -2.7083    -4.07086   -5.82915  -5.82915  …  -4.13656  -4.15156   -5.50566
  0.713171   0.907818   1.5843    1.5843      -0.27122  -0.265606   2.16141
  1.45896    3.22676    5.03256   5.03256      4.10402   4.16808    4.83384

[:, :, 2] =
 -1.44347  -3.87815   -4.04853   -4.80691  …  -5.53837  -5.53837  -3.20723
  1.03133   0.170357   0.392794   0.9556       0.2806    0.2806    1.6332
  2.82647   4.50543    6.70662    5.85267      4.30146   4.30146   3.91211

[:, :, 3] =
 -2.42827   -3.66298  -4.58214  -3.87491   …  -4.85816  -3.99127   -2.70635
 -0.859234  -1.95825  -1.31681  -0.560232     -1.07133   0.312253  -1.02183
  4.74496    5.9635    6.16669   5.76612       4.33264   2.77904    4.5469

[:, :, 4] =
 -0.190601  -1.19976   -4.27775  -3.61573   …  -4.06073  -5.9227   -5.56183
 -0.457277  -0.498981  -1.18102  -0.361314     -1.78257  -1.6117   -0.776974
  1.88985    4.26624    4.59945   4.60919       4.84376   5.22362   4.33679</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.98521     1.00474
 -0.00841302  1.00078
  4.98347     1.00327</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.57 seconds
Compute duration  = 2.57 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -4.9963    1.0208    0.0177   3304.7049   5213.4793    1.0001   ⋯
        x[2]   -0.0272    0.9903    0.0177   3129.7418   5842.2129    1.0006   ⋯
        x[3]    5.0080    1.0051    0.0177   3213.8009   4761.8834    1.0010   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -6.9719   -5.6928   -4.9973   -4.2958   -3.0254
        x[2]   -1.9847   -0.6975   -0.0294    0.6537    1.8900
        x[3]    3.0313    4.3360    5.0101    5.6909    6.9344</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.5 seconds
Compute duration  = 1.5 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.5047    0.1890    0.0028   4407.2005   6142.6759    1.0005   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1511    0.3613    0.5074    0.6453    0.8599</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.24 seconds
Compute duration  = 0.24 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk   ess_tail      rhat    ⋯
      Symbol   Float64   Float64   Float64     Float64    Float64   Float64    ⋯

           x    0.9587    0.0247    0.0004   3133.8728        NaN    1.0002    ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.9591    0.9591    0.9591    0.9591    0.9591</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(-0.9834679793748089, "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with -0.9834679793748089:
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/nmUhn/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/nmUhn/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/compiler.jl:579 [inlined]
  [7] demo(__model__::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, __varinfo__::DynamicPPL.ThreadSafeVarInfo{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, Vector{Base.RefValue{Float64}}}, __context__::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:592
  [8] _evaluate!!
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:973 [inlined]
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, context::DynamicPPL.ValuesAsInModelContext{OrderedDict{Any, Any}, DynamicPPL.DefaultContext})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:962
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/model.jl:892 [inlined]
 [11] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/values_as_in_model.jl:196 [inlined]
 [12] values_as_in_model
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/values_as_in_model.jl:195 [inlined]
 [13] getparams(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:343
 [14] Turing.Inference.Transition(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, vi::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, t::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:226
 [15] transition_to_turing
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:12 [inlined]
 [16] transition_to_turing(f::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, transition::MALASample{Vector{Float64}})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:17
 [17] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}; initial_state::Nothing, initial_params::Nothing, kwargs::@Kwargs{})
    @ Turing.Inference ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:141
 [18] step
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/abstractmcmc.jl:96 [inlined]
 [19] macro expansion
    @ ~/.julia/packages/AbstractMCMC/YrmkI/src/sample.jl:130 [inlined]
 [20] macro expansion
    @ ~/.julia/packages/AbstractMCMC/YrmkI/src/logging.jl:16 [inlined]
 [21] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/YrmkI/src/sample.jl:120
 [22] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/MjWTB/src/sampler.jl:93
 [23] sample
    @ ~/.julia/packages/DynamicPPL/MjWTB/src/sampler.jl:83 [inlined]
 [24] #sample#4
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:276 [inlined]
 [25] sample
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:267 [inlined]
 [26] #sample#3
    @ ~/.julia/packages/Turing/Bv30p/src/mcmc/Inference.jl:264 [inlined]
 [27] top-level scope
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:594</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.65 seconds
Compute duration  = 1.65 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    5.8623    0.0000    0.0000        NaN        NaN       NaN     ⋯
           x   -1.6463    0.0000    0.0000        NaN        NaN       NaN     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    5.8623    5.8623    5.8623    5.8623    5.8623
           x   -1.6463   -1.6463   -1.6463   -1.6463   -1.6463</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 3.07 seconds
Compute duration  = 3.07 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8668    0.5531    0.0235   412.9642   262.2750    1.0072     ⋯
           x   -0.0291    1.0118    0.0501   542.3363   277.2740    1.0025     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1240    0.4226    0.7540    1.2125    2.1522
           x   -2.4149   -0.4308   -0.0048    0.4467    2.1298</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>